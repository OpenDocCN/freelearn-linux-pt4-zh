# 前言

VMware 是 SDDC 的先驱和领导者，拥有多种工具；VCM 负责基于策略的合规性管理和基础设施的补丁管理。

VCM 通过自动收集数据并根据行业标准（如 VMware 和 Microsoft 硬化指南、CIS 基准、PCI DSS 和 FISMA 等）进行分析，帮助保持基础设施的合规性。它帮助您为机器打上操作系统厂商发布的最新补丁，并自动化软件配置。在集成 vROps 后，您可以在 vROps 控制台上查看您的合规性得分。

本书提供了安装 VCM 以及初始配置的步骤指南，接着继续与其他 VMware 工具进行集成。之后，我们继续介绍 Linux 和 Windows 机器的合规性配置和补丁管理。我们还有一章内容将帮助您配置 VCM，以便从 VCM 部署软件。

您可以将本书作为指南，全面探索 VCM 的所有功能，在故障排除部分，您还可以查看在日常使用 VCM 时可能遇到的问题。

# 本书内容

第一章，*安装 VCM*，讨论了 vRealize 配置管理器（VCM）的组成部分、安装 VCM 的各种选项，包括先决条件，并以微调 VCM 使用的数据库服务器作为结束。

第二章，*配置 VCM 来管理您的基础设施*，讨论了更多关于 VCM 配置的内容，并且我们开始添加虚拟基础设施元素、安装代理程序，并配置发现功能。

第三章，*Linux 补丁管理*，展示了如何安装软件内容库（SCR），该库用于下载和分发补丁，接着执行配置和分发补丁到托管的 Linux/Unix 服务器所需的所有步骤。

第四章，*Windows 补丁管理*，展示了如何配置 VCM 与 Microsoft 服务器同步补丁，检查托管 Windows 机器的状态，并最终按需或按计划安装补丁。

第五章，*Windows 的软件配置*，讨论了如何使用 VCM 在托管的 Windows 机器上分发软件；无论是服务器还是桌面，过程都是相同的。

第六章，*合规性管理*，教您如何导入和导出合规性配置，创建适用于 Windows 和 Unix/Linux 的合规性规则，并进行虚拟化操作。

第七章，*VCM 的维护*，讨论了如何升级 VCM、修改服务帐户、更换 VCM 升级后的代理程序、退役托管的机器，并提供了一些命名规范供使用。

第八章，*与 vROps 的集成和调度*，详细介绍了如何将 VCM 与 vROps 集成，并使用 VCM 的调度功能来安排报告、合规性、数据收集等任务。

第九章，*VCM 故障排除*，是最后一章，讨论了在 VCM 中故障排除的各种问题，如代理通信和代理升级。我们列出了用于故障排除的基本工具，如作业管理器历史记录和 EcmDebugEventViewer.exe。

# 本书所需的内容

如果你计划按照书中的配方进行实践（强烈推荐），你将需要一个好的实验室来工作。由于 VCM 与多个 VMware 组件配合工作，并且你可能还需要测试集成，因此你需要一台至少配备 32 GB 内存、四核处理器、1 TB 硬盘和 256 GB 固态硬盘的机器。你可以安装你喜欢的操作系统，并在其上安装 VMware Workstation 或 VirtualBox。你需要创建一个小型实验室，其中包括 Windows 域控制器和几台托管 SQL、vCenter、VCM 等的 Windows 服务器。你还可以安装其他组件，如 vCloud Director、vROps 和 vCNS。有时，32 GB 内存可能不够用，所以只启动你需要的虚拟机。基本功能可以在你配备 16 GB 内存的笔记本便携实验室上进行测试，但不包括 vCD、vROps 和 VCNS。

以下是我的实验室规格：

实验室 01：这是我家里的桌面，配备 32 GB DDR3 内存、AMD FX6300 六核处理器、256 GB 固态硬盘和 1 TB 硬盘。

实验室 02：这是我在笔记本电脑上的便携实验室，配备 16 GB DDR3 内存、Intel i5 四核处理器和 256 GB 硬盘。

# 本书适合谁

如果你是一名系统管理员，渴望通过 VCM 提供更好的管理，并且熟悉网络用户和资源管理，以及执行系统维护，那么这本书适合你。

# 章节

在本书中，你会发现几个经常出现的标题（准备工作、如何做、原理、更多内容以及另见）。

为了提供清晰的操作指引，我们使用以下这些章节：

## 准备工作

本节告诉你在配方中应该期待什么，并描述如何设置所需的软件或任何初步设置。

## 如何操作…

本节包含执行配方所需的步骤。

## 如何操作…

本节通常包括对上一节内容的详细解释。

## 更多内容…

本节包含有关配方的附加信息，旨在让读者更好地了解配方。

## 另见

本节提供有用的链接，指向与配方相关的其他有用信息。

# 约定

本书中有多种文本样式，用于区分不同类型的信息。以下是这些样式的一些示例及其含义的解释。

文本中的代码字、数据库表名、文件夹名称、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 用户名将按以下方式显示：“代理程序可在 VCM Collector 服务器上的`X: \Program Files (x86)\VMware\VCM\Installer\Packages\CMAgent.5.8.2.linux`位置找到。”

代码块按以下方式设置：

```
***  Installation Started 03/03/2016 3:57  ***
Title: EcmComSocketListenerService
Source: C:\windows\TEMP\GLB90C6.tmp | 03-03-2016 | 03:57:04 | 71680
Rem Wise Error Number: 141
Rem Function Name: EcmCreateService
Rem Error Message: Caught an exception from wise : Call to 
EcmCreateService for service CSI Socket Listener failed with error code 
of 1072 : error code 141
141
```

任何命令行输入或输出都按以下方式书写：

```
cd "PatchRepo/Repos"/unix 
rm SystemId*.xml

```

新术语和重要单词以粗体显示。在屏幕上看到的单词，例如菜单或对话框中的内容，将在文本中以这样的形式出现：“点击**添加**以启动向导。”

### 注意

警告或重要说明将以这样的框框呈现。

### 小贴士

小贴士和技巧如下所示。

# 读者反馈

我们始终欢迎读者反馈。告诉我们你对本书的看法——你喜欢或不喜欢什么。读者的反馈对我们非常重要，它帮助我们开发出更符合你需求的书籍。要发送一般反馈，只需通过电子邮件`feedback@packtpub.com`联系我们，并在邮件主题中注明书名。如果你在某个领域具有专业知识，并且有兴趣撰写或参与编写书籍，请参考我们的作者指南：[www.packtpub.com/authors](http://www.packtpub.com/authors)。

# 客户支持

既然你已经成为 Packt 书籍的骄傲拥有者，我们为你提供了一些帮助，以便你能够最大限度地利用你的购买。

## 勘误

尽管我们已经尽最大努力确保内容的准确性，但错误仍然可能发生。如果你在我们的书籍中发现任何错误——可能是文本或代码中的错误——我们将非常感激你能向我们报告。通过这样做，你可以帮助其他读者避免困扰，并帮助我们改进书籍的后续版本。如果你发现任何勘误，请访问[`www.packtpub.com/submit-errata`](http://www.packtpub.com/submit-errata)报告，选择你的书籍，点击**勘误提交表单**链接，输入勘误的详细信息。一旦你的勘误被验证，你的提交将被接受，勘误将被上传到我们的网站或添加到该书籍的**勘误**部分的现有勘误列表中。

要查看以前提交的勘误，请访问[`www.packtpub.com/books/content/support`](https://www.packtpub.com/books/content/support)，并在搜索框中输入书名。所需的信息将显示在勘误部分下。

## 盗版

互联网版权材料的盗版问题在所有媒体中都普遍存在。在 Packt，我们非常重视版权和许可证的保护。如果你在互联网上发现我们作品的任何非法复制品，请立即提供其位置地址或网站名称，以便我们采取措施。

如发现涉嫌盗版的内容，请通过 copyright@packtpub.com 与我们联系，并提供链接。

我们感谢你在保护我们的作者及我们提供有价值内容方面的帮助。

## 问题

如果你对本书的任何部分有疑问，可以通过 questions@packtpub.com 与我们联系，我们将尽力解决问题。
