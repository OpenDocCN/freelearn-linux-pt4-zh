- en: Chapter 4. File Sharing
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第4章. 文件共享
- en: 'In this chapter, we will cover:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 本章内容包括：
- en: Mounting USB disks (`pmount`)
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 挂载 USB 硬盘（`pmount`）
- en: Accessing another computer's files (`smbclient`)
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 访问其他计算机的文件（`smbclient`）
- en: Sharing folders from other computers (`mount.cifs`)
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从其他计算机共享文件夹（`mount.cifs`）
- en: Auto-mounting USB disks at boot (`/etc/fstab`)
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在启动时自动挂载 USB 硬盘（`/etc/fstab`）
- en: Auto-mounting a shared folder at boot
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在启动时自动挂载共享文件夹
- en: Creating a file server (Samba)
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建文件服务器（Samba）
- en: Sharing an attached USB disk (Samba)
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 分享附加的 USB 硬盘（Samba）
- en: Introduction
  id: totrans-9
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 简介
- en: The Raspberry Pi recipes in this chapter are for sharing files with other computers
    on the same local network.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 本章中的树莓派配方用于与同一局域网中的其他计算机共享文件。
- en: The chapter begins with a recipe for mounting USB disks that are attached to
    the Raspberry Pi. The next recipes show how files are exchanged with other computers
    using the SMB (CIFS) protocol. Then, there are two recipes showing how disks can
    be automatically mounted during boot. The chapter ends with a couple of recipes
    for setting up the Raspberry Pi as a file server.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 本章从挂载连接到树莓派的 USB 硬盘的配方开始。接下来的配方展示了如何使用 SMB（CIFS）协议与其他计算机交换文件。然后，有两个配方展示了如何在启动时自动挂载磁盘。本章以几个配方结束，介绍如何将树莓派设置为文件服务器。
- en: After completing the recipes in this chapter, you will be able to automatically
    mount local USB disks and exchange files between the Raspberry Pi and other computers
    using the SMB (CIFS) protocol.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 完成本章的配方后，你将能够自动挂载本地 USB 硬盘，并使用 SMB（CIFS）协议在树莓派和其他计算机之间交换文件。
- en: Mounting USB disks (pmount)
  id: totrans-13
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 挂载 USB 硬盘（pmount）
- en: This recipe installs and applies `pmount`, a command that mounts USB disks attached
    directly to the Raspberry Pi in the same manner as the desktop file manager.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 本配方安装并应用`pmount`命令，该命令以与桌面文件管理器相同的方式挂载直接连接到树莓派的 USB 硬盘。
- en: If a disk is connected to the Raspberry Pi via a USB port when using the Raspberry
    Pi's **graphical user interface** (**GUI**), the desktop file manager will ask
    the user's permission to mount the disk. However, when using a Raspberry Pi remotely
    (or when the Raspberry Pi has been booted in text mode), there is no GUI to ask
    if a file should be mounted.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 如果通过 USB 端口将磁盘连接到树莓派，使用树莓派的**图形用户界面**（**GUI**）时，桌面文件管理器会请求用户许可来挂载磁盘。然而，当远程使用树莓派（或树莓派以文本模式启动时），没有图形界面来询问是否挂载文件。
- en: This recipe does not rely on the Raspberry Pi GUI or the desktop file manager
    to mount a disk. Instead, the command-line utility `pmount` is used to mount a
    USB drive in the same way that the GUI would—in the `/media` directory.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 本配方不依赖树莓派的 GUI 或桌面文件管理器来挂载磁盘。相反，使用命令行工具`pmount`以与 GUI 相同的方式挂载 USB 驱动器——在 `/media`
    目录中。
- en: Once you've completed this recipe, you will be able to use both large USB storage
    devices and small USB flash drives to exchange files with other computers without
    relying on the Raspberry Pi graphical user interface or the desktop file manager.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 完成本配方后，你将能够使用大型 USB 存储设备和小型 USB 闪存驱动器与其他计算机交换文件，而无需依赖树莓派的图形用户界面或桌面文件管理器。
- en: Getting ready
  id: totrans-18
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: 'Here are the ingredients used in this recipe:'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 这里是本配方使用的配料：
- en: An initial setup or basic networking setup for the Raspberry Pi that has been
    powered on. You have also logged in as the user `pi` (see the recipes in [Chapter
    1](ch01.html "Chapter 1. Installation and Setup"), *Installation and Setup*, for
    how to boot and log in and the recipes in [Chapter 2](ch02.html "Chapter 2. Administration"),
    *Administration*, for how to log in remotely).
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 树莓派的初始设置或基本网络设置，已开启电源。你还需要以 `pi` 用户登录（有关如何启动和登录的信息，请参见[第1章](ch01.html "第1章.
    安装与设置")，*安装与设置*，以及[第2章](ch02.html "第2章. 管理")，*管理*中的远程登录配方）。
- en: A powered USB hub (recommended).
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个带电的 USB 集线器（推荐）。
- en: At least one USB disk drive.
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 至少需要一个 USB 硬盘驱动器。
- en: This recipe does not require the desktop GUI and could either be run from the
    text-based console or from within an LXTerminal.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 本配方不需要桌面 GUI，可以在基于文本的控制台或 LXTerminal 中运行。
- en: If the Raspberry Pi's Secure Shell server is running, this recipe can be completed
    remotely using a Secure Shell client (see the *Remote Access (SSH)* recipe in
    [Chapter 2](ch02.html "Chapter 2. Administration"), *Administration*).
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 如果树莓派的安全外壳服务器正在运行，则可以通过安全外壳客户端远程完成此配方（参见[第2章](ch02.html "第2章. 管理")中的*远程访问（SSH）*配方，*管理*）。
- en: 'The examples in this recipe use two USB drives: a 32 GB flash drive and a 500
    GB disk.'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 本配方中的示例使用了两个USB驱动器：一个32 GB的闪存驱动器和一个500 GB的磁盘。
- en: Note
  id: totrans-26
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Beware! The Raspberry Pi has power limits.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 小心！树莓派有电力限制。
- en: The Raspberry Pi does not have enough internal power to reliably power a large
    USB disk that has been directly connected to the Raspberry Pi's USB ports.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 树莓派没有足够的内部电力来可靠地驱动直接连接到树莓派USB端口的大型USB磁盘。
- en: To ensure that the Raspberry Pi continues to function optimally, you should
    attach any device that requires power (including USB disks) indirectly to the
    Raspberry Pi via a powered USB hub.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 为确保树莓派持续良好运作，任何需要电力的设备（包括USB磁盘）都应该通过带电源的USB集线器间接连接到树莓派。
- en: A powered USB hub provides enough power to run several large USB drives without
    draining extra power from the Raspberry Pi.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 带电源的USB集线器提供足够的电力来运行多个大型USB驱动器，而不需要额外从树莓派获取电力。
- en: If you see a large colorful square glowing in the top-right corner of the GUI,
    it is a warning that your Raspberry Pi does not have enough power.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你看到图形用户界面右上角有一个大而五颜六色的方块闪烁，那是一个警告，表示你的树莓派电力不足。
- en: How to do it...
  id: totrans-32
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 怎么做...
- en: 'The steps to mount USB disks are as follows:'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 挂载USB磁盘的步骤如下：
- en: Log in to the Raspberry Pi either directly or remotely.
  id: totrans-34
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 直接或远程登录到树莓派。
- en: Use `apt-get` to install the `pmount` command.
  id: totrans-35
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`apt-get`来安装`pmount`命令。
- en: '[PRE0]'
  id: totrans-36
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: The `apt-get install` command downloads and installs `pmount`.
  id: totrans-37
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`apt-get install`命令下载并安装`pmount`。'
- en: '[PRE1]'
  id: totrans-38
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Connect one or more USB disks to the Raspberry Pi. The example includes two
    disks: a 32 GB flash drive and a 500 GB disk.'
  id: totrans-39
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将一个或多个USB磁盘连接到树莓派。示例中包括两个磁盘：一个32 GB的闪存驱动器和一个500 GB的磁盘。
- en: Use the `fdisk –l` command to list the disks that are currently attached to
    the Raspberry Pi.
  id: totrans-40
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`fdisk –l`命令列出当前连接到树莓派的磁盘。
- en: '[PRE2]'
  id: totrans-41
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: The `fdisk` command displays information about the disks that are attached to
    the Raspberry Pi.
  id: totrans-42
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`fdisk`命令显示有关连接到树莓派的磁盘的信息。'
- en: '[PRE3]'
  id: totrans-43
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'The command output in the preceding example shows three disks:'
  id: totrans-44
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 上述命令输出显示了三个磁盘：
- en: '`/dev/mmcblk0`: The 31.9 GB SD card (the boot disk) has two partitions: `/dev/mmcblk0p1`
    and `/dev/mmcblk0p2`'
  id: totrans-45
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/dev/mmcblk0`：31.9 GB的SD卡（启动磁盘）有两个分区：`/dev/mmcblk0p1`和`/dev/mmcblk0p2`'
- en: '`/dev/sda`: The 128 MB flash drive has one partition'
  id: totrans-46
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/dev/sda`：128 MB的闪存驱动器有一个分区'
- en: '`/dev/sdb`: The 500.1 GB disk also has one partition'
  id: totrans-47
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/dev/sdb`：500.1 GB的磁盘也有一个分区'
- en: Use the freshly installed `pmount` command to mount the primary partition of
    the flash drive (`/dev/sda1`) and the primary partition of the USB disk (`/dev/sdb1`).
    The `sudo` command is not required.
  id: totrans-48
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用新安装的`pmount`命令来挂载闪存驱动器的主分区(`/dev/sda1`)和USB磁盘的主分区(`/dev/sdb1`)。无需使用`sudo`命令。
- en: '[PRE4]'
  id: totrans-49
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE4]'
- en: The preceding command output shows the contents of the `/media` directory before
    and after the `pmount` command is used to mount the two disks. After the `pmount`
    command is executed, each disk appears in the `/media` directory.
  id: totrans-50
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 上述命令输出显示了在使用`pmount`命令挂载两个磁盘之前和之后`/media`目录的内容。执行`pmount`命令后，每个磁盘都出现在`/media`目录中。
- en: 'The `df –h` command can also be used to display a list of the currently mounted
    disks with their mount points. In the following command output, the two disks,
    `/dev/sda1` and `/dev/sdb1`, are shown mounted on `/media/sda1` and `/media/sdb1`:'
  id: totrans-51
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`df –h`命令也可以用来显示当前挂载的磁盘及其挂载点。在以下命令输出中，两个磁盘`/dev/sda1`和`/dev/sdb1`分别挂载在`/media/sda1`和`/media/sdb1`：'
- en: '[PRE5]'
  id: totrans-52
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE5]'
- en: How it works...
  id: totrans-53
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: 'After logging in to the Raspberry Pi, the `pmount` command is installed, the
    two disk drives are attached, and the command `fdisk –l` is used to display the
    partition tables of the disks attached to the Raspberry Pi. In the example, three
    disks are displayed:'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 登录到树莓派后，安装`pmount`命令，连接两个磁盘驱动器，使用命令`fdisk –l`显示连接到树莓派的磁盘的分区表。在示例中，显示了三个磁盘：
- en: '`/dev/mmcblk0` is the boot disk'
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/dev/mmcblk0`是启动磁盘'
- en: '`/dev/sda` is the 128 MB flash drive'
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/dev/sda`是128 MB的闪存驱动器'
- en: '`/dev/sdb` is the 500 GB disk'
  id: totrans-57
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/dev/sdb`是500 GB磁盘'
- en: The flash drive has one partition (`/dev/sda1`) and so does the disk (`/dev/sdb1`).
    Within disk partitions, is where files are stored.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 闪存驱动器有一个分区(`/dev/sda1`)，磁盘也有一个分区(`/dev/sdb1`)。文件存储在磁盘分区中。
- en: The `pmount` command is used to mount disk partitions. The disk partitions are
    mounted in the `/media` directory. The `ls –l` command is used before and after
    the disks are mounted to show where the disk partitions appear once they have
    been mounted.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: '`pmount`命令用于挂载磁盘分区。磁盘分区挂载在`/media`目录下。使用`ls –l`命令在挂载前后显示磁盘分区挂载的位置。'
- en: The mount points in the `/media` directory are given names that correspond to
    the disk partitions that have been mounted there. The disk partition of the flash
    drive, `/dev/sda1`, is mounted on `/media/sda1` and the disk partition of the
    500 GB disk, `/dev/sdb1`, is mounted on `/media/sdb1`.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: '`/media`目录中的挂载点被赋予了与已挂载磁盘分区相对应的名称。闪存驱动器的磁盘分区`/dev/sda1`被挂载在`/media/sda1`，而500
    GB磁盘的磁盘分区`/dev/sdb1`则被挂载在`/media/sdb1`。'
- en: Finally, the `df –h` command is used to demonstrate another way of seeing where
    the disk partitions have been mounted. The `df` command also shows the amount
    of free disk space that is available on each of the mounted disks. The `–h` option
    tells `df` to display the size of each disk in bytes, instead of in disk blocks.
    The 500 GB disk is 40% full; it has 264 GB available. The flash drive is 58% full
    with only 53 MB available.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，使用`df -h`命令展示了另一种查看磁盘分区已挂载位置的方法。`df`命令还显示了每个已挂载磁盘上可用的空闲磁盘空间。`-h`选项告诉`df`以字节为单位显示每个磁盘的大小，而不是以磁盘块为单位。500
    GB磁盘已使用40%，还有264 GB可用。闪存驱动器已使用58%，只剩下53 MB可用。
- en: There's more...
  id: totrans-62
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多…
- en: Let's learn something more about the disks.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们更多地了解一下磁盘。
- en: Device files
  id: totrans-64
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 设备文件
- en: As each disk or disk partition is mounted, a device file is created for it and
    stored in the `/dev` directory. The names of each of these device files are assigned
    sequentially as the disks are mounted.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 当每个磁盘或磁盘分区被挂载时，会为其创建一个设备文件并存储在`/dev`目录下。这些设备文件的名称会随着磁盘的挂载顺序依次分配。
- en: The assigned names of USB drives all begin with the characters `sd`. The first
    USB disk drive is assigned the device file `/dev/sda`, the second `/dev/sdb`,
    and so on.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: USB驱动器的分配名称都以`sd`开头。第一个USB磁盘驱动器被分配了设备文件`/dev/sda`，第二个则是`/dev/sdb`，依此类推。
- en: The assigned names of the SD card drives begin with `mmcblk`, and a digit is
    added for each unique device starting with `0` (zero). The only SD card drive
    in the Raspberry Pi (the boot disk) has its device file located at `/dev/mmcblk0`.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: SD卡驱动器的分配名称以`mmcblk`开头，并为每个唯一的设备添加一个数字，从`0`开始。树莓派中的唯一SD卡驱动器（启动磁盘）的设备文件位于`/dev/mmcblk0`。
- en: For each disk partition discovered in a disk's partition table, a device file
    is also created. Each of these disk partition device files has the same name as
    the disk's device file with a digit attached corresponding to its location in
    the partition table.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 对于在磁盘分区表中发现的每个磁盘分区，也会创建一个设备文件。每个磁盘分区的设备文件与磁盘的设备文件名称相同，并附加一个数字，表示其在分区表中的位置。
- en: 'In the example, the 32 GB SD card is assigned the device file `/dev/mmcblk0`.
    It has two partitions: `/dev/mmcblk0p1` and `/dev/mmcblk0p2`. If the SD card had
    yet another partition, the third partition''s device file would be `/dev/mmcblk0p3`.'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个例子中，32 GB SD卡被分配了设备文件`/dev/mmcblk0`。它有两个分区：`/dev/mmcblk0p1`和`/dev/mmcblk0p2`。如果SD卡还有另一个分区，那么第三个分区的设备文件将是`/dev/mmcblk0p3`。
- en: When a disk has a partition table, each partition needs to be mounted separately.
    Use the `pmount` command with the partition's device file, not the disk device
    file. The 500 GB disk in the example has one partition that is mounted with the
    command `pmount /dev/sdb1`.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 当磁盘具有分区表时，每个分区需要单独挂载。使用`pmount`命令时，应使用分区的设备文件，而不是磁盘的设备文件。在示例中，500 GB磁盘有一个分区，可以使用命令`pmount
    /dev/sdb1`来挂载它。
- en: When a disk has no partition table, use the `pmount` command with the device
    file assigned to the disk drive.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 当磁盘没有分区表时，使用`pmount`命令时应使用分配给磁盘驱动器的设备文件。
- en: Mount points
  id: totrans-72
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 挂载点
- en: When disk partitions are mounted, by default a mount point is created for each
    partition in the `/media` directory. The name of the default mount point is the
    same as the name of the device file used to mount the disk partition.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 当磁盘分区被挂载时，默认情况下会在`/media`目录下为每个分区创建一个挂载点。默认挂载点的名称与用于挂载磁盘分区的设备文件名称相同。
- en: The only partition of the 128 MB flash drive was assigned the device file `/dev/sda1`,
    so by default its mount point is `/media/sda1`. The 500 GB disk also has one partition,
    `/dev/sdb1`, mounted at `/media/sdb1`.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 128 MB闪存驱动器的唯一分区被分配了设备文件`/dev/sda1`，因此默认的挂载点是`/media/sda1`。500 GB磁盘也只有一个分区`/dev/sdb1`，被挂载在`/media/sdb1`。
- en: 'To create a mount point under the `/media` directory with a name other than
    the default name, you need to pass the desired mount point as a second parameter
    of the `pmount` command, as in the following example:'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 若要在`/media`目录下创建一个与默认名称不同的挂载点，您需要将所需的挂载点作为第二个参数传递给`pmount`命令，如以下示例所示：
- en: '[PRE6]'
  id: totrans-76
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Unmounting disks
  id: totrans-77
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 卸载磁盘
- en: Use the `pumount` command to unmount the disks (there is no `n` in the command
    name). After the disks are unmounted, their mount points are deleted from the
    `/media` directory.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 `pumount` 命令卸载磁盘（命令名中没有 `n`）。磁盘卸载后，它们的挂载点会从 `/media` 目录中删除。
- en: '[PRE7]'
  id: totrans-79
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: As shown in the preceding example, the `pumount` command accepts either the
    disk device (`/dev/sda1`) or the mount point (`/media/mydisk`).
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 如前面的示例所示，`pumount` 命令接受磁盘设备（`/dev/sda1`）或挂载点（`/media/mydisk`）作为参数。
- en: The plugdev group
  id: totrans-81
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: plugdev 组
- en: Use of the `pmount` command does not require super user privileges. However,
    it does require some privileges. The privilege to execute the `pmount` command
    is reserved for members of the system group `plugdev`. Users who are not in the
    group `plugdev` cannot execute the `pmount` command.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 `pmount` 命令不需要超级用户权限，但仍然需要一定的权限。执行 `pmount` 命令的权限仅限于 `plugdev` 系统组的成员。不在
    `plugdev` 组中的用户无法执行 `pmount` 命令。
- en: '[PRE8]'
  id: totrans-83
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: Note
  id: totrans-84
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: On Raspbian, the default user, `pi`, is already a member of the `plugdev` group.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Raspbian 上，默认用户 `pi` 已经是 `plugdev` 组的成员。
- en: Other mount commands
  id: totrans-86
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 其他挂载命令
- en: The system command `mount` requires super user privileges. During the boot process,
    the mount command is used to automatically mount disks like the SD card from which
    the Raspberry Pi boots. The next recipe shows how to configure the Raspberry Pi
    to automatically mount attached drives when it boots.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 系统命令 `mount` 需要超级用户权限。在启动过程中，`mount` 命令会自动挂载像树莓派启动所用的 SD 卡这样的磁盘。下一个食谱将展示如何配置树莓派，使其在启动时自动挂载附加的驱动器。
- en: The file manager included with the Raspberry Pi desktop, PCManFM, will also
    mount disks in the `/media` directory. However, the PCManFM file manager uses
    the disk's label instead of the disk's device name as the name of the mount point.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 包含在树莓派桌面中的文件管理器 PCManFM 也会在 `/media` 目录中挂载磁盘。然而，PCManFM 文件管理器使用磁盘的标签作为挂载点的名称，而不是磁盘的设备名称。
- en: Disk performance
  id: totrans-89
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 磁盘性能
- en: A Class 10 SD card has a transfer rate of 10 MB per second, yet an external
    hard disk can transfer data to the computer at 300 MB/sec. The hard disk is almost
    30x faster than an SD card!
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: Class 10 SD 卡的传输速率为每秒 10 MB，而外部硬盘可以以每秒 300 MB 的速度向计算机传输数据。硬盘的速度几乎比 SD 卡快了 30
    倍！
- en: Even though SD cards can be purchased in increasingly large sizes, they are
    not the best choice for high-speed performance. Even the Ultra High Speed SD cards
    at 30 MB/sec are 10x slower than a hard disk. Most of the recipes in this book
    will perform better if the data that they depend on is stored on an external hard
    disk.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管 SD 卡的容量越来越大，但它们并不是高性能的最佳选择。即便是超高速 SD 卡，30 MB/sec 的速度也比硬盘慢 10 倍。本书中的大多数食谱如果依赖的数据存储在外部硬盘上，会表现得更好。
- en: The Raspberry Pi's power is limited
  id: totrans-92
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 树莓派的电力是有限的
- en: External disks and flash drives that have no power supply of their own draw
    power from the Raspberry Pi's USB connection. The power needed by devices without
    their own power supply is taken from the Raspberry Pi. The Raspberry Pi's power
    is limited; it cannot reliably support larger USB devices if the devices have
    no power supply of their own.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 没有独立电源的外部磁盘和闪存驱动器通过树莓派的 USB 连接来获取电力。没有自供电的设备所需的电力由树莓派提供。树莓派的电力是有限的；如果设备没有独立电源，它无法可靠地支持较大的
    USB 设备。
- en: The amount of power needed by an external USB device could easily exceed the
    amount of power that is available from the Raspberry Pi. If too much power is
    drawn from the Raspberry Pi, other USB devices, including the network interface
    (which internally uses the USB bus), may cease to function properly or they may
    cease to function at all.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 外部 USB 设备所需的电力可能会轻易超过树莓派提供的电力。如果从树莓派提取的电力过多，其他 USB 设备，包括网络接口（内部使用 USB 总线）可能无法正常工作，甚至可能完全失效。
- en: For best performance and reliability, it is recommended that all USB devices,
    including external disk drives and flash drives, be connected *indirectly* to
    the Raspberry Pi via a powered USB hub instead of being connected to the Raspberry
    Pi directly.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 为了获得最佳的性能和可靠性，建议将所有 USB 设备（包括外部硬盘驱动器和闪存驱动器）通过一个有电源的 USB 集线器*间接*连接到树莓派，而不是直接连接到树莓派。
- en: A powered USB hub is the power source for all of the USB devices that are connected
    to it. Only data is transferred to the Raspberry Pi. A powered USB hub does not
    draw power from the Raspberry Pi. Instead, it protects the Raspberry Pi from the
    power drain of other devices. By connecting USB devices *indirectly* via a powered
    USB hub, the Raspberry Pi can perform optimally and reliably.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 一个带电源的USB集线器是所有连接到它的USB设备的电源来源。只有数据会传输到树莓派，而带电源的USB集线器不会从树莓派获取电力。相反，它保护树莓派免受其他设备的电力消耗影响。通过带电源的USB集线器*间接*连接USB设备，可以确保树莓派以最佳性能和可靠性运行。
- en: See also
  id: totrans-97
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另见
- en: '**Hard disk drive** ([http://en.wikipedia.org/wiki/Hard_disk_drive](http://en.wikipedia.org/wiki/Hard_disk_drive)):
    This Wikipedia article has more information about disk drives.'
  id: totrans-98
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**硬盘驱动器** ([http://en.wikipedia.org/wiki/Hard_disk_drive](http://en.wikipedia.org/wiki/Hard_disk_drive)):
    这篇维基百科文章提供了关于磁盘驱动器的更多信息。'
- en: '**USB flash drive** ([http://en.wikipedia.org/wiki/USB_flash_drive](http://en.wikipedia.org/wiki/USB_flash_drive)):
    This Wikipedia article provides detailed information about USB drives.'
  id: totrans-99
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**USB闪存驱动器** ([http://en.wikipedia.org/wiki/USB_flash_drive](http://en.wikipedia.org/wiki/USB_flash_drive)):
    这篇维基百科文章提供了关于USB闪存驱动器的详细信息。'
- en: '**SD cards** ([http://en.wikipedia.org/wiki/Secure_Digital](http://en.wikipedia.org/wiki/Secure_Digital)):
    This Wikipedia article is about the **Secure Digital** (**SD**) card format.'
  id: totrans-100
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**SD卡** ([http://en.wikipedia.org/wiki/Secure_Digital](http://en.wikipedia.org/wiki/Secure_Digital)):
    这篇维基百科文章介绍了**安全数字**（**SD**）卡格式。'
- en: '**mount (Unix)** ([http://en.wikipedia.org/wiki/Mount_(Unix)](http://en.wikipedia.org/wiki/Mount_(Unix))):
    This Wikipedia article is about the `mount` command.'
  id: totrans-101
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**mount (Unix)** ([http://en.wikipedia.org/wiki/Mount_(Unix)](http://en.wikipedia.org/wiki/Mount_(Unix))):
    这篇维基百科文章介绍了`mount`命令。'
- en: '**df – report filesystem disk space usage** ([http://manpages.debian.net/cgi-bin/man.cgi?query=df](http://manpages.debian.net/cgi-bin/man.cgi?query=df)):
    The Debian man page for `df` has more information about the command and its options.'
  id: totrans-102
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**df – 报告文件系统磁盘空间使用情况** ([http://manpages.debian.net/cgi-bin/man.cgi?query=df](http://manpages.debian.net/cgi-bin/man.cgi?query=df)):
    Debian的`df`手册页提供了关于该命令及其选项的更多信息。'
- en: '**fdisk – partition table manipulator for Linux** ([http://manpages.debian.net/cgi-bin/man.cgi?query=fdisk](http://manpages.debian.net/cgi-bin/man.cgi?query=fdisk)):
    The Debian man page for `fdisk` has more information about the command.'
  id: totrans-103
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**fdisk – Linux分区表操作工具** ([http://manpages.debian.net/cgi-bin/man.cgi?query=fdisk](http://manpages.debian.net/cgi-bin/man.cgi?query=fdisk)):
    Debian的`fdisk`手册页提供了关于该命令的更多信息。'
- en: '**pmount – mount arbitrary hotpluggable devices as normal user** ([http://manpages.debian.net/cgi-bin/man.cgi?query=pmount](http://manpages.debian.net/cgi-bin/man.cgi?query=pmount)):
    The Debian man page for `pmount` has more information about the command.'
  id: totrans-104
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**pmount – 以普通用户身份挂载任意热插拔设备** ([http://manpages.debian.net/cgi-bin/man.cgi?query=pmount](http://manpages.debian.net/cgi-bin/man.cgi?query=pmount)):
    Debian的`pmount`手册页提供了关于该命令的更多信息。'
- en: '**pumount – unmount arbitrary hotpluggable devices** ([http://manpages.debian.net/cgi-bin/man.cgi?query=pumount](http://manpages.debian.net/cgi-bin/man.cgi?query=pumount)):
    The Debian man page for `pumount` has more information about the command.'
  id: totrans-105
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**pumount – 卸载任意热插拔设备** ([http://manpages.debian.net/cgi-bin/man.cgi?query=pumount](http://manpages.debian.net/cgi-bin/man.cgi?query=pumount)):
    Debian的`pumount`手册页提供了关于该命令的更多信息。'
- en: '**udev – Linux dynamic device management** ([http://manpages.debian.net/cgi-bin/man.cgi?query=udev](http://manpages.debian.net/cgi-bin/man.cgi?query=udev)):
    The Debian man page for `udev` explains in more detail how devices are mounted.'
  id: totrans-106
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**udev – Linux动态设备管理** ([http://manpages.debian.net/cgi-bin/man.cgi?query=udev](http://manpages.debian.net/cgi-bin/man.cgi?query=udev)):
    Debian的`udev`手册页更详细地解释了设备如何挂载。'
- en: Accessing another computer's files (smbclient)
  id: totrans-107
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 访问另一台计算机的文件（smbclient）
- en: The goal of this recipe is to transfer files between the Raspberry Pi and other
    computers using the command `smbclient`.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 本教程的目标是通过`smbclient`命令在树莓派和其他计算机之间传输文件。
- en: This recipe shows how to list the available network shared folders, to copy
    individual files, and how to copy entire directories of files from a computer
    with shared folders to the Raspberry Pi using the `smbclient` command.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 本教程展示了如何列出可用的网络共享文件夹、复制单个文件，并使用`smbclient`命令将整个文件夹的文件从共享文件夹的计算机复制到树莓派。
- en: After completing this recipe, you will be able to list the available file shares
    on the local network and transfer files directly between another computer and
    the Raspberry Pi using the SMB (CIFS) protocol.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 完成本教程后，你将能够列出本地网络上可用的文件共享，并使用SMB（CIFS）协议直接在另一台计算机和树莓派之间传输文件。
- en: Getting ready...
  id: totrans-111
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备中...
- en: 'Here are the ingredients for this recipe:'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是本教程的材料：
- en: An initial setup or basic networking setup for the Raspberry Pi that has been
    powered on. You have also logged in as the user `pi` (see the recipes in [Chapter
    1](ch01.html "Chapter 1. Installation and Setup"), *Installation and Setup*, for
    how to boot and log in and the recipes in [Chapter 2](ch02.html "Chapter 2. Administration"),
    *Administration*, for how to log in remotely).
  id: totrans-113
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 树莓派已经开机并完成初始设置或基础网络设置。你也已经以用户`pi`登录（请参阅[第1章](ch01.html "第1章. 安装与设置")中的配方，*安装与设置*，了解如何启动和登录，以及[第2章](ch02.html
    "第2章. 管理")中的配方，*管理*，了解如何远程登录）。
- en: A network connection.
  id: totrans-114
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个网络连接。
- en: A client PC connected to the same network as the Raspberry Pi.
  id: totrans-115
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一台与树莓派连接到相同网络的客户端PC。
- en: This recipe does not require the desktop GUI and could either be run from the
    text-based console or from within an LXTerminal.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 本配方不需要桌面图形界面，可以在基于文本的控制台或LXTerminal中运行。
- en: If the Raspberry Pi's Secure Shell server is running, this recipe can be completed
    remotely using a Secure Shell client (see the recipe *Remote access (SSH)* in
    [Chapter 2](ch02.html "Chapter 2. Administration"), *Administration*).
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 如果树莓派的安全外壳服务器正在运行，则可以使用安全外壳客户端远程完成此配方（请参阅[第2章](ch02.html "第2章. 管理")中的配方*远程访问（SSH）*，*管理*）。
- en: The examples in this recipe will connect the Raspberry Pi to a local network
    computer, golden-mackbook, and a home file server, `terragolden`. Configuration
    for other computers using the SMB (CIFS) protocol will be similar.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 本配方中的示例将树莓派连接到本地网络计算机golden-macbook和家庭文件服务器`terragolden`。使用SMB（CIFS）协议的其他计算机配置将类似。
- en: How to do it...
  id: totrans-119
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作……
- en: 'The steps to accessing another computer''s files are as follows:'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 访问另一台计算机文件的步骤如下：
- en: Log in to the Raspberry Pi either directly or remotely.
  id: totrans-121
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 直接或通过远程登录到树莓派。
- en: Use the command `apt-get install` to download and install the `smbclient` software
    package.
  id: totrans-122
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用命令`apt-get install`下载并安装`smbclient`软件包。
- en: '[PRE9]'
  id: totrans-123
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE9]'
- en: Use the command `smbclient` to list the services (`-L`) on the home file server,
    `terragolden`. No password is required (`-N`) for guest access.
  id: totrans-124
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用命令`smbclient`列出家庭文件服务器`terragolden`上的服务（`-L`）。无需密码（`-N`）即可进行游客访问。
- en: '[PRE10]'
  id: totrans-125
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE10]'
- en: A list of SMB (CIFS) services from the home file server, `terrgolden`, is displayed.
  id: totrans-126
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 显示来自家庭文件服务器`terragolden`的SMB（CIFS）服务列表。
- en: '[PRE11]'
  id: totrans-127
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE11]'
- en: Use the command `smbclient` to list the services (`-L`) on the home computer,
    golden-macbook. A valid username (`-U`) and password is required for access.
  id: totrans-128
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用命令`smbclient`列出家庭计算机golden-macbook上的服务（`-L`）。访问需要有效的用户名（`-U`）和密码。
- en: '[PRE12]'
  id: totrans-129
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE12]'
- en: A list of SMB (CIFS) services from the golden-macbook is displayed.
  id: totrans-130
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 显示来自golden-macbook的SMB（CIFS）服务列表。
- en: '[PRE13]'
  id: totrans-131
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE13]'
- en: Now, use the `mkdir` command to create a new directory (`xfer`) on the Raspberry
    Pi, use the `cd` command to switch to the new directory, and then use the `ls`
    command to show that there are no files in the newly created directory (`~/xfer`).
  id: totrans-132
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，使用`mkdir`命令在树莓派上创建一个新目录（`xfer`），使用`cd`命令切换到新目录，然后使用`ls`命令显示新创建的目录（`~/xfer`）中没有文件。
- en: '[PRE14]'
  id: totrans-133
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE14]'
- en: Use the `smbclient` command to begin a conversation with the home file server,
    `terragolden`, about files in the file share `livemusic`.
  id: totrans-134
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`smbclient`命令与家庭文件服务器`terragolden`进行文件共享`livemusic`的对话。
- en: '[PRE15]'
  id: totrans-135
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'The command prompt, `smb: \>`, is displayed showing that the `smbclient` command
    is ready to converse with `terragolden`.'
  id: totrans-136
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '显示命令提示符`smb: \>`，表示`smbclient`命令已准备好与`terragolden`进行对话。'
- en: Use the `ls` command to list the files and folders in the `livemusic` share
    of `terragolden`.
  id: totrans-137
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`ls`命令列出`terragolden`上`livemusic`共享的文件和文件夹。
- en: '[PRE16]'
  id: totrans-138
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE16]'
- en: Use the `get` command to download the `catalog.txt` file from `terragolden`
    to the Raspberry Pi.
  id: totrans-139
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`get`命令将`catalog.txt`文件从`terragolden`下载到树莓派。
- en: '[PRE17]'
  id: totrans-140
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE17]'
- en: Now, use the `mget` command to download an entire directory of files, `particle2010-04-15`,
    from `terragolden` to the Raspberry Pi. The `mget` command first requires that
    the `tarmode`, `recurse`, and `prompt` options are set.
  id: totrans-141
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，使用`mget`命令从`terragolden`下载整个目录`particle2010-04-15`到树莓派。`mget`命令首先要求设置`tarmode`、`recurse`和`prompt`选项。
- en: '[PRE18]'
  id: totrans-142
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE18]'
- en: Use the `quit` command to end the SMB (CIFS) conversation with the `terragolden`
    home file server and return to the Raspberry Pi command prompt.
  id: totrans-143
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`quit`命令结束与家庭文件服务器`terragolden`的SMB（CIFS）对话，并返回到树莓派命令提示符。
- en: '[PRE19]'
  id: totrans-144
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE19]'
- en: Use the `ls –l` command to display the contents of the current directory on
    the Raspberry Pi.
  id: totrans-145
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`ls –l`命令显示树莓派当前目录的内容。
- en: '[PRE20]'
  id: totrans-146
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE20]'
- en: How it works…
  id: totrans-147
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的……
- en: After logging in to the Raspberry Pi, the software distribution package `smbclient`
    is installed using the `apt-get install` command. For more information on how
    the `apt-get` command works, see [Chapter 3](ch03.html "Chapter 3. Maintenance"),
    *Maintenance*.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 登录树莓派后，使用`apt-get install`命令安装软件分发包`smbclient`。有关`apt-get`命令如何工作的更多信息，请参见[第3章](ch03.html
    "第3章. 维护")，*维护*。
- en: Note
  id: totrans-149
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Your software distribution may already have `smbclient` installed.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 你的软件分发包可能已经安装了`smbclient`。
- en: The `smbclient` software distribution package contains the command-line application
    `smbclient`. This application is used to communicate with other computers using
    the SMB protocol.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: '`smbclient`软件分发包包含命令行应用程序`smbclient`。该应用程序用于通过SMB协议与其他计算机进行通信。'
- en: After the software distribution package is installed, the `smbclient` command
    is used to list the available services on a home file server named `terragolden`.
    The `–N` option tells the command that no password is required for the remote
    computer, and the `–L` option tells the command to just list the available shares
    and printers.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 在软件分发包安装完成后，使用`smbclient`命令列出名为`terragolden`的主文件服务器上的可用服务。`–N`选项告诉命令不需要远程计算机的密码，而`–L`选项则告诉命令仅列出可用的共享和打印机。
- en: For comparison, the `smbclient` command is also used to list the available services
    on another computer attached to the local network, golden-macbook. This time,
    a username (`-U golden`) and a password (no `–N` option) are required for access
    to the computer and the `smbclient` command also requires the `--signing=off`
    option to turn off a security feature that the computer does not support.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 为了对比，`smbclient`命令还用于列出另一台连接到本地网络的计算机（golden-macbook）上的可用服务。这次，访问该计算机需要提供用户名（`-U
    golden`）和密码（没有`–N`选项），并且`smbclient`命令还需要使用`--signing=off`选项，以关闭该计算机不支持的安全功能。
- en: Before the `smbclient` command is used to start a conversation with `terragolden`,
    a transfer directory (`xfer`) is created using the `mkdir` command to receive
    the transferred files and its (empty) contents are displayed using the `ls –l`
    command. The `–l` option tells the `ls` command to use the long listing format
    that includes a total count of files (`0`).
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 在使用`smbclient`命令与`terragolden`开始会话之前，首先使用`mkdir`命令创建一个传输目录（`xfer`）以接收传输的文件，并通过`ls
    –l`命令显示其（空的）内容。`–l`选项告诉`ls`命令使用长格式列出文件，其中包含文件总数（`0`）。
- en: 'The command `smbclient –N //terragolden/livemusic` is used to start a conversation
    between the Raspberry Pi and the remote computer, `terragolden`, using the file
    share named `livemusic`. The command prompt changes to `smb: \>` telling the user
    that the conversation has begun.'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: '命令`smbclient –N //terragolden/livemusic`用于启动树莓派与远程计算机`terragolden`之间的会话，使用的是名为`livemusic`的文件共享。命令提示符会变为`smb:
    \>`，表示会话已开始。'
- en: The `ls` command of `smbclient` is used to list the files on the home file server.
    The command `dir` could be used instead and will return the same result as the
    `ls` command.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: '`smbclient`的`ls`命令用于列出主文件服务器上的文件。也可以使用`dir`命令，返回的结果与`ls`命令相同。'
- en: The command `get catalog.txt` is used to transfer the file `catalog.txt` from
    the file server to the Raspberry Pi. The `smbclient` command reports that the
    file transferred has a size of 5119 bytes and was transferred at a rate of 208.3
    KB per second.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 命令`get catalog.txt`用于将文件`catalog.txt`从文件服务器传输到树莓派。`smbclient`命令报告该文件的大小为5119字节，并以每秒208.3
    KB的速率完成传输。
- en: After the `catalog.txt` file has been transferred, three options are set to
    prepare for a multi-file transfer. The `tarmode` option is reset to its default
    setting to ensure that all files are transferred. The `recurse` option is toggled
    so that the upcoming `mget` command will copy subdirectories as well as files.
    And the `prompt` option is toggled so that the upcoming `mget` command does not
    prompt for validation before transferring each file.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 在`catalog.txt`文件传输完成后，设置三个选项以准备进行多文件传输。`tarmode`选项被重置为默认设置，确保所有文件都能传输。`recurse`选项被切换，以便即将执行的`mget`命令也能复制子目录和文件。而`prompt`选项被切换，以便即将执行的`mget`命令在传输每个文件之前不会提示进行验证。
- en: Once the transfer options have been set, the `mget` command is used to transfer
    the `particle2010-04-15` directory of files to the Raspberry Pi. As each file
    is transferred, the size of the file and its rate of transfer are displayed.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 设置好传输选项后，使用`mget`命令将`particle2010-04-15`目录中的文件传输到树莓派。每当传输一个文件时，会显示该文件的大小及其传输速率。
- en: After all of the files have been transferred, the `quit` command is used to
    tell the `smbclient` application that the conversation with the remote computer,
    `terragolden`, is now over.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 所有文件传输完成后，`quit` 命令用于告诉 `smbclient` 应用程序与远程计算机 `terragolden` 的会话已经结束。
- en: The command prompt returns to `pi@raspberrypi ~ $` showing that the conversation
    is complete.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 命令提示符返回到 `pi@raspberrypi ~ $`，显示会话已完成。
- en: There's more...
  id: totrans-162
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多内容...
- en: The `smbclient` application has its own rich set of commands for communicating
    with remote computers via the SMB protocol.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: '`smbclient` 应用程序拥有一套丰富的命令，用于通过 SMB 协议与远程计算机进行通信。'
- en: help
  id: totrans-164
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: help
- en: 'The `help` command can be used to list the commands available from the `smb:
    \>` prompt.'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: '可以使用 `help` 命令来列出从 `smb: \>` 提示符处可用的命令。'
- en: '[PRE21]'
  id: totrans-166
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: Each of the `smbclient` application's commands has its own help page displayed
    using the `help` command. Type `help` followed by a command name to display more
    information about the command.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 每个 `smbclient` 应用程序的命令都有自己的帮助页面，可以使用 `help` 命令显示。键入 `help` 后跟命令名称，以显示关于该命令的更多信息。
- en: Changing remote directories
  id: totrans-168
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 更改远程目录
- en: The `cd` command in `smbclient` can be used to change directories on the remote
    computer in the same way `cd` is used to change directories on the Raspberry Pi.
    Notice that the current remote directory path is reflected in the `smbclient`
    command prompt.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: '`smbclient` 中的 `cd` 命令可以用来像在 Raspberry Pi 上使用 `cd` 更改目录一样，在远程计算机上更改目录。注意，当前的远程目录路径会显示在
    `smbclient` 命令提示符中。'
- en: '[PRE22]'
  id: totrans-170
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: Fetching a single file
  id: totrans-171
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 获取单个文件
- en: If the location of a file on the remote computer is already known, it can be
    fetched directly with a single `smbclient` command.
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 如果已经知道远程计算机中文件的位置，可以通过一个 `smbclient` 命令直接获取该文件。
- en: '[PRE23]'
  id: totrans-173
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: / versus \
  id: totrans-174
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: / 与 \
- en: Notice that the SMB (CIFS) protocol uses `\` instead of `/` as a path separator.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，SMB (CIFS) 协议使用 `\` 作为路径分隔符，而不是 `/`。
- en: The path separator is one of the major differences between the Windows operating
    system and Linux-based operating systems like Raspbian Linux, which is used by
    the Raspberry Pi.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 路径分隔符是 Windows 操作系统与基于 Linux 的操作系统（如 Raspberry Pi 使用的 Raspbian Linux）之间的主要区别之一。
- en: Either character can be used within the `smbclient` application, if used consistently.
    However, it is much easier to use `/` as it is the path separator on the Raspberry
    Pi.
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 在 `smbclient` 应用程序中，两个字符都可以使用，只要一致使用。不过，使用 `/` 更加方便，因为它是 Raspberry Pi 上的路径分隔符。
- en: See also
  id: totrans-178
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参见
- en: '**cd – change the working directory** ([http://manpages.debian.net/cgi-bin/man.cgi?query=cd](http://manpages.debian.net/cgi-bin/man.cgi?query=cd)):
    The Debian manual page for `cd` has more information about the command and its
    options.'
  id: totrans-179
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**cd – 更改工作目录** ([http://manpages.debian.net/cgi-bin/man.cgi?query=cd](http://manpages.debian.net/cgi-bin/man.cgi?query=cd)):
    Debian 的 `cd` 手册页面提供了更多关于该命令及其选项的信息。'
- en: '**smbclient – client to access SMB/CIFS resources on servers** ([http://manpages.debian.net/cgi-bin/man.cgi?query=smbclient](http://manpages.debian.net/cgi-bin/man.cgi?query=smbclient)):
    The Debian manual page for `smbclient` has more information about the command.'
  id: totrans-180
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**smbclient – 用于访问服务器上的 SMB/CIFS 资源的客户端** ([http://manpages.debian.net/cgi-bin/man.cgi?query=smbclient](http://manpages.debian.net/cgi-bin/man.cgi?query=smbclient)):
    Debian 的 `smbclient` 手册页面提供了更多关于该命令的信息。'
- en: Sharing folders from other computers (mount.cifs)
  id: totrans-181
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 从其他计算机共享文件夹（mount.cifs）
- en: This recipe shows how to mount folders that have been shared from another computer.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 这个食谱展示了如何挂载从另一台计算机共享的文件夹。
- en: Recent Linux kernels, including the kernel used by the Raspbian Linux distribution
    for the Raspberry Pi, have built-in support for mounting shared folders using
    the SMB (CIFS) protocol. This is the file sharing protocol used commonly by Windows
    computers and home file sharing devices. It is also used on OS X when sharing
    files.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 最近的 Linux 内核，包括 Raspberry Pi 上使用的 Raspbian Linux 内核，内置支持使用 SMB (CIFS) 协议挂载共享文件夹。这是
    Windows 计算机和家庭文件共享设备常用的文件共享协议。在 OS X 上共享文件时也使用该协议。
- en: This is the simplest recipe for mounting a shared folder from the command line
    on the Raspberry Pi.
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 这是在 Raspberry Pi 上通过命令行挂载共享文件夹的最简单方法。
- en: Once you've completed this recipe, you will be able to share files with other
    computers on the same network using the SMB (CIFS) protocol.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 完成这个食谱后，你将能够使用 SMB (CIFS) 协议与同一网络上的其他计算机共享文件。
- en: Note
  id: totrans-186
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: SMB and CIFS are synonyms for the same file sharing protocol.
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: SMB 和 CIFS 是同一种文件共享协议的同义词。
- en: Getting ready
  id: totrans-188
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: 'Here are the ingredients for this recipe:'
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 这是这个食谱所需的配料：
- en: An initial setup or basic networking setup for the Raspberry Pi that has been
    powered on. You have also logged in as the user `pi` (see the recipes in [Chapter
    1](ch01.html "Chapter 1. Installation and Setup"), *Installation and Setup*, for
    how to boot and log in and the recipes in [Chapter 2](ch02.html "Chapter 2. Administration"),
    *Administration*, for how to log in remotely).
  id: totrans-190
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对于已开机的树莓派，需进行初步设置或基本网络设置。你还需要以`pi`用户身份登录（请参阅[第1章](ch01.html "Chapter 1. Installation
    and Setup")中的配方，*安装与设置*，了解如何启动和登录，以及[第2章](ch02.html "Chapter 2. Administration")中的配方，*管理*，了解如何远程登录）。
- en: A powered USB hub (recommended).
  id: totrans-191
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个带电源的USB集线器（推荐）。
- en: At least one USB disk drive.
  id: totrans-192
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 至少需要一个USB磁盘驱动器。
- en: This recipe does not require the desktop GUI and could either be run from the
    text-based console or from within an LXTerminal.
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 此配方不需要桌面GUI，可以从基于文本的控制台或LXTerminal中运行。
- en: If the Raspberry Pi's Secure Shell server is running, this recipe can be completed
    remotely using a Secure Shell client (see the recipe *Remote access (SSH)* in
    [Chapter 2](ch02.html "Chapter 2. Administration"), *Administration*).
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 如果树莓派的安全外壳（SSH）服务器正在运行，可以通过安全外壳客户端远程完成此操作（请参阅[第2章](ch02.html "Chapter 2. Administration")中的*远程访问（SSH）*配方，*管理*）。
- en: The examples in this recipe will connect the Raspberry Pi to a home file server
    named `terragolden` sharing one folder, `livemusic`, which is configured for guest
    access.
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 本配方中的示例将树莓派连接到名为`terragolden`的家庭文件服务器，该服务器共享一个名为`livemusic`的文件夹，并配置为访客访问。
- en: How to do it...
  id: totrans-196
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'The steps to sharing folders from other computers are as follows:'
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 从其他计算机共享文件夹的步骤如下：
- en: Log in to the Raspberry Pi either directly or remotely.
  id: totrans-198
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 登录到树莓派，直接登录或远程登录均可。
- en: 'Create a mount point for the shared folder using the `mkdir` command:'
  id: totrans-199
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`mkdir`命令为共享文件夹创建一个挂载点：
- en: '[PRE24]'
  id: totrans-200
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE24]'
- en: Use the `mount` command with the `guest` and `uid=pi options (-o)` to mount
    the remote file share `//terragolden/livemusic` on the local directory, `/media/livemusic`.
  id: totrans-201
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`mount`命令和`guest`及`uid=pi`选项（`-o`）将远程文件共享`//terragolden/livemusic`挂载到本地目录`/media/livemusic`。
- en: '[PRE25]'
  id: totrans-202
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE25]'
- en: Use the `ls –l` command to list the files in the folder `/media/livemusic`.
  id: totrans-203
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`ls –l`命令列出`/media/livemusic`文件夹中的文件。
- en: '[PRE26]'
  id: totrans-204
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE26]'
- en: How it works...
  id: totrans-205
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: After logging in to the Raspberry Pi, the `mkdir` command is used to create
    a mount point for the shared folder in the `/media` directory. A mount point is
    an empty directory (`/media/livemusic`) that serves as a placeholder in the filesystem.
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 在登录到树莓派后，使用`mkdir`命令在`/media`目录中为共享文件夹创建一个挂载点。挂载点是一个空目录（`/media/livemusic`），作为文件系统中的占位符。
- en: Then, the file share, `//terragolden/livemusic`, from the home file server,
    `terragolden`, is mounted at the newly created mount point (`/media/livemusic`).
    The options to the `mount` command (`–o guest,uid=pi`) tell the command that the
    share is to be accessed without a username or password (`guest`) and that the
    mounted files will belong to the user `pi` (`uid=pi`).
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，从家庭文件服务器`terragolden`共享的文件`//terragolden/livemusic`被挂载到新创建的挂载点（`/media/livemusic`）。`mount`命令的选项（`–o
    guest,uid=pi`）告诉命令以无需用户名或密码（`guest`）的方式访问共享，并且挂载的文件将属于用户`pi`（`uid=pi`）。
- en: Finally, the files in the mount point (`/media/livemusic`) are listed using
    the command `ls -l` to verify that they are indeed identical to the files on the
    home file server.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，使用`ls -l`命令列出挂载点（`/media/livemusic`）中的文件，以验证它们是否与家庭文件服务器上的文件完全相同。
- en: There's more...
  id: totrans-209
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: Let's look at some other aspects related to the sharing of folders.
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看与共享文件夹相关的其他方面。
- en: Protected shares require a username and a password
  id: totrans-211
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 受保护的共享需要用户名和密码
- en: If a file share is password protected, then the options on the mount command
    need to be expanded to include `username=USER` and `password=PASS` options. `USER`
    and `PASS` should be replaced with the respective username and password of a user
    who has access to the file share.
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 如果文件共享受密码保护，则`mount`命令中的选项需要扩展，添加`username=USER`和`password=PASS`选项。`USER`和`PASS`应分别替换为有权访问该共享的用户的用户名和密码。
- en: '[PRE27]'
  id: totrans-213
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: Unmounting disks
  id: totrans-214
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 卸载磁盘
- en: Use the `umount` command to unmount the disks (there is no `n` in the command
    name).
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 使用`umount`命令卸载磁盘（命令名称中没有`n`）。
- en: '[PRE28]'
  id: totrans-216
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: After the disks are unmounted, the mount points remain under the `/media` directory;
    however, they are once again empty. The command `umount` is privileged (use `sudo`).
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 在磁盘卸载后，挂载点会保留在`/media`目录下；然而，它们会再次变为空目录。`umount`命令需要特权（使用`sudo`）。
- en: See also
  id: totrans-218
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另见
- en: '**Filesystem** ([http://en.wikipedia.org/wiki/Filesystem](http://en.wikipedia.org/wiki/Filesystem)):
    The Wikipedia article on filesystems explains the differences in more detail.'
  id: totrans-219
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**文件系统** ([http://en.wikipedia.org/wiki/Filesystem](http://en.wikipedia.org/wiki/Filesystem))：维基百科关于文件系统的文章更详细地解释了它们的区别。'
- en: '**Server Message Block** ([http://en.wikipedia.org/wiki/Server_Message_Block](http://en.wikipedia.org/wiki/Server_Message_Block)):
    The Wikipedia article on the **Server Message** **Block** (**SMB**) protocol discusses
    the protocol''s use and its history.'
  id: totrans-220
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**服务器消息块** ([http://en.wikipedia.org/wiki/Server_Message_Block](http://en.wikipedia.org/wiki/Server_Message_Block))：维基百科关于**服务器消息块**（**SMB**）协议的文章讨论了该协议的使用及其历史。'
- en: '**Uniform Naming Convention** ([http://en.wikipedia.org/wiki/Uniform_Naming_Convention](http://en.wikipedia.org/wiki/Uniform_Naming_Convention)):
    The Wikipedia article on the **Uniform Naming Convention** (**UNC**) protocol
    shows how it supports the SMB (CIFS) protocol.'
  id: totrans-221
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**统一命名约定** ([http://en.wikipedia.org/wiki/Uniform_Naming_Convention](http://en.wikipedia.org/wiki/Uniform_Naming_Convention))：维基百科关于**统一命名约定**（**UNC**）协议的文章展示了它如何支持SMB（CIFS）协议。'
- en: '**mount – mount a filesystem** ([http://manpages.debian.net/cgi-bin/man.cgi?query=mount](http://manpages.debian.net/cgi-bin/man.cgi?query=mount)):
    The Debian manual page for `mount` explains the command and its options.'
  id: totrans-222
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**mount – 挂载文件系统** ([http://manpages.debian.net/cgi-bin/man.cgi?query=mount](http://manpages.debian.net/cgi-bin/man.cgi?query=mount))：Debian的`mount`手册页面解释了该命令及其选项。'
- en: '**mount.cifs – mount using the CIFS filesystem** ([http://manpages.debian.net/cgi-bin/man.cgi?query=mount.cifs](http://manpages.debian.net/cgi-bin/man.cgi?query=mount.cifs)):
    The Debian manual page for `mount.cifs` explains the command in more detail.'
  id: totrans-223
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**mount.cifs – 使用CIFS文件系统挂载** ([http://manpages.debian.net/cgi-bin/man.cgi?query=mount.cifs](http://manpages.debian.net/cgi-bin/man.cgi?query=mount.cifs))：Debian的`mount.cifs`手册页面更详细地解释了该命令。'
- en: '**umount – unmounts filesystems** ([http://manpages.debian.net/cgi-bin/man.cgi?query=umount](http://manpages.debian.net/cgi-bin/man.cgi?query=umount)):
    The Debian manual page for `umount` shows the command and its options.'
  id: totrans-224
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**umount – 卸载文件系统** ([http://manpages.debian.net/cgi-bin/man.cgi?query=umount](http://manpages.debian.net/cgi-bin/man.cgi?query=umount))：Debian的`umount`手册页面展示了该命令及其选项。'
- en: Auto-mounting USB disks at boot (/etc/fstab)
  id: totrans-225
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在启动时自动挂载USB磁盘（/etc/fstab）
- en: This recipe shows how to configure the Raspberry Pi so that it automatically
    mounts attached USB disk drives during the boot process.
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 本食谱展示了如何配置树莓派，以便它在启动过程中自动挂载附加的USB磁盘驱动器。
- en: The goal of this recipe is to mount the example disks at boot time with the
    same configuration that is used by the command `pmount`.
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 本食谱的目标是在启动时使用与`pmount`命令相同的配置挂载示例磁盘。
- en: The first few steps of this recipe use the `pmount` and `mount` commands to
    discover the correct filesystem table configuration parameters for two example
    disk drives. Once the correct configuration parameters are discovered, the filesystem
    table configuration file (`/etc/fstab`) is updated so that the disks are mounted
    when the Raspberry Pi boots.
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 本食谱的前几个步骤使用`pmount`和`mount`命令来发现两个示例磁盘驱动器的正确文件系统表配置参数。发现正确的配置参数后，文件系统表配置文件(`/etc/fstab`)将被更新，以便在树莓派启动时挂载这些磁盘。
- en: This recipe does not provide details on the meaning of each configuration parameter.
    Instead, the recipe reuses the same configuration that is used by the `pmount`
    command. More detail on the configuration parameters can be found in the man pages
    for the `mount` command.
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 本食谱不提供每个配置参数的详细含义，而是重用了`pmount`命令中使用的相同配置。有关配置参数的更多细节可以在`mount`命令的手册页中找到。
- en: After completing this recipe, the Raspberry Pi will mount USB disk drives at
    boot time with a configuration that is consistent with the `pmount` utility.
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 完成本食谱后，树莓派将在启动时使用与`pmount`工具一致的配置挂载USB磁盘驱动器。
- en: Getting ready
  id: totrans-231
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: 'Here are the ingredients for this recipe:'
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是本食谱的配料：
- en: An initial setup or basic networking setup for the Raspberry Pi that has been
    powered on. You have also logged in as the user `pi` (see the recipes in [Chapter
    1](ch01.html "Chapter 1. Installation and Setup"), *Installation and Setup*, for
    how to boot and log in and the recipes in [Chapter 2](ch02.html "Chapter 2. Administration"),
    *Administration*, for how to log in remotely).
  id: totrans-233
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 树莓派的初步设置或基本网络设置已经完成，并且已登录为用户`pi`（有关如何启动和登录的信息，请参见[第1章](ch01.html "Chapter 1.
    安装与设置")，《安装与设置》；有关如何远程登录的信息，请参见[第2章](ch02.html "Chapter 2. 管理")，《管理》）。
- en: A Powered USB hub (recommended).
  id: totrans-234
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个已供电的USB集线器（推荐）。
- en: At least one USB disk drive.
  id: totrans-235
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 至少需要一个USB磁盘驱动器。
- en: This recipe does not require the desktop GUI and could either be run from the
    text-based console or from within an LXTerminal.
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: 本配方不需要桌面GUI，可以在基于文本的控制台或在LXTerminal中运行。
- en: If the Raspberry Pi's Secure Shell server is running, this recipe can be completed
    remotely using a Secure Shell client (see the recipe *Remote access (SSH)* in
    [Chapter 2](ch02.html "Chapter 2. Administration"), *Administration*).
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: 如果 Raspberry Pi 的安全外壳服务器正在运行，则可以使用安全外壳客户端远程完成此配方（参见[第2章](ch02.html "第2章 管理")，*管理*中的配方*远程访问（SSH）*）。
- en: 'The examples in this recipe use two USB drives: a 128 MB flash drive and a
    500 GB disk.'
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 本配方中的示例使用了两块USB驱动器：一块128 MB的闪存驱动器和一块500 GB的磁盘。
- en: The `pmount` command should already be installed (see the recipe *Mounting USB
    disks*).
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: '`pmount`命令应该已经安装（参见配方*挂载USB磁盘*）。'
- en: Note
  id: totrans-240
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Be careful! A broken `/etc/fstab` may prevent the system from booting. Make
    sure that you've tested the configuration before rebooting!
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: 小心！一个损坏的`/etc/fstab`可能会导致系统无法启动。在重启之前，请确保已经测试过配置！
- en: How to do it...
  id: totrans-242
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'The steps to auto-mount USB disks at boot are as follows:'
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: 自动挂载USB磁盘的步骤如下：
- en: Log in to the Raspberry Pi either directly or remotely.
  id: totrans-244
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 直接或远程登录到 Raspberry Pi。
- en: Use the `pmount` command to mount the 128 MB flash drive's primary partition
    `/dev/sda1` in the `/media` directory at the mount point `thumbdrive`.
  id: totrans-245
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`pmount`命令将128 MB闪存驱动器的主分区`/dev/sda1`挂载到`/media`目录中的挂载点`thumbdrive`。
- en: '[PRE29]'
  id: totrans-246
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE29]'
- en: Use the `pmount` command to mount the 500 GB disk's primary partition `/dev/sdb1`
    in the `/media` directory at the mount point `bigdisk`.
  id: totrans-247
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`pmount`命令将500 GB磁盘的主分区`/dev/sdb1`挂载到`/media`目录中的挂载点`bigdisk`。
- en: '[PRE30]'
  id: totrans-248
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE30]'
- en: Show that the disks are mounted with the `ls –l` command.
  id: totrans-249
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`ls -l`命令显示磁盘是否已挂载。
- en: '[PRE31]'
  id: totrans-250
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE31]'
- en: Display the configuration used to mount the two disks with the `mount` command.
  id: totrans-251
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`mount`命令显示挂载这两个磁盘的配置。
- en: '[PRE32]'
  id: totrans-252
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE32]'
- en: The `mount` command displays the filesystem table, including the mount parameters
    needed for each disk (or disk partition).
  id: totrans-253
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`mount`命令显示文件系统表，包括每个磁盘（或磁盘分区）所需的挂载参数。'
- en: '[PRE33]'
  id: totrans-254
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE33]'
- en: After the disk configuration parameters have been displayed, use the `pumount`
    command to unmount the two disks.
  id: totrans-255
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在显示磁盘配置参数后，使用`pumount`命令卸载这两个磁盘。
- en: '[PRE34]'
  id: totrans-256
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE34]'
- en: Make a copy of the current filesystem configuration with the `cp` command. Files
    can only be created in (or copied into) the `/etc` directory by a privileged user
    (so use `sudo`).
  id: totrans-257
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`cp`命令复制当前的文件系统配置。只有特权用户才能在`/etc`目录中创建（或复制到）文件（因此请使用`sudo`）。
- en: '[PRE35]'
  id: totrans-258
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE35]'
- en: Use the `vi` command to edit the filesystem configuration table `fstab`.
  id: totrans-259
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`vi`命令编辑文件系统配置表`fstab`。
- en: '[PRE36]'
  id: totrans-260
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE36]'
- en: The vi editor displays the contents of the `/etc/fstab` configuration file.
    Instructions for using the editor can be found in the vi man pages. See the recipe
    *Reading the built-in documentation* in [Chapter 2](ch02.html "Chapter 2. Administration"),
    *Administration*.
  id: totrans-261
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: vi 编辑器显示`/etc/fstab`配置文件的内容。有关如何使用编辑器的说明，请参见vi手册页面。在[第2章](ch02.html "第2章 管理")，*管理*中查阅“*阅读内置文档*”的配方。
- en: '[PRE37]'
  id: totrans-262
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE37]'
- en: Add the configuration parameters for each disk to the bottom of the configuration
    file. The parameters for each disk can be copied from the output of the `mount`
    command.
  id: totrans-263
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将每个磁盘的配置参数添加到配置文件的底部。每个磁盘的参数可以从`mount`命令的输出中复制。
- en: Note
  id: totrans-264
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Each disk configuration should be a single line with fields separated by spaces
    or tabs. The example does not fit the page width.
  id: totrans-265
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 每个磁盘配置应为一行，字段之间用空格或制表符分隔。示例不适合页面宽度。
- en: '[PRE38]'
  id: totrans-266
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE38]'
- en: After entering the configuration parameters for each disk, save the file and
    exit the editor.
  id: totrans-267
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入每个磁盘的配置参数后，保存文件并退出编辑器。
- en: '[PRE39]'
  id: totrans-268
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE39]'
- en: Before the disks can be mounted, they need to have mount points. Create mount
    points using the `mkdir` command.
  id: totrans-269
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在磁盘可以挂载之前，需要先为其创建挂载点。使用`mkdir`命令创建挂载点。
- en: '[PRE40]'
  id: totrans-270
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE40]'
- en: Use the `mount –a` command to mount all of the configured disks.
  id: totrans-271
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`mount -a`命令挂载所有已配置的磁盘。
- en: '[PRE41]'
  id: totrans-272
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE41]'
- en: Use the `reboot` command to reboot the system, then log back in and use the
    `ls –l` command to display the contents of the two mount points `/media/thumdrive`
    and `/media/bigdisk`.
  id: totrans-273
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`reboot`命令重启系统，然后重新登录，使用`ls -l`命令显示两个挂载点`/media/thumdrive`和`/media/bigdisk`的内容。
- en: '[PRE42]'
  id: totrans-274
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE42]'
- en: The disks are now mounted automatically at boot!
  id: totrans-275
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在磁盘在启动时会自动挂载！
- en: How it works...
  id: totrans-276
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: After logging in to the Raspberry Pi, two example disks are mounted using the
    personal mount command, `pmount` (see the recipe *Mounting USB disks* for more
    information on the `pmount` command).
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
  zh: 登录树莓派后，使用个人挂载命令`pmount`挂载两个示例磁盘（有关`pmount`命令的更多信息，请参见食谱*挂载USB磁盘*）。
- en: The 128 MB flash drive (`/dev/sda1`) is mounted at `/media/thumbdrive`.
  id: totrans-278
  prefs: []
  type: TYPE_NORMAL
  zh: 128 MB闪存驱动器（`/dev/sda1`）挂载在`/media/thumbdrive`。
- en: The 500 GB disk (`/dev/sdb1`) is mounted at `/media/bigdisk`.
  id: totrans-279
  prefs: []
  type: TYPE_NORMAL
  zh: 500 GB磁盘（`/dev/sdb1`）挂载在`/media/bigdisk`。
- en: The system `mount` command is used to display the filesystem table configuration
    parameters of all the disks attached to the Raspberry Pi including the `bigdisk`
    and the `thumbdrive`.
  id: totrans-280
  prefs: []
  type: TYPE_NORMAL
  zh: 系统的`mount`命令用于显示附加到树莓派的所有磁盘的文件系统表配置参数，包括`bigdisk`和`thumbdrive`。
- en: After the configuration parameters are displayed, the two USB disks (`/dev/sda1`
    and `/dev/sdb1`) are unmounted using the `pumount` command. The `/media` directory
    is once again empty.
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
  zh: 配置参数显示后，使用`pumount`命令卸载两个USB磁盘（`/dev/sda1`和`/dev/sdb1`）。`/media`目录再次变为空。
- en: Before any changes are made to the filesystem configuration, the `cp` command
    is used to create a backup copy of `/etc/fstab`.
  id: totrans-282
  prefs: []
  type: TYPE_NORMAL
  zh: 在对文件系统配置进行任何更改之前，使用`cp`命令创建`/etc/fstab`的备份副本。
- en: The vi editor is then used to add the configuration parameters for each disk
    to the bottom of the filesystem table configuration file (`/etc/fstab`).
  id: totrans-283
  prefs: []
  type: TYPE_NORMAL
  zh: 然后使用vi编辑器将每个磁盘的配置参数添加到文件系统表配置文件（`/etc/fstab`）的底部。
- en: Before the disks can be mounted, they first need to have mount points within
    the filesystem. The `mkdir` command is used to create a mount point for each of
    the USB disks at `/media/thumbdrive and /media/bigdisk`.
  id: totrans-284
  prefs: []
  type: TYPE_NORMAL
  zh: 在磁盘可以挂载之前，必须首先在文件系统中创建挂载点。使用`mkdir`命令为每个USB磁盘在`/media/thumbdrive`和`/media/bigdisk`下创建挂载点。
- en: Once the mount points have been created, the `mount all disks` command, `mount
    –a`, is used to mount the example disks.
  id: totrans-285
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦挂载点创建完成，可以使用`mount all disks`命令，`mount –a`，来挂载示例磁盘。
- en: After the disks are mounted, the contents of the disks are displayed by using
    the `ls –l` command.
  id: totrans-286
  prefs: []
  type: TYPE_NORMAL
  zh: 在磁盘挂载后，可以使用`ls –l`命令显示磁盘的内容。
- en: Everything looks good, so the Raspberry Pi is rebooted using the `reboot` command.
  id: totrans-287
  prefs: []
  type: TYPE_NORMAL
  zh: 一切看起来都很正常，因此使用`reboot`命令重启树莓派。
- en: When the Raspberry Pi is finished rebooting, the user logs back in to the Raspberry
    Pi using the `ssh` command.
  id: totrans-288
  prefs: []
  type: TYPE_NORMAL
  zh: 当树莓派重启完成后，用户可以使用`ssh`命令重新登录到树莓派。
- en: Finally, the `ls –l` command is used once again to list the contents of the
    two disks' mount points, `/media/thumbdrive` and `/media/bigdisk`.
  id: totrans-289
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，再次使用`ls –l`命令列出两个磁盘挂载点`/media/thumbdrive`和`/media/bigdisk`的内容。
- en: The disks have been mounted successfully during boot!
  id: totrans-290
  prefs: []
  type: TYPE_NORMAL
  zh: 磁盘在启动过程中已成功挂载！
- en: There's more...
  id: totrans-291
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多内容…
- en: We will look at how we can recover from an error.
  id: totrans-292
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将看看如何从错误中恢复。
- en: Error recovery
  id: totrans-293
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 错误恢复
- en: If the `mount` command displays an error, edit the `/etc/fstab` file again and
    look for typos and extra spaces. Correct any errors and try again.
  id: totrans-294
  prefs: []
  type: TYPE_NORMAL
  zh: 如果`mount`命令显示错误，请再次编辑`/etc/fstab`文件，检查是否有拼写错误和多余的空格。修正任何错误并重试。
- en: 'If there are still errors, replace the configuration file with its original
    version using the following command:'
  id: totrans-295
  prefs: []
  type: TYPE_NORMAL
  zh: 如果仍然存在错误，请使用以下命令将配置文件替换为其原始版本：
- en: '[PRE43]'
  id: totrans-296
  prefs: []
  type: TYPE_PRE
  zh: '[PRE43]'
- en: The fstab file format
  id: totrans-297
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: fstab文件格式
- en: 'Each line of the `fstab` configuration file is used to configure where one
    disk (or disk partition) is mounted. Each line has six fields separated by blanks
    (or tabs):'
  id: totrans-298
  prefs: []
  type: TYPE_NORMAL
  zh: '`fstab`配置文件的每一行都用于配置某个磁盘（或磁盘分区）的挂载位置。每行有六个字段，用空格（或制表符）分隔：'
- en: The first field is the device file. The device file is assigned automatically
    to each disk and can be discovered using the `fdisk –l` command (see the previous
    recipe). The 128 MB `thumbdrive` has one partition; its mountable device file
    is `/dev/sda1`. The 500 GB disk also has one partition with the mountable device
    file `/dev/sdb1`.
  id: totrans-299
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第一个字段是设备文件。设备文件会自动分配给每个磁盘，并且可以使用`fdisk –l`命令发现（请参阅之前的食谱）。128 MB的`thumbdrive`有一个分区，其可挂载的设备文件是`/dev/sda1`。500
    GB磁盘也有一个分区，其可挂载的设备文件是`/dev/sdb1`。
- en: The second field is the mount point. Mount points can be located anywhere in
    the filesystem; however, current convention is to locate them in the `/media`
    directory. The mount point for the 128 MB flash drive is `/media/thumbdrive`.
    The mount point for the 500 GB disk is `/media/bigdisk`.
  id: totrans-300
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第二个字段是挂载点。挂载点可以位于文件系统中的任何位置；然而，当前的惯例是将它们放在`/media`目录下。128 MB闪存驱动器的挂载点是`/media/thumbdrive`，500
    GB磁盘的挂载点是`/media/bigdisk`。
- en: The third field is the type of filesystem on the device. The 128 MB flash drive
    has the `vfat` filesystem and the 500 GB drive has an `ext4` filesystem.
  id: totrans-301
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第三个字段是设备的文件系统类型。128 MB的闪存驱动器使用`vfat`文件系统，而500 GB的硬盘使用`ext4`文件系统。
- en: The fourth field is a comma-separated list of configuration parameters. They
    should be copied from the parenthetical list of parameters in the output of the
    `mount` command. There should be no spaces in this field and no parentheses.
  id: totrans-302
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第四个字段是一个以逗号分隔的配置参数列表。这些参数应该从`mount`命令输出中的括号列表复制过来。此字段中不应有空格，也不应包含括号。
- en: The fifth field is a dump flag. It is usually zero (`0`), indicating that the
    filesystem does not need to be dumped. Both disks have `0` in this field.
  id: totrans-303
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第五个字段是转储标志。通常为零（`0`），表示文件系统不需要转储。两个磁盘在此字段中都是`0`。
- en: The sixth field selects the boot phase in which the disk will be mounted. The
    disk mounted as the root filesystem (`/`) is mounted in phase one; all other disks
    should be mounted in phase two. The example disks will not be mounted as the root
    filesystem, so they both have `2` in this field.
  id: totrans-304
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第六个字段选择磁盘将被挂载的启动阶段。作为根文件系统（`/`）挂载的磁盘在第一阶段挂载；所有其他磁盘应该在第二阶段挂载。示例中的磁盘不会作为根文件系统挂载，因此它们在此字段中都有`2`。
- en: 'For the 128 MB flash drive, the configuration parameters are as follows:'
  id: totrans-305
  prefs: []
  type: TYPE_NORMAL
  zh: 对于128 MB的闪存驱动器，配置参数如下：
- en: '**The device file**: `/dev/sda1`'
  id: totrans-306
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**设备文件**: `/dev/sda1`'
- en: '**The mount point**: `/media/thumbdrive`'
  id: totrans-307
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**挂载点**: `/media/thumbdrive`'
- en: '**The filesystem type**: `vfat`'
  id: totrans-308
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**文件系统类型**: `vfat`'
- en: '**The mount options**: `rw,nosuid,nodev,noexec,relatime,uid=1001,gid=1004,fmask=0177,dmask=0077,codepage=437,iocharset=iso8859-1,shortname=mixed,quiet,utf8,errors=remount-ro`'
  id: totrans-309
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**挂载选项**: `rw,nosuid,nodev,noexec,relatime,uid=1001,gid=1004,fmask=0177,dmask=0077,codepage=437,iocharset=iso8859-1,shortname=mixed,quiet,utf8,errors=remount-ro`'
- en: '**Dump option**: (`0`)'
  id: totrans-310
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**转储选项**: （`0`）'
- en: '**Boot phase**: (`2`)'
  id: totrans-311
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**启动阶段**: （`2`）'
- en: 'For the 500 GB USB disk, the configuration parameters are as follows:'
  id: totrans-312
  prefs: []
  type: TYPE_NORMAL
  zh: 对于500 GB的USB硬盘，配置参数如下：
- en: '**The device file**: `/dev/sdb1`'
  id: totrans-313
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**设备文件**: `/dev/sdb1`'
- en: '**The mount point**: `/media/bigdisk`'
  id: totrans-314
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**挂载点**: `/media/bigdisk`'
- en: '**The filesystem type**: `ext4`'
  id: totrans-315
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**文件系统类型**: `ext4`'
- en: '**The mount options**: `rw,nosuid,nodev,noexec,relatime,errors=remount-ro,data=ordered`'
  id: totrans-316
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**挂载选项**: `rw,nosuid,nodev,noexec,relatime,errors=remount-ro,data=ordered`'
- en: '**Dump option**: (`0`)'
  id: totrans-317
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**转储选项**: （`0`）'
- en: '**Boot phase**: (`2`)'
  id: totrans-318
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**启动阶段**: （`2`）'
- en: See also
  id: totrans-319
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: '**fstab – static information about the filesystems** ([http://manpages.debian.net/cgi-bin/man.cgi?query=fstab](http://manpages.debian.net/cgi-bin/man.cgi?query=fstab)):
    The Debian manual page for the `fstab` command has detailed information about
    the command and its options.'
  id: totrans-320
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**fstab – 静态文件系统信息** ([http://manpages.debian.net/cgi-bin/man.cgi?query=fstab](http://manpages.debian.net/cgi-bin/man.cgi?query=fstab)):
    Debian手册页面为`fstab`命令提供了关于命令及其选项的详细信息。'
- en: Auto-mounting a shared folder at boot
  id: totrans-321
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在启动时自动挂载共享文件夹
- en: The goal of this recipe is to mount a shared folder from another computer at
    boot time.
  id: totrans-322
  prefs: []
  type: TYPE_NORMAL
  zh: 本配方的目标是在启动时挂载来自另一台计算机的共享文件夹。
- en: The previous recipe showed how to configure `/etc/fstab` for mounting USB disks.
    This recipe shows how a similar configuration can be used to auto-mount a Windows
    share at boot time (or any other set of files shared using the SMB (CIFS) protocol).
  id: totrans-323
  prefs: []
  type: TYPE_NORMAL
  zh: 上一个配方展示了如何配置`/etc/fstab`以挂载USB磁盘。这个配方展示了如何使用类似的配置，在启动时自动挂载Windows共享（或使用SMB（CIFS）协议共享的任何其他文件集）。
- en: At home or at the office, it is common for a local network to have some form
    of **Networked Attached Storage** (**NAS**) available to network users as shared
    folders using the SMB (CIFS) protocol. This recipe shows how the Raspberry Pi
    can be configured to automatically mount a shared folder at boot time.
  id: totrans-324
  prefs: []
  type: TYPE_NORMAL
  zh: 在家里或办公室，常见的本地网络中会有某种形式的**网络附加存储**（**NAS**）作为共享文件夹，通过SMB（CIFS）协议供网络用户使用。这个配方展示了如何配置树莓派，使其在启动时自动挂载共享文件夹。
- en: After completing this recipe, a shared folder from another computer will be
    attached to the root filesystem every time the Raspberry Pi boots.
  id: totrans-325
  prefs: []
  type: TYPE_NORMAL
  zh: 完成此配方后，每次树莓派启动时，来自另一台计算机的共享文件夹将自动附加到根文件系统。
- en: Getting ready
  id: totrans-326
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: 'Here are the ingredients:'
  id: totrans-327
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是所需的组件：
- en: An initial setup or basic networking setup for the Raspberry Pi that has been
    powered on. You have also logged in as the user `pi` (see the recipes in [Chapter
    1](ch01.html "Chapter 1. Installation and Setup"), *Installation and Setup*, for
    how to boot and log in and the recipes in [Chapter 2](ch02.html "Chapter 2. Administration"),
    *Administration*, for how to log in remotely).
  id: totrans-328
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 已开机的 Raspberry Pi 进行的初步设置或基本网络设置。你还以 `pi` 用户身份登录（有关如何启动和登录的说明，请参见 [第 1 章](ch01.html
    "第 1 章 安装与设置")，*安装与设置*；有关如何远程登录的说明，请参见 [第 2 章](ch02.html "第 2 章 管理")，*管理*）。
- en: A network connection.
  id: totrans-329
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个网络连接。
- en: A client PC connected to the same network as the Raspberry Pi.
  id: totrans-330
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一台与 Raspberry Pi 处于同一网络的客户端计算机。
- en: This recipe does not require the desktop GUI and could either be run from the
    text-based console or from within an LXTerminal.
  id: totrans-331
  prefs: []
  type: TYPE_NORMAL
  zh: 本食谱不需要桌面 GUI，可以从基于文本的控制台或 LXTerminal 中运行。
- en: If the Raspberry Pi's Secure Shell server is running, this recipe can be completed
    remotely using a Secure Shell client (see the recipe *Remote access (SSH)* in
    [Chapter 2](ch02.html "Chapter 2. Administration"), *Administration*).
  id: totrans-332
  prefs: []
  type: TYPE_NORMAL
  zh: 如果 Raspberry Pi 的 Secure Shell 服务器正在运行，可以使用 Secure Shell 客户端远程完成此食谱（参见 [第 2
    章](ch02.html "第 2 章 管理")，*管理* 中的食谱 *远程访问（SSH）*）。
- en: The examples in this recipe will connect the Raspberry Pi to a home file-sharing
    device named `terragolden`. This file server has several shares available, including
    backups. The shared folder is configured for guest access so no username or password
    is required.
  id: totrans-333
  prefs: []
  type: TYPE_NORMAL
  zh: 本食谱中的示例将 Raspberry Pi 连接到一个名为 `terragolden` 的家庭文件共享设备。这个文件服务器有多个共享文件夹，包括备份。共享文件夹已配置为访客访问，因此不需要用户名或密码。
- en: Configuration for other computers using the SMB (CIFS) protocol will be similar.
  id: totrans-334
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 SMB（CIFS）协议的其他计算机配置将类似。
- en: How to do it...
  id: totrans-335
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'The steps for auto-mounting shared folders at boot are as follows:'
  id: totrans-336
  prefs: []
  type: TYPE_NORMAL
  zh: 自动挂载共享文件夹的步骤如下：
- en: Log in to the Raspberry Pi either directly or remotely.
  id: totrans-337
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 直接或远程登录到 Raspberry Pi。
- en: Use the `cp` command to make a backup copy of the `/etc/fstab` configuration
    file named `/etc/fstab.orig`. Files can only be created in (or copied into) the
    `/etc` directory by a privileged user (so use `sudo`).
  id: totrans-338
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 `cp` 命令将 `/etc/fstab` 配置文件备份为名为 `/etc/fstab.orig` 的副本。文件只能由具有特权的用户在 `/etc`
    目录中创建（或复制到该目录）（因此使用 `sudo`）。
- en: '[PRE44]'
  id: totrans-339
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE44]'
- en: 'Execute the command:'
  id: totrans-340
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 执行以下命令：
- en: '[PRE45]'
  id: totrans-341
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE45]'
- en: Edit the filesystem configuration table `fstab`. The file `fstab` may only be
    modified by a privileged user (use `sudo`).
  id: totrans-342
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 编辑文件系统配置表 `fstab`。`fstab` 文件只能由特权用户修改（使用 `sudo`）。
- en: Use the `vi` command to edit the filesystem configuration table `fstab`.
  id: totrans-343
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 `vi` 命令编辑文件系统配置表 `fstab`。
- en: '[PRE46]'
  id: totrans-344
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE46]'
- en: The vi editor displays the contents of the `/etc/fstab` configuration file.
    Instructions for using the editor can be found in the vi man pages. See the recipe
    *Reading the built-in documentation* in [Chapter 2](ch02.html "Chapter 2. Administration"),
    *Administration*.
  id: totrans-345
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: vi 编辑器显示 `/etc/fstab` 配置文件的内容。使用编辑器的说明可以在 vi 手册中找到。请参阅 [第 2 章](ch02.html "第
    2 章 管理")，*管理* 中的食谱 *读取内置文档*。
- en: '[PRE47]'
  id: totrans-346
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE47]'
- en: 'For the example home file server, the configuration is as follows:'
  id: totrans-347
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对于示例中的家庭文件服务器，配置如下：
- en: The network location is `//terragolden/backups`
  id: totrans-348
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 网络位置为 `//terragolden/backups`
- en: The mount point is `/media/backups`
  id: totrans-349
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 挂载点为 `/media/backups`
- en: The filesystem type is `cifs`
  id: totrans-350
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 文件系统类型为 `cifs`
- en: The mount options are `guest,uid=pi`
  id: totrans-351
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 挂载选项为 `guest,uid=pi`
- en: The dump option is `0`
  id: totrans-352
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: dump 选项为 `0`
- en: The boot phase is `2`
  id: totrans-353
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 启动阶段为 `2`
- en: After entering the configuration parameters for file share, save the file and
    exit the editor.
  id: totrans-354
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入文件共享的配置参数后，保存文件并退出编辑器。
- en: '[PRE48]'
  id: totrans-355
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE48]'
- en: Before the file share can be mounted, it needs to have a mount point. Create
    a mount point at `/media/backups` using the `mkdir` command.
  id: totrans-356
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在文件共享被挂载之前，需要创建挂载点。使用 `mkdir` 命令在 `/media/backups` 创建挂载点。
- en: '[PRE49]'
  id: totrans-357
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE49]'
- en: Use the `mount –a` command to mount all of the configured disks.
  id: totrans-358
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 `mount –a` 命令挂载所有已配置的磁盘。
- en: '[PRE50]'
  id: totrans-359
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE50]'
- en: Use the `reboot` command to reboot the system.
  id: totrans-360
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 `reboot` 命令重启系统。
- en: '[PRE51]'
  id: totrans-361
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE51]'
- en: Log back in to the Raspberry Pi and then use the `ls –l` command to display
    the contents of the file share /media/backups.
  id: totrans-362
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 重新登录 Raspberry Pi，然后使用 `ls –l` 命令显示文件共享 /media/backups 的内容。
- en: '[PRE52]'
  id: totrans-363
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE52]'
- en: The remote file share is now mounted automatically at boot!
  id: totrans-364
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 远程文件共享现在已在启动时自动挂载！
- en: How it works...
  id: totrans-365
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: After logging in to the Raspberry Pi, a backup is made of the filesystem table
    configuration file `/etc/fstab`. The configuration file is copied to `/etc/fstab.orig`.
  id: totrans-366
  prefs: []
  type: TYPE_NORMAL
  zh: 登录 Raspberry Pi 后，对文件系统表配置文件 `/etc/fstab` 进行备份。配置文件被复制到 `/etc/fstab.orig`。
- en: The vi editor is used to add the configuration parameters for the shared folder
    to the bottom of the configuration file.
  id: totrans-367
  prefs: []
  type: TYPE_NORMAL
  zh: 使用vi编辑器将共享文件夹的配置参数添加到配置文件的底部。
- en: 'The configuration used in the example is as follows:'
  id: totrans-368
  prefs: []
  type: TYPE_NORMAL
  zh: 示例中使用的配置如下：
- en: 'The first field is the network location: `//terragolden/xfer`. The second field
    is the mount point: `/media/backups`.'
  id: totrans-369
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第一个字段是网络位置：`//terragolden/xfer`。第二个字段是挂载点：`/media/backups`。
- en: 'The third field is the type of filesystem: `cifs`. This is the protocol used
    by the file server to share folders.'
  id: totrans-370
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第三个字段是文件系统的类型：`cifs`。这是文件服务器用来共享文件夹的协议。
- en: 'The fourth field is a comma-separated list of options: `guest,uid=pi`. Additional
    options include `user=` and `password=` for specifying the username and password
    when a shared folder is protected.'
  id: totrans-371
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第四个字段是一个以逗号分隔的选项列表：`guest,uid=pi`。其他选项包括`user=`和`password=`，用于指定共享文件夹受保护时的用户名和密码。
- en: The fifth field is a dump flag. It is set to zero (`0`), indicating that the
    shared folder does not need to be dumped at boot.
  id: totrans-372
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第五个字段是一个转储标志。它被设置为零（`0`），表示共享文件夹在启动时不需要转储。
- en: The sixth field selects the boot phase in which the disk will be mounted. The
    disk mounted as the root filesystem (`/`) is mounted in phase one; all other disks
    should be mounted in phase two (`2`).
  id: totrans-373
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第六个字段选择了磁盘挂载的启动阶段。作为根文件系统（`/`）挂载的磁盘在第一阶段挂载；所有其他磁盘应在第二阶段（`2`）挂载。
- en: Once the filesystem table configuration file (`/etc/fstab`) has been updated,
    the configuration is tested before rebooting the system. The `mount all disks`
    command, `mount –a`, is used to mount the example disks.
  id: totrans-374
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦文件系统表配置文件（`/etc/fstab`）被更新，配置会在重启系统前进行测试。使用`mount all disks`命令，即`mount -a`，来挂载示例磁盘。
- en: If there is no error, the system can be rebooted.
  id: totrans-375
  prefs: []
  type: TYPE_NORMAL
  zh: 如果没有错误，系统可以重启。
- en: If the mount command displays an error, edit the `/etc/fstab` file again and
    look for typos and extra spaces. Correct any errors and try again.
  id: totrans-376
  prefs: []
  type: TYPE_NORMAL
  zh: 如果挂载命令显示错误，请再次编辑`/etc/fstab`文件，检查是否有拼写错误或多余的空格。修正错误后重新尝试。
- en: 'If there are still errors, replace the configuration file with its original
    version using the following command:'
  id: totrans-377
  prefs: []
  type: TYPE_NORMAL
  zh: 如果仍然存在错误，请使用以下命令将配置文件替换为原始版本：
- en: '[PRE53]'
  id: totrans-378
  prefs: []
  type: TYPE_PRE
  zh: '[PRE53]'
- en: See also
  id: totrans-379
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参见
- en: '**Network Attached Storage** ([http://en.wikipedia.org/wiki/Network_Attached_Storage](http://en.wikipedia.org/wiki/Network_Attached_Storage)):
    Here is an interesting Wikipedia article on **Network Attached Storage** (**NAS**).'
  id: totrans-380
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**网络附加存储** ([http://en.wikipedia.org/wiki/Network_Attached_Storage](http://en.wikipedia.org/wiki/Network_Attached_Storage))：这是关于**网络附加存储**（**NAS**）的一个有趣的维基百科文章。'
- en: Creating a file server (Samba)
  id: totrans-381
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建文件服务器（Samba）
- en: This recipe shows how the Raspberry Pi can be configured to become a file server
    on the local network.
  id: totrans-382
  prefs: []
  type: TYPE_NORMAL
  zh: 本步骤展示了如何将树莓派配置为局域网上的文件服务器。
- en: The Raspberry Pi, with attached file storage, functions well as a file server.
    Such a file server could be used as a central location for sharing files and documents,
    for storing backups of other computers, and for storing large media files, such
    as photo, music, and video files.
  id: totrans-383
  prefs: []
  type: TYPE_NORMAL
  zh: 树莓派，配备附加的文件存储，作为文件服务器运行良好。这样的文件服务器可以用作共享文件和文档的中心位置、存储其他计算机的备份文件，并存储大容量媒体文件，如照片、音乐和视频文件。
- en: This recipe installs and configures samba and samba-common-bin. The Samba software
    distribution package, samba, contains a server for the SMB (CIFS) protocol used
    by modern computers for setting up *shared drives* or *shared folders*. The samba-common-bin
    package contains a small collection of utilities for managing access to shared
    files.
  id: totrans-384
  prefs: []
  type: TYPE_NORMAL
  zh: 本步骤安装并配置了samba和samba-common-bin。Samba软件包包含一个用于设置*共享驱动器*或*共享文件夹*的SMB（CIFS）协议服务器，这是现代计算机使用的协议。samba-common-bin软件包包含一组用于管理共享文件访问的小工具。
- en: The recipe includes setting a file sharing password for the logged-in user and
    providing read/write access to the files in the user's home directory. However,
    it does not set up a new file share or show how to share a USB disk. The next
    recipe shows how to do that.
  id: totrans-385
  prefs: []
  type: TYPE_NORMAL
  zh: 本步骤包括为登录用户设置文件共享密码，并为用户主目录中的文件提供读/写权限。然而，它并没有设置新的文件共享，也没有显示如何共享USB磁盘。下一个步骤将展示如何操作。
- en: After completing this recipe, other computers on the local network can exchange
    files with the Raspberry Pi.
  id: totrans-386
  prefs: []
  type: TYPE_NORMAL
  zh: 完成此步骤后，局域网上的其他计算机可以与树莓派交换文件。
- en: Getting ready
  id: totrans-387
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: 'Here are the ingredients for this recipe:'
  id: totrans-388
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是此步骤所需的配置信息：
- en: An initial setup or basic networking setup for the Raspberry Pi that has been
    powered on. You have also logged in as the user `pi` (see the recipes in [Chapter
    1](ch01.html "Chapter 1. Installation and Setup"), *Installation and Setup*, for
    how to boot and log in and the recipes in [Chapter 2](ch02.html "Chapter 2. Administration"),
    *Administration*, for how to log in remotely.
  id: totrans-389
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为已开机的 Raspberry Pi 完成初始设置或基本的网络设置。你还需要作为用户 `pi` 登录（请参阅 [第 1 章](ch01.html "第
    1 章 安装与设置")，*安装与设置* 中的配方，了解如何启动并登录，以及 [第 2 章](ch02.html "第 2 章 管理")，*管理* 中的配方，了解如何远程登录）。
- en: A network connection.
  id: totrans-390
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个网络连接。
- en: A client PC connected to the same network as the Raspberry Pi.
  id: totrans-391
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一台与 Raspberry Pi 连接到同一网络的客户端 PC。
- en: This recipe does not require the desktop GUI and could either be run from the
    text-based console or from within an LXTerminal.
  id: totrans-392
  prefs: []
  type: TYPE_NORMAL
  zh: 本配方不需要桌面图形界面，可以在基于文本的控制台或 LXTerminal 中运行。
- en: If the Raspberry Pi's Secure Shell server is running, this recipe can be completed
    remotely using a Secure Shell client (see the recipe *Remote access (SSH)* in
    [Chapter 2](ch02.html "Chapter 2. Administration"), *Administration*).
  id: totrans-393
  prefs: []
  type: TYPE_NORMAL
  zh: 如果 Raspberry Pi 的安全外壳服务器正在运行，则可以使用安全外壳客户端远程完成此配方（请参见 [第 2 章](ch02.html "第 2
    章 管理")，*管理* 中的 *远程访问（SSH）* 配方）。
- en: How to do it...
  id: totrans-394
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'The steps to creating a file server are as follows:'
  id: totrans-395
  prefs: []
  type: TYPE_NORMAL
  zh: 创建文件服务器的步骤如下：
- en: Log in to the Raspberry Pi either directly or remotely.
  id: totrans-396
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 直接或远程登录到 Raspberry Pi。
- en: Use the `apt-get install` command to install the software packages samba and
    samba-common-bin.
  id: totrans-397
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 `apt-get install` 命令安装软件包 samba 和 samba-common-bin。
- en: '[PRE54]'
  id: totrans-398
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE54]'
- en: Use the `vi` command to edit the Samba configuration file (`/etc/samba/smb.conf`).
  id: totrans-399
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 `vi` 命令编辑 Samba 配置文件 (`/etc/samba/smb.conf`)。
- en: '[PRE55]'
  id: totrans-400
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE55]'
- en: The vi editor displays the contents of the `/etc/samba/smb.conf` file. Instructions
    for using the editor can be found in the vi man pages; see the recipe *Reading
    the built-in documentation* in [Chapter 2](ch02.html "Chapter 2. Administration"),
    *Administration*.
  id: totrans-401
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: vi 编辑器显示 `/etc/samba/smb.conf` 文件的内容。使用编辑器的说明可以在 vi 手册页中找到；请参见 [第 2 章](ch02.html
    "第 2 章 管理")，*管理* 中的 *阅读内建文档*。
- en: '[PRE56]'
  id: totrans-402
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE56]'
- en: Change the security `= user` line. Uncomment the line. (Remove the hash, `#`,
    from the beginning of the line.)
  id: totrans-403
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 更改 `= user` 的安全行，取消该行的注释。（移除行首的井号 `#`。）
- en: '[PRE57]'
  id: totrans-404
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE57]'
- en: Change the `read only = yes` line to be `read only = no`.
  id: totrans-405
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将 `read only = yes` 行更改为 `read only = no`。
- en: '[PRE58]'
  id: totrans-406
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE58]'
- en: Save (`:w`) and exit (`:q`) the vi editor.
  id: totrans-407
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 保存（`:w`）并退出（`:q`）vi 编辑器。
- en: Use the `/etc/init.d/samba` initialization script to tell the Samba server to
    reload its configuration file.
  id: totrans-408
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 `/etc/init.d/samba` 初始化脚本，告诉 Samba 服务器重新加载其配置文件。
- en: '[PRE59]'
  id: totrans-409
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE59]'
- en: Use the `smbpasswd –a` command to create an SMB (CIFS) password for the logged-in
    user, `pi`. Enter the password (twice).
  id: totrans-410
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 `smbpasswd –a` 命令为已登录的用户 `pi` 创建一个 SMB（CIFS）密码。输入密码（两次）。
- en: '[PRE60]'
  id: totrans-411
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE60]'
- en: The Raspberry Pi is now accessible as a file server!
  id: totrans-412
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，Raspberry Pi 作为文件服务器可以访问！
- en: From a Windows computer, use **Map network drive** to mount the Raspberry Pi
    as a network disk.![How to do it...](img/B04547_04_01.jpg)
  id: totrans-413
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 Windows 计算机上，使用 **映射网络驱动器** 将 Raspberry Pi 挂载为网络磁盘。![如何操作...](img/B04547_04_01.jpg)
- en: The above screenshot shows the mapping of a network drive to the Raspberry Pi
    on Windows 7.
  id: totrans-414
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 上面的截图展示了在 Windows 7 上将网络驱动器映射到 Raspberry Pi。
- en: Enter the UNC address `\\raspberrypi\pi` as the network folder. Choose an appropriate
    drive letter. The following example uses the `R:` drive. Select **Connect using
    different credentials**. Click on **Finish**.![How to do it...](img/B04547_04_02.jpg)
  id: totrans-415
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入 UNC 地址 `\\raspberrypi\pi` 作为网络文件夹。选择一个合适的驱动器字母。以下示例使用 `R:` 驱动器。选择 **使用不同的凭据连接**。点击
    **完成**。![如何操作...](img/B04547_04_02.jpg)
- en: The above screenshot finishes mapping a network drive to the Raspberry Pi.
  id: totrans-416
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 上面的截图完成了将网络驱动器映射到 Raspberry Pi。
- en: Log in using the newly configured SMB (CIFS) password (from step 7).![How to
    do it...](img/B04547_04_03.jpg)
  id: totrans-417
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用新配置的 SMB（CIFS）密码登录（见步骤 7）。![如何操作...](img/B04547_04_03.jpg)
- en: In the screenshot, a dialog box is displayed for logging in to the Raspberry
    Pi with the SMB (CIFS) username and password.
  id: totrans-418
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在截图中，显示了一个对话框，提示使用 SMB（CIFS）用户名和密码登录到 Raspberry Pi。
- en: The Raspberry Pi is now accessible as a Windows share! Only the home directory
    of the user `pi` is accessible at this point. The next recipe configures a USB
    disk for use as a shared drive.
  id: totrans-419
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，Raspberry Pi 作为 Windows 共享可以访问！此时，仅用户 `pi` 的主目录可以访问。下一步的操作是配置 USB 磁盘作为共享驱动器使用。
- en: How it works...
  id: totrans-420
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'After logging in to the Raspberry Pi, the recipe installs two software distribution
    packages: samba and samba-common-bin, using the `apt-get install` command.'
  id: totrans-421
  prefs: []
  type: TYPE_NORMAL
  zh: 登录树莓派后，配方通过 `apt-get install` 命令安装两个软件包：samba 和 samba-common-bin。
- en: The samba package contains an implementation of the **Server Message Block**
    (**SMB**) protocol (also known as the **Common Internet File System**, **CIFS**).
    For sharing files and printers, Microsoft Windows computers use the SMB (CIFS)
    protocol.
  id: totrans-422
  prefs: []
  type: TYPE_NORMAL
  zh: samba 包包含 **服务器消息块**（**SMB**）协议的实现（也称为 **公共互联网文件系统**，**CIFS**）。用于共享文件和打印机时，Microsoft
    Windows 计算机使用 SMB（CIFS）协议。
- en: After the packages are installed, the Samba configuration file `/etc/samba/smb.conf`
    is updated. The file is updated to turn on user security (`security = user`) and
    to enable writing files to user home directories (`readonly = no`).
  id: totrans-423
  prefs: []
  type: TYPE_NORMAL
  zh: 安装完软件包后，Samba 配置文件 `/etc/samba/smb.conf` 会被更新。该文件被更新以启用用户安全（`security = user`）并允许将文件写入用户的主目录（`readonly
    = no`）。
- en: After the configuration file is updated, the Samba server is told to reload
    its configuration using the server's initialization file, `/etc/init.d/samba`.
  id: totrans-424
  prefs: []
  type: TYPE_NORMAL
  zh: 配置文件更新后，Samba 服务器会使用服务器的初始化文件 `/etc/init.d/samba` 重新加载其配置。
- en: At this point, the Raspberry Pi should be visible to other machines on the local
    network that are using the SMB protocol. However, the passwords for the authorized
    users have not yet been configured.
  id: totrans-425
  prefs: []
  type: TYPE_NORMAL
  zh: 此时，树莓派应该能被使用 SMB 协议的本地网络中的其他计算机看到。然而，授权用户的密码尚未配置。
- en: The `smbpasswd` command is used to add (`-a`) the user `pi` to the list of users
    authorized to share files with the Raspberry Pi using the SMB protocol. The passwords
    for file sharing are managed separately from the login passwords used to log in
    to the Raspberry Pi either directly or remotely.
  id: totrans-426
  prefs: []
  type: TYPE_NORMAL
  zh: '`smbpasswd` 命令用于将用户 `pi` 添加（`-a`）到授权与树莓派使用 SMB 协议共享文件的用户列表中。文件共享的密码与用于直接或远程登录树莓派的登录密码是分开管理的。'
- en: After the password has been added for the user `pi`, the Raspberry Pi should
    be accessible from any machine on the local network that is configured for the
    SMB protocol.
  id: totrans-427
  prefs: []
  type: TYPE_NORMAL
  zh: 在为用户 `pi` 添加密码后，树莓派应该可以从本地网络中任何配置为 SMB 协议的机器访问。
- en: The last steps of the recipe configure access to the Raspberry Pi from a Windows
    7 PC using a mapped network drive. The UNC name for the file share, `\\raspberrypi\pi`,
    could also be used to access the share directly from Windows Explorer.
  id: totrans-428
  prefs: []
  type: TYPE_NORMAL
  zh: 配方的最后步骤配置了从 Windows 7 PC 使用映射的网络驱动器访问树莓派。文件共享的 UNC 名称 `\\raspberrypi\pi` 也可以直接在
    Windows 资源管理器中访问共享。
- en: There's more...
  id: totrans-429
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: This is a very simple configuration for sharing files. It enables file sharing
    for users with a login to the Raspberry Pi. However, it only permits the files
    in the user home directories to be shared. The next recipe describes how to add
    a new file share.
  id: totrans-430
  prefs: []
  type: TYPE_NORMAL
  zh: 这是一个非常简单的文件共享配置。它为登录到树莓派的用户启用文件共享。然而，它仅允许共享用户主目录中的文件。下一个配方描述了如何添加新的文件共享。
- en: In addition to the SMB protocol server `smbd`, the Samba software distribution
    package also contains a NetBIOS name server, `nmbd`. The NetBIOS name server provides
    naming services to computers using the SMB protocol. The `nmbd` server broadcasts
    the configured name of the Raspberry Pi, `raspberrypi`, to other computers on
    the local network.
  id: totrans-431
  prefs: []
  type: TYPE_NORMAL
  zh: 除了 SMB 协议服务器 `smbd`，Samba 软件包还包含一个 NetBIOS 名称服务器 `nmbd`。NetBIOS 名称服务器为使用 SMB
    协议的计算机提供命名服务。`nmbd` 服务器将树莓派的配置名称 `raspberrypi` 广播到本地网络中的其他计算机。
- en: In addition to file sharing, a Samba server could also be used as a **Primary
    Domain Controller** (**PDC**)—a central network server that is used to provide
    logins and security for all computers on a LAN. More information on using the
    samba package as a PDC can be found in the following links.
  id: totrans-432
  prefs: []
  type: TYPE_NORMAL
  zh: 除了文件共享，Samba 服务器还可以用作 **主域控制器**（**PDC**）——一个用于为局域网上所有计算机提供登录和安全性的中央网络服务器。关于将
    samba 包用作 PDC 的更多信息可以在以下链接中找到。
- en: See also
  id: totrans-433
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另见
- en: '**Samba (software)** ([http://en.wikipedia.org/wiki/Samba_(software)](http://en.wikipedia.org/wiki/Samba_(software))):
    A Wikipedia article on the Samba software suite.'
  id: totrans-434
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Samba（软件）** ([http://en.wikipedia.org/wiki/Samba_(software)](http://en.wikipedia.org/wiki/Samba_(software)))：关于
    Samba 软件套件的 Wikipedia 文章。'
- en: '**nmbd – NetBIOS over IP naming service** ([http://manpages.debian.net/cgi-bin/man.cgi?query=nmbd](http://manpages.debian.net/cgi-bin/man.cgi?query=nmbd)):
    The Debian manual page for `nmbd`.'
  id: totrans-435
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**nmbd – NetBIOS 通过 IP 命名服务** ([http://manpages.debian.net/cgi-bin/man.cgi?query=nmbd](http://manpages.debian.net/cgi-bin/man.cgi?query=nmbd))：`nmbd`
    的 Debian 手册页面。'
- en: '**samba – a Windows SMB/CIFS file server for Unix** ([http://manpages.debian.net/cgi-bin/man.cgi?query=samba](http://manpages.debian.net/cgi-bin/man.cgi?query=samba)):
    The Debian man page for samba.'
  id: totrans-436
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**samba – 用于 Unix 的 Windows SMB/CIFS 文件服务器** ([http://manpages.debian.net/cgi-bin/man.cgi?query=samba](http://manpages.debian.net/cgi-bin/man.cgi?query=samba)):
    Debian 的 samba 手册页。'
- en: '**smb.conf – the configuration file for the Samba suite** ([http://manpages.debian.net/cgi-bin/man.cgi?query=smb.conf](http://manpages.debian.net/cgi-bin/man.cgi?query=smb.conf)):
    The Debian manual page for `smb.conf`.'
  id: totrans-437
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**smb.conf – Samba 套件的配置文件** ([http://manpages.debian.net/cgi-bin/man.cgi?query=smb.conf](http://manpages.debian.net/cgi-bin/man.cgi?query=smb.conf)):
    Debian 的 `smb.conf` 手册页。'
- en: '**smbd – server to provide SMB/CIFS services to clients** ([http://manpages.debian.net/cgi-bin/man.cgi?query=smbd](http://manpages.debian.net/cgi-bin/man.cgi?query=smbd)):
    The Debian manual page for `smbd`.'
  id: totrans-438
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**smbd – 提供 SMB/CIFS 服务给客户端的服务器** ([http://manpages.debian.net/cgi-bin/man.cgi?query=smbd](http://manpages.debian.net/cgi-bin/man.cgi?query=smbd)):
    Debian 的 `smbd` 手册页。'
- en: '**smbpasswd – change a user''s SMB password** ([http://manpages.debian.net/cgi-bin/man.cgi?query=smbpasswd](http://manpages.debian.net/cgi-bin/man.cgi?query=smbpasswd)):
    The Debian manual page for `smbpasswd`.'
  id: totrans-439
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**smbpasswd – 更改用户的 SMB 密码** ([http://manpages.debian.net/cgi-bin/man.cgi?query=smbpasswd](http://manpages.debian.net/cgi-bin/man.cgi?query=smbpasswd)):
    Debian 的 `smbpasswd` 手册页。'
- en: '**System initialization** ([http://www.debian.org/doc/manuals/debian-reference/ch04.en.html](http://www.debian.org/doc/manuals/debian-reference/ch04.en.html)):
    The *Debian Reference Manual* article on system initialization.'
  id: totrans-440
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**System initialization** ([http://www.debian.org/doc/manuals/debian-reference/ch04.en.html](http://www.debian.org/doc/manuals/debian-reference/ch04.en.html)):
    *Debian参考手册*中关于系统初始化的文章。'
- en: '**Samba.org** ([http://www.samba.org](http://www.samba.org)): The Samba software
    website.'
  id: totrans-441
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Samba.org** ([http://www.samba.org](http://www.samba.org)): Samba 软件官网。'
- en: Sharing an attached USB disk (Samba)
  id: totrans-442
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 共享连接的 USB 硬盘（Samba）
- en: This recipe extends the default Samba configuration to include sharing a USB
    disk.
  id: totrans-443
  prefs: []
  type: TYPE_NORMAL
  zh: 本食谱扩展了默认的 Samba 配置，以包括共享 USB 硬盘。
- en: The previous recipe showed how to install Samba and set up basic file sharing.
    However, the Samba configuration used only shared files that are in the user's
    home directory. Other directories on the Raspberry Pi are not yet accessible via
    the SMB (CIFS) protocol.
  id: totrans-444
  prefs: []
  type: TYPE_NORMAL
  zh: 上一个食谱展示了如何安装 Samba 并设置基本的文件共享。然而，之前使用的 Samba 配置仅共享用户的主目录中的文件。其他目录尚未通过 SMB（CIFS）协议开放。
- en: This recipe extends the Samba configuration used in the previous recipe to include
    a new file share definition that points to a USB hard disk mounted on the Raspberry
    Pi.
  id: totrans-445
  prefs: []
  type: TYPE_NORMAL
  zh: 本食谱扩展了之前食谱中使用的 Samba 配置，加入了一个新的文件共享定义，指向挂载在 Raspberry Pi 上的 USB 硬盘。
- en: After completing this recipe, the Raspberry Pi can be used as a file server
    for any computer that shares its files via the SMB (CIFS) protocol (for example,
    Windows, Mac, and Linux computers).
  id: totrans-446
  prefs: []
  type: TYPE_NORMAL
  zh: 完成此食谱后，Raspberry Pi 可以作为文件服务器，供任何计算机通过 SMB（CIFS）协议共享文件（例如 Windows、Mac 和 Linux
    计算机）。
- en: Getting ready
  id: totrans-447
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: 'Ingredients:'
  id: totrans-448
  prefs: []
  type: TYPE_NORMAL
  zh: 配料：
- en: An initial setup or basic networking setup for the Raspberry Pi that has been
    powered on. You have also logged in as the user `pi` (see the recipes in [Chapter
    1](ch01.html "Chapter 1. Installation and Setup"), *Installation and Setup*, for
    how to boot and log in and the recipes in [Chapter 2](ch02.html "Chapter 2. Administration"),
    *Administration*, for how to log in remotely).
  id: totrans-449
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Raspberry Pi 的初始设置或基本网络设置，设备已经开机，并且你已作为用户 `pi` 登录（有关如何启动和登录的详细步骤，请参见 [第 1 章](ch01.html
    "第 1 章 安装与设置") *安装与设置*，以及 [第 2 章](ch02.html "第 2 章 管理") *管理* 中的远程登录教程）。
- en: A network connection (optional).
  id: totrans-450
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个网络连接（可选）。
- en: A client PC connected to the same network as the Raspberry Pi (optional).
  id: totrans-451
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一台与 Raspberry Pi 连接到同一网络的客户端 PC（可选）。
- en: A powered USB hub (recommended).
  id: totrans-452
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个有电的 USB 集线器（推荐）。
- en: At least one USB disk drive (the example uses a 500 GB USB disk).
  id: totrans-453
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 至少一个 USB 硬盘驱动器（本示例使用 500 GB 的 USB 硬盘）。
- en: This recipe does not require the desktop GUI and could either be run from the
    text-based console or from within an LXTerminal.
  id: totrans-454
  prefs: []
  type: TYPE_NORMAL
  zh: 本食谱不需要桌面 GUI，可以从基于文本的控制台或 LXTerminal 中运行。
- en: If the Raspberry Pi's Secure Shell server is running and it has a network connection,
    this recipe can be completed remotely using a Secure Shell client (see the preceding).
  id: totrans-455
  prefs: []
  type: TYPE_NORMAL
  zh: 如果 Raspberry Pi 的安全外壳（Secure Shell）服务器正在运行，并且它有网络连接，可以通过安全外壳客户端远程完成此食谱（见前文）。
- en: The example in this recipe uses a USB disk mounted at `/media/bigdisk` (see
    the recipe *Mounting USB disks* at the beginning of this chapter).
  id: totrans-456
  prefs: []
  type: TYPE_NORMAL
  zh: 本食谱中的示例使用了一个挂载在 `/media/bigdisk` 的 USB 硬盘（请参见本章开头的食谱 *挂载 USB 硬盘*）。
- en: The example in this recipe also includes test access to the new file share from
    another computer on the local network, golden-macbook.
  id: totrans-457
  prefs: []
  type: TYPE_NORMAL
  zh: 本配方中的示例还包括从本地网络中的另一台计算机（golden-macbook）测试访问新的文件共享。
- en: The Raspberry Pi should already have Samba installed (see the previous recipe).
  id: totrans-458
  prefs: []
  type: TYPE_NORMAL
  zh: 树莓派应该已经安装了Samba（请参见前一个配方）。
- en: How to do it...
  id: totrans-459
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'The steps for sharing an attached USB disk are as follows:'
  id: totrans-460
  prefs: []
  type: TYPE_NORMAL
  zh: 分享附加的USB磁盘的步骤如下：
- en: Log in to the Raspberry Pi either directly or remotely.
  id: totrans-461
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 直接或远程登录到树莓派。
- en: Use the `ls –l` command to list the disk drives that have been mounted in the
    `/media` directory.
  id: totrans-462
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`ls –l`命令列出已经挂载在`/media`目录下的磁盘驱动器。
- en: '[PRE61]'
  id: totrans-463
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE61]'
- en: Use the vi editor to edit the Samba configuration file, `/etc/samba/smb.conf`.
  id: totrans-464
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用vi编辑器编辑Samba配置文件`/etc/samba/smb.conf`。
- en: '[PRE62]'
  id: totrans-465
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE62]'
- en: The vi editor displays the contents of the configuration file. Instructions
    for using the editor can be found in the vi man pages; see the recipe *Reading
    the built-in documentation* in [Chapter 2](ch02.html "Chapter 2. Administration"),
    *Administration*.
  id: totrans-466
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: vi编辑器显示配置文件的内容。关于如何使用编辑器的说明可以在vi手册页中找到；请参阅[第2章](ch02.html "第2章 管理")中的配方*阅读内建文档*，*管理*。
- en: '[PRE63]'
  id: totrans-467
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE63]'
- en: 'Add a new share configuration to the bottom of the file:'
  id: totrans-468
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将新的共享配置添加到文件的底部：
- en: '[PRE64]'
  id: totrans-469
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE64]'
- en: '[PRE65]'
  id: totrans-470
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE65]'
- en: Save and exit the vi editor.
  id: totrans-471
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 保存并退出vi编辑器。
- en: Use the `/etc/init.d/samba reload` command to tell the Samba server to reload
    its configuration file.
  id: totrans-472
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`/etc/init.d/samba reload`命令通知Samba服务器重新加载其配置文件。
- en: '[PRE66]'
  id: totrans-473
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE66]'
- en: The file share `\\raspberrypi\bigdisk` is now accessible from the local network!
    Connect as the user `pi`.
  id: totrans-474
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，可以从本地网络访问文件共享`\\raspberrypi\bigdisk`！请以用户`pi`身份连接。
- en: '[PRE67]'
  id: totrans-475
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE67]'
- en: How it works...
  id: totrans-476
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: After logging in to the Raspberry Pi, the recipe lists the disks that have been
    mounted in the `/media` directory. This is the directory used by the Raspberry
    Pi desktop (GUI) when auto-mounting USB disks. It is also the directory used by
    the `pmount` command (and the recipe auto-mounting USB disks at boot).
  id: totrans-477
  prefs: []
  type: TYPE_NORMAL
  zh: 登录到树莓派后，配方列出了已经挂载在`/media`目录下的磁盘。这是树莓派桌面（GUI）在自动挂载USB磁盘时使用的目录，也是`pmount`命令（以及配方在启动时自动挂载USB磁盘）使用的目录。
- en: Then, the vi editor is used to modify the Samba configuration file, `smb.conf`.
    The configuration for a new share `[bigdisk]` is added to the file.
  id: totrans-478
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，使用vi编辑器修改Samba配置文件`smb.conf`。新共享`[bigdisk]`的配置被添加到文件中。
- en: '`[bigdisk]` starts a new section in the `config` file and sets the name of
    the share: `bigdisk`'
  id: totrans-479
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`[bigdisk]`在`config`文件中启动一个新部分，并设置共享的名称为`bigdisk`。'
- en: '`Comment =` A really big disk! defines a comment to display when users browse
    the share from another computer'
  id: totrans-480
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Comment =` 一个非常大的磁盘！定义了在其他计算机浏览共享时显示的注释。'
- en: '`Path = /media/bigdisk` is the location of the files on the Raspberry Pi'
  id: totrans-481
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Path = /media/bigdisk`是树莓派上文件的位置。'
- en: '`valid users = pi` declares that only the user `pi` can access the files'
  id: totrans-482
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`valid users = pi`声明只有用户`pi`可以访问这些文件。'
- en: '`admin users = pi` gives the user `pi` administrative access to the files'
  id: totrans-483
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`admin users = pi`授予用户`pi`对文件的管理员访问权限。'
- en: '`read only = no` allows files to be written to and deleted from the share'
  id: totrans-484
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`read only = no`允许向共享中写入和删除文件。'
- en: After the configuration is saved and the vi editor has been exited, the Samba
    server is told to reload its configuration with the command `/etc/init.d/samba`
    reload.
  id: totrans-485
  prefs: []
  type: TYPE_NORMAL
  zh: 配置保存并退出vi编辑器后，使用命令`/etc/init.d/samba reload`通知Samba服务器重新加载其配置。
- en: Once the configuration file is reloaded, the Samba server is ready to share
    files from the `/media/bigdata` directory over the file share, `bigdata`, at the
    UNC address `\\raspberrypi\bigdata`.
  id: totrans-486
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦配置文件重新加载，Samba服务器就准备好通过文件共享`bigdata`在UNC地址`\\raspberrypi\bigdata`上共享`/media/bigdata`目录中的文件。
- en: Finally, the `smbutil` command is used on another computer (golden-macbook)
    to validate that the new bigdisk share is accessible from the local network.
  id: totrans-487
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，在另一台计算机（golden-macbook）上使用`smbutil`命令验证新的bigdisk共享是否可以从本地网络访问。
- en: There's more...
  id: totrans-488
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: The files in the new share are protected and require that users on other computers
    connect to the share using the Samba password of the `pi` user.
  id: totrans-489
  prefs: []
  type: TYPE_NORMAL
  zh: 新共享中的文件是受保护的，要求其他计算机上的用户通过`pi`用户的Samba密码连接到共享。
- en: Note
  id: totrans-490
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: 'Remember: the Samba password of a user is maintained separately from the login
    password.'
  id: totrans-491
  prefs: []
  type: TYPE_NORMAL
  zh: 请记住：用户的Samba密码与登录密码是分开维护的。
- en: Use the `smbpasswd` command to create and manage Samba passwords (see the previous
    recipe, *Creating a file server for an example*).
  id: totrans-492
  prefs: []
  type: TYPE_NORMAL
  zh: 使用`smbpasswd`命令创建和管理Samba密码（请参见前一个配方，*为示例创建文件服务器*）。
