- en: Understanding Horizon 7 Architecture and Components
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 理解 Horizon 7 架构和组件
- en: In the previous chapter, we introduced you to virtual desktop infrastructure
    and, in particular, the VMware solution, VMware Horizon. As part of that introduction,
    we took a high-level view of some of the different components that make up the
    complete solution. In this chapter, we will start to take a deeper dive into these
    architecture and infrastructure components, concentrating on how they work together
    to make up the complete solution.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一章中，我们介绍了虚拟桌面基础设施，特别是 VMware 的解决方案 VMware Horizon。作为介绍的一部分，我们高层次地了解了构成完整解决方案的一些不同组件。在本章中，我们将开始深入探讨这些架构和基础设施组件，重点讨论它们如何协同工作，共同构成完整的解决方案。
- en: Throughout the sections of this chapter, we will discuss the role of each of
    the Horizon View components, explaining where each one fits into the overall infrastructure,
    and its role. Once we have explained the high-level concept, we will then take
    a deeper dive into how each individual component works. As we work through the
    sections, we will also highlight some of the best practices, as well as some useful
    hints and tips along the way.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 本章的各个部分将讨论每个 Horizon View 组件的作用，解释每个组件在整体基础设施中的位置和作用。我们首先会解释高层次的概念，然后深入探讨每个单独组件的工作原理。在我们逐步讨论这些部分时，还会强调一些最佳实践，并提供一些有用的提示和建议。
- en: 'Along the way, we will also cover some of the third-party technologies that
    integrate and complement VMware Horizon, such as antivirus solutions, storage
    acceleration technologies, and high-end graphics solutions, which all help deliver
    a complete end-to-end solution from the data center to the end user. After reading
    this chapter, you will be able to describe each of the Horizon components, such
    as the following:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个过程中，我们还将介绍一些与 VMware Horizon 集成和互补的第三方技术，如杀毒解决方案、存储加速技术和高端图形解决方案，这些都帮助提供一个从数据中心到最终用户的完整端到端解决方案。阅读完本章后，你将能够描述
    Horizon 的每个组件，例如：
- en: Connection server
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 连接服务器
- en: Security server
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 安全服务器
- en: Replica server
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 副本服务器
- en: Security and the VMware Unified Access Gateway
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 安全性与 VMware 统一访问网关
- en: Managing end user profiles in **View Persona Management** (**VDI**) and **User
    Environment Manager** (**UEM**)
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 **View Persona Management** (**VDI**) 和 **User Environment Manager** (**UEM**)
    中管理最终用户配置文件
- en: Display protocols
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 显示协议
- en: Linked, instant, and full clones
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 链接、即时和完全克隆
- en: Hardware-accelerated graphics (vSGA, vDGA, and vGPU)
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 硬件加速图形（vSGA、vDGA 和 vGPU）
- en: We will discuss what part each one plays within the overall solution, and why
    you would use them, along with how to configure them and the prerequisites for
    installation.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将讨论每个组件在整体解决方案中的作用，以及为什么要使用它们，如何配置它们，以及安装的前提条件。
- en: Introducing the key Horizon components
  id: totrans-13
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 介绍关键的 Horizon 组件
- en: 'To start with, we are going to introduce you to, at a high level, the core
    infrastructure components and the architecture that make up the Horizon View solution.
    We will start with a top-level overview, as shown in the following diagram, before
    we start to drill down into each component in greater detail:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们将高层次地介绍构成 Horizon View 解决方案的核心基础设施组件和架构。我们将从如图所示的顶层概览开始，然后再深入探讨每个组件的详细信息：
- en: '![](img/e500b731-1e9b-4aa7-ab7d-b44a6d077cb0.png)'
  id: totrans-15
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e500b731-1e9b-4aa7-ab7d-b44a6d077cb0.png)'
- en: All the VMware Horizon components described in the preceding diagram are part
    of the overall Horizon solution, but, don't forget, some of the features available
    are dependent on which edition you have purchased.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的图表中描述的所有 VMware Horizon 组件都是整体 Horizon 解决方案的一部分，但不要忘记，一些可用功能取决于你所购买的版本。
- en: It's also worth remembering that Horizon licensing includes the relevant vSphere
    components, ESXi hypervisor and vCenter Server licensing, to enable you to deploy
    the core hosting infrastructure. You can deploy as many ESXi hosts and vCenter
    servers as you require to host the desktop infrastructure.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 还值得记住的是，Horizon 许可包括相关的 vSphere 组件、ESXi 虚拟化程序和 vCenter Server 许可，使你能够部署核心托管基础设施。你可以根据需要部署任意数量的
    ESXi 主机和 vCenter 服务器来托管桌面基础设施。
- en: High-level architectural overview
  id: totrans-18
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 高层次的架构概述
- en: In this section, we are going to discuss the core Horizon View features and
    functionality for brokering virtual desktop machines that are hosted on the VMware
    vSphere platform.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 本节我们将讨论 Horizon View 的核心功能，特别是如何为托管在 VMware vSphere 平台上的虚拟桌面机器提供代理服务。
- en: The Horizon architecture is straightforward to understand, as its foundations
    lie in the standard VMware vSphere products (ESXi and vCenter). So, if you have
    the skills and experience of working with this platform, then you are already
    halfway there.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: Horizon 架构易于理解，因为它的基础建立在标准的 VMware vSphere 产品（ESXi 和 vCenter）上。因此，如果你有使用该平台的技能和经验，那么你已经走了一半的路。
- en: Horizon View builds on the vSphere infrastructure, taking advantage of some
    of the features of the ESXi hypervisor and vCenter Server, adding a number of
    virtual server machines to perform the various View roles and functions.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: Horizon View 基于 vSphere 基础架构，利用 ESXi 虚拟化和 vCenter Server 的一些功能，添加了多个虚拟服务器以执行各种
    View 角色和功能。
- en: 'An overview of the View architecture for delivering virtual desktops is shown
    in the following diagram:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 以下图所示是提供虚拟桌面的 View 架构概述：
- en: '![](img/842ef811-5905-48b4-a877-a78fc312021f.png)'
  id: totrans-23
  prefs: []
  type: TYPE_IMG
  zh: '![](img/842ef811-5905-48b4-a877-a78fc312021f.png)'
- en: Horizon View infrastructure components run as applications that are installed
    on the Microsoft Windows Server operating system, except for the Unified Access
    Gateway, which is a hardened Linux-based appliance. In theory, these infrastructure
    components could run on physical machines; however, there are a great number of
    benefits when you run them as virtual machines, such as delivering HA and DR,
    as well as the typical cost savings that can be achieved through virtualization.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: Horizon View 基础架构组件作为安装在 Microsoft Windows Server 操作系统上的应用程序运行，除了统一访问网关（Unified
    Access Gateway），它是基于 Linux 的硬化设备。理论上，这些基础架构组件可以运行在物理机器上；然而，当它们作为虚拟机运行时，可以获得许多好处，例如提供高可用性（HA）和灾难恢复（DR），以及通过虚拟化实现的典型成本节省。
- en: The following sections will cover each of these roles and components of the
    View architecture in greater detail, starting with the Horizon View Connection
    Server.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 以下章节将更详细地介绍视图架构中的各个角色和组件，从 Horizon View 连接服务器开始。
- en: The Horizon View Connection Server
  id: totrans-26
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Horizon View 连接服务器
- en: The Horizon View Connection Server is also referred to as a connection broker
    or a view manager. It is the primary component of the View infrastructure. Its
    primary role is to connect a user to their virtual desktop by means of performing
    user authentication and then delivering and managing the appropriate desktop resources
    based on the user's profile and entitlement. When logging on to your virtual desktop,
    it is the connection server that you are communicating with.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: Horizon View 连接服务器也被称为连接代理或视图管理器。它是 View 基础架构的主要组件。其主要角色是通过执行用户身份验证，将用户连接到其虚拟桌面，然后根据用户的配置文件和授权交付和管理适当的桌面资源。登录到虚拟桌面时，您与连接服务器进行通信。
- en: How does the connection server work?
  id: totrans-28
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 连接服务器是如何工作的？
- en: A user will connect to their VDI desktop using their endpoint device by first
    launching the Horizon Client, but, equally, they could use browser-based access.
    We will cover the Horizon clients and other access methods in [Chapter 12](e1944fcc-6ae9-4db7-b51b-db75e37e01ab.xhtml),
    *Horizon Client Options*.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 用户将通过启动 Horizon 客户端连接到其 VDI 桌面，但同样，他们也可以使用基于浏览器的访问方式。我们将在[第 12 章](e1944fcc-6ae9-4db7-b51b-db75e37e01ab.xhtml)
    *Horizon 客户端选项*中介绍 Horizon 客户端和其他访问方法。
- en: So, what happens next, and how does the login process work? Once the Horizon
    client has launched, the end user enters the address details of the View Connection
    server they want to connect to (**1**), which in turn responds (**2**) by asking
    them to provide their network login details, their Active Directory domain username,
    and their password.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 那么，接下来会发生什么，登录过程是如何工作的呢？一旦启动 Horizon 客户端，最终用户会输入他们想要连接的 View 连接服务器的地址详情（**1**），然后连接服务器（**2**）会回应并要求他们提供网络登录信息、Active
    Directory 域用户名和密码。
- en: 'It''s worth noting that Horizon View now supports the following different AD
    Domain functional levels:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 值得注意的是，Horizon View 现在支持以下不同的 AD 域功能级别：
- en: Windows Server 2003
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Windows Server 2003
- en: Windows Server 2008 and Windows Server 2008 R2
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Windows Server 2008 和 Windows Server 2008 R2
- en: Windows Server 2012 and Windows Server 2012 R2
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Windows Server 2012 和 Windows Server 2012 R2
- en: Windows Server 2016
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Windows Server 2016
- en: The end users' credentials are authenticated with Active Directory (**3**) and,
    if successful, the user can continue the login process. Depending on what resources
    they are entitled to, the end user will see a launch screen that displays a few
    different virtual desktop machine icons that are available for them to log in
    to. These desktop icons represent the desktop pools that the user has been entitled
    to use. They may well also see application icons representing published applications.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 终端用户的凭证通过Active Directory进行验证（**3**），如果验证成功，用户可以继续登录过程。根据他们被授权的资源，终端用户将看到一个启动屏幕，显示几个可以登录的虚拟桌面机图标。这些桌面图标代表了用户被授权使用的桌面池。用户还可能会看到代表已发布应用程序的应用程序图标。
- en: A desktop pool is basically a collection of similar virtual desktop machines.
    For example, it could be a pool for the marketing department where the virtual
    desktop machines contain specific applications and software for that department.
    We will discuss desktop pools in more detail in [Chapter 8](d44c9a7b-bcae-4758-a857-197be388a4be.xhtml),
    *Configuring and Managing Desktop Pools – Part 1*.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 桌面池基本上是类似虚拟桌面机的集合。例如，它可能是为营销部门设置的池，虚拟桌面机包含该部门特定的应用程序和软件。我们将在[第8章](d44c9a7b-bcae-4758-a857-197be388a4be.xhtml)，*配置和管理桌面池
    – 第一部分*中更详细地讨论桌面池。
- en: Once authenticated, the view manager or the connection server makes a call to
    the vCenter server (**4**) to create a virtual desktop machine, and then vCenter
    makes a call (**5**) to either View Composer (if you are using linked clones),
    or it will create an instant clone using the VM fork feature of vSphere to start
    the build process of the virtual desktop if there is not one already available
    for the user to log in to.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦验证通过，视图管理器或连接服务器会调用vCenter服务器（**4**）以创建虚拟桌面机，并且随后vCenter会调用（**5**）View Composer（如果你使用的是链接克隆），或者它会使用vSphere的VM分支功能创建一个即时克隆来启动虚拟桌面的构建过程，如果没有已经可供用户登录的虚拟桌面。
- en: As part of the overall build process, at this point, if configured, VMware UEM
    will load the end user's profile, personalizing and customizing the virtual desktop
    to that individual user. The same applies to VMware app volumes, which, if configured,
    will now deliver any layered applications at the same time.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 作为整体构建过程的一部分，如果已配置，VMware UEM将加载终端用户的个人资料，个性化并定制该虚拟桌面以适应该用户。同样适用于VMware应用程序卷，如果已配置，它将同时交付任何分层应用程序。
- en: 'When the build process has completed, and the virtual desktop machine is available
    to the end user, complete with their profile and applications, it is displayed
    or delivered within the Horizon Client window (**6**) or browser, using the chosen
    display protocol PCoIP, Blast Extreme, or RDP. This process is described pictorially
    in the following diagram:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 当构建过程完成，虚拟桌面机已准备好供终端用户使用，且包括他们的个人资料和应用程序时，它会通过Horizon Client窗口（**6**）或浏览器显示或交付，使用所选择的显示协议PCoIP、Blast
    Extreme或RDP。这个过程在下图中进行了形象化展示：
- en: '![](img/a7444ef5-d086-45f5-ad92-1273ef188a2e.png)'
  id: totrans-41
  prefs: []
  type: TYPE_IMG
  zh: '![](img/a7444ef5-d086-45f5-ad92-1273ef188a2e.png)'
- en: There are other ways to deploy VDI solutions that do not require a connection
    broker, although you could argue that, strictly speaking, this is not a true VDI
    solution. As we discussed in the introduction and history, this is what the first
    VDI solutions looked like, allowing an end user to connect directly to their own
    virtual desktop via the RDP protocol. If you think about it, though, there are
    still some specific use cases for doing it this way.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 还有其他方式可以部署VDI解决方案，而不需要连接代理，尽管你可以说，严格来说，这不是一个真正的VDI解决方案。正如我们在介绍和历史中讨论的那样，这就是最早的VDI解决方案的样子，允许终端用户通过RDP协议直接连接到他们自己的虚拟桌面。然而，如果仔细考虑，仍然有一些特定的使用场景适合采用这种方式。
- en: For example, if you have a large number of remote branches or offices, you could
    deploy a subset of the infrastructure, hosting it on the local site, allowing
    users to continue working in the event of a WAN outage or poor network communication
    between the branch and head office.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，如果你有大量的远程分支或办公室，你可以部署一部分基础设施，将其托管在本地站点上，从而允许用户在WAN故障或分支机构与总部之间网络通信不良的情况下继续工作。
- en: It just so happens that VMware also thought of this as a use case and has a
    solution that's referred to as a **Brokerless View**, which uses the VMware Horizon
    view agent DirectConnection plugin to connect directly to a virtual desktop machine
    without needing the connection server. This was originally part of the Desktone
    **Desktop as a Service** (**DaaS**) solution that VMware acquired in October 2013\.
    However, don't forget that in a Horizon View environment, the view connection
    server provides greater functionality and does much more than just connect users
    to desktops, as we will see later in this chapter.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 恰巧 VMware 也考虑到这一使用场景，并提出了解决方案，称为 **无代理视图（Brokerless View）**，它使用 VMware Horizon
    视图代理的 DirectConnection 插件直接连接虚拟桌面机器，而无需连接服务器。这最初是 VMware 于 2013 年 10 月收购的 Desktone
    **桌面即服务** (**DaaS**) 解决方案的一部分。然而，别忘了，在 Horizon View 环境中，视图连接服务器提供了更多的功能，远不止将用户连接到桌面，正如我们将在本章后面看到的那样。
- en: Along with brokering the connections between the end users and the virtual desktop
    machines, the view connection server also works with the vCenter server to manage
    the virtual desktop machines. For example, when using linked clones or instant
    clones and powering on virtual desktops, these tasks are initiated by the connection
    server, but they are executed by the vCenter server.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 除了在最终用户和虚拟桌面机器之间进行连接代理外，视图连接服务器还与 vCenter 服务器协作，管理虚拟桌面机器。例如，当使用链接克隆或即时克隆并启动虚拟桌面时，这些任务由连接服务器发起，但由
    vCenter 服务器执行。
- en: Now that we have covered what the connection server is and given you an overview
    of how it works, in the next section, we are going to look at the requirements
    you need in order for it to run.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经介绍了什么是连接服务器，并简要概述了它的工作原理，在接下来的章节中，我们将讨论为了让它正常运行，你需要的要求。
- en: Minimum requirements for the connection server
  id: totrans-47
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 连接服务器的最低要求
- en: To install the connection server, you need to meet the following minimum requirements
    to run on physical or virtual machines.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 要安装连接服务器，你需要满足以下最低要求，才能在物理或虚拟机器上运行。
- en: Hardware requirements
  id: totrans-49
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 硬件要求
- en: 'The following table shows the hardware required for installing the connection
    server:'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 下表显示了安装连接服务器所需的硬件：
- en: '![](img/9ffb6c9e-a63b-4a92-a2f0-cc4a067beac9.png)'
  id: totrans-51
  prefs: []
  type: TYPE_IMG
  zh: '![](img/9ffb6c9e-a63b-4a92-a2f0-cc4a067beac9.png)'
- en: Supported OS
  id: totrans-52
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 支持的操作系统
- en: 'The view connection server must be installed on one of the operating systems
    listed in the following table:'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 视图连接服务器必须安装在下表列出的操作系统之一上：
- en: '![](img/1b461a76-6380-45bb-9f38-616afa48023f.png)'
  id: totrans-54
  prefs: []
  type: TYPE_IMG
  zh: '![](img/1b461a76-6380-45bb-9f38-616afa48023f.png)'
- en: Windows Server 2008 R2 without a service pack is no longer supported.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 不再支持没有服务包的 Windows Server 2008 R2。
- en: In the next section, we are going to look at the Horizon View security server.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 在接下来的章节中，我们将讨论 Horizon View 安全服务器。
- en: The Horizon View security server
  id: totrans-57
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Horizon View 安全服务器
- en: The **Horizon View security server** is another individual component of the
    architecture and is another role performed by the connection server. The key differences
    are that firstly, it sits within your DMZ, and therefore is not joined to your
    domain. This allows it to be used for end users to securely connect to their virtual
    desktop machine from an external network or the internet without the need for
    a VPN. As it is paired with one of your connection servers, the internal connection
    server it is paired with takes care of knowing about the users and desktop pools,
    and so on. Secondly, it does not hold a copy of the ADAM database. As you will
    see in [Chapter 5](89619cdf-5fc7-4dd1-a431-76cef6cbb67c.xhtml), *Installing and
    Configuring Horizon 7 – Part 2*, the installation process is the same as installing
    the view connection server, but, instead, this time, you select the security server
    role from the drop-down menu at the start of installation.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: '**Horizon View 安全服务器**是架构中的另一个独立组件，也是连接服务器执行的另一个角色。主要的区别在于，首先，它位于你的 DMZ（隔离区）内，因此没有加入到你的域中。这使得它能够供最终用户从外部网络或互联网安全地连接到他们的虚拟桌面机器，而无需使用
    VPN。由于它与其中一个连接服务器配对，因此，它所配对的内部连接服务器负责管理用户和桌面池等信息。其次，它不持有 ADAM 数据库的副本。正如你在[第 5
    章](89619cdf-5fc7-4dd1-a431-76cef6cbb67c.xhtml)《安装与配置 Horizon 7 – 第二部分》中看到的，安装过程与安装视图连接服务器相同，但这一次，你在安装开始时从下拉菜单中选择安全服务器角色。'
- en: You cannot install the view security server on the same machine that is already
    running as a connection server or any of the other Horizon View components.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 你不能在已经作为连接服务器或其他任何 Horizon View 组件运行的机器上安装视图安全服务器。
- en: How does the security server work?
  id: totrans-60
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 安全服务器是如何工作的？
- en: To start with, the user login process at the beginning is the same as when connecting
    to a view connection server, essentially because the security server is just another
    version of the connection server running a subset of the features, with the exclusion
    of the ADAM database. The difference is that you connect to the address of the
    security server. The security server sits inside your DMZ and communicates with
    a connection server sitting on the internal network that it is paired with. So,
    now we have added an extra security layer, as the internal connection server is
    not exposed externally, with the idea being that users can now access their virtual
    desktop machines externally without needing to first connect to a VPN on the network.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，用户登录过程与连接到视图连接服务器时相同，本质上因为安全服务器只是运行部分功能的连接服务器的另一个版本，排除了 ADAM 数据库。不同之处在于您连接到安全服务器的地址。安全服务器位于您的
    DMZ（隔离区）内，并与其所配对的位于内部网络上的连接服务器进行通信。因此，现在我们增加了额外的安全层，因为内部连接服务器没有暴露在外部，目的是让用户可以在不首先连接到
    VPN 网络的情况下，外部访问他们的虚拟桌面机。
- en: The security server should not be joined to the domain.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 安全服务器不应加入域。
- en: 'This security server connection process is described pictorially in the following
    diagram:'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 下面的图示描述了安全服务器连接过程：
- en: When the user logs in from the Horizon client, they now use the external URL
    of the security server to access the connection server, which, in turn, authenticates
    the user against Active Directory. If the connection server is configured as a
    PCoIP gateway, then it will pass the connection and addressing information to
    the Horizon client. This connection information will allow the Horizon client
    to connect to the security server using PCoIP. This is shown in the diagram by
    the green arrow (**1**). The security server will then forward the PCoIP connection
    to the virtual desktop machine (**2**), creating the connection for the user.
    The virtual desktop machine is displayed/delivered within the Horizon client window
    (**3**) using the chosen display protocol (PCoIP, Blast Extreme, or RDP). We will
    cover this process and the different ports View uses for connecting later in this
    chapter.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 当用户从 Horizon 客户端登录时，他们现在使用安全服务器的外部 URL 来访问连接服务器，连接服务器反过来会通过 Active Directory
    对用户进行身份验证。如果连接服务器被配置为 PCoIP 网关，那么它将把连接和地址信息传递给 Horizon 客户端。这些连接信息将允许 Horizon 客户端通过
    PCoIP 连接到安全服务器。图中由绿色箭头（**1**）表示。然后，安全服务器将把 PCoIP 连接转发到虚拟桌面机（**2**），为用户创建连接。虚拟桌面机将在
    Horizon 客户端窗口中显示/交付（**3**），并使用所选择的显示协议（PCoIP、Blast Extreme 或 RDP）。我们将在本章稍后讨论此过程以及
    View 用于连接的不同端口。
- en: The Horizon View replica server
  id: totrans-65
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Horizon View 复制服务器
- en: The Horizon View replica server, as the name suggests, is a replica or a copy
    of a view connection server and serves two key roles.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: Horizon View 复制服务器，顾名思义，是视图连接服务器的副本，起着两个关键作用。
- en: The first role is to enable high availability for your Horizon view environment.
    Having a replica of your view connection server means that, if a connection server
    fails, a replica server will take over the management of connection requests so
    that end users are still able to connect to their virtual desktop machines.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 第一个作用是为您的 Horizon View 环境提供高可用性。拥有视图连接服务器的副本意味着，如果一个连接服务器出现故障，复制服务器将接管连接请求的管理，从而使最终用户仍然能够连接到他们的虚拟桌面机。
- en: Secondly, adding replica servers allows you to scale up the number of users
    and virtual desktop connections. An individual instance of a connection server
    can support 2,000 connections, so adding additional connection servers allows
    you to add another 2,000 users at a time, up to the maximum of five connection
    servers and 10,000 users per Horizon view pod. We will discuss the Pod and Block
    architecture in [Chapter 3](20877fa6-9a03-4c97-ab85-4a4338e2c680.xhtml), *Design
    and Deployment Considerations*.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 其次，添加复制服务器可以帮助您扩展用户数量和虚拟桌面连接数。单个连接服务器实例最多支持 2,000 个连接，因此添加额外的连接服务器可以一次增加 2,000
    个用户，最多可扩展到每个 Horizon View pod 五个连接服务器和 10,000 个用户。我们将在[第 3 章](20877fa6-9a03-4c97-ab85-4a4338e2c680.xhtml)
    *设计与部署考虑事项*中讨论 Pod 和 Block 架构。
- en: When deploying a replica server, remember that you will need to change the IP
    address or update the DNS record to match this server if you are not using a load
    balancer.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 部署复制服务器时，请记住，如果您没有使用负载均衡器，则需要更改 IP 地址或更新 DNS 记录，以匹配此服务器。
- en: As with the security server, you will see that the installation process is again
    almost the same as the connection server, but this time, you select the replica
    server role from the drop-down menu during installation.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 与安全服务器类似，你会发现安装过程几乎与连接服务器相同，但这次，在安装过程中你需要从下拉菜单中选择复制服务器角色。
- en: How does the replica server work?
  id: totrans-71
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 复制服务器是如何工作的？
- en: 'The first question is: what gets replicated? The connection broker stores all
    its information relating to the end users, desktop pools, virtual desktop machines,
    and other View-related objects, in an ADAM database. Then, using the **Lightweight
    Directory Access Protocol** (**LDAP**) (it uses a method similar to the one AD
    uses for replication), this View information gets copied from the original connection
    server to the replica server.'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 第一个问题是：什么会被复制？连接代理存储所有与最终用户、桌面池、虚拟桌面机以及其他与 View 相关的对象有关的信息，存储在 ADAM 数据库中。然后，使用
    **轻量级目录访问协议** (**LDAP**)（它使用类似 AD 用于复制的方法），这些 View 信息从原始连接服务器复制到复制服务器。
- en: As both the connection server and the replica server are now identical to each
    other, if your connection server fails, then you essentially have a backup that
    steps in and takes over, so that end users can continue to connect to their virtual
    desktop machines. Also, as the replica server is another instance of a connection
    server within your environment, you can scale up and manage additional end users.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 由于连接服务器和复制服务器现在彼此完全相同，如果你的连接服务器出现故障，那么复制服务器实质上就是一个备份，可以接管并让最终用户继续连接他们的虚拟桌面机。此外，由于复制服务器是环境中连接服务器的另一个实例，你可以扩展和管理额外的最终用户。
- en: As with the other Horizon components, you cannot install the replica server
    role on the same machine that is running as a connection server or any of the
    other Horizon View components.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 与其他 Horizon 组件一样，你不能将复制服务器角色安装在运行连接服务器或任何其他 Horizon View 组件的同一台机器上。
- en: The Horizon View enrolment server and True SSO
  id: totrans-75
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Horizon View 注册服务器和 True SSO
- en: The **Horizon View Enrollment Server** is the final component that is part of
    the Horizon View connection server installation options, and is another installation
    option from the connection server installation process and is selected from the
    drop-down menu. So, what role does the enrolment server perform?
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: '**Horizon View Enrollment Server** 是 Horizon View 连接服务器安装选项的最终组成部分，也是连接服务器安装过程中的另一个安装选项，并且可以从下拉菜单中选择。那么，注册服务器的角色是什么？'
- en: Horizon 7 saw the introduction of a new feature, called **True SSO**. True SSO
    is a solution that allows a user to authenticate to a Microsoft Windows environment
    without them having to enter their AD credentials. It integrates into another
    VMware product, **VMware Identity Manager** (**VIDM**), which forms part of both
    Horizon 7's advanced and enterprise editions.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: Horizon 7 引入了一个名为 **True SSO** 的新功能。True SSO 是一种解决方案，允许用户在不必输入他们的 AD 凭据的情况下认证到
    Microsoft Windows 环境。它集成到另一个 VMware 产品 **VMware Identity Manager** (**VIDM**)
    中，这是 Horizon 7 高级版和企业版的一部分。
- en: Its job is to sit between the connection server and the Microsoft CA to request
    temporary certificates from the certificate store.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 它的工作是坐在连接服务器和 Microsoft CA 之间，从证书存储请求临时证书。
- en: 'This process is described pictorially in the following diagram:'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 此过程在以下图表中有详细描述：
- en: '![](img/a579db1c-47d7-4f3e-9dc7-b742ed58ca9d.png)'
  id: totrans-80
  prefs: []
  type: TYPE_IMG
  zh: '![](img/a579db1c-47d7-4f3e-9dc7-b742ed58ca9d.png)'
- en: 'A user first logs into VIDM, either using their credentials or another authentication
    method such as the following:'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 用户首先登录 VIDM，可以使用他们的凭据或者其他身份验证方法，例如以下内容：
- en: RSA SecurID
  id: totrans-82
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: RSA SecurID
- en: Kerberos
  id: totrans-83
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Kerberos
- en: RADIUS authentication
  id: totrans-84
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: RADIUS 认证
- en: RSA Adaptive Authentication
  id: totrans-85
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: RSA 自适应认证
- en: Standards-based, third-party identity providers
  id: totrans-86
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 基于标准的第三方身份提供者
- en: Once successfully authenticated, the end user will be presented with the virtual
    desktop machines or hosted applications that they are entitled to use. They can
    launch any of these by simply double-clicking, which will launch the Horizon client,
    as shown by the red arrow (**1**) in the previous diagram. The user's credentials
    will then be passed to the connection server (**2**), which, in turn, will verify
    them by sending a **Security Assertion Markup Language** (**SAML**) assertion
    back to the identity manager (**3**).
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦成功验证，最终用户将被呈现其有权使用的虚拟桌面机或托管应用程序。他们可以通过双击启动其中任何一个，这将启动地平线客户端，如前一图中的红色箭头所示（**1**）。然后用户的凭据将传递给连接服务器（**2**），连接服务器将通过将**安全断言标记语言**（**SAML**）断言发送回身份管理器（**3**）来验证它们。
- en: If the end user's credentials are verified, then the connection server passes
    them on to the enrolment server (**4**). The enrolment server then makes a request
    to the Microsoft **Certificate Authority** (**CA**) to generate a short-lived,
    temporary certificate for that user to use (**5**).
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 如果验证了最终用户的凭据，则连接服务器将其传递给注册服务器（**4**）。注册服务器然后向Microsoft **证书颁发机构**（**CA**）发出请求，为该用户生成一个短期临时证书以供使用（**5**）。
- en: With the certificate now generated, the connection server presents it to the
    operating system of the virtual desktop machine (**6**), which, in turn, validates
    with Active Directory to confirm whether the certificate is authentic (**7**).
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 现在生成了证书，连接服务器将其提交给虚拟桌面机的操作系统（**6**），然后操作系统通过活动目录验证证书是否真实（**7**）。
- en: When the certificate has been authenticated, the end user is logged on to their
    virtual desktop machine, which is then displayed/delivered to the Horizon client
    using the chosen display protocol (**8**).
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 证书经过验证后，最终用户将登录其虚拟桌面机，然后使用所选择的显示协议将其显示/传递到地平线客户端（**8**）。
- en: True SSO is supported by all Horizon 7-supported desktop operating systems,
    as well as Windows Server 2008 R2 and Windows Server 2012 R2\. It also supports
    PCoIP, HTML, and Blast Extreme delivery protocols.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 所有Horizon 7支持的桌面操作系统以及Windows Server 2008 R2和Windows Server 2012 R2都支持真正的SSO。它还支持PCoIP、HTML和Blast
    Extreme交付协议。
- en: VMware Unified Access Gateway
  id: totrans-92
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: VMware统一访问网关
- en: 'The **VMware Unified Gateway** performs the same role as the view security
    server and is shown in the following diagram, but there''s one key difference.
    Instead of being a Windows application and another role in the connection server,
    the Unified Access Gateway is a separate virtual appliance that runs a hardened,
    locked-down Linux operating system:'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: '**VMware Unified Gateway**在下图中显示了与视图安全服务器相同的角色，但存在一个关键区别。统一访问网关不是Windows应用程序，也不是连接服务器中的另一个角色，而是一个运行硬化、锁定的Linux操作系统的单独虚拟设备：'
- en: '![](img/7a852476-4147-4f12-8a51-886e8bf70e66.png)'
  id: totrans-94
  prefs: []
  type: TYPE_IMG
  zh: '![](img/7a852476-4147-4f12-8a51-886e8bf70e66.png)'
- en: Although the Unified Gateway appliances deliver pretty much the same functionality
    as the security server, they do not yet completely replace it, especially if you
    already have a production deployment that uses the security server for external
    access. In that event, you can continue to use this architecture.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管统一网关设备提供与安全服务器几乎相同的功能，但它们尚未完全替代它，特别是如果您已经在生产环境中使用安全服务器进行外部访问。在这种情况下，您可以继续使用此架构。
- en: If you are using the secure tunnel function, PCoIP Secure Gateway, or the Blast
    Secure Gateway features of the connection server, then these features will need
    to be disabled on the connection server if you are using Unified Access Gateway.
    They are all enabled by default on the Unified Gateway appliance.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您使用连接服务器的安全隧道功能、PCoIP安全网关或Blast安全网关功能，则在使用统一访问网关时需要在连接服务器上禁用这些功能。这些功能在统一网关设备上默认启用。
- en: A key difference between Unified Access Gateway Appliances and the security
    server is in the way Unified Access Gateway scales. Before, you had to pair a
    security server with a connection server, which was a limitation, but this is
    no longer the case. As such, you can now scale to as many Unified Access Gateways
    as you need for your environment, with the maximum limit being around 2,000 sessions
    for a single appliance. Adding additional appliances is simply a case of deploying
    the appliance, as appliances don't depend on other appliances and do not communicate
    with them. They communicate directly with the connection servers over a load balancer.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: Unified Access Gateway 设备和安全服务器之间的一个关键区别在于 Unified Access Gateway 的扩展方式。之前，您必须将安全服务器与连接服务器配对，这是一种限制，但现在不再是这种情况。因此，您现在可以根据需要为您的环境扩展任意数量的
    Unified Access Gateway，单台设备的最大限制约为 2,000 个会话。添加额外的设备只需部署设备即可，因为设备不依赖于其他设备，也不与其他设备通信。它们通过负载均衡器直接与连接服务器通信。
- en: Persistent or non-persistent desktops?
  id: totrans-98
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 持久桌面还是非持久桌面？
- en: In this section, we are going to talk about the different types of desktop assignments
    and the way a virtual desktop machine is delivered to an end user. This is an
    important design consideration, as the chosen method could potentially impact
    on the storage requirements (covered in the next section), the hosting infrastructure,
    and which technology or solution is used to provision the virtual desktop machines
    to the end users.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将讨论不同类型的桌面分配以及虚拟桌面如何交付给最终用户。这是一个重要的设计考虑因素，因为所选择的方法可能会影响存储需求（将在下一节讨论）、托管基础设施，以及用来向最终用户提供虚拟桌面的技术或解决方案。
- en: One of the questions that often gets asked is whether you should deploy a dedicated
    (persistent) assignment or a floating desktop (non-persistent) assignment. Desktops
    can either be individual virtual machines, which are dedicated to a user on a
    1:1 basis (as we have in a physical desktop deployment, where each user effectively
    owns their own desktop), or a user has a new, vanilla desktop that gets provisioned,
    built, personalized, and then assigned to them at login. The virtual desktop machine
    they access is chosen at random from a pool of available desktops that the end
    user is entitled to use.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 一个常被问到的问题是，是否应该部署专用（持久）分配或浮动桌面（非持久）分配。桌面可以是独立的虚拟机，按 1:1 的比例专门分配给用户（就像物理桌面部署一样，每个用户实际上拥有自己的桌面），或者用户有一个新的、普通的桌面，该桌面在用户登录时会被提供、构建、个性化并分配给他们。用户访问的虚拟桌面从一组可用桌面中随机选择，这些桌面是最终用户有权使用的。
- en: 'The two options are described in more detail as follows:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是对这两种选项的更详细描述：
- en: '**Persistent desktop**: End users are assigned a desktop that keeps all their
    documents, applications, and settings between sessions. The first time the user
    connects to it, the desktop gets statically assigned and is further used for all
    subsequent sessions. No other user is permitted access to the desktop.'
  id: totrans-102
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**持久桌面**：最终用户分配一个桌面，该桌面在会话之间保持所有文档、应用程序和设置。用户第一次连接时，桌面会被静态分配，并将在所有后续会话中继续使用。其他用户无法访问该桌面。'
- en: '**Non-persistent desktop**: End users might be connected to different virtual
    desktops each time they connect. Environmental applications or user data does
    not persist between sessions and is instead delivered as the user logs on to their
    desktop using the composite desktop model we discussed back in [Chapter 1](6b70801c-f579-4fd6-8910-1cc57a06831e.xhtml),
    *Introducing VDI and VMware Horizon 7*. The desktop is refreshed or reset when
    the user logs off and is then ready for the next user.'
  id: totrans-103
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**非持久桌面**：最终用户每次连接时可能会连接到不同的虚拟桌面。环境应用程序或用户数据在会话之间不会持久保存，而是通过我们在[第 1 章](6b70801c-f579-4fd6-8910-1cc57a06831e.xhtml)
    *《引入 VDI 和 VMware Horizon 7》* 中讨论的复合桌面模型在用户登录其桌面时提供。用户注销时桌面会被刷新或重置，然后准备好供下一个用户使用。'
- en: In most use cases, a non-persistent configuration is the best option; the key
    reason is that using this model, you don't need to build all the desktops upfront
    for each user. You only need to power on a virtual desktop as and when it's required.
    All end users start with the same basic desktop, which then gets personalized
    before delivery. This helps with concurrency rates. For example, you might have
    5,000 people in your organization, but only 2,000 ever log in at the same time;
    therefore, you only need to have 2,000 virtual desktops available. Otherwise,
    you would have to build a desktop for each one of the 5,000 users that might ever
    log in, resulting in more server infrastructure, more storage capacity, and more
    software licensing.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 在大多数情况下，非持久性配置是最佳选择；其主要原因在于，使用这种模型，你不需要为每个用户预先构建所有桌面。你只需在需要时启动虚拟桌面。所有用户都从相同的基本桌面开始，然后在交付之前进行个性化。这有助于提高并发率。例如，你的组织可能有
    5,000 人，但每次只有 2,000 人同时登录；因此，你只需要有 2,000 个虚拟桌面可用。否则，你将不得不为可能登录的 5,000 名用户中的每一个构建一个桌面，导致更多的服务器基础设施、更多的存储容量和更多的软件许可证。
- en: One of the things that used to be a bit of a showstopper for non-persistent
    desktops was regarding how to deliver the applications to the virtual desktop
    machine, and whether this would mean you had to install applications each time
    an end user logged in. Now that application layering solutions, such as VMware
    App Volumes or Liquidware FlexApp, are becoming a more mainstream technology,
    the applications can be delivered on demand as the desktop is built and the user
    logs in.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 对于非持久性桌面来说，以前曾经是个小小的障碍是如何将应用程序交付到虚拟桌面机器上，以及这是否意味着每次用户登录时都必须安装应用程序。现在，应用层分层解决方案（例如
    VMware App Volumes 或 Liquidware FlexApp）成为主流技术，应用程序可以按需在构建桌面和用户登录时交付。
- en: Another thing that we often see some confusion over is the difference between
    persistent and non-persistent desktops, and how cloning fits in. Just to make
    it clear, linked clones, full clones, and instant clones are not what we are talking
    about when we refer to persistent and non-persistent desktops. *Cloning operations*
    refers to how a desktop is built and provisioned, whereas the terms *persistent*
    and *non-persistent* refer to how a desktop is assigned to an end user.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 我们经常看到有些人对持久性和非持久性桌面的区别以及克隆如何适用感到困惑。为了明确起见，链接克隆、完整克隆和即时克隆不是我们讨论持久性和非持久性桌面时所指的内容。*克隆操作*
    指的是如何构建和配置桌面，而术语 *持久性* 和 *非持久性* 指的是如何分配桌面给最终用户。
- en: Persistent and non-persistent desktops are purely about user assignment and
    whether an end user has a dedicated desktop, or one allocated from a pool on demand
    each time they log in. Cloning is a feature of Horizon View, which uses either
    View Composer and/or vCenter to create the desktop images for each user from a
    master or parent image. This means, regardless of having a persistent or non-persistent
    desktop assignment, the virtual desktop machine could still be a linked clone,
    full clone, or instant clone.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 持久性和非持久性桌面完全关乎用户分配，以及用户是否拥有专用桌面，或者每次登录时从池中分配一个桌面。克隆是 Horizon View 的一个特性，它使用
    View Composer 和/或 vCenter 从主或父映像为每个用户创建桌面映像。这意味着，无论是持久性还是非持久性桌面分配，虚拟桌面机器仍然可以是链接克隆、完整克隆或即时克隆。
- en: In the next sections, we are going to cover an in-depth overview of the cloning
    technologies available in Horizon 7, starting with Horizon View Composer and linked
    clones, and the advantages the technology delivers.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 在接下来的章节中，我们将深入概述 Horizon 7 中可用的克隆技术，从 Horizon View Composer 和链接克隆开始，以及这项技术所提供的优势。
- en: Horizon View Composer and linked clones
  id: totrans-109
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Horizon View Composer 和链接克隆
- en: In this section, we are going to discuss how virtual desktop machines are built,
    created, and scaled using cloning techniques. We will describe the different cloning
    options, what they deliver, and how they impact disk storage requirements.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将讨论如何使用克隆技术构建、创建和扩展虚拟桌面机器。我们将描述不同的克隆选项，它们的交付内容以及它们对磁盘存储需求的影响。
- en: What is cloning?
  id: totrans-111
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 什么是克隆？
- en: 'Starting at a high level, a clone is a copy of an existing or parent virtual
    machine. This parent virtual desktop machine is your gold build from which you
    want to create new virtual desktop machines. When a clone is created, it becomes
    a separate, new virtual desktop machine with its own unique identity. This process
    is not unique to Horizon View. It''s actually a function of vSphere and vCenter,
    and in the case of Horizon View, we add in another component, View Composer, to
    manage the desktop images. There are three types of clone that can be deployed:
    a full clone, a linked clone, or an instant clone.'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 从高层次开始，克隆是现有或父虚拟机的副本。这个父虚拟桌面机器是您要从中创建新虚拟桌面机器的金像。当克隆创建时，它变成一个独立的新虚拟桌面机器，具有自己独特的身份。这个过程不是Horizon
    View独有的。实际上，这是vSphere和vCenter的功能，而在Horizon View的情况下，我们还添加了另一个组件View Composer来管理桌面图像。可以部署三种类型的克隆：完整克隆、链接克隆或即时克隆。
- en: One of the main reasons a virtual desktop project fails to deliver or doesn't
    even get out of the starting blocks is because of the heavy infrastructure and
    storage requirements. The storage requirements are often seen as a huge cost burden,
    which can be attributed to the fact that people are approaching a VDI project
    in the same way they would approach a physical desktop environment. This would
    mean that each user gets their own dedicated virtual desktop and the hard-disk
    space that comes with it, albeit a virtual disk. This is then scaled out for the
    entire user population, with each user being allocated a virtual desktop with
    some storage.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 虚拟桌面项目无法交付或甚至无法起步的主要原因之一是因为庞大的基础设施和存储需求。存储需求通常被视为巨大的成本负担，这可以归因于人们以与物理桌面环境相同的方式对待VDI项目。这意味着每个用户都获得自己专用的虚拟桌面及其带有硬盘空间的虚拟磁盘。然后，这被扩展到整个用户群体，每个用户分配一个带有一些存储空间的虚拟桌面。
- en: Let's discuss an example. If you had 1,000 users and allocated 250 GB disk space
    per desktop, you would need 1,000 * 250 GB = 250 TB of disk space just for the
    virtual desktop environment. That's a lot of storage just for desktops and could
    result in significant infrastructure costs, which could possibly mean that the
    cost to deploy this amount of storage in the data center would render the project
    cost-ineffective compared to physical desktop deployments. This would be described
    as the **Full Clone** approach.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们举个例子。如果您有1,000个用户，并分配250 GB的磁盘空间给每个桌面，那么您将需要1,000 * 250 GB = 250 TB的磁盘空间仅用于虚拟桌面环境。这对于桌面来说是很多存储空间，可能会导致显著的基础设施成本，这可能意味着在数据中心部署这么多存储成本不划算，与物理桌面部署相比。这将被描述为**完整克隆**方法。
- en: What is a full clone?
  id: totrans-115
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 什么是完整克隆？
- en: As the name implies, a full clone disk is an exact, full-size copy of the parent
    virtual machine or gold image template. Once the clone of the gold image has been
    created, the virtual desktop machine is unique, with its own identity, and operates
    as a fully independent virtual desktop in its own right and is not reliant on
    the gold image from which it was created.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 正如其名称所示，完整克隆磁盘是父虚拟机或金像模板的精确、全尺寸副本。一旦创建了金像的克隆，虚拟桌面机器就是独特的，有着自己的身份，作为一个完全独立的虚拟桌面运行，并且不依赖于它所创建的金像。
- en: However, as it is a full-sized copy, be aware that it will take up exactly the
    same amount of storage as the gold image, which leads back to our discussion earlier
    in this chapter about storage capacity requirements. Using a full clone will require
    larger amounts of storage capacity and will possibly lead to higher infrastructure
    costs.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，由于它是一个全尺寸的副本，请注意它将占用与金像完全相同的存储空间，这与本章早期关于存储容量要求的讨论相关。使用完整克隆将需要更大量的存储容量，并可能导致更高的基础设施成本。
- en: But before you completely dismiss the idea of using full clone virtual desktop
    machines, there are some use cases that rely on this model. For example, if you
    use VMware Mirage to deliver the operating system as a base layer, it only works
    today with full clones and dedicated Horizon View virtual desktop machines.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 但是，在您完全放弃使用完整克隆虚拟桌面机器的想法之前，有一些使用情况依赖于这种模型。例如，如果您使用VMware Mirage将操作系统作为基础层传送，它今天只能使用完整克隆和专用Horizon
    View虚拟桌面机器。
- en: With VDI, a new approach to deploying storage is needed, and this is where linked
    clone and instant clone technology comes into play. In a nutshell, linked and
    instant clones are designed to reduce the amount of disk space required, and to
    simplify the deployment and management of images to multiple virtual desktop machines,
    making it a centralized, and much easier, process.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 在VDI中，部署存储需要一种新的方法，这时链接克隆和即时克隆技术便发挥作用。简而言之，链接克隆和即时克隆的设计目的是减少所需的磁盘空间，并简化将镜像部署到多个虚拟桌面机器的过程，使其成为一个集中式的、更加简单的过程。
- en: What are linked clones?
  id: totrans-120
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 什么是链接克隆？
- en: Having discussed full clones, we are going to talk about deploying virtual desktop
    machines using linked clones.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 在讨论完完全克隆后，我们将讨论使用链接克隆部署虚拟桌面机器。
- en: In a linked clone deployment, a delta disk is created and then used by the virtual
    desktop machine to store the data differences between its own operating system
    and the operating system of its parent virtual desktop machine. Unlike the full
    clone method, a linked clone is not a full copy of the virtual disk. The term
    *linked clone* refers to the fact that the linked clone will always look to its
    parent in order to operate, as it continues to read from the replica disk. Basically,
    the replica is a copy of a snapshot of the parent virtual desktop machine.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 在链接克隆部署中，会创建一个增量磁盘，并由虚拟桌面机器使用它来存储自身操作系统与其父虚拟桌面机器操作系统之间的数据差异。与完全克隆方法不同，链接克隆并不是虚拟磁盘的完整副本。术语*链接克隆*指的是链接克隆始终依赖其父虚拟桌面机器进行操作，因为它会继续从副本磁盘中读取数据。基本上，副本是父虚拟桌面机器快照的复制。
- en: The linked clone itself could potentially grow to the same size as the replica
    disk if you allowed it to. However, you can set limits on how big it can grow,
    and should it start to get too big, then you can refresh the virtual desktops
    that are linked to it. This essentially starts the cloning process again from
    the initial snapshot.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 链接克隆本身如果不加限制，可能会增长到与副本磁盘相同的大小。然而，你可以设置限制，控制其增长的上限，如果它开始变得过大，可以刷新与之链接的虚拟桌面。这实际上是从初始快照重新开始克隆过程。
- en: Immediately after a linked clone virtual desktop is deployed, the difference
    between the parent virtual machine and the newly-created virtual desktop machine
    is extremely small, and therefore reduces the storage capacity requirements compared
    to that of a full clone. This is how linked clones are more space-efficient than
    their full clone brothers.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 当一个链接克隆虚拟桌面被部署后，父虚拟机与新创建的虚拟桌面机器之间的差异非常小，因此与完全克隆相比，减少了存储容量的需求。这就是链接克隆比完全克隆更加节省空间的原因。
- en: The underlying technology behind linked clones is more like a snapshot than
    a clone, but with one key difference—View Composer. With View Composer, you can
    have more than one active snapshot linked to the parent virtual machine disk.
    This allows you to create multiple virtual desktop images from just one parent.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 链接克隆背后的底层技术更像是快照而非克隆，但有一个关键的不同——View Composer。通过View Composer，你可以将多个活动快照与父虚拟机磁盘链接。这使得你可以仅从一个父虚拟机创建多个虚拟桌面镜像。
- en: Best practice would be to deploy an environment with linked clones (or instant
    clones) to reduce the storage requirements. However, as we previously mentioned,
    there are some use cases where you may need to deploy full clones.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 最佳实践是部署一个包含链接克隆（或即时克隆）的环境，以减少存储需求。然而，正如我们之前提到的，有一些使用场景可能需要部署完全克隆。
- en: One thing to be aware of, which still relates to the storage, is that, rather
    than capacity, we are now talking about performance. All linked clone virtual
    desktops are going to be reading from one replica and will, therefore, drive a
    high number of **Input/Output Operations Per Second** (**IOPS**) on the storage
    where the replica lives. Depending on your desktop pool design, you are likely
    to have more than one replica, as you would typically have more than one data
    store. This, in turn, depends on the number of users who will drive the design
    of the solution. We will cover this in greater detail in [Chapter 3](20877fa6-9a03-4c97-ab85-4a4338e2c680.xhtml),
    *Design and Deployment Considerations*.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 需要注意的一点，仍然与存储相关的是，我们现在讨论的不是容量，而是性能。所有的链接克隆虚拟桌面都将从一个副本中读取数据，因此会在存储该副本的地方产生大量的**每秒输入/输出操作次数**（**IOPS**）。根据你的桌面池设计，可能会有多个副本，因为通常会有多个数据存储。这反过来取决于用户数量，从而推动解决方案设计。我们将在[第3章](20877fa6-9a03-4c97-ab85-4a4338e2c680.xhtml)《设计与部署考虑因素》中详细讨论这一点。
- en: With Horizon View, you can choose the location where the replica lives. One
    of the recommendations is that the replica should sit in fast storage, such as
    a local or shared SSD.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 使用Horizon View，你可以选择副本存储的位置。一个推荐是副本应该存放在快速存储设备中，例如本地或共享的SSD。
- en: An alternative solution would be to deploy some form of storage acceleration
    technology to drive the IOPS. Horizon View also has its own integrated solution,
    called **View Storage Accelerator** (**VSA**) or **Content Based Read Cache**
    (**CBRC**). This feature allows you to allocate up to 2 GB of memory from the
    underlying ESXi host server, which can be used as a cache for the most commonly
    read blocks. As we are talking about creating and booting up desktop operating
    systems, the same blocks are required; as these can be retrieved from memory,
    the process is accelerated.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 一种替代方案是部署某种形式的存储加速技术来提升IOPS。Horizon View也有其集成的解决方案，称为**视图存储加速器**（**VSA**）或**基于内容的读取缓存**（**CBRC**）。该功能允许你从底层ESXi主机服务器分配最多2GB的内存，可用作最常读取的块的缓存。由于我们正在创建和启动桌面操作系统，相同的块是必需的；这些可以从内存中检索，从而加速了过程。
- en: View Storage Accelerator is enabled by default when using instant clones and
    cannot be configured.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 在使用即时克隆时，视图存储加速器默认启用且无法配置。
- en: Another solution is **View Composer Array Integration** (**VCAI**), which allows
    the process of building linked clones to be offloaded to the storage array and
    its native snapshot mechanism, rather than taking CPU cycles from the host server.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 另一种解决方案是**视图作曲器阵列集成**（**VCAI**），它允许将构建链接克隆的过程卸载到存储阵列及其本地快照机制，而不是占用主机服务器的CPU资源。
- en: There are also several other third-party solutions that resolve the storage
    performance bottleneck, such as ThinScale's ThinIO ([https://www.thinscale.com/products/thinio/](https://www.thinscale.com/products/thinio/))
    solution, which delivers software-defined storage acceleration to actively reduce
    disk I/O.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 还有其他一些第三方解决方案可以解决存储性能瓶颈，例如ThinScale的ThinIO（[https://www.thinscale.com/products/thinio/](https://www.thinscale.com/products/thinio/)）解决方案，它提供软件定义的存储加速，有效减少磁盘I/O。
- en: In the next section, we will take a deeper look at how the linked clone process
    works.
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一节中，我们将深入探讨链接克隆过程是如何工作的。
- en: How do linked clones work?
  id: totrans-134
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 链接克隆是如何工作的？
- en: The first step, before you even start to build clones, is to create your master
    virtual desktop machine image, which should contain not only the operating system,
    core applications, and settings, but also the Horizon View Agent components. This
    virtual desktop machine will become your parent VM or your gold image from which
    all other virtual desktop machines will be created. We will cover the build process
    in [Chapter 7](d42ce468-eec2-4d43-ba82-25b90b59f936.xhtml), *Building and Optimizing
    the Virtual Desktop OS*. Linked clones are built and managed using View composer
    and the vCenter server.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 在开始构建克隆之前，第一步是创建你的主虚拟桌面机器镜像，该镜像不仅应包含操作系统、核心应用程序和设置，还应包含Horizon View代理组件。这个虚拟桌面机器将成为你的父虚拟机或金像镜像，所有其他虚拟桌面机器都将从中创建。我们将在[第7章](d42ce468-eec2-4d43-ba82-25b90b59f936.xhtml)《构建与优化虚拟桌面操作系统》中介绍构建过程。链接克隆通过View
    composer和vCenter服务器进行构建和管理。
- en: The gold image or parent image cannot be a virtual machine template.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 金像镜像或父镜像不能是虚拟机模板。
- en: 'Once the parent VM has been built, then you can start to build virtual desktops
    and virtual desktop pools using that image. An overview of the linked clone creation
    process is shown in the following diagram:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦父虚拟机（VM）构建完成，你就可以开始使用这个镜像构建虚拟桌面和虚拟桌面池。链接克隆创建过程的概览如下图所示：
- en: '![](img/1624fe36-2f5e-4e23-821d-321189377c75.png)'
  id: totrans-138
  prefs: []
  type: TYPE_IMG
  zh: '![](img/1624fe36-2f5e-4e23-821d-321189377c75.png)'
- en: Take your gold image (**1**), and take a snapshot of it (**2**). When you create
    your desktop pool, this snapshot is selected and will become the replica (**3**)
    and will be set to be read-only. Each virtual desktop is linked back to this replica,
    hence, the term *linked clone*. When you start creating your virtual desktops,
    you create linked clones that are unique copies for each user.
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 获取你的黄金镜像(**1**)，并对其进行快照(**2**)。当你创建桌面池时，这个快照会被选中并成为副本(**3**)，并被设置为只读。每个虚拟桌面都链接到这个副本，因此称之为*链接克隆*。当你开始创建虚拟桌面时，你创建的是每个用户独特的链接克隆副本。
- en: Try not to create too many snapshots for your parent VM. I would recommend having
    just a handful; otherwise, this could impact the performance of your desktops
    and make it a little harder to know which snapshot is which.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 尽量不要为父虚拟机创建太多快照。我建议只有少数几个快照，否则可能会影响桌面的性能，并使得很难区分每个快照的内容。
- en: Creating linked clones
  id: totrans-141
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建链接克隆
- en: During the image-building process, and once the replica disk has been created,
    View Composer creates several other virtual disks, including the linked clone
    (operating system disk) itself. These are described in the following sections.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 在镜像构建过程中，一旦副本磁盘被创建，View Composer会创建几个其他虚拟磁盘，包括链接克隆（操作系统磁盘）本身。这些将在以下章节中描述。
- en: Linked clone disk
  id: totrans-143
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 链接克隆磁盘
- en: The main disk that is created is the linked clone disk itself. This linked clone
    disk is basically an empty virtual disk container that is attached to the virtual
    desktop machine as the user logs in and the desktop starts up and boots.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 创建的主要磁盘是链接克隆磁盘本身。这个链接克隆磁盘基本上是一个空的虚拟磁盘容器，随着用户登录并且桌面启动，它被附加到虚拟桌面机器上。
- en: This disk will start off small but will grow over time depending on the block
    changes that are requested from the replica disk by the virtual desktop machine's
    operating system. These block changes are stored in the linked clone disk, and
    this disk is sometimes referred to as the **delta disk**, or **differential disk**,
    since it stores all the delta changes that the desktop operating system requests
    from the parent VM. As mentioned before, the linked clone disk can grow to the
    maximum size, equal to the parent VM, but, following best practice, you would
    never let this happen. Typically, you can expect the linked clone disk to only
    increase to a few hundred MBs. We will cover this in the *L**inked clone features
    and functionality* section later in this chapter.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 这个磁盘开始时会很小，但随着时间的推移，它会根据虚拟桌面机器操作系统从副本磁盘请求的区块变化而增长。这些区块变化会存储在链接克隆磁盘中，这个磁盘有时也被称为**增量磁盘**或**差异磁盘**，因为它存储了桌面操作系统从父虚拟机请求的所有增量变化。如前所述，链接克隆磁盘可以增长到与父虚拟机相等的最大大小，但按照最佳实践，你不应该允许这种情况发生。通常，你可以预期链接克隆磁盘只会增加到几百MB。我们将在本章后面的*链接克隆功能和特性*部分讨论这个问题。
- en: The replica disk is set as read-only and is used as the primary disk. Any writes
    and/or block changes that are requested by the virtual desktop are written/read
    directly from the linked clone disk.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 副本磁盘被设置为只读，并作为主磁盘使用。任何虚拟桌面请求的写入和/或区块变化都会直接从链接克隆磁盘中进行读取/写入。
- en: Recommended best practice is to allocate tier-1 storage, such as local or shared
    SSD drives, for storing and hosting the replica, as all virtual desktop machines
    within the cluster will be continually referencing this single read-only VMDK
    file as their base image. Keeping it high in the stack improves performance, by
    reducing the overall storage
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 推荐的最佳实践是为存储和托管副本分配一级存储，例如本地或共享的SSD驱动器，因为集群中的所有虚拟桌面机器将持续引用这个单一的只读VMDK文件作为它们的基础镜像。将其保持在存储栈的顶部可以提高性能，通过减少整体存储负载。
- en: Persistent disk or user data disk
  id: totrans-148
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 持久磁盘或用户数据磁盘
- en: The persistent disk feature of View Composer allows you to configure a separate
    disk that contains just the user data and user settings and not the operating
    system. This allows any user data to be preserved when you update or make changes
    to the operating system disk, such as a recompose action.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: View Composer 的持久磁盘功能允许你配置一个单独的磁盘，该磁盘只包含用户数据和用户设置，而不包含操作系统。这使得在你更新或对操作系统磁盘进行更改时（例如重新组合操作），任何用户数据都能得到保留。
- en: It's worth noting that the persistent disk is referenced by the VM name and
    not the username, so bear this in mind if you want to attach the disk to a different
    VM.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 值得注意的是，持久磁盘是通过虚拟机名称而非用户名来引用的，因此，如果你想将磁盘附加到不同的虚拟机，请记住这一点。
- en: The data disk is also used to store the end user's profile. You, therefore,
    need to size it accordingly, ensuring that it is large enough to store any user
    profile type data, such as Virtual Desktop Assessments. This is another reason
    why it's a good idea to run a desktop assessment, as we will cover in [Chapter
    3](20877fa6-9a03-4c97-ab85-4a4338e2c680.xhtml), *Design and Deployment Considerations*,
    so that you can build up a picture of what your user desktop profiles and user
    data requirements look like.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 数据磁盘还用于存储最终用户的配置文件。因此，你需要根据需求合理调整其大小，确保它足够大，能够存储任何类型的用户配置文件数据，例如虚拟桌面评估。这也是为什么进行桌面评估是个好主意的另一个原因，正如我们在[第3章](20877fa6-9a03-4c97-ab85-4a4338e2c680.xhtml)《设计与部署注意事项》中会讲到的那样，帮助你了解用户桌面配置文件和用户数据需求的情况。
- en: Disposable disk
  id: totrans-152
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 一次性磁盘
- en: With the **disposable disk** option, Horizon View creates what is effectively
    a temporary disk that gets deleted every time the user powers off their virtual
    desktop machine.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 使用**一次性磁盘**选项时，Horizon View 创建一个实际上是临时磁盘的磁盘，每次用户关闭其虚拟桌面机器时都会被删除。
- en: If you think about how the Windows desktop operating system operates and the
    files it creates, there are several files that are used on a temporary basis.
    Files such as temporary internet files or the Windows pagefile are two such examples.
    As these are only temporary files, why would you want to keep them? With Horizon
    View, these types of files are redirected to the disposable disk and then deleted
    when the VM is powered off.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你考虑一下 Windows 桌面操作系统的工作方式以及它创建的文件，你会发现有几种文件是临时使用的。例如，临时 Internet 文件或 Windows
    页面文件就是其中的两个例子。既然这些只是临时文件，为什么要保留它们呢？在 Horizon View 中，这些类型的文件会被重定向到一次性磁盘，并在虚拟机关闭时删除。
- en: Horizon View provides the option to have a disposable disk for each virtual
    desktop. This disposable disk is used to contain temporary files that will get
    deleted when the virtual desktop is powered off. These are files that you don't
    want to store on the main operating system disk, as they would consume unnecessary
    disk space. For example, files on the disposable disk are things such as the pagefile,
    Windows system temporary files, and VMware log files.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: Horizon View 提供了为每个虚拟桌面配置一次性磁盘的选项。此一次性磁盘用于存储临时文件，这些文件在虚拟桌面关闭时会被删除。这些文件不希望存储在主操作系统磁盘上，因为它们会占用不必要的磁盘空间。例如，一次性磁盘上的文件包括页面文件、Windows
    系统临时文件和 VMware 日志文件等。
- en: It's worth pointing out that we are talking about temporary system files and
    not user files. An end user's temporary files are still stored on the user data
    disk so that they can be preserved. Many applications use the Windows temp folder
    to store installation CAB files, which can be referenced post-installation. Having
    said that, you might want to delete the temporary user data to reduce the overall
    desktop image size, in which case you could ensure that the user's temporary files
    are directed to the disposable disk.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 值得指出的是，我们讨论的是临时系统文件，而不是用户文件。最终用户的临时文件仍然存储在用户数据磁盘上，以便能够保留。许多应用程序使用 Windows 临时文件夹来存储安装
    CAB 文件，安装后可以引用这些文件。话虽如此，你可能希望删除临时用户数据，以减小整体桌面镜像大小，在这种情况下，你可以确保用户的临时文件被定向到一次性磁盘。
- en: Internal disk
  id: totrans-157
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 内部磁盘
- en: Finally, we have the internal disk. The internal disk is used to store important
    configuration information, such as the computer account password, which would
    be needed to join the virtual desktop machine back to the domain if you refreshed
    the linked clones. It is also used to store the **Sysprep** and **Quickprep**
    configuration details. We will cover Quickprep in [Chapter 7](d42ce468-eec2-4d43-ba82-25b90b59f936.xhtml),
    *Building and Optimizing the Virtual Desktop OS*.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们有内部磁盘。内部磁盘用于存储重要的配置信息，例如计算机帐户密码，如果刷新了链接克隆，它将用于将虚拟桌面机器重新加入域。它还用于存储**Sysprep**和**Quickprep**配置详细信息。我们将在[第七章](d42ce468-eec2-4d43-ba82-25b90b59f936.xhtml)，*构建和优化虚拟桌面操作系统*中详细讲解Quickprep。
- en: In terms of disk space, the internal disk is relatively small, averaging around
    20 MB. By default, the user will not see this disk from their Windows Explorer,
    as it contains important configuration information that you wouldn't want them
    to delete.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 在磁盘空间方面，内部磁盘相对较小，平均大约为20 MB。默认情况下，用户无法在其Windows资源管理器中看到此磁盘，因为它包含重要的配置信息，您不希望他们删除它。
- en: 'The following diagram shows you an outline of the different disk types created:'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 下图展示了不同磁盘类型的创建概述：
- en: '![](img/6fc90d3d-b667-4be6-856f-8cf55aec88b4.png)'
  id: totrans-161
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6fc90d3d-b667-4be6-856f-8cf55aec88b4.png)'
- en: In the next section, we will take a deeper dive into how the linked clone process
    works.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一节中，我们将深入探讨链接克隆过程的工作原理。
- en: Understanding how the linked clone process works
  id: totrans-163
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 理解链接克隆过程是如何工作的
- en: There are several complex steps performed by View Composer and View Manager
    that initiate when a user requests a virtual desktop machine. So, what's the process
    of building a linked clone desktop, and what goes on behind the scenes? When a
    user logs into Horizon View and requests a virtual desktop machine, View Manager,
    using vCenter and View Composer, will create a virtual desktop machine if there
    is not already one available to the end user.
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: View Composer和View Manager执行了几个复杂的步骤，当用户请求虚拟桌面机器时，这些步骤会启动。那么，构建链接克隆桌面的过程是怎样的，幕后发生了什么呢？当用户登录Horizon
    View并请求虚拟桌面机器时，View Manager将使用vCenter和View Composer创建一个虚拟桌面机器，如果没有现有的虚拟桌面机器可供最终用户使用。
- en: This process is described in the following sections.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 该过程在以下章节中进行描述。
- en: Creating and provisioning a new virtual desktop
  id: totrans-166
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建和配置新的虚拟桌面
- en: 'The first step in the process is to create and provision the virtual desktop
    machine as described in the following steps:'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 该过程的第一步是创建和配置虚拟桌面机器，如下所述：
- en: An entry for the virtual desktop machine is created in the **Active Directory
    Application Mode** (**ADAM**) database before it is then put into provisioning
    mode.
  id: totrans-168
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在将虚拟桌面机器置于配置模式之前，**Active Directory 应用程序模式**（**ADAM**）数据库中会创建一个虚拟桌面机器条目。
- en: The linked clone virtual desktop machine is created by View Composer.
  id: totrans-169
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 链接克隆虚拟桌面机器由View Composer创建。
- en: A machine account is created in Active Directory with a randomly generated password.
  id: totrans-170
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在Active Directory中创建一个机器帐户，并生成随机密码。
- en: View Composer checks for a replica disk and creates one if one does not already
    exist.
  id: totrans-171
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: View Composer检查是否存在副本磁盘，如果没有，则会创建一个。
- en: A linked clone is created by the vCenter Server API call from View Composer.
  id: totrans-172
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 链接克隆是通过View Composer的vCenter Server API调用创建的。
- en: An internal disk is created to store the configuration information and machine
    account password.
  id: totrans-173
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个内部磁盘以存储配置信息和机器帐户密码。
- en: The virtual desktop machine has been created and is now ready for the next step
    of the process—customization.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 虚拟桌面机器已经创建，现在可以进入下一步：自定义。
- en: Customizing the desktop
  id: totrans-175
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 自定义桌面
- en: Now that the new linked clone virtual desktop machine has been built, the next
    step in the process is to customize it.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，新建的链接克隆虚拟桌面机器已经构建完成，下一步是对其进行自定义。
- en: 'To customize the virtual desktop machine, follow these steps:'
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 要自定义虚拟桌面机器，请按照以下步骤操作：
- en: The virtual desktop machine is switched to customization mode.
  id: totrans-178
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 虚拟桌面机器被切换到自定义模式。
- en: The virtual desktop machine is customized by vCenter Server using the `customizeVM_Task`
    command and is joined to the domain with the information you entered in the View
    Manager console.
  id: totrans-179
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 虚拟桌面机器通过vCenter Server使用`customizeVM_Task`命令进行自定义，并使用您在View Manager控制台中输入的信息加入域。
- en: The linked clone virtual desktop is powered on.
  id: totrans-180
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启动链接克隆虚拟桌面。
- en: The View Composer Agent on the linked clone virtual desktop machine starts up
    for the first time and joins the machine to the domain, using the `NetJoinDomain`
    command and the machine account password that was created on the internal disk.
  id: totrans-181
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 链接克隆虚拟桌面机上的 View Composer 代理首次启动并将该机器加入域，使用 `NetJoinDomain` 命令和在内部磁盘上创建的机器账户密码。
- en: The linked clone virtual desktop machine is now Sysprep'd or Quickprep'd. Once
    complete, View Composer tells View Agent that the customization has finished,
    and View Agent tells View Manager that the customization process has finished.
  id: totrans-182
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 链接克隆虚拟桌面机现在已完成 Sysprep 或 Quickprep 操作。完成后，View Composer 会通知 View Agent 自定义已完成，View
    Agent 再通知 View Manager 自定义过程已结束。
- en: The linked clone virtual desktop machine is powered off and a snapshot is taken.
    If you use Quickprep, then you don't need to restart the virtual desktop machine
    following customization.
  id: totrans-183
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 链接克隆虚拟桌面机已关闭，并且已创建快照。如果使用 Quickprep，则在自定义后无需重新启动虚拟桌面机。
- en: The linked clone virtual desktop machine is marked as provisioned and is now
    available for use.
  id: totrans-184
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 链接克隆虚拟桌面机被标记为已配置，现在可以使用。
- en: When an end user connects and powers on a linked clone virtual desktop machine,
    the View Composer agent installed on that virtual desktop is able to track changes
    to the machine account password. If there is a change, then the new updated password
    will be stored on the linked clone internal disk. The machine account password
    is often changed, depending on password policies, so if the View Composer agent
    detects this change of password, then it will update the machine account password
    on the internal disk that was created when the linked clone desktop was created.
    This is a key feature when refreshing linked clone disks, as the linked clone
    virtual desktop machine reverts back to the snapshot taken after the virtual desktop
    machine has been customized. This means that the View Composer agent can reset
    the machine account password to the latest one.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 当最终用户连接并启动链接克隆虚拟桌面机时，安装在该虚拟桌面机上的 View Composer 代理能够跟踪机器账户密码的变化。如果发生更改，新的更新密码将存储在链接克隆的内部磁盘上。根据密码策略，机器账户密码通常会发生变化，因此如果
    View Composer 代理检测到密码更改，它将更新链接克隆桌面创建时所创建的内部磁盘上的机器账户密码。这是刷新链接克隆磁盘时的一个关键功能，因为链接克隆虚拟桌面机会恢复到自定义后拍摄的快照。这意味着
    View Composer 代理可以将机器账户密码重置为最新密码。
- en: 'The linked clone process is depicted in the following diagram:'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 链接克隆过程如下图所示：
- en: '![](img/f3c39cd8-9cd5-41df-8a34-ae096d4c67a7.png)'
  id: totrans-187
  prefs: []
  type: TYPE_IMG
  zh: '![](img/f3c39cd8-9cd5-41df-8a34-ae096d4c67a7.png)'
- en: In the next section, we are going to look at some of the additional features
    and functions of using linked clones.
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 在接下来的部分中，我们将讨论使用链接克隆的一些附加功能和特性。
- en: Linked clone features and functionality
  id: totrans-189
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 链接克隆的特性和功能
- en: There are several other management functions that you can perform on a linked
    clone disk using View Composer. These functions are outlined in this section and
    are used to deliver the ongoing management of the virtual desktop machines.
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 View Composer，您可以对链接克隆磁盘执行几个其他管理功能。此部分概述了这些功能，并用于提供虚拟桌面机器的持续管理。
- en: Recomposing a linked clone
  id: totrans-191
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 重新组合链接克隆
- en: Recomposing a linked clone virtual desktop machine or desktop pool allows you
    to perform updates to the operating system disk, such as updating the image with
    the latest patches, or software updates. You can only perform updates on the same
    version of an operating system, so you cannot use the recompose feature to migrate
    from one operating system to another, such as going from Windows 7 to Windows
    10.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 重新组合链接克隆虚拟桌面机或桌面池允许您对操作系统磁盘进行更新，例如使用最新的补丁或软件更新更新镜像。您只能在相同版本的操作系统上执行更新，因此无法使用重新组合功能从一个操作系统迁移到另一个操作系统，例如从
    Windows 7 迁移到 Windows 10。
- en: As we've covered in the *What does View Composer Build?* section, we have separate
    disks for items such as a user's data. These disks are not affected during a recompose
    operation, so all user-specific data on them is preserved.
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 正如我们在*View Composer构建了什么？*部分中提到的，我们为用户数据等项目准备了独立的磁盘。在重新组合操作期间，这些磁盘不会受到影响，因此上面的所有用户特定数据都会被保留。
- en: When you initiate the recompose operation, View Composer essentially starts
    the linked clone building process over again; thus, a new operating system disk
    is created, which then gets customized, and a snapshot, such as the ones shown
    in the preceding sections, is taken.
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 当您启动重新合成操作时，View Composer实际上是重新开始链接克隆的构建过程；因此，新的操作系统磁盘会被创建，随后会进行自定义，并拍摄类似前面章节所展示的快照。
- en: During the recompose operation, the Mac addresses of the network interface and
    the Windows SID are not preserved. There are some management tools and security-type
    solutions that might not work due to this change. However, the UUID will remain
    the same.
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 在重新合成操作过程中，网络接口的Mac地址和Windows SID不会被保留。由于此更改，某些管理工具和安全类型的解决方案可能无法正常工作。然而，UUID将保持不变。
- en: 'Before you perform the recompose operation, you will need to create your new
    image and then take the initial snapshot. The recompose process is described in
    the following steps:'
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 在执行重新合成操作之前，您需要创建新的镜像并拍摄初始快照。重新合成过程如下所述：
- en: View Manager switches the linked clone to maintenance mode.
  id: totrans-197
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: View Manager将链接克隆切换到维护模式。
- en: View Manager calls the View composer resync API for the linked clones being
    recomposed, directing View Composer to use the new base image and the snapshot.
  id: totrans-198
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: View Manager调用View composer的resync API，针对正在重新合成的链接克隆，指示View Composer使用新的基础镜像和快照。
- en: If no replica for the base image and snapshot exist, then, in the target datastore
    used by the linked clone, View Composer will create the replica in that same target
    datastore, that is, unless you have configured View to use a separate datastore
    for storing replicas.
  id: totrans-199
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果基础镜像和快照的副本不存在，则在链接克隆使用的目标数据存储中，View Composer将创建该副本，前提是您未配置View使用单独的数据存储来存储副本。
- en: For the linked clone, the current OS disk is deleted by the View composer. It
    then creates a new OS disk that is linked to the newly created replica.
  id: totrans-200
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对于链接克隆，当前的操作系统磁盘会被View Composer删除。然后，它会创建一个新的操作系统磁盘，并将其与新创建的副本关联。
- en: The remainder of the recompose cycle follows the customization phase of the
    provisioning and customization cycles.
  id: totrans-201
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 重新合成周期的其余部分跟随了配置和自定义周期的自定义阶段。
- en: 'The following diagram shows a graphical representation of the recompose process.
    Before the process begins, the first thing you need to do is update your gold
    image (**1**) with the patch updates or new applications you want to deploy as
    the virtual desktops:'
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 以下图示展示了重新合成过程的图形表示。在过程开始之前，首先需要做的是更新您的黄金镜像（**1**），包括您想要部署为虚拟桌面的补丁更新或新应用程序：
- en: '![](img/0d3374ba-08db-4227-a7b9-f3cf7edf1a1f.png)'
  id: totrans-203
  prefs: []
  type: TYPE_IMG
  zh: '![](img/0d3374ba-08db-4227-a7b9-f3cf7edf1a1f.png)'
- en: As described in the preceding steps, the snapshot is then taken (**2**) to create
    the new replica, Replica V2 (**3**). The existing OS disk is destroyed, but the
    user data disk (**4**) is maintained during the recompose process.
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，快照会被拍摄（**2**），以创建新的副本，副本V2（**3**）。现有的操作系统磁盘会被销毁，但在重新合成过程中，用户数据磁盘（**4**）会被保留。
- en: Refreshing a linked clone
  id: totrans-205
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 刷新链接克隆
- en: By carrying out a refresh of the linked clone virtual desktop, you are effectively
    reverting it to its initial state, when its original snapshot was taken after
    it had completed the customization phase. This process only applies to the operating
    system disk and no other disks are affected.
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 通过执行链接克隆虚拟桌面的刷新操作，实际上您是在将其恢复到初始状态，即在完成自定义阶段后拍摄的原始快照。这一过程仅适用于操作系统磁盘，其他磁盘不会受到影响。
- en: An example use case for refresh operations would be recomposing a non-persistent
    desktop two hours after logoff, to return it to its original state and make it
    available for the next user.
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 刷新操作的一个使用案例是，在注销后两小时重新合成一个非持久化桌面，将其恢复到原始状态，并使其可供下一个用户使用。
- en: 'The refresh process performs the following tasks:'
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 刷新过程执行以下任务：
- en: The linked clone virtual desktop is switched to maintenance mode.
  id: totrans-209
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 链接克隆虚拟桌面被切换到维护模式。
- en: 'View Manager reverts the linked clone virtual desktop to the snapshot taken
    after customization was completed: `- vdm-initial-checkpoint`.'
  id: totrans-210
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: View Manager将链接克隆虚拟桌面还原为自定义完成后所拍摄的快照：`- vdm-initial-checkpoint`。
- en: The linked clone virtual desktop starts up, and the View Composer agent detects
    whether the machine account password needs to be updated. If it doesn't, and the
    current password on the internal disk is newer than the password currently stored
    in the registry, then the View Composer agent updates the machine account password
    using the password that is on the internal disk.
  id: totrans-211
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 链接克隆虚拟桌面启动时，View Composer 代理会检测机器帐户密码是否需要更新。如果不需要更新，并且内部磁盘上的当前密码比注册表中当前存储的密码更新，那么
    View Composer 代理将使用内部磁盘上的密码来更新机器帐户密码。
- en: One of the reasons you would perform a refresh operation is if the linked clone
    OS disk starts to become bloated. As we previously discussed, the OS-linked clone
    disk could grow to the full size of its parent image. This means it would be taking
    up more disk space than is necessary, which kind of defeats the objective of linked
    clones. The refresh operation effectively resets the linked clone back to a small
    delta between it and its parent image.
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 执行刷新操作的一个原因是当链接克隆的操作系统磁盘开始膨胀时。正如我们之前讨论过的，操作系统链接克隆磁盘可能会增长到与其父映像相同的大小。这意味着它占用了比必要的更多磁盘空间，这在某种程度上违背了链接克隆的目的。刷新操作有效地将链接克隆重置为与其父映像之间的小差异。
- en: 'The following diagram shows a representation of the refresh operation:'
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 以下图示展示了刷新操作的表现：
- en: '![](img/c9002f0b-553e-4190-a195-642c4c657afc.png)'
  id: totrans-214
  prefs: []
  type: TYPE_IMG
  zh: '![](img/c9002f0b-553e-4190-a195-642c4c657afc.png)'
- en: The linked clone disk on the left-hand side of the diagram has started to grow
    (**2**). Refreshing the first places the virtual desktop machine in maintenance
    mode (**1**). The virtual desktop is then reverted to the original snapshot (**3**).
    The new linked clone desktop has now been reset to the same size as when it was
    first created (**4**).
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 图示左侧的链接克隆磁盘开始膨胀（**2**）。首先刷新操作将虚拟桌面机置于维护模式（**1**）。然后，虚拟桌面机被还原为原始快照（**3**）。新的链接克隆桌面现在已经重置为与首次创建时相同的大小（**4**）。
- en: Rebalancing operations with View Composer
  id: totrans-216
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 View Composer 的重新平衡操作
- en: The rebalance operation in View Composer is used to evenly distribute the linked
    clone virtual desktop machines across multiple datastores in your environment.
    You would perform this task if one of your datastores was becoming full while
    others have ample free space. It might also help with the performance of that
    datastore. For example, if you had 10 virtual desktop machines in one datastore
    and only 2 in another, then running a rebalance operation would potentially even
    this out and leave you with 6 virtual desktop machines in each datastore.
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: View Composer 中的重新平衡操作用于将链接克隆虚拟桌面机均匀地分布到环境中的多个数据存储区。如果其中一个数据存储区即将满而其他数据存储区还有充足的空闲空间，你可以执行此任务。它还可能有助于提高该数据存储区的性能。例如，如果你在一个数据存储区有
    10 台虚拟桌面机，而在另一个数据存储区只有 2 台，那么执行重新平衡操作可能会使它们更均衡，使每个数据存储区都拥有 6 台虚拟桌面机。
- en: You must use the View Administrator console to initiate the rebalance operation
    in View Composer. If you simply try to Storage vMotion any of your virtual desktop
    machines, then View Composer will not be able to keep track of them.
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: 你必须使用 View Administrator 控制台来启动 View Composer 中的重新平衡操作。如果你只是尝试对虚拟桌面机执行存储 vMotion，那么
    View Composer 将无法跟踪它们。
- en: 'On the other hand, if you have six virtual desktop machines on one datastore
    and seven on another, then it is highly likely that initiating a rebalance operation
    will have no effect, and no virtual desktop machines will be moved, as doing so
    has no benefit. A VDI desktop will only be moved to another datastore if the target
    datastore has significantly more spare capacity than the source:'
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 另一方面，如果你在一个数据存储区有六台虚拟桌面机，而在另一个数据存储区有七台，那么启动重新平衡操作很可能不会产生任何效果，虚拟桌面机也不会被移动，因为这样做没有任何好处。只有当目标数据存储区比源数据存储区有显著更多的空闲容量时，VDI
    桌面才会被移动到另一个数据存储区：
- en: The linked clone is switched to maintenance mode.
  id: totrans-220
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 链接克隆被切换到维护模式。
- en: Virtual machines to be moved are identified based on the free space in the available
    datastores.
  id: totrans-221
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 根据可用数据存储区的空闲空间，识别需要移动的虚拟机。
- en: The operating system disk and persistent disk are disconnected from the virtual
    desktop machine.
  id: totrans-222
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 操作系统磁盘和持久磁盘与虚拟桌面机断开连接。
- en: The detached operating system disk and persistent disk are moved to the target
    datastore.
  id: totrans-223
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 分离的操作系统磁盘和持久磁盘被移动到目标数据存储区。
- en: The virtual desktop machine is moved to the target datastore.
  id: totrans-224
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 虚拟桌面机被移动到目标数据存储区。
- en: The operating system disk and persistent disk are reconnected to the linked
    clone virtual desktop machine.
  id: totrans-225
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 操作系统磁盘和持久磁盘重新连接到链接克隆虚拟桌面机。
- en: View Composer resynchronizes the linked clone virtual desktop machines.
  id: totrans-226
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: View Composer 重新同步链接克隆虚拟桌面机。
- en: View Composer checks for the replica disk in the datastore and creates one if
    one does not already exist, as per the provisioning steps covered earlier in this
    chapter.
  id: totrans-227
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: View Composer 会在数据存储中检查副本磁盘，如果不存在副本磁盘，会根据本章前面所述的配置步骤创建一个副本磁盘。
- en: As per a recompose operation, the OS disk for the linked clone gets deleted
    and a new one is created and then customized.
  id: totrans-228
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 根据重新配置操作，链接克隆的操作系统磁盘将被删除，然后创建一个新的操作系统磁盘并进行自定义。
- en: 'The following diagram shows the rebalance operation. It started with two virtual
    desktop machines in datastore A, and four virtual desktop machines in datastore
    B. The rebalance operation in this example evened out the datastores so that there
    are four virtual desktop machines in each of the two datastores:'
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 以下图示展示了重新平衡操作。操作开始时，数据存储 A 中有两台虚拟桌面机，数据存储 B 中有四台虚拟桌面机。在这个例子中，重新平衡操作使两个数据存储的虚拟桌面机数量趋于均衡，每个数据存储中有四台虚拟桌面机：
- en: '![](img/c44335aa-f665-4ecf-8a4b-1d98455d0542.png)'
  id: totrans-230
  prefs: []
  type: TYPE_IMG
  zh: '![](img/c44335aa-f665-4ecf-8a4b-1d98455d0542.png)'
- en: In the next section, we are going to look at the Instant Clone feature for creating
    virtual desktop machines.
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一节中，我们将探讨创建虚拟桌面机的即时克隆功能。
- en: Instant Clones
  id: totrans-232
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 即时克隆
- en: The **Instant Clones** feature is functionality built into the vSphere platform
    rather than a specific Horizon feature, and was made available from the vSphere
    6.0 U1 release when it became a supported feature as part of Horizon.
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: '**即时克隆**功能是内置于 vSphere 平台的功能，而非特定的 Horizon 功能，并且从 vSphere 6.0 U1 版本开始提供支持，当时它成为
    Horizon 的支持功能之一。'
- en: It uses the VMware VM Fork technology to very quickly provision virtual desktop
    machines. An instant clone is created from an already powered on and running virtual
    desktop machine, called the parent virtual desktop machine, which is quiesced
    before the instant clone is created. This is what makes instant clones quicker
    to provision than linked clones and View Composer.
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 它使用 VMware VM Fork 技术来快速配置虚拟桌面机。即时克隆是从已经开机并运行的虚拟桌面机中创建的，称为父虚拟桌面机，在创建即时克隆之前，父虚拟桌面机会被暂挂。这使得即时克隆比链接克隆和
    View Composer 更快速地进行配置。
- en: 'The instant clone shares its memory and its disk with the parent virtual desktop
    machine for read operations and is created immediately, and in an already powered-on
    state, unlike with View Composer-based linked clones that must power on as part
    of the creation process. As well as sharing the memory and disk with the parent
    virtual desktop machine, the instant clone has its own unique memory and delta
    disk file. The following diagram shows the instant clone''s architecture:'
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: 即时克隆与父虚拟桌面机共享内存和磁盘进行读取操作，并且会立即创建，且处于已开机状态，这与基于 View Composer 的链接克隆不同，后者在创建过程中必须启动。此外，除了与父虚拟桌面机共享内存和磁盘外，即时克隆还拥有其自己的独立内存和增量磁盘文件。以下图示展示了即时克隆的架构：
- en: '![](img/cba7d6a8-a804-4e1f-90d4-8154b719edd2.png)'
  id: totrans-236
  prefs: []
  type: TYPE_IMG
  zh: '![](img/cba7d6a8-a804-4e1f-90d4-8154b719edd2.png)'
- en: When the end user logs off the instant clone virtual desktop machine, it is
    destroyed, and when the user logs on again, they will have a new instant clone
    created. If they need any data to persist, then they would use the Writeable Volume
    feature of App Volumes to deliver that functionality and UEM to manage their personalization
    settings.
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: 当最终用户注销即时克隆虚拟桌面机时，它将被销毁，当用户再次登录时，将创建一个新的即时克隆。如果需要保留任何数据，用户可以使用 App Volumes 的可写卷功能来提供该功能，并使用
    UEM 管理他们的个性化设置。
- en: To take advantage of instant clones, the virtual desktop machines will need
    to be running virtual machine hardware version 11 or higher.
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 要利用即时克隆，虚拟桌面机需要运行虚拟机硬件版本 11 或更高版本。
- en: Instant clone build process
  id: totrans-239
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 即时克隆构建过程
- en: Previously, when we talked about linked clones, we looked at what the build
    process looks like and what gets built, so let's now look at that again from an
    instant clone perspective.
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: 之前我们讨论过链接克隆时，分析了构建过程及构建内容，现在我们从即时克隆的角度再看一遍。
- en: As always, we start with the master image, the virtual desktop machine that
    all other desktops are built from. The first thing that happens is that a snapshot
    of the master virtual desktop machine is taken. Next, an internal template is
    created that is a linked clone of the master virtual desktop machine based on
    the virtual desktop machine snapshot taken in the previous step.
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: 一如既往，我们从主镜像开始，这是所有其他桌面构建的虚拟桌面。首先，会对主虚拟桌面进行快照。接下来，基于前一步拍摄的虚拟桌面快照，创建一个内部模板，该模板是主虚拟桌面的链接克隆。
- en: Next, we have the replica virtual desktop machine, which is a thin-provisioned,
    full clone of the internal template virtual desktop machine. View Storage Accelerator
    uses a CBRC digest of this virtual desktop machine. After the replica virtual
    desktop machine, the running parent virtual desktop machine is created using a
    linked clone of the replica virtual desktop machine, which, in turn, is based
    on a replica virtual desktop machine snapshot.
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来是复制的虚拟桌面，它是内部模板虚拟桌面的瘦配置全克隆。视图存储加速器使用该虚拟桌面的CBRC摘要。在复制虚拟桌面之后，通过使用复制虚拟桌面的链接克隆来创建运行中的父虚拟桌面，该链接克隆又是基于复制虚拟桌面快照创建的。
- en: 'Finally, the instant clone desktop is created and is ready for the end user.
    The following diagram describes this process pictorially:'
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: 最终，瞬时克隆桌面被创建并准备好供最终用户使用。以下图示描述了这一过程：
- en: '![](img/09296593-2598-425b-b0c5-4c6748142b1a.png)'
  id: totrans-244
  prefs: []
  type: TYPE_IMG
  zh: '![](img/09296593-2598-425b-b0c5-4c6748142b1a.png)'
- en: Instant clone benefits
  id: totrans-245
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 瞬时克隆的优势
- en: 'There are several benefits to using instant clones, compared to linked clones:'
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: 与链接克隆相比，使用瞬时克隆有几个好处：
- en: Instant clones provision in seconds, whereas linked clones take a lot longer
    (typically minutes).
  id: totrans-247
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 瞬时克隆几秒钟内即可配置完成，而链接克隆通常需要更长的时间（通常是几分钟）。
- en: There are no longer any boot storms, as the parent desktop is already powered
    on, and therefore all instant clones get created in an already powered-on state.
  id: totrans-248
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 不再出现启动风暴，因为父桌面已经开机，因此所有瞬时克隆都会在已开机的状态下创建。
- en: There is no requirement to perform a refresh or recompose operation, as desktops
    have a short life cycle.
  id: totrans-249
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 不需要执行刷新或重组操作，因为桌面的生命周期较短。
- en: Patching the operating system requires you to just update the parent VM, rather
    than running a recompose operation, resulting in an end user receiving the updated
    virtual desktop machine on their next login, automatically.
  id: totrans-250
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 更新操作系统只需要更新父虚拟机，而无需执行重组操作，最终用户在下次登录时会自动收到更新后的虚拟桌面。
- en: They lessen the load on the vCenter server.
  id: totrans-251
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 它们减轻了vCenter服务器的负担。
- en: There is no requirement for SE Spare Disk or CBRC.
  id: totrans-252
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 不需要SE备用磁盘或CBRC。
- en: In the next section, we are going to look at how these newly built virtual desktop
    machines are customized and personalized.
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一部分，我们将探讨这些新建的虚拟桌面如何进行定制和个性化设置。
- en: View Persona Management
  id: totrans-254
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 视图个性化管理
- en: Let's start with a little bit about the background and history behind **View
    Persona Management**. View Persona Management was originally a technology product
    called **Virtual Profiles**, and was acquired by VMware from RTO Software in 2010.
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们先来了解一下**视图个性化管理**的背景和历史。视图个性化管理最初是一个名为**虚拟配置文件**的技术产品，于2010年由VMware从RTO Software公司收购。
- en: View Persona Management was then introduced with **View 5.0**, and it allows
    you to configure user profiles so that they dynamically synchronize with a remote
    profile repository that is located on a file server in the data center. Its purpose
    is to manage user profiles centrally within a virtualized desktop environment
    as part of the composite desktop model we discussed in [Chapter 1](6b70801c-f579-4fd6-8910-1cc57a06831e.xhtml),
    *Introducing VDI and VMware Horizon 7*.
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: 随后，**视图5.0**推出了视图个性化管理，它允许您配置用户配置文件，以便它们与位于数据中心文件服务器上的远程配置文件库动态同步。其目的是在虚拟化桌面环境中集中管理用户配置文件，作为我们在[第1章](6b70801c-f579-4fd6-8910-1cc57a06831e.xhtml)《引入VDI和VMware
    Horizon 7》中讨论的复合桌面模型的一部分。
- en: Why do we need to manage user profiles differently in VDI?
  id: totrans-257
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 为什么我们需要在VDI中以不同的方式管理用户配置文件？
- en: In a VDI solution, one of the key benefits is the way the virtual desktop is
    either built on demand or delivered from a pool of prebuilt, non-persistent desktops
    and then delivered back to the user. The typical deployment model is the non-persistent
    model, which basically means that the user doesn't own their own desktop or have
    personal files, data, or settings stored on it either. It's these settings that
    form their user profile.
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
  zh: 在 VDI 解决方案中，一个主要的好处是虚拟桌面按需构建或从预构建的非持久桌面池中交付给用户，之后再交回给用户。典型的部署模型是非持久模型，基本上意味着用户无法拥有自己的桌面，也没有个人文件、数据或设置存储在桌面上。这些设置形成了他们的用户个人资料。
- en: When they log in, they could have any desktop delivered to them from a pool
    of available virtual desktop machines. This means that the virtual desktop that
    is delivered would not be personalized to that user. It would just be a standard
    vanilla build of the operating system and applications.
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: 当用户登录时，他们可能会从可用的虚拟桌面池中接收任何桌面。这意味着交付的虚拟桌面将不会针对该用户进行个性化设置。它只是操作系统和应用程序的标准裸机版本。
- en: This is where View Persona Management comes into play and delivers the user's
    profile to that non-persistent virtual desktop machine they have been assigned
    to, effectively making it their own.
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
  zh: 这就是 View Persona Management 发挥作用的地方，它将用户的个人资料传递到他们被分配的非持久虚拟桌面机器，从而有效地使其成为用户自己的桌面。
- en: 'When we talk about the desktop being built on demand, we are again referring
    to the composite desktop model and how a desktop is put together from several
    different components. As a reminder, the desktop can be broken down into three
    components: the operating system, applications, and the user''s personalization
    or profile, essentially, the bit that makes the desktop yours. As a user logs
    in, all these pieces come together to deliver the end user desktop experience.
    With View Persona Management, we are talking about the user''s profile.'
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们谈论按需构建桌面时，我们再次提到复合桌面模型以及桌面如何由几个不同的组件组成。提醒一下，桌面可以分为三个组件：操作系统、应用程序以及用户的个性化设置或个人资料，本质上是构成桌面独属于你的部分。当用户登录时，这些部分会汇聚在一起，提供最终用户的桌面体验。通过
    View Persona Management，我们讨论的是用户的个人资料。
- en: In this section, we will introduce you to View Persona Management and its benefits
    for managing user profiles. A deeper dive into the technical details and configuring
    View Persona Management can be found in [Chapter 17](https://www.packtpub.com/sites/default/files/downloads/Managing_the_End_User_Environment_in_Horizon.pdf),
    *Managing the End User Environment in Horizon*.
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: 本节将向您介绍 View Persona Management 及其在管理用户个人资料方面的优势。有关 View Persona Management
    的技术细节和配置，您可以参考 [第17章](https://www.packtpub.com/sites/default/files/downloads/Managing_the_End_User_Environment_in_Horizon.pdf)，*在
    Horizon 中管理最终用户环境*。
- en: The benefits of View Persona Management
  id: totrans-263
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: View Persona Management 的优势
- en: 'At a high level, View Persona Management provides the following features:'
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
  zh: 从高层次来看，View Persona Management 提供以下功能：
- en: Fast loading of user personalization settings, with just-in-time retrieval of
    user profile data
  id: totrans-265
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 用户个性化设置的快速加载，实时检索用户个人资料数据
- en: Little or no infrastructure is required—just a file share or the use of an existing
    folder redirection structure
  id: totrans-266
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 几乎不需要基础设施——只需要文件共享或使用现有的文件夹重定向结构
- en: Profile consistency maintains personalization between sessions
  id: totrans-267
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 配置一致性保持了会话间的个性化设置
- en: Efficient architecture with no dependency on Windows roaming user profiles
  id: totrans-268
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 高效架构，无需依赖 Windows 漂移用户配置文件
- en: Multiplatform support for Windows XP, Windows Vista, Windows 7, Windows 8.x,
    and Windows 10
  id: totrans-269
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 支持多平台，兼容 Windows XP、Windows Vista、Windows 7、Windows 8.x 和 Windows 10
- en: In addition to the listed features, View Persona Management also helps reduce
    virtual desktop TCO by enabling the move to a stateless virtual desktop environment.
    In some deployments, users were placed in dedicated pools solely to retain their
    profile settings, which added to the cost and complexity in management. When it
    comes to cost, as persona management is an integrated part of Horizon View; you
    don't need to purchase additional third-party products, unless you need additional
    functionality above and beyond the basics.
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: 除了列出的功能外，View Persona Management 还通过实现无状态虚拟桌面环境，帮助减少虚拟桌面的总拥有成本（TCO）。在一些部署中，用户被分配到专用池中，仅用于保留其个人资料设置，这增加了管理的成本和复杂性。在成本方面，由于个人资料管理是
    Horizon View 的一部分，除非需要额外的功能，否则无需购买额外的第三方产品。
- en: On the subject of management, there are no additional components to set up or
    install, since everything is driven by the Active Directory Group Policy. In terms
    of scalability, again, as there are no infrastructure overheads such as databases,
    so scalability is not an issue, as it scales with your active directory.
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
  zh: 关于管理方面，没有额外的组件需要设置或安装，因为一切都由Active Directory组策略驱动。在可扩展性方面，鉴于没有诸如数据库之类的基础设施开销，因此可扩展性不是问题，它会随着您的活动目录一起扩展。
- en: VMware UEM
  id: totrans-272
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: VMware UEM
- en: The **VMware UEM** product is one of the newest editions to the Horizon portfolio
    and was added when VMware acquired the Dutch company Immidio back in February
    2015\. Immidio was a software company that created products that were aimed at
    helping their consultants out in the field, with the core product being called
    **Flex+**.
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: '**VMware UEM**产品是Horizon产品组合中最新的版本之一，VMware在2015年2月收购荷兰公司Immidio时将其加入了该产品线。Immidio是一家软件公司，开发的产品旨在帮助他们的顾问进行现场工作，核心产品叫做**Flex+**。'
- en: UEM adds additional functionality over and above the standard persona management
    solution, providing a central management console, to deliver personalization of
    the end user's virtual desktop machine as well as the ability to dynamically configure
    policies. It works across several different environments, such as virtual desktop
    machines, physical PCs, as well as cloud-based Windows desktop environments or
    DaaS. It's all about managing Windows profiles regardless of where or how the
    operating system runs.
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
  zh: UEM在标准用户配置管理解决方案之上增加了额外的功能，提供一个集中管理控制台，以便提供最终用户虚拟桌面计算机的个性化设置，并能够动态配置策略。它适用于多个不同环境，例如虚拟桌面计算机、物理PC以及基于云的Windows桌面环境或DaaS。它的核心是管理Windows配置文件，无论操作系统在何种环境或方式下运行。
- en: To manage a virtual desktop machine with UEM, you will need to install the FlexEngine
    components onto the virtual desktop machine. Make sure you include this as part
    of your master image or parent virtual desktop machine.
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
  zh: 要使用UEM管理虚拟桌面计算机，您需要将FlexEngine组件安装到虚拟桌面计算机上。确保将其包含在您的母版映像或父虚拟桌面计算机中。
- en: 'There are five key use cases that UEM can be used with:'
  id: totrans-276
  prefs: []
  type: TYPE_NORMAL
  zh: UEM有五个主要的应用场景：
- en: '**Application Configuration Management**: Allows you to configure an application''s
    initial settings rather than deploying the application''s own default settings.
    You can configure predefined settings as one-time defaults, fully enforced (application
    starts with the user''s personalized settings every time), or partially enforced
    (application starts as configured, but allows the user to perform limited personalization),
    using the VMware UEM Application Profiler to capture predefined settings for an
    application.'
  id: totrans-277
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**应用程序配置管理**：允许您配置应用程序的初始设置，而不是部署应用程序的默认设置。您可以使用VMware UEM应用程序配置文件捕获应用程序的预定义设置，将其配置为一次性默认值、完全强制执行（每次应用程序启动时都使用用户的个性化设置）或部分强制执行（应用程序启动时按配置进行，但允许用户进行有限的个性化设置）。'
- en: '**User Environment Settings**: Allows you to centrally manage user environment
    settings such as the following:'
  id: totrans-278
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**用户环境设置**：允许您集中管理用户环境设置，如下所示：'
- en: Application blocking
  id: totrans-279
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 应用程序阻止
- en: Application shortcuts and file type associations
  id: totrans-280
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 应用程序快捷方式和文件类型关联
- en: Drive and printer mappings
  id: totrans-281
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 驱动器和打印机映射
- en: Environment variables
  id: totrans-282
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 环境变量
- en: Files, folders, and registry settings
  id: totrans-283
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 文件、文件夹和注册表设置
- en: Folder redirection
  id: totrans-284
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 文件夹重定向
- en: '**Personalization**: Abstracts user-specific desktop and application settings
    from the underlying OS and then makes these settings available across multiple
    devices, Windows versions, and applications. It also supports operating system
    migration such as Windows 7 or Windows 10.'
  id: totrans-285
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**个性化**：将特定于用户的桌面和应用程序设置从底层操作系统中抽象出来，并使这些设置可以跨多个设备、Windows版本和应用程序使用。它还支持操作系统迁移，例如从Windows
    7或Windows 10。'
- en: '**Application Migration**: Allows an end user to effectively have roaming application
    and personalization settings so that they can move between different operating
    system versions, such as from Windows 7 to Windows 10.'
  id: totrans-286
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**应用程序迁移**：允许最终用户有效地拥有漫游应用程序和个性化设置，从而使他们能够在不同操作系统版本之间移动，例如从Windows 7迁移到Windows
    10。'
- en: '**Dynamic Configuration**: Using condition sets allows you to combine conditions
    based on variables such as user, location, and device, to deliver dynamic delivery
    of content and appearance, for example, delivering access to a network printer
    based on an end user''s location, or to create drive mapping that is based on
    the user''s identity.'
  id: totrans-287
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**动态配置**：使用条件集可以让您根据用户、位置和设备等变量组合条件，以动态地提供内容和外观的交付，例如，根据最终用户的位置提供访问网络打印机，或创建基于用户身份的驱动器映射。'
- en: SmartPolicies is a feature of Horizon and uses UEM to deliver a set of policies
    that are specific to virtual desktop machines.
  id: totrans-288
  prefs: []
  type: TYPE_NORMAL
  zh: SmartPolicies 是 Horizon 的一个功能，利用 UEM 提供特定于虚拟桌面机的政策集。
- en: To use SmartPolicies, it is recommended that you run View Connection Server
    Version 7.2 or later and is required for using Smart Policies with RDSH-published
    applications. You also require UEM 9.0 or later, but UEM 9.2 or later is recommended.
  id: totrans-289
  prefs: []
  type: TYPE_NORMAL
  zh: 要使用 SmartPolicies，建议您运行 View Connection Server 版本 7.2 或更高版本，且在使用 RDSH 发布的应用程序时必须使用
    Smart Policies。您还需要 UEM 9.0 或更高版本，但推荐使用 UEM 9.2 或更高版本。
- en: 'With Smart Policies, administrators have a more granular level of control over
    an end user''s virtual desktop machine. Horizon 7 features can be dynamically
    enabled, disabled, or controlled based on the end user as well as other variables,
    such as the client device type, IP address, and desktop pool name. With SmartPolicies,
    you can configure the following:'
  id: totrans-290
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 Smart Policies，管理员可以对最终用户的虚拟桌面机进行更精细的控制。Horizon 7 功能可以根据最终用户以及其他变量，如客户端设备类型、IP
    地址和桌面池名称，动态启用、禁用或控制。通过 SmartPolicies，您可以配置以下内容：
- en: USB redirection
  id: totrans-291
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: USB 重定向
- en: Printing
  id: totrans-292
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 打印
- en: Clipboard behavior
  id: totrans-293
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 剪贴板行为
- en: Client drive redirection
  id: totrans-294
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 客户端驱动器重定向
- en: HTML access file transfer
  id: totrans-295
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: HTML 访问文件传输
- en: Bandwidth profile
  id: totrans-296
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 带宽配置文件
- en: If you are using UEM 9.1 or later, along with the Horizon Agent 7.0.1 or later,
    this setting applies when users are using either the Blast Extreme display protocol
    or the PCoIP display protocol.
  id: totrans-297
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您使用的是 UEM 9.1 或更高版本，并且使用的是 Horizon Agent 7.0.1 或更高版本，当用户使用 Blast Extreme 显示协议或
    PCoIP 显示协议时，此设置将生效。
- en: UEM or Persona Management?
  id: totrans-298
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 UEM 还是 Persona Management？
- en: The question is which solution should you use? UEM is available as part of Horizon
    Enterprise Edition or as a standalone product, so that means higher or additional
    costs, unless, of course, you planned on purchasing Enterprise Edition in the
    first place.
  id: totrans-299
  prefs: []
  type: TYPE_NORMAL
  zh: 问题是，您应该使用哪种解决方案？UEM 作为 Horizon 企业版的一部分或独立产品提供，这意味着会产生更高的费用或额外费用，除非您本来就计划购买企业版。
- en: UEM delivers a far greater set of configuration variables and features, as well
    as having a central management console that makes it far easier to manage and
    deploy. However, you may already have a more comprehensive UEM solution in place.
    If you are using a lesser edition of Horizon, then Persona Management may well
    deliver your requirements, and, if not, then maybe it's worth considering a third-party
    product, such as Liquidware ProfileUnity.
  id: totrans-300
  prefs: []
  type: TYPE_NORMAL
  zh: UEM 提供了更广泛的配置变量和功能，并且具有一个中央管理控制台，使得管理和部署更加容易。然而，您可能已经有了更全面的 UEM 解决方案。如果您使用的是
    Horizon 的较低版本，那么 Persona Management 可能已经能够满足您的需求，如果不能，或许可以考虑使用第三方产品，如 Liquidware
    ProfileUnity。
- en: Printing from a virtual desktop machine
  id: totrans-301
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 从虚拟桌面机进行打印
- en: A question that often comes up when deploying a VDI solution is "*How do you
    manage printing*?" As your virtual desktop is now effectively running on a server
    in the data center, does that mean that when you hit the print button, your print
    job comes out there? What about printer drivers? Typically, your desktop has the
    driver installed for the printer that is nearest to you, or it might be a locally-attached
    printer. Does that mean you need to install every possible printer driver on to
    your virtual desktop machines? Luckily, the answer to these questions is no, and,
    in this section, we will briefly cover how VMware Horizon View manages printing.
  id: totrans-302
  prefs: []
  type: TYPE_NORMAL
  zh: 在部署 VDI 解决方案时，常见的一个问题是“*如何管理打印？*”由于您的虚拟桌面实际上是在数据中心的服务器上运行，是否意味着当您按下打印按钮时，打印任务会在那里输出？打印机驱动程序怎么办？通常，您的桌面上已安装与您最近的打印机对应的驱动程序，或者它可能是一个本地连接的打印机。这是否意味着您需要在虚拟桌面机上安装所有可能的打印机驱动程序？幸运的是，这些问题的答案是否定的，在本节中，我们将简要介绍
    VMware Horizon View 如何管理打印。
- en: Bundled within Horizon View is an OEM virtual printing solution, **ThinPrint**,
    for which a company called Cortado is the OEM. ThinPrint allows your end users
    to print either to a network-based printer or to a local printer that is attached
    from the user's endpoint device to their virtual desktop machine via USB redirection.
    We will cover USB device management in the next section.
  id: totrans-303
  prefs: []
  type: TYPE_NORMAL
  zh: Horizon View 包含了一款 OEM 虚拟打印解决方案，**ThinPrint**，其 OEM 为名为 Cortado 的公司。ThinPrint
    允许你的终端用户将打印作业发送到网络打印机或通过 USB 重定向将连接在用户终端设备上的本地打印机发送到虚拟桌面机器。我们将在下一节中介绍 USB 设备管理。
- en: To answer the question about the printer drivers that must be installed, ThinPrint
    uses a single, virtual print driver that replaces all other print drivers. You
    can still install a specific print driver, if necessary, for use cases where your
    printer has some additional features or functionalities. However, the virtual
    print driver provides support for most multifunctional printers, supporting features
    such as double-sided printing.
  id: totrans-304
  prefs: []
  type: TYPE_NORMAL
  zh: 为了回答有关必须安装打印机驱动程序的问题，ThinPrint 使用一个单一的虚拟打印驱动程序，替代所有其他打印驱动程序。若有需要，你仍然可以安装特定的打印驱动程序，用于打印机具有额外功能或特性的情况。然而，虚拟打印驱动程序支持大多数多功能打印机，支持如双面打印等功能。
- en: The other question is regarding location and where your print job prints are
    also addressed with ThinPrint, which provides a location-based printing feature
    that allows you to map to a printer that is nearest to your endpoint device. There
    are, of course, third-party solutions available such as UniPrint.
  id: totrans-305
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个问题是关于打印作业的打印位置，ThinPrint 也解决了这个问题，它提供了基于位置的打印功能，允许你映射到离你的终端设备最近的打印机。当然，也有第三方解决方案可用，比如
    UniPrint。
- en: Managing USB devices
  id: totrans-306
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 管理 USB 设备
- en: There isn't a list that details every single device that works within Horizon
    View, as that would be one very long list, and it would be impractical to test
    everything out there, given the number of USB devices on the market.
  id: totrans-307
  prefs: []
  type: TYPE_NORMAL
  zh: 没有一份列出所有在 Horizon View 中可用的设备的清单，因为那将是一个非常长的清单，且鉴于市场上 USB 设备的数量，测试所有设备是不现实的。
- en: Most USB devices should work in a Horizon View environment, as all it essentially
    does is redirect the USB traffic from the View client running on the endpoint
    device to the View agent running on the virtual desktop machine. A complete list
    of validated devices does not exist, as it would be a very long list and impossible
    to test every device on the market. If there are any questions about the functionality
    of a device, you should contact the USB device's manufacturer.
  id: totrans-308
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数 USB 设备应该可以在 Horizon View 环境中正常工作，因为它所做的就是将从终端设备上运行的 View 客户端的 USB 流量重定向到虚拟桌面机器上运行的
    View 代理程序。没有完整的经过验证的设备列表，因为这将是一个非常长的列表，且无法测试市场上所有的设备。如果有关于设备功能的问题，你应该联系该 USB 设备的制造商。
- en: There might be some devices that will not work, purely due to the nature and
    the behavior of the device itself; for example, some security devices that check
    the physical properties of the machine or device they are plugged into. We used
    to classify USB webcams as unsupported devices. However, with the introduction
    of **Real Time Audio Video** (**RTAV**), these devices are now supported. In the
    next section, we will talk about how you can select which USB devices get redirected
    by using USB filtering.
  id: totrans-309
  prefs: []
  type: TYPE_NORMAL
  zh: 可能有些设备因其自身的特性和行为无法工作；例如，一些安全设备检查它们所连接的机器或设备的物理属性。我们曾将 USB 网络摄像头归类为不受支持的设备。然而，随着
    **实时音视频**（**RTAV**）的推出，这些设备现在已得到支持。在下一节中，我们将讨论如何通过使用 USB 过滤功能来选择哪些 USB 设备被重定向。
- en: Filtering supported USB devices
  id: totrans-310
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 过滤支持的 USB 设备
- en: In some circumstances, you might not want to allow users to have the ability
    to plug in external USB devices and redirect them to their virtual desktop machine.
    The question is whether you allow users to plug USB devices into their physical
    desktops?
  id: totrans-311
  prefs: []
  type: TYPE_NORMAL
  zh: 在某些情况下，你可能不希望允许用户有能力插入外部 USB 设备并将其重定向到虚拟桌面机器。问题是，你是否允许用户将 USB 设备插入到他们的物理桌面？
- en: Horizon View has a feature that can prevent USB devices from being redirected
    to the user's VDI desktop. You can apply this using a policy on the endpoint device,
    the virtual desktop, or by means of an Active Directory Group Policy. For example,
    your organization might want to prevent USB memory sticks from being used, as
    this would give the user the ability to copy data from the virtual desktop machine
    (one of the reasons for the deployment of VDI is so that data is centralized and
    doesn't leave the data center).
  id: totrans-312
  prefs: []
  type: TYPE_NORMAL
  zh: Horizon View 具有一种功能，可以防止 USB 设备被重定向到用户的 VDI 桌面。您可以通过在终端设备、虚拟桌面或使用 Active Directory
    组策略来应用此功能。例如，您的组织可能希望禁止使用 USB 闪存盘，因为这将使用户能够从虚拟桌面计算机中复制数据（部署 VDI 的原因之一是将数据集中存储，避免数据离开数据中心）。
- en: You can create specific filters to include devices (by the manufacturer or by
    device type) that you want to allow, but block all others. So, if you have a corporate,
    standard-type device, it will be allowed. You could even go to the next level
    and choose a specific model of a device while blocking any other devices, even
    though they are from the same vendor.
  id: totrans-313
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以创建特定的过滤器，选择允许特定设备（按制造商或设备类型），并阻止所有其他设备。因此，如果您有公司标准类型的设备，它将被允许。您甚至可以进一步选择特定型号的设备，同时阻止任何其他设备，即使它们来自同一供应商。
- en: Managing multi-function USB devices
  id: totrans-314
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 管理多功能 USB 设备
- en: In your environment, you might have USB devices that have several different
    functions, while still using a single USB connection. For example, a multimedia
    keyboard could have a touchpad mouse, speakers, a fingerprint reader, and the
    keyboard itself.
  id: totrans-315
  prefs: []
  type: TYPE_NORMAL
  zh: 在您的环境中，您可能会有具有多种不同功能的 USB 设备，同时仍使用单一的 USB 连接。例如，一款多媒体键盘可能配备触控板鼠标、扬声器、指纹识别器以及键盘本身。
- en: Horizon View supports a function known as **device splitting**. This allows
    you to just redirect certain components of that device rather than the entire
    device. With our multimedia example, you might want to leave the mouse as a local
    device on the endpoint, while redirecting the fingerprint reader to allow secure
    login to the virtual desktop.
  id: totrans-316
  prefs: []
  type: TYPE_NORMAL
  zh: Horizon View 支持一种被称为 **设备拆分** 的功能。这使得您可以仅重定向设备的某些组件，而不是整个设备。以我们的多媒体示例为例，您可能希望将鼠标保留为终端设备上的本地设备，同时将指纹识别器重定向，以便允许用户安全登录虚拟桌面。
- en: ThinApp application virtualization
  id: totrans-317
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ThinApp 应用虚拟化
- en: ThinApp is an agentless application virtualization or application packaging
    solution that decouples applications from their underlying operating systems.
    It's designed to eliminate application conflict, streamline application delivery,
    and improve management. ThinApp licenses are included with the Horizon View license
    and can be used on both physical and virtual desktops, therefore providing a mechanism
    to deliver applications across your entire desktop estate.
  id: totrans-318
  prefs: []
  type: TYPE_NORMAL
  zh: ThinApp 是一种无代理的应用虚拟化或应用打包解决方案，它将应用程序与底层操作系统解耦。它旨在消除应用程序冲突、简化应用程序交付并提高管理效率。ThinApp
    许可证包含在 Horizon View 许可证中，可以在物理和虚拟桌面上使用，从而提供一种在整个桌面环境中交付应用程序的机制。
- en: How does application virtualization work?
  id: totrans-319
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 应用虚拟化是如何工作的？
- en: 'ThinApp encapsulates applications into a package consisting of a single `.exe`
    or `.msi` file and abstracts them from the following:'
  id: totrans-320
  prefs: []
  type: TYPE_NORMAL
  zh: ThinApp 将应用程序封装成一个包含单个 `.exe` 或 `.msi` 文件的包，并将它们与以下内容解耦：
- en: The host operating system
  id: totrans-321
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 主机操作系统
- en: Any traditionally installed applications already running on the system
  id: totrans-322
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 系统上已安装的任何传统应用程序
- en: All other virtual applications running on the system
  id: totrans-323
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 系统上运行的所有其他虚拟应用程序
- en: Applications then run in their own isolated virtual environment, with minimal
    or zero impact on the underlying operating system, virtual filesystem, or virtual
    registry.
  id: totrans-324
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，应用程序将在其隔离的虚拟环境中运行，对底层操作系统、虚拟文件系统或虚拟注册表的影响最小或为零。
- en: When you create a ThinApp package, you are basically capturing all the application
    files, registry settings, and filesystem changes that an application requires
    for it to run. It also captures its own agent as part of the process, so the endpoint
    device requires nothing to be installed.
  id: totrans-325
  prefs: []
  type: TYPE_NORMAL
  zh: 当您创建 ThinApp 包时，实际上是在捕获应用程序运行所需的所有文件、注册表设置和文件系统更改。它还会在过程中捕获其自身的代理，因此终端设备无需安装任何东西。
- en: Once packaged, the application can be deployed (either streamed or installed)
    on to the virtual desktop machine or even a physical desktop. The only requirement
    ThinApp packages have to run is an underlining Windows operating system, either
    physical or virtual. When running, it's important to note that the package makes
    no changes to the OS of the machine it's running on.
  id: totrans-326
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦打包，应用程序可以被部署（无论是流式传输还是安装）到虚拟桌面机或甚至物理桌面。ThinApp 包运行的唯一要求是底层的 Windows 操作系统，无论是物理的还是虚拟的。运行时，重要的是要注意，该包不会对其运行的机器的操作系统进行任何更改。
- en: 'There are no requirements for additional backend infrastructure components,
    as all your ThinApp-packaged applications are stored in a file share on a file
    server. This means that you can centrally manage and easily update your packages
    so that all users will receive the updates the next time they launch the application.
    The following diagram shows a high-level ThinApp architecture:'
  id: totrans-327
  prefs: []
  type: TYPE_NORMAL
  zh: 不需要额外的后端基础设施组件，因为所有 ThinApp 打包的应用程序都存储在文件服务器上的文件共享中。这意味着您可以集中管理并轻松更新您的包，以便所有用户在下次启动应用程序时都会收到更新。下图显示了一个高层次的
    ThinApp 架构：
- en: '![](img/17c8dabd-c3b7-495c-a2e7-6552faee09d2.png)'
  id: totrans-328
  prefs: []
  type: TYPE_IMG
  zh: '![](img/17c8dabd-c3b7-495c-a2e7-6552faee09d2.png)'
- en: 'To summarize, ThinApp delivers the following:'
  id: totrans-329
  prefs: []
  type: TYPE_NORMAL
  zh: 总结来说，ThinApp 提供以下功能：
- en: Allows Windows applications to be packaged, distributed, and executed as single
    `.exe` or `.msi` files on either physical or virtual desktop machines
  id: totrans-330
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 允许将 Windows 应用程序打包、分发并作为单一的 `.exe` 或 `.msi` 文件在物理或虚拟桌面机器上执行
- en: Builds process links, a `Virtual OS` (`VOS`) with a compressed embedded filesystem,
    and registry, in a single file
  id: totrans-331
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 构建过程链接，一个 `Virtual OS`（`VOS`）与压缩嵌入文件系统和注册表，打包为一个文件
- en: Requires no pre-installed software on the end user machine.
  id: totrans-332
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 不需要在终端用户机器上预先安装任何软件。
- en: Provides a zero footprint on the underlying OS
  id: totrans-333
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在底层操作系统上提供零占用
- en: Necessitates no traditional installation or changes to the local OS registry
    or filesystem
  id: totrans-334
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 不需要传统的安装程序或更改本地操作系统的注册表或文件系统
- en: Requires no backend server infrastructure, other than a file share to store
    your ThinApp packages
  id: totrans-335
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 除了用于存储 ThinApp 包的文件共享外，不需要任何后端服务器基础设施
- en: To learn more about ThinApp and how to use it in your environment, read *VMware
    ThinApp 4.7 Essentials*, by Peter Bjork, Packt Publishing.
  id: totrans-336
  prefs: []
  type: TYPE_NORMAL
  zh: 要了解更多关于 ThinApp 的信息以及如何在您的环境中使用它，请阅读 *VMware ThinApp 4.7 Essentials*，作者 Peter
    Bjork，Packt Publishing。
- en: Antivirus software for virtual desktops
  id: totrans-337
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 虚拟桌面的防病毒软件
- en: In a traditional desktop model, an antivirus agent is installed, runs on every
    desktop, and is responsible for the performance of antivirus detection scans,
    while maintaining and updating the definition files containing information about
    the latest malware.
  id: totrans-338
  prefs: []
  type: TYPE_NORMAL
  zh: 在传统的桌面模型中，安装了防病毒代理，防病毒代理在每个桌面上运行，负责执行防病毒检测扫描，同时维护和更新包含最新恶意软件信息的定义文件。
- en: This model works well in the physical desktop world, but presents some challenges
    when running in a virtual desktop environment. When a detection scan starts, every
    virtual desktop's resource usage will increase significantly. This will result
    in end user performance degradation, and the desktop host server will become resource-bound.
    That's fine on a physical desktop, but now, in VDI, it's the servers hosting the
    desktops that are going to become resource-bound. When recomposing desktops or
    building them on demand, the desktops will have to download the definitions file
    each time, taking up network bandwidth and storage capacity. One last thing you
    need to take into consideration is the memory footprint of the typical desktop
    AV software that gets installed on each virtual desktop. You will need to allocate
    more memory to run the agents and scanning process.
  id: totrans-339
  prefs: []
  type: TYPE_NORMAL
  zh: 这种模型在物理桌面环境中运行良好，但在虚拟桌面环境中运行时会遇到一些挑战。当启动检测扫描时，每个虚拟桌面的资源使用量会显著增加。这将导致终端用户的性能下降，桌面主机服务器将变得资源紧张。在物理桌面上没问题，但在
    VDI 中，承载桌面的服务器将变得资源紧张。在重新组合桌面或按需构建时，桌面每次都必须下载定义文件，占用网络带宽和存储容量。最后需要考虑的一点是，典型桌面
    AV 软件在每个虚拟桌面上安装后会占用多少内存。您需要分配更多内存来运行代理和扫描过程。
- en: Let's say you have a vSphere host server running maybe 100 virtual desktops
    or so; what if, at 12:00 on Thursday, they all kick off a virus scan? That host
    is likely to become 100% utilized very quickly, both for CPU and storage I/Os,
    with the result being unresponsive desktops. Instead of affecting one user's desktop,
    you have now affected 100 users, desktops. You could schedule the scans so that
    they don't all happen at once, but, ideally, you need to look at alternative methods
    that are designed to work more specifically with a virtual desktop infrastructure.
  id: totrans-340
  prefs: []
  type: TYPE_NORMAL
  zh: 假设你有一台 vSphere 主机服务器，运行着大约 100 个虚拟桌面；那么，如果在周四中午 12:00，它们同时启动病毒扫描会怎样？该主机很可能会迅速达到
    100% 的使用率，CPU 和存储 I/O 都会达到瓶颈，结果就是桌面无法响应。这样一来，你不仅影响到一个用户的桌面，而是影响了 100 个用户的桌面。你可以安排扫描任务，以避免它们同时进行，但理想情况下，你需要寻找专门为虚拟桌面基础架构设计的替代方法。
- en: Secondly, if we are recomposing desktops or building them on demand, we must
    download the definitions file every time, which not only takes up network bandwidth,
    but also unnecessary storage capacity.
  id: totrans-341
  prefs: []
  type: TYPE_NORMAL
  zh: 其次，如果我们要重新生成桌面或按需构建桌面，我们必须每次都下载定义文件，这不仅占用了网络带宽，还浪费了不必要的存储容量。
- en: So, what is required is a new approach to antivirus protection, specifically
    designed for virtual desktop infrastructure. With VMware vSphere 5.5, VMware introduced
    a product called **vShield Endpoint**, which has now been superceded by VMware
    NSX that addresses the problems inherent in antivirus scanning in large-scale
    virtual desktop implementations. It does this by offloading all antivirus operations
    into one centralized appliance. The scanning is then done at the hypervisor level
    and not on each of the virtual desktop machines.
  id: totrans-342
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，所需的是一种新的防病毒保护方法，专为虚拟桌面基础架构设计。随着 VMware vSphere 5.5 的发布，VMware 推出了一个名为 **vShield
    Endpoint** 的产品，后来被 VMware NSX 取代，它解决了大规模虚拟桌面实施中防病毒扫描的固有问题。通过将所有防病毒操作卸载到一个集中设备上，扫描过程在虚拟化管理程序层面完成，而不是在每个虚拟桌面机器上执行。
- en: 'Although VMware provide the engine to help deliver the scanning process, they
    have also worked alongside and partnered with some of the leading antivirus software
    vendors to deliver the knowledge around how to identify and protect against viruses,
    malware, and other threats. They work with partners including the following:'
  id: totrans-343
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管 VMware 提供了帮助实现扫描过程的引擎，但它们也与一些领先的防病毒软件供应商合作，传递有关如何识别和防护病毒、恶意软件及其他威胁的知识。他们与以下合作伙伴共同工作：
- en: Bitdefender
  id: totrans-344
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Bitdefender
- en: Kaspersky
  id: totrans-345
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Kaspersky
- en: McAfee
  id: totrans-346
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: McAfee
- en: Sourcefire
  id: totrans-347
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Sourcefire
- en: Symantec
  id: totrans-348
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Symantec
- en: Trend Micro
  id: totrans-349
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Trend Micro
- en: Protocols – Delivering the virtual desktop experience
  id: totrans-350
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 协议 – 提供虚拟桌面体验
- en: 'One of the most important elements of a virtual desktop solution is how you
    get the screen contents of the virtual desktop machine, which is running in the
    data center, delivered to the end user''s device they are connecting from, and
    how they interact using the keyboard and mouse. To do this, VMware Horizon View
    has the option to use several displays or delivery protocols: PCoIP, Blast Extreme,
    or RDP. In this section, we are going to cover each protocol, how it works in
    delivering the end user experience, and some more advanced technical details.'
  id: totrans-351
  prefs: []
  type: TYPE_NORMAL
  zh: 虚拟桌面解决方案的一个最重要的元素是如何将运行在数据中心的虚拟桌面机的屏幕内容传输到终端用户的设备，并使用户能够通过键盘和鼠标进行互动。为此，VMware
    Horizon View 提供了使用多种显示或传输协议的选项：PCoIP、Blast Extreme 或 RDP。在本节中，我们将介绍每种协议，如何在提供终端用户体验时发挥作用，以及一些更高级的技术细节。
- en: PCoIP
  id: totrans-352
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: PCoIP
- en: '**PCoIP** is a high-performance display protocol designed and developed by
    Teradici ([http://www.teradici.com/](http://www.teradici.com/)). It has been purpose
    built to deliver virtual desktops over the LAN or WAN and to provide end users
    with the best feature-rich desktop experience.'
  id: totrans-353
  prefs: []
  type: TYPE_NORMAL
  zh: '**PCoIP** 是由 Teradici ([http://www.teradici.com/](http://www.teradici.com/))
    设计和开发的高性能显示协议。它特别针对通过局域网或广域网提供虚拟桌面，并为终端用户提供功能丰富的桌面体验。'
- en: With PCoIP, the entire screen content is compressed, encrypted, and encoded
    in the data center before transmitting only the pixels across a standard IP network
    to PCoIP-enabled endpoint devices (such as zero clients) that use the hardware-based
    Teradici Terra 1 or Terra 2 chipset, or to Windows, macOS, or tablet devices running
    the software-based Horizon Client. The key thing to remember is that no data ever
    leaves the data center.
  id: totrans-354
  prefs: []
  type: TYPE_NORMAL
  zh: 使用PCoIP技术，整个屏幕内容会在数据中心进行压缩、加密和编码，然后仅将像素通过标准IP网络传输到支持PCoIP的终端设备（如零客户端），这些设备使用基于硬件的Teradici
    Terra 1或Terra 2芯片组，或者运行基于软件的Horizon Client的Windows、macOS或平板设备。需要记住的关键点是，数据永远不会离开数据中心。
- en: PCoIP supports high-resolution, full-frame rates, 3D graphics, HD media, multiple
    displays (up to four, depending on the endpoint device), and high-definition audio.
    PCoIP also supports USB peripheral redirection.
  id: totrans-355
  prefs: []
  type: TYPE_NORMAL
  zh: PCoIP支持高分辨率、全帧率、3D图形、高清媒体、多显示器（最多四个，具体取决于终端设备）和高清音频。PCoIP还支持USB外设重定向。
- en: Unlike some legacy display protocols that were built just to deliver applications,
    PCoIP was designed and built from the ground up, specifically to deliver a full
    desktop experience, taking advantage of Teradici-based zero clients with an integrated
    graphics acceleration technology built into the silicon on these devices, or software-based
    clients. PCoIP ensures the best user experience, regardless of the end user location,
    whether that is on the LAN or even across a WAN. It adapts, dynamically adapts
    based on network conditions and user policy.
  id: totrans-356
  prefs: []
  type: TYPE_NORMAL
  zh: 与一些仅用于交付应用程序的传统显示协议不同，PCoIP是从零开始设计并构建的，专门用于提供完整的桌面体验，利用集成了图形加速技术的基于Teradici的零客户端，这些技术被集成在设备的芯片中，或者基于软件的客户端。无论最终用户身处何地（无论是在局域网中还是跨越广域网），PCoIP都能确保最佳的用户体验。它能够根据网络状况和用户策略动态适应。
- en: PCoIP host rendering
  id: totrans-357
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: PCoIP主机渲染
- en: So, let's start by looking at how the different rendering models work. With
    a desktop PC, the applications, operating system, and graphics drivers work together
    locally to deliver the best performance on that PC. This is local client rendering.
  id: totrans-358
  prefs: []
  type: TYPE_NORMAL
  zh: 那么，让我们首先来看看不同渲染模型的工作原理。对于桌面PC，应用程序、操作系统和图形驱动程序在本地协同工作，以提供最佳的PC性能。这就是本地客户端渲染。
- en: If we move to a client rendering model, we now introduce a network between the
    components. Images are now sent across the network to the endpoint device, where
    they are processed locally using the resources of that endpoint device. Using
    this model introduces degradation of the application performance as it travels
    across the network from the host server to the client, and you would still need
    a powerful Windows-based endpoint device.
  id: totrans-359
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们转向客户端渲染模型，那么就引入了一个网络连接各个组件。图像现在会通过网络发送到终端设备，在终端设备上使用其本地资源进行处理。使用这种模型会导致应用程序性能下降，因为它在从主机服务器到客户端的过程中需要通过网络传输，同时你仍然需要一个强大的基于Windows的终端设备。
- en: So, what about host rendering? In a host rendering scenario, the desktop PC
    environment that we previously described is pretty much the same. However, the
    PC is now running as a virtual desktop machine. This means that applications will
    work as they normally would on a physical desktop PC and the rendering is done
    at the host end. PCoIP then works by encrypting just the pixels on the virtual
    desktop machine running the View agent, and then sends them to the endpoint device
    running the View client, or to a zero client device running Teradici hardware,
    where the decoding takes place.
  id: totrans-360
  prefs: []
  type: TYPE_NORMAL
  zh: 那么，主机渲染如何呢？在主机渲染场景中，我们之前描述的桌面PC环境几乎不变。然而，PC现在作为虚拟桌面机器运行。这意味着应用程序会像在物理桌面PC上一样正常工作，渲染过程在主机端完成。PCoIP通过仅加密虚拟桌面机上运行的View代理的像素，然后将它们发送到运行View客户端的终端设备，或发送到运行Teradici硬件的零客户端设备，解码过程将在那里进行。
- en: Using this model, you can easily deploy lower powered, non-Windows devices such
    as zero clients, as the applications have no dependencies on the endpoint on which
    they run.
  id: totrans-361
  prefs: []
  type: TYPE_NORMAL
  zh: 使用这种模型，您可以轻松部署低功耗、非Windows设备，如零客户端，因为应用程序与其运行的终端设备没有依赖关系。
- en: Multi-codec support with PCoIP
  id: totrans-362
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: PCoIP的多编解码器支持
- en: If you look at how an image is built up and how the content is rendered, some
    of the components of the image might require the use of different codecs to display
    the image, depending on what type of image it is. For example, you would use a
    different codec to display text from one that you would use to display videos.
  id: totrans-363
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你查看图像的构建过程以及内容的呈现方式，图像的一些组件可能需要使用不同的编解码器来显示图像，这取决于图像的类型。例如，显示文本时会使用不同的编解码器，而显示视频时则会使用另一个编解码器。
- en: PCoIP can analyze these different media image components and apply the appropriate
    codec for each pixel before compressing, encrypting, and sending the pixels to
    the endpoint device for decoding. Working in this way allows PCoIP to transmit
    the pixels more efficiently, which ultimately means less bandwidth and better
    performance. It also means that you can control the image content quality that
    is being delivered. We will talk about it in the next section.
  id: totrans-364
  prefs: []
  type: TYPE_NORMAL
  zh: PCoIP 可以分析这些不同的媒体图像组件，并在压缩、加密并将像素发送到终端设备进行解码之前，为每个像素应用适当的编解码器。通过这种方式，PCoIP 能够更高效地传输像素，这最终意味着更少的带宽需求和更好的性能。这也意味着你可以控制传输的图像内容质量。我们将在下一部分讨论这一点。
- en: Controlling the image quality
  id: totrans-365
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 控制图像质量
- en: The quality of the image that PCoIP delivers can be controlled through the AD
    Group Policy or SmartPolicies to deliver the appropriate image quality, depending
    on the use case. The image is built progressively from what is termed a **perceptually
    lossless image** to a **lossless image**, with the latter delivering a high-fidelity,
    pixel-perfect image. For example, would you really need to build a pixel-perfect
    image if you were just running Microsoft Word?
  id: totrans-366
  prefs: []
  type: TYPE_NORMAL
  zh: PCoIP 提供的图像质量可以通过 AD 组策略或智能策略进行控制，以根据使用场景提供适当的图像质量。图像是从所谓的**感知无损图像**逐步构建到**无损图像**，后者提供高保真度、像素完美的图像。例如，如果你仅仅是在运行
    Microsoft Word，是否真的需要构建像素完美的图像呢？
- en: The important thing to remember is that the quality of the image will have an
    impact on the bandwidth required to deliver it. We will cover these controls in
    more detail in [Chapter 10](8ebc54c4-3812-46fe-9534-fe38b78804a9.xhtml), *Fine-Tuning
    the End User Experience*.
  id: totrans-367
  prefs: []
  type: TYPE_NORMAL
  zh: 需要记住的重要一点是，图像质量将会影响传输所需的带宽。我们将在[第 10 章](8ebc54c4-3812-46fe-9534-fe38b78804a9.xhtml)《微调终端用户体验》中更详细地讨论这些控制方法。
- en: Dynamic networking capabilities
  id: totrans-368
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 动态网络功能
- en: To manage the use of bandwidth, PCoIP employs adaptive encoders that automatically
    adjust the image quality on networks that are congested. The level of network
    congestion can be defined via policies that allow you to configure this based
    on use case, location, and so on. So, maybe the limits are different for those
    users based in the HQ on the main network, versus those in satellite/branch sites.
    When the network is no longer congested, then the maximum image quality is restored.
    PCoIP doesn't transfer any user data over the network. It just transmits pixels,
    and therefore uses a real-time **User Datagram Protocol** (**UDP**), rather than
    using a TCP protocol (used for **Voice over IP** (**VoIP**), to ensure a responsive
    and interactive end user experience. This will reduce the overall bandwidth requirement
    and deliver the best interactive user experience, based on the network bandwidth
    available at any particular time.
  id: totrans-369
  prefs: []
  type: TYPE_NORMAL
  zh: 为了管理带宽使用，PCoIP 使用自适应编码器，自动调整网络拥塞时的图像质量。网络拥塞的程度可以通过策略进行定义，允许你根据使用场景、位置等配置这一点。因此，位于总部主要网络的用户与位于卫星/分支站点的用户，可能会有不同的限制。当网络不再拥塞时，将恢复最大图像质量。PCoIP
    不会通过网络传输任何用户数据，它只传输像素，因此使用实时**用户数据报协议**(**UDP**)，而不是使用 TCP 协议（用于**网络语音协议**(**VoIP**)），以确保响应迅速和交互流畅的终端用户体验。这将减少总体带宽需求，并根据特定时刻可用的网络带宽提供最佳的交互式用户体验。
- en: UDP does not employ error checking or correction, and therefore removes any
    overheads in processing the checking and correcting. The lack of retransmission
    delays that you would find with a TCP protocol means that it's ideal for streaming
    media. For the end user experience, these delays translate to jerky movements,
    most commonly experienced when watching video content.
  id: totrans-370
  prefs: []
  type: TYPE_NORMAL
  zh: UDP 不使用错误检查或校正，因此消除了处理检查和校正的任何开销。由于没有像 TCP 协议那样的重传延迟，这使得它非常适合用于媒体流传输。对于终端用户体验而言，这些延迟表现为画面卡顿，通常发生在观看视频内容时。
- en: PCoIP offloading with the Teradici PCoIP Hardware Accelerator
  id: totrans-371
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 Teradici PCoIP 硬件加速器进行 PCoIP 卸载
- en: In addition to the software solutions discussed in the previous sections, Teradici
    also offers a server offload card called the **Teradici PCoIP Hardware Accelerator**.
    This PCI card is installed in the servers that are hosting the virtual desktop
    machines.
  id: totrans-372
  prefs: []
  type: TYPE_NORMAL
  zh: 除了前面讨论的软件解决方案，Teradici 还提供了一张名为 **Teradici PCoIP 硬件加速卡** 的服务器卸载卡。这张 PCI 卡被安装在托管虚拟桌面机器的服务器上。
- en: The first thing to say about this card is that it is not a **Graphics Processing
    Unit** (**GPU**) card. I often hear some confusion around this, and users assume
    that, by adding an accelerator card, you would get the OpenGL and DirectX capabilities,
    but this is not the case. You might improve the overall experience and performance,
    but you won't be adding additional GPU features.
  id: totrans-373
  prefs: []
  type: TYPE_NORMAL
  zh: 关于这张卡片的第一件事要说明的是，它并不是一张 **图形处理单元**（**GPU**）卡。我经常听到一些关于这个问题的混淆，用户们通常认为通过添加加速卡，可以获得
    OpenGL 和 DirectX 功能，但事实并非如此。你可能会改善整体体验和性能，但并不会增加额外的 GPU 功能。
- en: The objective of this card is purely to take the load away from the CPU of the
    host server when it is processing image encoding operations. Offloading the image
    encoding to a specialized hardware solution reduces CPU utilization, which, in
    turn, delivers a consistent end user experience, thereby allowing applications
    to run more smoothly as they have the resources they require. If you compare it
    to something such as TCP Offload Engine or the TOE card used in the IP storage
    world for iSCSI, it's much better to use hardware-based cards than it is to use
    software initiators.
  id: totrans-374
  prefs: []
  type: TYPE_NORMAL
  zh: 这张卡片的目标纯粹是将主机服务器在处理图像编码操作时的负载从 CPU 中分离出来。将图像编码任务卸载到专门的硬件解决方案上可以减少 CPU 的使用，从而提供一致的终端用户体验，使得应用程序能够更加顺畅地运行，因为它们得到了所需的资源。如果将其与类似于
    TCP 卸载引擎（TCP Offload Engine）或用于 iSCSI 的 IP 存储世界中的 TOE 卡进行比较，使用基于硬件的卡片要比使用软件发起程序好得多。
- en: Freeing up CPU cycles and the overall load on the servers' CPU will potentially
    result in better consolidation ratios of the virtual desktops, that is, more virtual
    desktops per host server. Typically, you will see a 1.2 fold increase.
  id: totrans-375
  prefs: []
  type: TYPE_NORMAL
  zh: 释放 CPU 周期以及减少服务器 CPU 的整体负载可能会导致虚拟桌面的更好整合比率，也就是说，每台主机服务器上的虚拟桌面数量会更多。通常，你会看到大约
    1.2 倍的增长。
- en: The accelerator card can also be used in conjunction with a GPU. In this scenario,
    the card efficiently encodes the extra pixels that are generated by the GPU, ensuring
    the end user has all the benefits that the local GPU can deliver.
  id: totrans-376
  prefs: []
  type: TYPE_NORMAL
  zh: 加速卡也可以与 GPU 一起使用。在这种情况下，该卡有效地编码由 GPU 生成的额外像素，确保终端用户能够享受到本地 GPU 提供的所有好处。
- en: Teradici host card for physical PCs
  id: totrans-377
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Teradici 物理 PC 主机卡
- en: 'Teradici also has a solution for physical workstations to leverage the PCoIP
    protocol: the **PCoIP Remote Workstation card**. This card is not actually for
    virtual desktop sessions, but, instead, it allows you to add a Teradici host card
    to a physical workstation, connect to your workstation, and send remote graphics,
    audio, and USB from the workstation to a PCoIP-enabled endpoint device, such as
    a zero client. Think of it as picking up your desktop PC and putting it in the
    data center, and then running a very long video, mouse, and keyboard cable to
    it. This use case is typically deployed for high-powered rack mount workstations
    or PCs.'
  id: totrans-378
  prefs: []
  type: TYPE_NORMAL
  zh: Teradici 还为物理工作站提供了利用 PCoIP 协议的解决方案：**PCoIP 远程工作站卡**。这张卡实际上并不是用于虚拟桌面会话，而是允许你将
    Teradici 主机卡添加到物理工作站上，连接到工作站，并将远程图形、音频和 USB 从工作站传送到启用 PCoIP 的终端设备，比如零客户端。可以把它当作是将你的桌面
    PC 搬到数据中心，然后用一根非常长的视频、鼠标和键盘线缆连接过去。这种使用场景通常应用于高性能的机架式工作站或 PC。
- en: So, how does that fit in with Horizon View? Quite simply, the connection to
    the physical desktop from the client device is managed using Horizon View and
    the connection server brokers the session in the same way it would when connecting
    to a virtual desktop machine. The pixels and keyboard and mouse strokes are sent
    over the network using the PCoIP protocol.
  id: totrans-379
  prefs: []
  type: TYPE_NORMAL
  zh: 那么，这与 Horizon View 有什么关系呢？简单来说，客户端设备与物理桌面的连接是通过 Horizon View 管理的，连接服务器以与连接虚拟桌面机器的方式相同的方式来代理会话。像素、键盘和鼠标操作通过
    PCoIP 协议通过网络传输。
- en: How the PCoIP connection process works
  id: totrans-380
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: PCoIP 连接过程的工作原理
- en: 'The following describes how the PCoIP connection process works when an end
    user logs in and requests a virtual desktop machine:'
  id: totrans-381
  prefs: []
  type: TYPE_NORMAL
  zh: 以下描述了当终端用户登录并请求虚拟桌面机器时，PCoIP 连接过程是如何工作的：
- en: The Horizon Client sends the end user's credentials for authentication via HTTPS
    to the external URL of the PCoIP External URL that you configured on the security
    server or Unified Access Gateway. To do this, it uses the XML-API.
  id: totrans-382
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Horizon客户端通过HTTPS将最终用户的凭证发送到您在安全服务器或统一访问网关上配置的PCoIP外部URL进行身份验证。为此，它使用XML-API。
- en: HTTPS authentication data is passed through from either the Unified Access Gateway
    or the security server to the connection server. The security server uses IPsec
    protected AJP13-forwarded traffic, from the security server to the connection
    server that it is paired with. The desktop pools and apps that the user is entitled
    to are read from the connection server and then displayed as available resources
    displayed in the Horizon Client.
  id: totrans-383
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: HTTPS身份验证数据从统一访问网关或安全服务器传递到连接服务器。安全服务器使用IPsec保护的AJP13转发流量，从安全服务器转发到它配对的连接服务器。用户有权访问的桌面池和应用程序从连接服务器读取，并作为可用资源显示在Horizon客户端中。
- en: The end user launches either a virtual desktop or published app session. This
    connection is initiated on TCP port `4172` (PCoIP port) to the Unified Access
    Gateway or the security server. This session initiation process is called the
    **PCoIP session handshake**.
  id: totrans-384
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最终用户启动虚拟桌面或发布的应用程序会话。此连接在TCP端口`4172`（PCoIP端口）上启动，连接到统一访问网关或安全服务器。该会话启动过程称为**PCoIP会话握手**。
- en: A bi-directional PCoIP connection is established using UDP port `4172` (ensure
    that this port is not being blocked) to send the session data from the Horizon
    client and the configured `pcoipExternalUrl` to the Unified Access Gateway or
    the security server. Details of the PCoIP session are then forwarded from the
    Unified Access Gateway or the security server back to the Horizon Agent running
    on the virtual desktop machine and then to the client.
  id: totrans-385
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用UDP端口`4172`（确保此端口未被阻塞）建立双向PCoIP连接，以便从Horizon客户端和配置的`pcoipExternalUrl`将会话数据发送到统一访问网关或安全服务器。然后，PCoIP会话的详细信息从统一访问网关或安全服务器转发回运行在虚拟桌面上的Horizon代理，并传输到客户端。
- en: '`pcoipExternalUrl` is only used for the Unified Access Gateway. If you are
    using security servers for external access, then the PCoIP external URL on the
    paired connection server will be used instead.'
  id: totrans-386
  prefs: []
  type: TYPE_NORMAL
  zh: '`pcoipExternalUrl`仅用于统一访问网关。如果您使用的是安全服务器进行外部访问，则会使用配对连接服务器上的PCoIP外部URL。'
- en: 'This process is shown in the following diagram:'
  id: totrans-387
  prefs: []
  type: TYPE_NORMAL
  zh: 该过程如下图所示：
- en: '![](img/95435ec1-d35d-42b1-91b0-59816387fa9c.png)'
  id: totrans-388
  prefs: []
  type: TYPE_IMG
  zh: '![](img/95435ec1-d35d-42b1-91b0-59816387fa9c.png)'
- en: In the next section, we are going to look at the **Blast Extreme** protocol
    in more detail.
  id: totrans-389
  prefs: []
  type: TYPE_NORMAL
  zh: 在接下来的章节中，我们将更详细地了解**Blast Extreme**协议。
- en: Blast Extreme
  id: totrans-390
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Blast Extreme
- en: Blast Extreme is a new VMware developed protocol that uses the H.264 video codec
    as an option if you have the appropriate GPU acceleration resources available
    in the host servers, allowing it to deliver the user experience to H.264-enabled
    client devices. H.264, or MPEG-4 part 10, is an advanced video coding, or MPEG-4
    AVC, solution. It is a standard of video compression that is block-oriented, motion
    compensation-based. It's a commonly used video format, and an example of where
    it is used is in the delivery of DVD video content.
  id: totrans-391
  prefs: []
  type: TYPE_NORMAL
  zh: Blast Extreme是VMware开发的新协议，如果主机服务器具备适当的GPU加速资源，它可以选择使用H.264视频编码器，从而将用户体验传递到启用了H.264的客户端设备。H.264，或MPEG-4第10部分，是一种先进的视频编码，或称为MPEG-4
    AVC，解决方案。它是一种基于块的、运动补偿的视频压缩标准。它是一种常用的视频格式，应用实例包括DVD视频内容的传输。
- en: Blast as a VMware protocol has been around for a while and was first seen in
    Horizon 5.2 a few years ago, where it was used to deliver HTML5 access to virtual
    desktop machines. Now, however, it's not just limited to delivering HTML5 access;
    it can also deliver the user experience to the latest client devices using standard
    HTTPS ports.
  id: totrans-392
  prefs: []
  type: TYPE_NORMAL
  zh: Blast作为VMware协议已经存在一段时间，最早出现在几年前的Horizon 5.2版本中，当时它用于提供HTML5访问虚拟桌面。现在，它不仅限于提供HTML5访问；它还可以使用标准HTTPS端口将用户体验交付到最新的客户端设备。
- en: The Blast Extreme delivery method is also on feature parity with PCoIP and supports
    similar functionality, such as client drive redirection, USB, unified communications,
    and local printing. Where they start to differ is in resource consumption, with
    Blast using far fewer CPU cycles, and delivery protocols, and more flexible.
  id: totrans-393
  prefs: []
  type: TYPE_NORMAL
  zh: Blast Extreme交付方式与PCoIP具有相同的功能，支持类似的功能，如客户端驱动器重定向、USB、统一通信和本地打印。它们的区别在于资源消耗，Blast使用更少的CPU周期，交付协议更灵活。
- en: Like PCoIP, Blast Extreme can compensate for an increase in latency or a reduction
    in bandwidth and dynamically adjust; however, it can also leverage both TCP and
    UDP, whereas PCoIP is UDP only.
  id: totrans-394
  prefs: []
  type: TYPE_NORMAL
  zh: 与 PCoIP 类似，Blast Extreme 可以补偿延迟增加或带宽减少并动态调整；然而，它还可以同时利用 TCP 和 UDP，而 PCoIP 只能使用
    UDP。
- en: You can also connect multiple monitors. Depending on the endpoint device, up
    to four monitors are supported, each one running at 2,560 x 1,600\. Or you can
    run three 4K monitors running at 3,840 x 2,160 for Windows 7 remote desktops with
    Aero disabled.
  id: totrans-395
  prefs: []
  type: TYPE_NORMAL
  zh: 您还可以连接多个监视器。根据终端设备，支持最多四个运行分辨率为 2,560 x 1,600 的监视器，或者可以在 Windows 7 远程桌面上禁用 Aero
    的情况下运行三个分辨率为 3,840 x 2,160 的 4K 监视器。
- en: 'Some of the other features of Blast Extreme are detailed in the following list:'
  id: totrans-396
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是 Blast Extreme 的其他特性详细列表：
- en: '**Blast Adaptive UX**: Delivers end user access to Horizon View virtual desktop
    machines and hosted applications via the Horizon View Client or browser-based
    clients, using either Blast Extreme, PCoIP, or RDP. It automatically adapts to
    network conditions, delivering the best experience possible, through either.'
  id: totrans-397
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Blast 自适应 UX**：通过 Horizon View 客户端或基于浏览器的客户端，使用 Blast Extreme、PCoIP 或 RDP
    提供对 Horizon View 虚拟桌面机器和托管应用程序的最终用户访问。它自动适应网络条件，通过任一方式提供最佳体验。'
- en: '**Blast Multimedia**: Delivers rich video playback for Flash, HTML5, QuickTime,
    Microsoft Silverlight, and Windows Media.'
  id: totrans-398
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Blast 多媒体**：为 Flash、HTML5、QuickTime、Microsoft Silverlight 和 Windows Media
    提供丰富的视频播放。'
- en: '**Blast 3D Services**: Built on the broadest virtualized graphics capabilities
    in the industry, including hardware-accelerated graphics with NVIDIA GRID vGPU
    technology. With Blast 3D enabled, Horizon View supports either up to two monitors
    running up to 1,920 x 1,200, or a single 4K monitor running at 3,840 x 2,160.'
  id: totrans-399
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Blast 3D 服务**：基于行业内最广泛的虚拟化图形能力构建，包括使用 NVIDIA GRID vGPU 技术的硬件加速图形。启用 Blast
    3D 后，Horizon View 支持最多两个运行分辨率为 1,920 x 1,200 的监视器，或一个运行分辨率为 3,840 x 2,160 的单个
    4K 监视器。'
- en: '**Blast Live Communications**: Delivers full access to communications tools
    such as headsets and webcams, for rich audio and video. Supports applications
    such as Skype, Google Hangouts, and Cisco WebEx.'
  id: totrans-400
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Blast 实时通信**：提供对头戴式耳机和网络摄像头等通信工具的完全访问，支持 Skype、Google Hangouts 和 Cisco WebEx
    等应用程序。'
- en: '**Blast Unity Touch**: Delivers a more intuitive interface, allowing you to
    use Windows desktops, applications, and files from a mobile device.'
  id: totrans-401
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Blast Unity Touch**：提供更直观的界面，允许您从移动设备上使用 Windows 桌面、应用程序和文件。'
- en: '**Blast Local Access**: Supports connecting peripheral devices such as USB
    flash drives, printers, smart card devices, and smartphones to your virtual desktop
    machine.'
  id: totrans-402
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Blast 本地访问**：支持连接外围设备，如 USB 闪存驱动器、打印机、智能卡设备和智能手机到您的虚拟桌面机器。'
- en: '**Blast Horizon Clients**: Blast-enabled clients for delivering a high-end
    user experience to endpoint devices.'
  id: totrans-403
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Blast Horizon 客户端**：为终端设备提供高端用户体验的 Blast 启用客户端。'
- en: How the Blast Extreme connection process works
  id: totrans-404
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Blast Extreme 连接过程的工作原理
- en: 'The following steps describe how the Blast Extreme connection process works:'
  id: totrans-405
  prefs: []
  type: TYPE_NORMAL
  zh: 以下步骤描述了 Blast Extreme 连接过程的工作原理：
- en: As with PCoIP, with Blast Extreme, the Horizon Client sends the end user's credentials
    for authentication via HTTPS to the external URL of the PCoIP external URL that
    you configured on the security server or Unified Access Gateway.
  id: totrans-406
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 与 PCoIP 一样，使用 Blast Extreme，Horizon 客户端通过 HTTPS 将最终用户的凭据用于在安全服务器或统一访问网关上配置的
    PCoIP 外部 URL 的身份验证。
- en: HTTPS authentication data is passed through from either the Unified Access Gateway
    appliance or the security server to the connection server. The security server
    uses AJP13-forwarded traffic from the security server to the connection server
    it are paired with. The desktop pools and apps that the user is entitled to are
    read from the connection server and then displayed as available resources displayed
    in the Horizon client.
  id: totrans-407
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: HTTPS 认证数据通过统一访问网关设备或安全服务器传递到连接服务器。安全服务器使用从安全服务器到连接服务器的 AJP13 转发流量进行配对。用户有权访问的桌面池和应用程序从连接服务器读取，然后在
    Horizon 客户端中显示为可用资源。
- en: The end user launches either a virtual desktop or published app session from
    the Horizon client. A session handshake occurs over HTTPS on TCP port `443` to
    the Unified Access Gateway Appliance or the security server.
  id: totrans-408
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最终用户从 Horizon 客户端启动虚拟桌面或发布的应用程序会话。在统一访问网关设备或安全服务器上通过 HTTPS 在 TCP 端口 `443` 进行会话握手。
- en: A secure WebSocket is established on TCP port `443`) to allow the session data
    between the Horizon client and the Unified Access Gateway Appliance or the security
    server.
  id: totrans-409
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在TCP端口`443`上建立一个安全的WebSocket连接，用于允许Horizon客户端和统一访问网关设备或安全服务器之间的会话数据传输。
- en: The Blast Secure Gateway Service (either Unified Access Gateway Appliance or
    security server-based) will attempt to establish a UDP WebSocket connection on
    port `443`. If the connection fails, or is blocked for some reason, then the Blast
    Secure Gateway Service will revert to the initial WebSocket TCP port `443` connection.
  id: totrans-410
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Blast安全网关服务（无论是统一访问网关设备还是基于安全服务器的）将尝试在端口`443`上建立UDP WebSocket连接。如果连接失败或因某种原因被阻止，Blast安全网关服务将回退到初始的WebSocket
    TCP端口`443`连接。
- en: 'This process is shown in the following diagram:'
  id: totrans-411
  prefs: []
  type: TYPE_NORMAL
  zh: 这个过程在下图中展示：
- en: '![](img/d7e6984a-3eab-48cf-b24e-83f8be4676c4.png)'
  id: totrans-412
  prefs: []
  type: TYPE_IMG
  zh: '![](img/d7e6984a-3eab-48cf-b24e-83f8be4676c4.png)'
- en: 'For more detailed port settings, follow this link:'
  id: totrans-413
  prefs: []
  type: TYPE_NORMAL
  zh: 有关更详细的端口设置，请参见以下链接：
- en: '[https://techzone.vmware.com/resource/](https://techzone.vmware.com/resource/network-ports-vmware-horizon-7)[network-ports-vmware-horizon-7](https://techzone.vmware.com/resource/network-ports-vmware-horizon-7).'
  id: totrans-414
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://techzone.vmware.com/resource/](https://techzone.vmware.com/resource/network-ports-vmware-horizon-7)[network-ports-vmware-horizon-7](https://techzone.vmware.com/resource/network-ports-vmware-horizon-7)。'
- en: Alternative display protocols
  id: totrans-415
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 替代显示协议
- en: There are a couple of other mainstream desktop protocols available on the market,
    some that work with VMware Horizon, and others that are used by Horizon's competitors.
    The main protocols available today are Microsoft **Remote Desktop Protocol** (**RDP**)
    and Citrix **Independent Computing Architecture** (**ICA**). These are described
    in the following sections.
  id: totrans-416
  prefs: []
  type: TYPE_NORMAL
  zh: 市面上还有一些其他主流桌面协议，其中一些与VMware Horizon兼容，另一些被Horizon的竞争者使用。目前可用的主要协议是Microsoft的**远程桌面协议**(**RDP**)和Citrix的**独立计算架构**(**ICA**)。这些将在接下来的章节中进行描述。
- en: RDP
  id: totrans-417
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: RDP
- en: The RDP was developed for Microsoft and is used primarily to connect to a remote
    machine, server, desktop, or virtual machine using TCP IP. The RDP is now more
    commonly known as the **Remote Desktop Connection**. You probably use it daily
    to connect remotely to your server infrastructure in order to manage servers remotely.
  id: totrans-418
  prefs: []
  type: TYPE_NORMAL
  zh: RDP是为Microsoft开发的，主要用于通过TCP IP连接到远程计算机、服务器、桌面或虚拟机。RDP现在更常被称为**远程桌面连接**。你可能每天都使用它来远程连接到你的服务器基础设施，以便远程管理服务器。
- en: When you connect to the remote desktop or machine, you are essentially connecting
    to a terminal service component, which then relays the screen content back to
    the client, along with keystrokes and mouse movements.
  id: totrans-419
  prefs: []
  type: TYPE_NORMAL
  zh: 当你连接到远程桌面或计算机时，实际上是连接到一个终端服务组件，该组件将屏幕内容、按键输入和鼠标移动传送回客户端。
- en: ICA protocol
  id: totrans-420
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ICA协议
- en: ICA is another display protocol that is used by Citrix in its products, XenDesktop
    and XenApp. It is similar in design to other protocols in that it is used to deliver
    screen content and keyboard strokes to a client device over a TCP IP network connection.
  id: totrans-421
  prefs: []
  type: TYPE_NORMAL
  zh: ICA是Citrix在其产品XenDesktop和XenApp中使用的另一种显示协议。它与其他协议的设计类似，用于通过TCP IP网络连接将屏幕内容和键盘输入传送到客户端设备。
- en: You connect using an ICA client, such as **Citrix Receiver**, installed on your
    endpoint device. This loads an ICA file containing the details of the remote system
    you are connecting to and any properties to apply to that session.
  id: totrans-422
  prefs: []
  type: TYPE_NORMAL
  zh: 你通过安装在端点设备上的ICA客户端（如**Citrix Receiver**）进行连接。这会加载一个ICA文件，包含你正在连接的远程系统的详细信息以及应用于该会话的属性。
- en: What about **High Definition Experience** (**HDX**)? HDX is not a protocol or
    a technology, but rather a marketing brand for HDX. HDX encompasses a number of
    Citrix technologies that describe the entire user experience rather than concentrating
    on just the protocol element. You will also see some sub-brands fall under HDX,
    such as HDX MediaStream, HDX RealTime, and HDX 3D.
  id: totrans-423
  prefs: []
  type: TYPE_NORMAL
  zh: 那么**高清体验**(**HDX**)呢？HDX不是一个协议或技术，而是HDX的市场品牌。HDX涵盖了多项Citrix技术，描述了整个用户体验，而不是仅仅集中在协议元素上。你还会看到一些子品牌属于HDX，比如HDX
    MediaStream、HDX RealTime和HDX 3D。
- en: Which protocol should you use – Blast Extreme, PCoIP, or RDP?
  id: totrans-424
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 你应该使用哪种协议——Blast Extreme、PCoIP还是RDP？
- en: Now that we have a good understanding of PCoIP, Blast Extreme, and RDP, which
    one would you choose?
  id: totrans-425
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经对PCoIP、Blast Extreme和RDP有了很好的理解，你会选择哪一个？
- en: The most compelling reason to go with PCoIP is the fact that it uses the UDP
    protocol, which is much better suited to streaming media and therefore lends itself
    perfectly to the characteristics of virtual desktop delivery, but, as discussed,
    Blast can also use UDP as the delivery protocol. Just to highlight this again,
    UDP is not concerned with how the data ends up on the endpoint device; it's only
    concerned with the speed of delivery and how quickly it gets there.
  id: totrans-426
  prefs: []
  type: TYPE_NORMAL
  zh: 选择PCoIP的最有力理由是它使用UDP协议，UDP更适合流媒体传输，因此非常适合虚拟桌面交付的特性。不过，正如前面提到的，Blast也可以使用UDP作为传输协议。再次强调，UDP不关心数据如何到达端点设备，它只关心传输的速度以及数据到达的速度。
- en: On the other hand, RDP uses TCP as its protocol, which is widely used across
    the internet. The key difference with TCP is that it is concerned with how the
    data is being received. TCP requests an acknowledgment from the endpoint device
    as to whether it has received all of the packets successfully. If the endpoint
    device does not receive what it was expecting, then it replies, asking TCP to
    either stop sending packets or to narrow the amount that it receives. UDP just
    keeps sending and is much speedier, simply because there is no acknowledgment
    packet back from the endpoint device.
  id: totrans-427
  prefs: []
  type: TYPE_NORMAL
  zh: 另一方面，RDP使用TCP作为协议，这是互联网上广泛使用的协议。与TCP的关键区别在于，它关注数据如何接收。TCP要求端点设备确认是否成功接收所有数据包。如果端点设备未收到期望的数据包，它会回复请求TCP停止发送数据包或缩小接收量。UDP则持续发送，并且速度更快，因为没有来自端点设备的确认包。
- en: This is where Blast Extreme would come in, as it can use either TCP or UDP as
    the delivery protocol and is able to determine what network capacity it has available
    to it and adjust accordingly.
  id: totrans-428
  prefs: []
  type: TYPE_NORMAL
  zh: 这时，Blast Extreme就可以派上用场，它可以使用TCP或UDP作为传输协议，并能够判断可用的网络容量并相应调整。
- en: Blast Extreme will also use fewer resources on the endpoint device, especially
    if you offload the decoding using the NVIDIA GRID technology. However, the only
    point to be aware of is that when using TCP as the delivery protocol, it could
    potentially consume more bandwidth, as it compensates for packet loss.
  id: totrans-429
  prefs: []
  type: TYPE_NORMAL
  zh: Blast Extreme还将减少端点设备的资源使用，特别是当你使用NVIDIA GRID技术进行解码卸载时。然而，需要注意的一点是，当使用TCP作为传输协议时，由于需要补偿丢包，它可能会消耗更多的带宽。
- en: There are some cases where PCoIP won't be the appropriate protocol and Blast
    Extreme or RDP would need to be used. The one we see most often is when the required
    network ports are being blocked by corporate policy, or from remote locations
    that lock down internet connections.
  id: totrans-430
  prefs: []
  type: TYPE_NORMAL
  zh: 在某些情况下，PCoIP可能不是合适的协议，Blast Extreme或RDP则需要使用。我们最常见的情况是当所需的网络端口被公司策略阻塞，或是来自远程位置的互联网连接被限制时。
- en: When your desktop is displayed back to you, PCoIP uses UDP port `4172` to send
    the pixels. This port is sometimes blocked, as it's not typically used. The result
    of this port being blocked is that, even though you will be able to log on to
    your virtual desktop via the View client and everything looks OK' you will just
    receive a black screen. The black screen is due to the pixels being blocked as
    they are sent. In this example, the workaround is to access the desktop from an
    HTML5-enabled browser using Blast Extreme, which uses standard HTTPS ports. We
    will cover this in [Chapter 10](8ebc54c4-3812-46fe-9534-fe38b78804a9.xhtml), *Fine-Tuning
    the End User Experience*.
  id: totrans-431
  prefs: []
  type: TYPE_NORMAL
  zh: 当你的桌面被显示回你时，PCoIP使用UDP端口`4172`来传送像素。这个端口有时会被阻塞，因为它通常不被使用。如果这个端口被阻塞，结果是，尽管你能够通过View客户端登录到虚拟桌面并且一切看起来正常，你却只会看到一个黑屏。黑屏的原因是像素在传输时被阻塞。在这个例子中，解决方法是使用支持HTML5的浏览器通过Blast
    Extreme访问桌面，Blast Extreme使用标准的HTTPS端口。我们将在[第10章](8ebc54c4-3812-46fe-9534-fe38b78804a9.xhtml)，*优化终端用户体验*中详细讲解。
- en: The key takeaway here is to engage with your networking and security teams when
    planning how users connect to their virtual desktop machines and look at how the
    users are working and from what locations. It may well be that you don't need
    external access, and therefore WAN limitations are no longer a consideration.
  id: totrans-432
  prefs: []
  type: TYPE_NORMAL
  zh: 这里的关键点是，在规划用户如何连接到虚拟桌面时，要与网络和安全团队合作，并考虑用户的工作方式和所在位置。也许你并不需要外部访问，因此WAN的限制就不再是考虑因素。
- en: Now that we have talked about how to deliver graphics via the delivery protocol,
    in the next section, we are going to look at the options for enabling high-end
    graphics in virtual desktop machines.
  id: totrans-433
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经讨论了如何通过交付协议传输图形，在接下来的部分中，我们将探讨如何在虚拟桌面机器中启用高端图形的选项。
- en: Horizon View Hardware-accelerated graphics
  id: totrans-434
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Horizon View 硬件加速图形
- en: Early versions of virtual desktop technology faced challenges when it came to
    delivering high-end graphical content, as the host servers were not designed to
    render and deliver the size and quality of images required for such applications.
  id: totrans-435
  prefs: []
  type: TYPE_NORMAL
  zh: 虚拟桌面技术的早期版本在提供高端图形内容时遇到了挑战，因为宿主服务器并未设计用于渲染和提供这些应用所需的图像大小和质量。
- en: Let's start with a brief history and background. The technology to support high-end
    graphics was released in several phases, with the first support for 3D graphics
    released in vSphere 5, with View 5.0 using software-based rendering. This gave
    us the ability to support things such as the Windows Aero feature, but it was
    still not powerful enough for some of the high-end use cases due to this being
    a software feature.
  id: totrans-436
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们从简要的历史和背景开始。支持高端图形的技术是分阶段发布的，首次在 vSphere 5 中推出对 3D 图形的支持，而 View 5.0 则使用基于软件的渲染。这使我们能够支持
    Windows Aero 功能等内容，但由于这是一个软件功能，仍然不足以满足一些高端用例的需求。
- en: The next phase was to provide a hardware-based GPU virtualization solution that
    came with vSphere 5.1 and allowed virtual machines to share a physical GPU by
    allowing virtual machines to pass through the hypervisor layer to take advantage
    of a physical graphics card installed inside the host server.
  id: totrans-437
  prefs: []
  type: TYPE_NORMAL
  zh: 下一阶段是提供基于硬件的 GPU 虚拟化解决方案，这个解决方案随着 vSphere 5.1 的发布而推出，它允许虚拟机通过虚拟机监控程序层传递，从而利用安装在宿主服务器中的物理图形卡。
- en: If we had this conversation a couple of years ago and you had a use case that
    required high-end graphics capabilities, then virtual desktops would not have
    been a viable solution. As we just discussed, in a VDI environment, graphics will
    be delivered using a virtualized, software-based graphics driver as part of the
    hypervisor.
  id: totrans-438
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们几年前就讨论这个话题，且你有一个需要高端图形功能的用例，那么虚拟桌面将不是一个可行的解决方案。正如我们刚才讨论的，在 VDI 环境中，图形将通过虚拟化的、基于软件的图形驱动程序作为虚拟机监控程序的一部分来交付。
- en: Also, don't forget that, as we are now using servers to host the virtual desktops,
    we are using the power of the graphics card in the server, and servers aren't
    renowned for their high-end graphics capabilities and have limited GPU power,
    as typically, all a server needs to do is display a management console.
  id: totrans-439
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，不要忘记，既然我们现在使用服务器来托管虚拟桌面，我们实际上是在使用服务器中图形卡的处理能力，而服务器并不以高端图形能力著称，并且 GPU 能力有限，因为通常情况下，服务器只需要显示管理控制台。
- en: That has all changed now. With the release of View 5.2 back in 2013, the ability
    to deliver hardware-accelerated graphics became a standard product feature with
    the introduction of **Virtual Shared Graphics Acceleration** (**vSGA**), which
    was then followed by the launch of **Virtual Dedicated Graphics Acceleration**
    (**vDGA**).
  id: totrans-440
  prefs: []
  type: TYPE_NORMAL
  zh: 现在这一切都变了。随着 2013 年 View 5.2 的发布，硬件加速图形的能力成为了标准产品功能，推出了**虚拟共享图形加速**（**vSGA**），随后推出了**虚拟专用图形加速**（**vDGA**）。
- en: We will discuss these two technologies in the following sections of this chapter.
    We will also discuss the latest installment of graphics capabilities in Horizon
    View, with **Virtual Graphics Processing Unit** (**vGPU**).
  id: totrans-441
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将在本章的接下来的部分讨论这两种技术。我们还将讨论 Horizon View 中图形功能的最新版本，包含**虚拟图形处理单元**（**vGPU**）。
- en: vSGA
  id: totrans-442
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: vSGA
- en: The vSGA implementation allows for multiple virtual desktop machines to share
    a physical GPU card, which is installed inside the ESXi host server that is hosting
    those virtual desktop machines.
  id: totrans-443
  prefs: []
  type: TYPE_NORMAL
  zh: vSGA 实现允许多个虚拟桌面机器共享一张物理 GPU 卡，该卡安装在托管这些虚拟桌面机器的 ESXi 主机服务器中。
- en: In this model, the virtual desktop machines do not have direct access to a dedicated
    physical GPU card. Instead, the standard VMware SVGA 3D graphics driver that is
    part of VMware Tools is installed on the virtual desktop's operating system. The
    SVGA driver is a VMware driver that provides support for DirectX 9.0c and OpenGL
    2.1.
  id: totrans-444
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种模式下，虚拟桌面机器无法直接访问专用的物理 GPU 卡。相反，VMware Tools 中的标准 VMware SVGA 3D 图形驱动程序被安装在虚拟桌面操作系统中。SVGA
    驱动程序是一个 VMware 驱动程序，提供对 DirectX 9.0c 和 OpenGL 2.1 的支持。
- en: In this configuration, the driver supplied by the graphics card manufacturer
    (VIB) is installed on the ESXi hypervisor rather than the virtual desktop machine's
    own operating system. Graphics commands from user sessions are intercepted by
    this driver and sent to the hypervisor, which controls the GPU in the ESXi server.
  id: totrans-445
  prefs: []
  type: TYPE_NORMAL
  zh: 在此配置中，由显卡制造商提供的驱动程序（VIB）会安装在ESXi虚拟化管理程序上，而不是虚拟桌面机器的操作系统上。来自用户会话的图形命令会被此驱动程序拦截并发送到虚拟化管理程序，后者控制ESXi服务器中的GPU。
- en: 'Delivery to the user''s endpoint works in the same way, where DevTAP encodes
    the user experience to PCoIP or Blast Extreme, and delivers it to the end user''s
    device, either in an HTML5 browser or Horizon Client. The following diagram shows
    an overview of the vSGA architecture:'
  id: totrans-446
  prefs: []
  type: TYPE_NORMAL
  zh: 向用户端点的交付工作方式相同，DevTAP会将用户体验编码为PCoIP或Blast Extreme，并通过HTML5浏览器或Horizon客户端将其交付到最终用户设备。下图展示了vSGA架构的概览：
- en: '![](img/ab9c0469-21d3-4d39-b404-51a826fe3b1d.png)'
  id: totrans-447
  prefs: []
  type: TYPE_IMG
  zh: '![](img/ab9c0469-21d3-4d39-b404-51a826fe3b1d.png)'
- en: There are several configurations and support options to consider, which we will
    cover in the next sections.
  id: totrans-448
  prefs: []
  type: TYPE_NORMAL
  zh: 有几种配置和支持选项需要考虑，我们将在接下来的章节中进行讨论。
- en: vSGA-supported graphics cards
  id: totrans-449
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: vSGA支持的显卡
- en: 'vSGA will support OpenGL 2.1- and DirectX 9-based applications running either
    on Windows 7 or 8 virtual desktop machines, virtualized on VMware vSphere 5.1
    and greater, using one of the following manufacturer''s GPU cards:'
  id: totrans-450
  prefs: []
  type: TYPE_NORMAL
  zh: vSGA将支持基于OpenGL 2.1和DirectX 9的应用程序，这些应用程序可以在Windows 7或8的虚拟桌面机器上运行，并且虚拟化在VMware
    vSphere 5.1及更高版本上，使用以下制造商的GPU卡之一：
- en: Intel HD Graphics P4700, and Intel Iris Graphics
  id: totrans-451
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Intel HD Graphics P4700，和Intel Iris Graphics
- en: Tesla
  id: totrans-452
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Tesla
- en: NVIDIA GRID
  id: totrans-453
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: NVIDIA GRID
- en: AMD FirePro
  id: totrans-454
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: AMD FirePro
- en: 'For the latest compatibility guide and supported graphics cards, please click
    on the following link: [http://www.vmware.com/resources/compatibility/search.php?deviceCategory=vsga](http://www.vmware.com/resources/compatibility/search.php?deviceCategory=vsga).'
  id: totrans-455
  prefs: []
  type: TYPE_NORMAL
  zh: 有关最新的兼容性指南和支持的显卡，请点击以下链接：[http://www.vmware.com/resources/compatibility/search.php?deviceCategory=vsga](http://www.vmware.com/resources/compatibility/search.php?deviceCategory=vsga)。
- en: How many virtual desktops are supported by vSGA?
  id: totrans-456
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: vSGA支持多少个虚拟桌面？
- en: This is a question that often gets asked when talking about delivering hardware-based
    graphics within a Horizon View environment, so let's spend some time understanding
    this. Within Horizon View, you can create different desktop pools depending on
    the use case, as we will cover in [Chapter 8](d44c9a7b-bcae-4758-a857-197be388a4be.xhtml),
    *Configuring and Managing Desktop Pools – Part 1*, where one of the desktop pools
    will be configured to use high-end graphics. Typically, you would not want to
    give all users access to a hardware-based GPU, hence the reason you would create
    a desktop pool for this use case.
  id: totrans-457
  prefs: []
  type: TYPE_NORMAL
  zh: 这是一个在讨论在Horizon View环境中提供硬件加速图形时经常被问到的问题，所以我们需要花些时间来理解这个问题。在Horizon View中，您可以根据使用场景创建不同的桌面池，正如我们将在[第8章](d44c9a7b-bcae-4758-a857-197be388a4be.xhtml)《配置和管理桌面池——第1部分》中所介绍的那样，其中一个桌面池将配置为使用高端图形。通常，您不希望所有用户都能访问硬件GPU，因此您会为这一使用场景创建一个桌面池。
- en: So, to answer the question, the number of virtual desktops you can allocate
    to a GPU is dependent on the amount of video memory (VRAM) that you allocate to
    each virtual desktop. The thing to bear in mind is that the resources are shared,
    and therefore normal VMware virtualization rules apply. The first thing to note
    is how memory is shared.
  id: totrans-458
  prefs: []
  type: TYPE_NORMAL
  zh: 所以，要回答这个问题，您可以分配给GPU的虚拟桌面数量取决于您为每个虚拟桌面分配的视频内存（VRAM）量。需要记住的是，资源是共享的，因此正常的VMware虚拟化规则适用。首先要注意的是内存是如何共享的。
- en: Half of the video memory allocated to a virtual desktop machine is allocated
    from the GPU card's memory, and the other half is from the host server's memory.
    When sizing your host servers, you need to ensure that you have enough memory
    configured in the server to allocate this as video memory.
  id: totrans-459
  prefs: []
  type: TYPE_NORMAL
  zh: 分配给虚拟桌面机器的视频内存的一半来自GPU卡的内存，另一半来自主机服务器的内存。在配置主机服务器时，您需要确保服务器中配置了足够的内存来分配为视频内存。
- en: Based on this, and on the number of virtual desktops supported being based on
    the amount of allocated VRAM, let's look at how that works out.
  id: totrans-460
  prefs: []
  type: TYPE_NORMAL
  zh: 基于这一点，且支持的虚拟桌面数量是根据分配的VRAM量来决定的，接下来我们来看看具体是如何实现的。
- en: The default amount of VRAM allocated to a virtual desktop machine is 128 MB.
    So, in this example, 64 MB will come from the GPU and the other 64 MB from the
    host server. If you then take a GPU card that has 4 GB of VRAM on board, you will
    be able to support 64 virtual desktops (4 GB or 4,096 MB divided by 64 MB from
    the GPU = 64 virtual desktop machines).
  id: totrans-461
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，每台虚拟桌面机分配的显存为128 MB。因此，在这个示例中，64 MB来自GPU，另外64 MB来自主机服务器。如果你使用一张拥有4 GB显存的GPU卡，你将能够支持64台虚拟桌面机（4
    GB或4,096 MB除以每台虚拟桌面机的64 MB显存 = 64台虚拟桌面机）。
- en: With Horizon View, you can allocate a maximum of 512 MB of VRAM per virtual
    desktop machine. If you apply this to the preceding example using the same 4 GB
    GPU card, you now reduce the number of supported virtual desktops to 16 (4 GB
    or 4,096 MB divided by 256 MB from the GPU = 16 virtual desktop machines).
  id: totrans-462
  prefs: []
  type: TYPE_NORMAL
  zh: 使用Horizon View，你可以为每台虚拟桌面机分配最多512 MB的显存。如果将此应用于前面的示例，并使用相同的4 GB GPU卡，那么你现在将支持16台虚拟桌面机（4
    GB或4,096 MB除以每台虚拟桌面机的256 MB显存 = 16台虚拟桌面机）。
- en: With the AMD graphics solutions, the maximum number of supported desktops is
    15 desktops per GPU.
  id: totrans-463
  prefs: []
  type: TYPE_NORMAL
  zh: 使用AMD图形解决方案时，每个GPU最多支持15台桌面。
- en: We stated previously that normal VMware virtualization rules apply, so let's
    explain exactly what that means. Basically, what happens when you can't fulfil
    a virtual desktop machine's specification and there are insufficient resources?
    It won't boot or power on, right? It's the same for GPU configuration. If you
    configure a desktop pool with more virtual desktop machines than you can support
    on that GPU, they will not boot.
  id: totrans-464
  prefs: []
  type: TYPE_NORMAL
  zh: 我们之前提到过，正常的VMware虚拟化规则适用，那么我们来详细解释一下这是什么意思。基本上，当你无法满足虚拟桌面机的规格且资源不足时，会发生什么？它无法启动或开机，对吧？GPU配置也是如此。如果你为桌面池配置了超过该GPU能够支持的虚拟桌面机，它们将无法启动。
- en: If you do happen to configure more virtual desktop machines in a pool where
    you probably cannot guarantee the GPU resources to be available, set the Hardware
    3D setting in the View Administrator console to Automatic. Doing this allows Horizon
    View to revert to the software-based 3D rendering to deliver the virtual desktop
    machines.
  id: totrans-465
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你确实配置了更多虚拟桌面机并且无法确保GPU资源可用，请在View Administrator控制台中将硬件3D设置为自动。这样，Horizon View将会回退到基于软件的3D渲染来提供虚拟桌面机。
- en: vDGA
  id: totrans-466
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: vDGA
- en: While vSGA works on a shared basis, vDGA allows for an individual VM to have
    its own dedicated access to a physical GPU card installed in the ESXi host server.
    This allows the virtual desktop machine to have a higher level of graphics performance,
    making it perfect for such use cases as CAD/CAM applications, as it supports DirectX
    (9, 10, and 11), OpenGL 4.4, and NVIDIA CUDA.
  id: totrans-467
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然vSGA是基于共享的，vDGA允许每个虚拟机拥有对安装在ESXi主机服务器上的物理GPU卡的独立访问权限。这使得虚拟桌面机能够获得更高水平的图形性能，非常适合用于CAD/CAM应用等场景，因为它支持DirectX（9、10和11）、OpenGL
    4.4和NVIDIA CUDA。
- en: 'The following diagram shows the architecture for vDGA:'
  id: totrans-468
  prefs: []
  type: TYPE_NORMAL
  zh: 以下图示展示了vDGA的架构：
- en: '![](img/13660d3c-57e2-4c16-a4d3-8c75c8ecf8cd.png)'
  id: totrans-469
  prefs: []
  type: TYPE_IMG
  zh: '![](img/13660d3c-57e2-4c16-a4d3-8c75c8ecf8cd.png)'
- en: The vDGA solution makes use of a feature called **VMDirectPath I/O pass-through**,
    sometimes referred to as **PCI pass-through**, which allows the virtual desktop
    machine to pass through the hypervisor layer and directly access the hardware
    in the host server. In this case, the hardware in question is the NVIDIA GPU cards.
  id: totrans-470
  prefs: []
  type: TYPE_NORMAL
  zh: vDGA解决方案利用了一项名为**VMDirectPath I/O直通**的功能，有时也被称为**PCI直通**，它允许虚拟桌面机绕过虚拟化管理程序层，直接访问主机服务器中的硬件。在这种情况下，所涉及的硬件是NVIDIA
    GPU卡。
- en: As a VDI Desktop is mapped directly to a GPU on a one-to-one basis, you cannot
    use vSphere features such as HA, DRS, or vMotion.
  id: totrans-471
  prefs: []
  type: TYPE_NORMAL
  zh: 由于VDI桌面与GPU之间是按一对一方式映射的，因此无法使用vSphere的功能，如HA、DRS或vMotion。
- en: How many virtual desktops are supported with vDGA?
  id: totrans-472
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: vDGA支持多少台虚拟桌面？
- en: Unlike vSGA, which is limited by the amount of memory on the GPU card, vDGA
    is limited purely by the number of GPUs or GRID cards you can physically fit into
    the host server. This is dependent on your server vendor and what they support.
  id: totrans-473
  prefs: []
  type: TYPE_NORMAL
  zh: 与vSGA不同，vSGA受限于GPU卡上的内存数量，而vDGA仅受限于你可以物理安装在主机服务器中的GPU或GRID卡的数量。这取决于你的服务器供应商及其支持的硬件。
- en: Server vendors offer NVIDIA GRID-enabled servers that are prebuilt, and therefore
    this technology is only available from the OEM channel. The primary reason is
    that servers require additional power and cooling components to drive the GRID
    cards.
  id: totrans-474
  prefs: []
  type: TYPE_NORMAL
  zh: 服务器供应商提供启用了 NVIDIA GRID 的预构建服务器，因此这种技术只能通过 OEM 渠道获得。主要原因是服务器需要额外的电力和冷却组件来驱动
    GRID 卡。
- en: For example, an NVIDIA GRID K2 GPU card has two GPUs on board, which would mean
    that you can allocate four virtual desktop machines to this card. Depending on
    your server hardware platform, you could install more than one card, thereby increasing
    the number of users that have access to a hardware-enabled GPU in their virtual
    desktop.
  id: totrans-475
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，一张 NVIDIA GRID K2 GPU 卡上有两个 GPU，这意味着您可以将四个虚拟桌面机器分配给这张卡。根据您的服务器硬件平台，您可以安装多个卡，从而增加使用硬件启用
    GPU 的虚拟桌面用户数量。
- en: vDGA-supported graphics cards
  id: totrans-476
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: vDGA 支持的显卡
- en: 'The following are some of the GPU cards that are supported with vDGA:'
  id: totrans-477
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是一些与 vDGA 兼容的 GPU 卡：
- en: NVIDIA GRID, NVIDIA Tesla, and NVIDIA Quadro
  id: totrans-478
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: NVIDIA GRID、NVIDIA Tesla 和 NVIDIA Quadro
- en: AMD FirePro
  id: totrans-479
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: AMD FirePro
- en: 'For the latest compatibility guide and supported graphics cards, please click
    on the following link: [http://www.vmware.com/resources/compatibility/search.php?deviceCategory=vdga](http://www.vmware.com/resources/compatibility/search.php?deviceCategory=vdga).'
  id: totrans-480
  prefs: []
  type: TYPE_NORMAL
  zh: 有关最新的兼容性指南和支持的显卡，请点击以下链接：[http://www.vmware.com/resources/compatibility/search.php?deviceCategory=vdga](http://www.vmware.com/resources/compatibility/search.php?deviceCategory=vdga)。
- en: vGPU
  id: totrans-481
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: vGPU
- en: In the previous sections, we have talked about two different models for delivering
    high-end graphics. However, there are a couple of limitations to each of these
    solutions.
  id: totrans-482
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的章节中，我们讨论了两种提供高端图形的不同模型。然而，这些解决方案各自存在一些限制。
- en: With vSGA, you get the scalability in terms of the number of users that can
    use the GPU card; however, because it does not use the native driver provided
    by the GPU vendor, then some of the ISVs will not certify their applications running
    on this solution. They would need to certify the VMware SVGA driver, as that's
    the driver that's used.
  id: totrans-483
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 vSGA 时，您可以获得在用户数量上的扩展性，这些用户可以使用 GPU 卡；然而，由于它不使用 GPU 供应商提供的原生驱动程序，因此一些 ISV
    不会认证其应用程序在此解决方案上运行。他们需要认证 VMware SVGA 驱动程序，因为这是使用的驱动程序。
- en: So, the answer to tackle the ISV support issue is to use vDGA, which does use
    the native GPU vendor's graphics driver, but now you are limited in terms of scalability
    and the high cost. Having a virtual desktop machine dedicated to a GPU, with only
    a handful of GPUs available in each host server would make for quite an expensive
    solution. Having said that, there may be a use case where that would be the correct
    solution.
  id: totrans-484
  prefs: []
  type: TYPE_NORMAL
  zh: 所以，解决 ISV 支持问题的答案是使用 vDGA，它使用了原生 GPU 供应商的图形驱动程序，但现在在扩展性和高成本方面存在限制。将虚拟桌面机器专用给
    GPU，并且每个主机服务器中只有少量的 GPU，这会导致一个非常昂贵的解决方案。尽管如此，也可能有某些应用场景适合这种解决方案。
- en: What we need is a solution that is the best of both worlds; a solution that
    takes the shared GPU approach for scalability, yet uses the native graphics drivers.
    That solution is called vGPU, and was launched as part of Horizon 6 and the 6.1
    release.
  id: totrans-485
  prefs: []
  type: TYPE_NORMAL
  zh: 我们需要的是一种兼顾两全的解决方案；既能够利用共享 GPU 的扩展性，又能使用原生图形驱动程序。这种解决方案称为 vGPU，并作为 Horizon 6
    和 6.1 版本的一部分发布。
- en: 'The following diagram shows the architecture for vGPU:'
  id: totrans-486
  prefs: []
  type: TYPE_NORMAL
  zh: 下图展示了 vGPU 的架构：
- en: '![](img/167e6018-2e9d-424a-b1d7-4869560d1a6b.png)'
  id: totrans-487
  prefs: []
  type: TYPE_IMG
  zh: '![](img/167e6018-2e9d-424a-b1d7-4869560d1a6b.png)'
- en: In this model, we have the native NVIDIA driver installed in the virtual desktop
    machines, which then has direct access to the NVIDIA GRID card in the host servers.
    The GPU is then effectively virtualized and time-sliced, with each virtual desktop
    machine having a slice of that time.
  id: totrans-488
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种模型中，我们在虚拟桌面机器中安装了原生 NVIDIA 驱动程序，然后该机器可以直接访问主机服务器中的 NVIDIA GRID 卡。GPU 被有效地虚拟化并进行时间切片，每个虚拟桌面机器都能分到这一段时间。
- en: vGPU is only available with VMware vSphere 6 and Horizon View 6.1 and later.
  id: totrans-489
  prefs: []
  type: TYPE_NORMAL
  zh: vGPU 仅在 VMware vSphere 6 和 Horizon View 6.1 及更高版本中可用。
- en: How many virtual desktops are supported with vGPU?
  id: totrans-490
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: vGPU 支持多少个虚拟桌面？
- en: 'With vGPU, the number of supported users/virtual desktop machines is based
    on different profiles. These profiles are detailed in the following diagram and
    give you the number of users, number of supported monitors, and so on:'
  id: totrans-491
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 vGPU 时，支持的用户/虚拟桌面机器数量基于不同的配置文件。这些配置文件在下图中有详细说明，显示了支持的用户数量、支持的显示器数量等：
- en: '![](img/374dfd12-544d-4507-8c26-0aa812132f2a.png)'
  id: totrans-492
  prefs: []
  type: TYPE_IMG
  zh: '![](img/374dfd12-544d-4507-8c26-0aa812132f2a.png)'
- en: 'As with the vDGA and vSGA solutions, you need to check that you have the correct
    supported hardware. In addition, you should also check that your applications
    are supported in these configurations. You can find the current list of supported
    applications by following the link to the NVIDIA website: [http://www.nvidia.com/object/grid-isv-tested-applications.html](http://www.nvidia.com/object/grid-isv-tested-applications.html).'
  id: totrans-493
  prefs: []
  type: TYPE_NORMAL
  zh: 与vDGA和vSGA解决方案一样，你需要检查是否具有正确支持的硬件。此外，你还应检查你的应用程序是否在这些配置中得到支持。你可以通过以下链接访问NVIDIA官网，查找当前支持的应用程序列表：[http://www.nvidia.com/object/grid-isv-tested-applications.html](http://www.nvidia.com/object/grid-isv-tested-applications.html)。
- en: Unified communications support
  id: totrans-494
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 统一通信支持。
- en: Like high-end graphics, if we had a conversation about running a unified communications
    solution or VoIP session on a VDI desktop a couple of years ago, I would have
    described it as Kryptonite for VDI! Although it technically works, the first call
    might have acceptable performance, but adding more users would ultimately bring
    the servers to their knees with the amount of traffic generated and resources
    required to conduct the calls. Eventually, the experience would have become completely
    unusable. Unified communications was not a good use case for VDI.
  id: totrans-495
  prefs: []
  type: TYPE_NORMAL
  zh: 就像高端图形处理一样，如果我们几年前讨论在VDI桌面上运行统一通信解决方案或VoIP会话，我会把它描述为VDI的致命克星！尽管技术上可以运行，第一次通话可能表现尚可，但增加更多用户最终会导致服务器在处理生成的流量和进行通话所需的资源时崩溃。最终，体验会变得完全不可用。统一通信并不是VDI的理想用例。
- en: However, this has all changed, and you can now happily use a unified communications
    solution with your virtual desktop. There was always a great use case to deploy
    unified communications with VDI; it's just that it never worked! Take, for example,
    a call center environment. with the ability to provide a DR solution or allow
    users to work from home during a snowy day and still be able to make and answer
    calls as if they were in the office.
  id: totrans-496
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，这一切都发生了变化，现在你可以愉快地在虚拟桌面上使用统一通信解决方案。始终存在一个很好的用例来将统一通信与VDI部署结合；只是它以前从未能正常工作！举例来说，一个呼叫中心环境，能够提供灾难恢复解决方案，或者允许用户在雪天时在家工作，仍然能够像在办公室一样拨打和接听电话。
- en: 'So, why didn''t it work? Quite simply, because when you placed a VoIP call
    from your virtual desktop, the call would go over the PCoIP protocol, causing
    bandwidth issues and making your desktop perform slowly, and placing an additional
    load on the servers in having to process the call. This is detailed in the following
    diagram, which shows how it was before and the result afterward:'
  id: totrans-497
  prefs: []
  type: TYPE_NORMAL
  zh: 那么，为什么以前不行呢？很简单，因为当你从虚拟桌面拨打VoIP电话时，通话会通过PCoIP协议进行，从而导致带宽问题，使得桌面性能变慢，并且给服务器增加额外的负载，必须处理通话。这在下图中有详细说明，展示了以前的情况和之后的结果：
- en: '![](img/f1e051d8-deb7-4453-8718-a91e9ac57d8d.png)'
  id: totrans-498
  prefs: []
  type: TYPE_IMG
  zh: '![](img/f1e051d8-deb7-4453-8718-a91e9ac57d8d.png)'
- en: 'To solve these issues, and to enable a working solution, VMware concentrated
    on three key areas and delivered the following new features/enhancements:'
  id: totrans-499
  prefs: []
  type: TYPE_NORMAL
  zh: 为了解决这些问题并实现可行的解决方案，VMware专注于三个关键领域，并提供了以下新功能/增强功能：
- en: Offloading media processing to the client device by removing the load that was
    placed on the server in the data center
  id: totrans-500
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将媒体处理卸载到客户端设备，通过移除数据中心服务器的负载。
- en: Optimized point-to-point media delivery, eliminating the hairpin effect
  id: totrans-501
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 优化的点对点媒体传输，消除回环效应。
- en: High-quality UC VoIP and video with QoS
  id: totrans-502
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 高质量的统一通信VoIP和视频，带有QoS保障。
- en: How do unified communications work now?
  id: totrans-503
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 现在统一通信是如何工作的？
- en: A remote procedure call utilizes a virtual channel to allow the different components
    of a softphone, running on a VDI desktop, to communicate and pass voice and video
    data to other softphone components in the client device. These out-of-band communications.
  id: totrans-504
  prefs: []
  type: TYPE_NORMAL
  zh: 远程过程调用利用虚拟通道，使得运行在VDI桌面上的软电话不同组件之间能够进行通信，并将语音和视频数据传输到客户端设备中的其他软电话组件。这些是带外通信。
- en: The call-control stack (a **SIP stack** if using SIP signaling) communicates
    with the call-control server or call manager to register or establish the call.
  id: totrans-505
  prefs: []
  type: TYPE_NORMAL
  zh: 呼叫控制栈（如果使用SIP信令，则为**SIP栈**）与呼叫控制服务器或呼叫管理器进行通信，以注册或建立通话。
- en: A media engine on the client device performs the encoding and decoding of voice
    and video streams into native voice and video codecs and then streams the VoIP/video
    stream directly to the other endpoint (as directed by the call manager server),
    therefore setting up a peer-to-peer call and not going through the data center.
    This now eliminates the hairpin effect.
  id: totrans-506
  prefs: []
  type: TYPE_NORMAL
  zh: 客户端设备上的媒体引擎执行语音和视频流的编码与解码，转换成本地的语音和视频编解码器，然后将 VoIP/视频流直接传输到另一个终端（按照呼叫管理服务器的指示），从而建立点对点通话，避免通过数据中心。这消除了回拨效应。
- en: Currently, VMware supports solutions from Cisco, Mittal, Avaya, and Microsoft
    Lync 2013\. We will cover the **Microsoft Skype (Lync)** solution in the next
    section.
  id: totrans-507
  prefs: []
  type: TYPE_NORMAL
  zh: 目前，VMware 支持来自 Cisco、Mittal、Avaya 和 Microsoft Lync 2013 的解决方案。我们将在下一节中讨论 **Microsoft
    Skype (Lync)** 解决方案。
- en: Support for Microsoft Skype
  id: totrans-508
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 支持 Microsoft Skype
- en: 'Based on what we just discussed, VMware Horizon now supports Microsoft Skype
    with the Horizon Virtualization Pack for Skype for Business. This includes full
    support for VoIP and video. The following diagram shows the process of how the
    client works:'
  id: totrans-509
  prefs: []
  type: TYPE_NORMAL
  zh: 根据我们刚才讨论的内容，VMware Horizon 现在支持 Microsoft Skype，并通过 Horizon Virtualization Pack
    for Skype for Business 提供完整支持，包括对 VoIP 和视频的全面支持。下图展示了客户端工作过程：
- en: '![](img/39d67b6b-0d4d-4fb7-9049-a89dc9682ec3.png)'
  id: totrans-510
  prefs: []
  type: TYPE_IMG
  zh: '![](img/39d67b6b-0d4d-4fb7-9049-a89dc9682ec3.png)'
- en: To enable Skype, you need to ensure that the Horizon Virtualization Pack for
    Skype for Business is installed on the endpoint device, along with the Horizon
    Client and Microsoft Skype client. VMware has implemented Microsoft's **Dynamic
    Virtual Channels** (**DVC**) inside the PCoIP protocol to enable this feature.
    DVC provides the communication path between the virtual desktop machine and the
    client endpoint.
  id: totrans-511
  prefs: []
  type: TYPE_NORMAL
  zh: 要启用 Skype，您需要确保在终端设备上安装了 Horizon Virtualization Pack for Skype for Business，并且同时安装了
    Horizon 客户端和 Microsoft Skype 客户端。VMware 在 PCoIP 协议内部实现了 Microsoft 的 **动态虚拟通道**（**DVC**）以启用此功能。DVC
    提供虚拟桌面机器与客户端终端之间的通信路径。
- en: 'There are some limitations to the solution that should be mentioned:'
  id: totrans-512
  prefs: []
  type: TYPE_NORMAL
  zh: 解决方案有一些限制，需要提到：
- en: Tuning pages are not available for the audio device and the video device.
  id: totrans-513
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 不支持为音频设备和视频设备调节页面。
- en: Multi-view video is not supported.
  id: totrans-514
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 不支持多视角视频。
- en: The recording of conversations is not supported.
  id: totrans-515
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 不支持对话录音功能。
- en: Call delegation is not supported.
  id: totrans-516
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 不支持呼叫代理功能。
- en: The response group agent anonymization feature is not supported.
  id: totrans-517
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 不支持响应组代理匿名化功能。
- en: Joining meetings anonymously is not supported.
  id: totrans-518
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 不支持匿名加入会议。
- en: Using the Skype for Business VDI plugin with a Skype for Business Phone Edition
    device is not supported.
  id: totrans-519
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 不支持将 Skype for Business VDI 插件与 Skype for Business Phone Edition 设备一起使用。
- en: Real-Time Audio-Video (RTAV)
  id: totrans-520
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 实时音视频（RTAV）
- en: Following on from the unified communications support, the next question we hear
    concerns support for plugging in a USB webcam and using it with a virtual desktop.
  id: totrans-521
  prefs: []
  type: TYPE_NORMAL
  zh: 在统一通信支持的基础上，我们接下来听到的问题是关于如何插入 USB 网络摄像头并在虚拟桌面中使用它的支持。
- en: The issue
  id: totrans-522
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 问题
- en: Like unified communications and VoIP, using a webcam, or using audio in and
    audio out on a virtual desktop machine was not initially supported due to the
    high bandwidth requirements these types of devices require, thereby resulting
    in poor performance. Any redirection of these types of devices was previously
    handled with the USB redirection feature of the PCoIP protocol.
  id: totrans-523
  prefs: []
  type: TYPE_NORMAL
  zh: 与统一通信和 VoIP 类似，由于这类设备对带宽的高需求，最初不支持在虚拟桌面机器上使用网络摄像头或进行音频输入和输出，这会导致性能较差。之前，任何此类设备的重定向都是通过
    PCoIP 协议的 USB 重定向功能来处理的。
- en: This is how audio-in used to work, but audio-in using a 3.5 mm jack socket did
    not work at all. Audio-out did work when using the PCoIP audio redirection feature,
    which was much better than using USB redirection. This was because the client
    system was unable to split a USB audio device, which resulted in the audio-out
    functionality remaining local, while the audio-in got redirected. This implies
    that using a USB headset in a VoIP solution would require the entire headset (audio-in
    and audio-out) to be forwarded to the guest.
  id: totrans-524
  prefs: []
  type: TYPE_NORMAL
  zh: 这是音频输入的工作方式，但使用 3.5mm 插孔的音频输入完全无法工作。使用 PCoIP 音频重定向功能时，音频输出是有效的，这比使用 USB 重定向要好得多。因为客户端系统无法拆分
    USB 音频设备，导致音频输出保持本地，而音频输入被重定向。这意味着在 VoIP 解决方案中使用 USB 耳机时，需要将整个耳机（音频输入和音频输出）都转发给客户端。
- en: How does RTAV fix this issue?
  id: totrans-525
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: RTAV 如何解决这个问题？
- en: '**RTAV** does not use a USB to forward audio and webcam devices. Instead, the
    USB devices remain connected to the local client, and the audio and images are
    taken from the local device. Audio and image data are encoded and delivered to
    the guest virtual desktop machine, where they are then decoded. VMware installs
    a virtual webcam and a virtual microphone virtual desktop machine. These devices
    are used to play back the audio and video. You will see these device entries in
    the device manager of your virtual desktop machine.'
  id: totrans-526
  prefs: []
  type: TYPE_NORMAL
  zh: '**RTAV** 不使用 USB 转发音频和摄像头设备。相反，USB 设备保持连接到本地客户端，音频和图像从本地设备提取。音频和图像数据被编码后传送到来宾虚拟桌面机器，在那里解码。VMware
    安装了一个虚拟摄像头和一个虚拟麦克风虚拟桌面机器。这些设备用于回放音频和视频。你将会在虚拟桌面机器的设备管理器中看到这些设备条目。'
- en: 'RTAV can support the following:'
  id: totrans-527
  prefs: []
  type: TYPE_NORMAL
  zh: RTAV 支持以下功能：
- en: Connecting webcams and audio devices simultaneously, used for VoIP-based video
    conferencing apps such as Skype.
  id: totrans-528
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 同时连接摄像头和音频设备，用于基于 VoIP 的视频会议应用，如 Skype。
- en: Audio-in only (no video) for VoIP (voice-only) apps
  id: totrans-529
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 仅音频输入（无视频）用于 VoIP（仅语音）应用
- en: Webcam only; used for webcam monitoring type apps (CCTV, for example), and taking
    photos
  id: totrans-530
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 仅摄像头；用于摄像头监控类应用（例如 CCTV）和拍照
- en: URL Content Redirection
  id: totrans-531
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: URL 内容重定向
- en: The **URL Content Redirection** feature allows you to configure a URL to either
    open on a local browser on the endpoint device, or open on the virtual desktop
    machine. Which content opens in which is configured by using a **GPO**.
  id: totrans-532
  prefs: []
  type: TYPE_NORMAL
  zh: '**URL 内容重定向**功能允许你配置 URL，以便在终端设备的本地浏览器中打开，或在虚拟桌面机器上打开。哪个内容在何处打开是通过使用**GPO**进行配置的。'
- en: The use case for doing this is to separate internal browsing from internal browsing.
    It may be that if you want to look at secure content, then you would use the browser
    on the virtual desktop machine, since, if the data doesn't leave the data center,
    then any other browsing can happen locally. Another case may be that you want
    to limit bandwidth usage into the data center, and if users are browsing heavy
    content, they can use their local internet connection.
  id: totrans-533
  prefs: []
  type: TYPE_NORMAL
  zh: 这样做的使用场景是将内部浏览与外部浏览分开。如果你想查看安全内容，可以使用虚拟桌面机器上的浏览器，因为如果数据不离开数据中心，其他浏览活动可以在本地进行。另一个场景可能是你希望限制进入数据中心的带宽使用，如果用户浏览的是大容量内容，他们可以使用本地的互联网连接。
- en: 'There are two types of URL that you can configure for redirection:'
  id: totrans-534
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以配置两种类型的 URL 进行重定向：
- en: URLs that a user enters into the address bar of the browser
  id: totrans-535
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 用户在浏览器地址栏中输入的 URL
- en: Links in an application, such as Outlook or Word, that users can click
  id: totrans-536
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 应用程序中的链接，例如 Outlook 或 Word，用户可以点击的链接
- en: Horizon clients
  id: totrans-537
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Horizon 客户端
- en: 'The Horizon client is basically where your virtual desktop machine''s screen
    is decoded and displayed on an endpoint device. There are two distinct types of
    Horizon Clients: a software-based version, which is installed on the user''s endpoint
    device, and a hardware-based version, which uses zero or thin clients.'
  id: totrans-538
  prefs: []
  type: TYPE_NORMAL
  zh: Horizon 客户端基本上是解码并在终端设备上显示虚拟桌面机器屏幕的地方。Horizon 客户端有两种不同的类型：一种是基于软件的版本，安装在用户的终端设备上；另一种是基于硬件的版本，使用零客户端或瘦客户端。
- en: We will cover the View client options in [Chapter 12](e1944fcc-6ae9-4db7-b51b-db75e37e01ab.xhtml),
    *Horizon Client Options*.
  id: totrans-539
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将在[第 12 章](e1944fcc-6ae9-4db7-b51b-db75e37e01ab.xhtml)中讲解 View 客户端选项，*Horizon
    客户端选项*。
- en: Summary
  id: totrans-540
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we discussed the Horizon View architecture and the different
    components that make up the complete solution. We covered key technologies, such
    as how linked clones and instant clones work to optimize storage, and then we
    introduced some of the features that go toward delivering a great end user experience,
    such as delivering high-end graphics, unified communications, profile management,
    and how the protocols deliver the desktop to the end user.
  id: totrans-541
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们讨论了 Horizon View 架构及构成完整解决方案的不同组件。我们介绍了关键技术，比如如何通过链接克隆和即时克隆来优化存储，然后我们介绍了一些旨在提供出色终端用户体验的功能，如提供高端图形、统一通信、配置文件管理，以及协议如何将桌面交付给终端用户。
- en: Now that you understand all of these features and components, how they work,
    and how they fit into the overall solution, in the upcoming chapters, we will
    be taking a deeper look at how to configure them.
  id: totrans-542
  prefs: []
  type: TYPE_NORMAL
  zh: 现在你已经理解了所有这些功能和组件，它们是如何工作的，以及它们如何融入整体解决方案。在接下来的章节中，我们将深入探讨如何配置它们。
