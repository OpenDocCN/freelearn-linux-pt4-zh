<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Installing and Configuring Horizon 7 - Part 2</h1>
                </header>
            
            <article>
                
<p>In the previous part of this chapter, we installed the core Horizon View Connection Server. Now, in this second part, we are going to continue building out the environment and install the other server roles and components, starting with the Replica Server.</p>
<p>In this chapter, we will cover the following topics:</p>
<ul>
<li>Installing a Horizon View Replica Server</li>
<li>Installing a Security Server</li>
<li>Installing an Enrollment Server</li>
<li>Configuring the Cloud Pod Architecture</li>
<li>Configuring View for GPU-enabled virtual desktops</li>
</ul>
<p class="mce-root"/>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Installing a Horizon View Replica Server</h1>
                </header>
            
            <article>
                
<p>In this section, we are going to deploy a second View Connection Server. Additional View Connection Servers are referred to as Replica Servers. This is due to the nature in which View shares its configurations between multiple View Connection Servers using the ADAM database.</p>
<p>Additional Connection Servers are generally deployed for availability reasons, as discussed in the previous chapters. For test purposes, you could roll out a single View Connection Server.</p>
<p>This second instance of the Connection Server is going to be installed on the virtual machine with the hostname <kbd>hzn7-cs2.pvolab.com</kbd>. This was built at the start of the previous chapter. It will also need a static IP address assigned to it and needs to be joined to the domain. <span>Since the</span> screenshots <span>are almost identical to those from the first Connection Server install, we will only highlight and show the differences in this section:</span></p>
<ol>
<li>Open a console to the <kbd>hzn7-cs2</kbd> virtual machine, and then locate the Horizon View installation software. In the example lab, this was saved to a shared folder on the Domain Controller.</li>
<li>Launch the <kbd>VMware-Horizon-Connection-Server-x86_64-7.6.0-9823717</kbd> file to start the installation. This is the same installer application that you used for the first Connection Server, but it will be configured differently to reflect the fact that this is a Replica Server.</li>
<li>If you see the <strong><span class="packt_screen">Open File - Security Warning</span></strong> message, click the <span class="packt_screen">Run</span> button.</li>
<li>You will now see the <span class="packt_screen">Welcome to the Installation Wizard for VMware Horizon 7 Connection Server</span> screen.</li>
<li>Click the <span class="packt_screen">Next &gt;</span> button to start the installation. You will now see the <span class="packt_screen">License Agreement</span> screen.</li>
<li>Click the radio button for <span class="packt_screen">I accept the terms in the license agreement</span>, and then click the <span class="packt_screen"><strong>Next &gt;</strong></span> button. You will now see the <span class="packt_screen">Destination Folder</span> screen.</li>
<li>Leave the folder with its default settings and then click the <span class="packt_screen">Next &gt;</span> button to continue.</li>
</ol>
<ol start="8">
<li>You will now see the <span class="packt_screen">Installation Options</span> screen, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/46603283-87f3-408c-99be-2339f8fe5439.png" style=""/></div>
<ol start="9">
<li>As this is the second Connection Server, or Replica Server, from the list of <span class="packt_screen">Horizon 7 Connection Server</span> instances, select the option for <span class="packt_screen">Horizon 7 Replica Server</span> from the list (<strong>1</strong>).</li>
<li>Like before, we are going to install HTML access, so check the box for <span class="packt_screen">Install HTML Access</span> (<strong>2</strong>). This will allow users to access their desktops from an HTML 5 web browser. This setting should match that of the original Connection Server so that this server is capable of delivering the same features and functionality. Don't forget that a Replica Server could take over should the first Connection Server be unavailable.</li>
</ol>
<ol start="11">
<li>The final option on this screen is to select which IP protocol to use: either <span class="packt_screen">IPv4</span> or <span class="packt_screen">IPv6</span>. In the example lab, select the <span class="packt_screen">IPv4</span> option (<strong>3</strong>). Again, as a reminder, you cannot mix the IP protocol version between the different View server instances.</li>
<li>Click the <span class="packt_screen">Next &gt;</span> button to continue.</li>
</ol>
<ol start="13">
<li>You will now see the <span class="packt_screen">Source Server</span> configuration screen, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/d45a5113-41a5-47e4-8c17-5abb4725ed64.png" style=""/></div>
<ol start="14">
<li>The Source Server is the Connection Server that you want to use as the source to replicate from, so in the <span class="packt_screen">Server</span> box (<strong>4</strong>), type in the address of the first Connection Server. In the example lab, this is <kbd>hzn7-cs1.pvolab.com</kbd>.</li>
<li>Click the <span class="packt_screen">Next &gt;</span> button to continue. You will now see the <span class="packt_screen">Firewall Configuration</span> screen.</li>
<li>Click the radio button for <strong><span class="packt_screen">Configure Windows Firewall automatically</span></strong>, and then click the <span class="packt_screen">Next &gt;</span> button to continue. You will now see the <span class="packt_screen">Ready to Install the Program</span> screen.</li>
</ol>
<ol start="17">
<li>Click the <span class="packt_screen">Install</span> button to start the process.</li>
<li>The install will start and you will see the program filed install, and also the status of the initial replication. Once the Replica Server has been installed, you will see the <span class="packt_screen">Installer Completed</span> screen. Click the <span class="packt_screen">Finish</span> button on this screen to close the installer.</li>
</ol>
<ol start="19">
<li>You will now see the icon on the desktop for the <span class="packt_screen">Horizon 7 Administrator</span> console. To check that the Replica Server has been installed correctly and that it is up and running, log in to the <span class="packt_screen">View Administrator</span>.</li>
<li>From the <span class="packt_screen">Inventory</span> menu, expand the <span class="packt_screen">View Configuration</span> section, and then click on <span class="packt_screen">Servers</span> (<strong>5</strong>). Click the <span class="packt_screen">Connection Servers</span> tab (<strong>6</strong>). You will now see the Replica Server <kbd>hzn7-cs2</kbd> listed (<strong>7</strong>), as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/02b0e666-0987-4fdc-b2a4-11a48ef3132e.png"/></div>
<p>You have successfully installed and configured the Replica Server.</p>
<p>Now that you have two Connection Servers, don't forget that Horizon View, as standard, includes no method to load balance Connection Servers or Security Servers. As such, you should work with the relevant documentation from your load balancing manufacturer to configure your load balancers to work with your View Connection Servers as required. This allows users to be load balanced for availability and scale.</p>
<p>In the next section, we are going to install a Horizon View Security Server.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Installing a Security Server</h1>
                </header>
            
            <article>
                
<p>The next component that we are going to install is the Security Server so that you can allow external access to your end users.</p>
<p>The Security Server is another instance of the Connection Server and is going to be installed on the virtual machine with the hostname <kbd>hzn7-sec.pvolab.com.</kbd> This was built in the previous chapter. It will also need a static IP address assigned to it, but this should not be joined to the domain.</p>
<div class="packt_infobox">Don't forget that a Security Server has a one-to-one relationship with a Connection Server. If you wish to roll out a number of Security Servers, you will want to have multiple View Connection Servers.</div>
<p>It is also recommended that you have dedicated external View Connection Servers ready to pair with your Security Servers and separate View Connection Servers for internal connections. This will allow you to specify which users can access desktops from outside the organization by using the tagging functionality, which we will discuss later in this chapter and in <a href="d44c9a7b-bcae-4758-a857-197be388a4be.xhtml">Chapter 8</a>, <em>Configuring and Managing Desktop Pools - Part 1</em>.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Preparing View Administrator for the Security Server install</h1>
                </header>
            
            <article>
                
<p>Before we start with the installation, we need to prepare the Connection Server for the Security Server by creating a pairing password. This password will be used to connect the two servers together securely. It's the same kind of process you would use to pair your Bluetooth cell phone to the hands-free system in your car:</p>
<ol>
<li>Log in to the View Administrator. You will then see the main configuration screen, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/d6cd5ee8-b53e-4e3c-a0ac-20fe2bb84e5d.png"/></div>
<ol start="2">
<li>From the <span class="packt_screen">Inventory</span> menu, expand the <span class="packt_screen">View Configuration</span> section, and then click on <span class="packt_screen">Servers</span> (<strong>1</strong>). Now, click the <span class="packt_screen">Connection Servers</span> tab (<strong>2</strong>). You will then see the <span class="packt_screen">Connection Server</span> within your environment. In the example lab, we have two, <kbd>hzn7-cs1</kbd> and <kbd>hzn7-cs2</kbd>.</li>
<li>Click to select the Connection Server you want to pair the Security Server with. In the example lab, we are going to pair it with the Connection Server called <kbd>hzn7-cs2</kbd> (<strong>3</strong>).</li>
</ol>
<ol start="4">
<li>Now, click the <span class="packt_screen">More Commands</span> button (<strong>4</strong>) and select the option for <span class="packt_screen">Specify Security Server Pairing Password…</span> (<strong>5</strong>). You will now see the <span class="packt_screen">Specify Security Server Pairing Password</span> screen, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/7f5140fa-f332-4c8c-9a7e-251401d180c8.png" style=""/></div>
<ol start="5">
<li>In the <span class="packt_screen">Pairing password</span> (<strong>6</strong>) box, type in the password you want to use for pairing. You will need to remember this password as you will enter it again during the installation of the Security Server. Type the password again in the <span class="packt_screen">Confirm password</span> box (<strong>7</strong>).</li>
</ol>
<ol start="6">
<li>In the <span class="packt_screen">Password timeout</span> box (<strong>8</strong>), enter a time for this password to be valid for. Make sure that the time you set will give you enough time to install the Security Server. This will save you from having to come back and set up a new pairing password. From the dropdown box (<strong>9</strong>), you can also choose whether the time to live for the password is in hours or minutes.</li>
<li>Click <span class="packt_screen">OK</span> once you have configured the pairing password.</li>
<li>You can now go ahead and start the installation of the Security Server.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Security Server software installation</h1>
                </header>
            
            <article>
                
<p>With the prerequisites in place and the pairing password set, we can now install the Security Server. <span>As the</span> screenshots <span>are almost identical to those from the previous Connection Server installs, we will only highlight and show the differences in this section:</span></p>
<ol>
<li>Open a console to the <kbd>hzn7-sec.pvolab.com</kbd> virtual machine, and then locate the Horizon View installation software. In the example lab, this was saved to a shared folder on the Domain Controller.</li>
<li>Launch the <kbd>VMware-Horizon-Connection-Server-x86_64-7.6.0-9823717</kbd> file to start the installation. This is the same installer application that you used for the first Connection Server, but it will be configured differently to reflect the fact that this is a Security Server.</li>
<li>If you see the <span class="packt_screen">Open File - Security Warning</span> message, click the <span class="packt_screen">Run</span> button.</li>
<li>You will now see the <span class="packt_screen">Welcome to the Installation Wizard for VMware Horizon 7 Connection Server</span> screen.</li>
<li>Click the <span class="packt_screen">Next &gt;</span> button to start the installation. You will now see the <span class="packt_screen">License Agreement</span> screen.</li>
<li>Click the radio button for <span class="packt_screen">I accept the terms in the license agreement</span>, and then click the <span class="packt_screen">Next &gt;</span> button. You will now see the <span class="packt_screen">Destination Folder</span> screen.</li>
<li>Leave the folder as the default setting and then click the <span class="packt_screen">Next &gt;</span> button to continue.</li>
</ol>
<ol start="8">
<li>You will now see the <span class="packt_screen">Installation Options</span> screen, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/3660595f-3d27-40e6-9b8b-c31da40de795.png" style=""/></div>
<ol start="9">
<li>As this is the third Connection Server instance, or Security Server, from the list of <span class="packt_screen">Horizon 7 Connection Server</span> instances, select the option for <span class="packt_screen">Horizon 7 Security Server</span> from the list (<strong>10</strong>).</li>
<li>The final option on this screen is to select which IP protocol to use: either <span class="packt_screen">IPv4</span> or <span class="packt_screen">IPv6</span>. In the example lab, select the <span class="packt_screen">IPv4</span> option (<strong>11</strong>). Again, as a reminder, you cannot mix the IP protocol version between the different View Server instances.</li>
<li>Click the <span class="packt_screen">Next &gt;</span> button to continue. You will now see the <span class="packt_screen">Paired Horizon 7 Connection Server</span> screen, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/ce5c44f0-85b1-4cc9-aace-4493d6d8993f.png" style=""/></div>
<ol start="12">
<li>In the <span class="packt_screen">Server</span> box (<strong>12</strong>), enter the details of the Connection Server to pair with. In the example lab, we are going to pair with the server called <kbd>hzn7-cs2.pvolab.com</kbd>, which is the Replica Server we set up in the previous section.</li>
<li>Click the <span class="packt_screen">Next &gt;</span> button to continue. You will now see the <span class="packt_screen">Paired Horizon 7 Connection Server Password</span> screen:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/99926b52-e21a-4bda-bba2-a4b5f262a3ad.png" style=""/></div>
<ol start="14">
<li>In the <span class="packt_screen">Password</span> box (<strong>13</strong>), type in the pairing password that you specified when you configured it in the View Administrator.</li>
<li>Click the <span class="packt_screen">Next &gt;</span> button to continue.</li>
<li>You will now see the <span class="packt_screen">Horizon 7 Security Server Configuratio</span><span class="packt_screen">n</span>, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/886c3449-d220-453b-9c7c-474453509b3f.png" style=""/></div>
<ol start="17">
<li>On this screen, you can specify the Security Server settings. First, in the <span class="packt_screen">External URL</span> box (<strong>14</strong>), enter the address that users will use to connect their Horizon client to over an internet connection. In the preceding example, this has been left as the default; however, you would probably want to change this to something more user-friendly.</li>
<li>In the <span class="packt_screen">PCoIP External URL</span> box (<strong>15</strong>), enter the IP address for the external PCoIP connection. Note that, this must contain an IP address rather than a URL, as the box suggests. The address must also have the port suffix added, so in this case, <kbd>:4172</kbd> is the default PCoIP port.</li>
</ol>
<ol start="19">
<li>Finally, in the <span class="packt_screen">Blast External URL</span> box (<strong>16</strong>), enter the address for the Blast protocol. This is used for HTML5 access.</li>
<li>Click the <span class="packt_screen">Next &gt;</span> button to continue. You will now see the <span class="packt_screen">Firewall Configuration</span> screen.</li>
<li>Click the radio button for <span class="packt_screen">Configure Windows Firewall automatically</span>, and then click the <span class="packt_screen">Next &gt;</span> button to continue. You will see the <span class="packt_screen">Ready to Install the Program</span> screen.</li>
<li>Click the <span class="packt_screen">Install</span> button to start the installation process.</li>
<li>Once the Security Server has been installed, you will see the <span class="packt_screen">Installer Completed</span> screen. Click the <span class="packt_screen">Finish</span> button to exit.<br/>
Unlike when we installed the Connection Server and the Replica Server, no Horizon icon is placed on the desktop. The settings are managed using the View Administrator console. However, to check whether the Security Server is installed and running, on the desktop of the Security Server, launch a <span class="packt_screen">Services</span> console, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/0c88fedf-483f-4adb-8da2-2552e88ca136.png"/></div>
<p style="padding-left: 60px">Scroll down until you see the entry for <span class="packt_screen">VMware Horizon 7 Security Server</span> (<strong>17</strong>), and then check that it is running.</p>
<p>You also need to check that the Security Server had registered with the View Administrator. To do this, perform the following steps:</p>
<ol>
<li>From the <span class="packt_screen">Inventory</span> menu, expand the <span class="packt_screen">View Configuration</span> section, and then click on <span class="packt_screen">Servers</span> (<strong>18</strong>). Click the <span class="packt_screen">Security Servers</span> tab (<strong>19</strong>). You will now see the Security Server <kbd>HZN7-SEC</kbd> listed (<strong>20</strong>). This is shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/775293aa-43e7-4fb3-bcc2-0f8b0d5a9720.png"/></div>
<ol start="2">
<li>You have successfully installed and configured a Security Server.</li>
</ol>
<p>As we mentioned earlier, we recommend installing Security Servers in conjunction with dedicated external View Connection Servers so that you can limit access to the virtual desktop machines from external connections by using the tagging functionality.</p>
<p>The first step in achieving this is by tagging your external Connection Servers. To tag a server, perform the following steps:</p>
<ol>
<li>In the View Administrator, from the <span class="packt_screen">Inventory</span> menu, expand the <span class="packt_screen">View Configuration</span> section, and then click on <span class="packt_screen">Servers</span> (<strong>21</strong>). Click the <span class="packt_screen">Connection Servers</span> tab (<strong>22</strong>) and then highlight the Connection Server that is paired with the Security Server for the external connections. In the example lab, this server is called <kbd>HZN7-CS2</kbd> (<strong>23</strong>).</li>
<li>Right-click and then from the contextual menu, click on <span class="packt_screen">Edit…</span> (<strong>24</strong>), as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/025fdfbc-2742-4053-a990-5881f31b34fb.png" style=""/></div>
<ol start="3">
<li>Y<span>ou will now see the</span> <span class="packt_screen">Edit Connection Server Settings</span> <span>screen, as shown in the following screenshot:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/c100782c-5a36-4150-8755-5ca9c896689a.png" style=""/></div>
<ol start="4">
<li>In the <span class="packt_screen">Tags</span> box (<strong>25</strong>), type in the name for this tag. In the example lab, this tag is called <kbd>external</kbd>. This means that only desktop pools that have also been configured with the tab named <kbd>external</kbd> can connect via this Connection Server.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Installing an Enrollment Server</h1>
                </header>
            
            <article>
                
<p>The final component we are going to install is the Enrollment Server.</p>
<p>This FINAL instance of the Connection Server is going to be installed on the virtual machine with the hostname <kbd>hzn7-enrol.pvolab.com.</kbd> This was built in the previous chapter. It will also need a static IP address assigned to it and needs to be joined to the domain. <span>As the</span> screenshots <span>are almost identical to those from the other Connection Server installs, we will only highlight and show the differences in this section:</span></p>
<ol>
<li>Open a console to the <kbd>hzn7-enrol.pvolab.com</kbd> virtual machine, and then locate the Horizon View installation software. In the example lab, this was saved to a shared folder on the Domain Controller.</li>
<li>Launch the <kbd>VMware-Horizon-Connection-Server-x86_64-7.6.0-9823717</kbd> file to start the installation. This is the same installer application that you used for the first Connection Server, but it will be configured differently to reflect the fact that this is a Replica Server.</li>
<li>If you see the <span class="packt_screen">Open File - Security Warning</span> message, click the <span class="packt_screen">Run</span> button.</li>
<li>You will now see the <span class="packt_screen">Welcome to the Installation Wizard for VMware Horizon 7 Connection Server</span> screen.</li>
<li>Click the <span class="packt_screen">Next &gt;</span> button to start the installation. You will now see the <span class="packt_screen">License Agreement</span> screen.</li>
<li>Click the radio button for <span class="packt_screen">I accept the terms in the license agreement</span>, and then click the <span class="packt_screen">Next &gt;</span> button. You will now see the <span class="packt_screen">Destination Folder</span> screen.</li>
<li>Leave the folder as the default setting and then click the <span class="packt_screen">Next &gt;</span> button to continue.</li>
</ol>
<ol start="8">
<li>You will now see the <span class="packt_screen">Installation Options</span> screen, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/a7413715-5569-4014-aed5-87d4493e802d.png" style=""/></div>
<ol start="9">
<li>As this is the final Connection Server instance, or Enrollment Server, from the list of <span class="packt_screen">Horizon 7 Connection Server</span> instances, select the option for <span class="packt_screen">Horizon 7 Enrollment Server</span> from the list (<strong>1</strong>).</li>
<li>The final option on this screen is to select an authentication mode for this Enrollment Server instance. Horizon 7 supports both on-premises and Horizon Cloud deployments. The example lab is an on-premises environment, so click the option for <span class="packt_screen">Horizon</span> <span class="packt_screen">7</span> (<strong>2</strong>).</li>
<li><span>Click the</span> <span class="packt_screen">Next &gt;</span> <span>button to continue.</span> You will now see the <span class="packt_screen">Firewall Configuration</span> screen.</li>
<li>Click the radio button for <span class="packt_screen">Configure Windows Firewall automatically</span> and then click <span class="packt_screen">Next &gt;</span> to continue.</li>
<li>You will see the <span class="packt_screen">Ready to Install the Program</span> screen.</li>
<li>Click the <span class="packt_screen">Install</span> button to start the installation process. Once the Enrollment Server has been installed, you will see the <span class="packt_screen">Installer Completed</span> screen. Click the <span class="packt_screen">Finish</span> button to close the installer.</li>
</ol>
<ol start="15">
<li>There is no user interface or console for the Enrollment Server, nor is there an icon on the desktop. To check whether or not it's running, we are going to check the Windows Services console. To do this, press the Windows key and <em>R</em> to open a <span class="packt_screen">Run</span> dialog box. In the box, type <kbd>services.msc</kbd>. You will now see the <span class="packt_screen">Services</span> screen, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/3daee796-969f-4668-aac7-935e5f975385.png"/></div>
<ol start="16">
<li>Scroll down, and you will see an entry for <span class="packt_screen">VMware Horizon View Enrollment Server</span>. Check that the service is running, and then close the <span class="packt_screen">Services</span> screen.</li>
</ol>
<p>You have successfully installed and configured an Horizon View Enrollment Server. In the next section, we are going to complete the View Administration elements of the installation and configuration by enabling the Cloud Pod Architecture.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Configuring Cloud Pod Architecture</h1>
                </header>
            
            <article>
                
<p class="NormalPACKT"><span>In</span> <span class="ChapterrefPACKT"><span><a href="20877fa6-9a03-4c97-ab85-4a4338e2c680.xhtml" target="_blank">Chapter 3</a>, <em>Design and Deployment Considerations</em></span></span><span>, we discussed the Cloud Pod Architecture and its ability to deliver multi-site View deployments to allow for scalability and also disaster recovery scenarios. We are now going to look at how to set up a cloud pod by using the example lab.</span></p>
<p class="NormalPACKT"><span>In the example lab, we have built and configured another Connection Server called</span> <kbd>hzn7-cs1b.pvolab.com</kbd>, <span>which we will use to represent a second pod, located on a second site.</span></p>
<div class="packt_infobox">This server is installed as a Connection Server and not a Replica Server, as it needs to be the first server in a different pod.</div>
<p class="NormalPACKT"><span>The following diagram illustrates the installation we are going to follow, using the example lab:</span></p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/3003f856-0e22-42b3-bb9f-4af1de62c3a4.png" style=""/></div>
<p class="NormalPACKT"><span>The first step of the process is to initialize the Cloud Pod from the first Connection Server.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Initializing the Cloud Pod</h1>
                </header>
            
            <article>
                
<p class="NormalPACKT"><span>To initialize the Cloud Pod Architecture, perform the following the steps:</span></p>
<ol>
<li class="NormalPACKT"><span>Log in to the</span> <span class="packt_screen">View Administrator</span><span>, and from the console screen, in the</span> <span class="packt_screen">Inventory</span> <span>pane on the left, expand the</span> <span class="packt_screen">View Configuration</span> <span>section and click</span> <span class="packt_screen">Cloud Pod Architecture</span> <span>(<strong>1</strong>).</span></li>
</ol>
<ol start="2">
<li class="NormalPACKT">Now, click the option for the <span class="packt_screen">Initialize the</span> <span class="packt_screen">Cloud Pod Architecture</span> <span><span class="ScreenTextPACKT">feature</span> (<strong>2</strong>), as shown in the following screenshot:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/f567effe-84c5-412b-b3bd-01760e791d5f.png"/></div>
<ol start="3">
<li>You will <span>now see the</span> <span class="packt_screen">Initialize</span> <span>dialog box, as shown in the following screenshot:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/39d304ed-5328-4902-83cd-b62cad05668a.png" style=""/></div>
<ol start="4">
<li>C<span>l</span>ick the <span class="packt_screen">OK</span> b<span>utton to start the initialization.</span> <span>You will now see the initialization process start, and a visual representation of the progress displayed as a % bar across the screen. You will also see that the</span> status <span>is shown as</span> <span class="packt_screen">Pending</span>, <span>as shown in the following screenshot:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/411d1023-6af3-479d-840a-6fea9e0b5eae.png"/></div>
<ol start="5">
<li>Once the <span class="packt_screen">Clo</span><span><span class="packt_screen">ud Pod Architecture</span> feature has complete its initialization, you will see the</span> <span class="packt_screen">Reload</span> <span>dialog box, as shown in the following screenshot:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/36413d9f-1c1e-4c25-9fe4-5e532fe1122f.png" style=""/></div>
<p class="mce-root"/>
<ol start="6">
<li><span>Click the <span class="packt_screen">OK</span> button to reload the client. You will now see the <span class="packt_screen">Cloud Pod Architecture</span> screen in the View Administrator, as shown in the following screenshot:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/89f07272-09bc-45d3-b64c-f021cf4e6adb.png"/></div>
<p class="NormalPACKT"><span>As you can see, a Pod Federation has been created called</span> <span class="packt_screen">Horizon Cloud Pod Federation</span><span>. You can change this name by clicking the</span> <span class="packt_screen">Edit…</span> <span>button, should you need to.</span></p>
<p class="NormalPACKT"><span>You will also see that the pods are listed, along with the site information. In the example lab, we only have the</span> <kbd>HZN7-CS1</kbd> <span>Connection Server listed, as this is the first Connection Server to have the Cloud Pod Architecture installed.</span></p>
<p class="NormalPACKT"><span>The next step is to connect the Connection Server in the second pod, or second site to the federation.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Connecting the second pod to the Cloud Pod</h1>
                </header>
            
            <article>
                
<p>The next step in this process is to connect or join your other pods to the pod federation.</p>
<p>Log in to the <span class="packt_screen">View Administrator</span> console on the second Connection Server. This is called <kbd>hzn7-cs1b.pvolab.com</kbd>. This is the first Connection Server on the second site in the example lab.</p>
<p>Perform the following steps to connect the second pod to the federation:</p>
<ol>
<li>Log in to the <span class="packt_screen">View Administrato</span>r console. In the <span class="packt_screen">Inventory</span> pane on the left, expand the <span class="packt_screen">View Configuration</span> section and click <span class="packt_screen">Cloud</span> <span class="packt_screen">Pod Architecture</span> (<strong>1</strong>), but this time click the option for <span class="packt_screen">Join the pod federation</span> (<strong>2</strong>), as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/eb5c8a83-f4a3-481e-8671-d23363001f38.png"/></div>
<p class="mce-root"/>
<ol start="2">
<li>Y<span>ou will now see the</span> <span class="packt_screen">Join</span> <span>dialog box, as shown in the following screenshot:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/fe88f6d1-bd38-4b00-b242-8fcf7634abed.png" style=""/></div>
<ol start="3">
<li><span>Here, enter the details of a</span> <span class="packt_screen">Connection Server</span> <span>that is in a pod that has the Cloud Pod Architecture already initialized.</span></li>
<li><span>In the</span> <span class="packt_screen">Connection Serve</span><span class="packt_screen">r</span> <span>box (<strong>3</strong>), enter the address of the <span class="packt_screen">Connection Server</span> from the first site. In the example lab, this is the server called</span> <kbd>hzn7-cs1.pvolab.com</kbd><span>.</span></li>
<li>In the <span class="packt_screen">User name</span> box (<strong>4</strong>), enter the username that has the correct privileges for joining pods together. In the example lab, we are going to use the administrator account. Note that you need to enter the username in the format <kbd>domain\username</kbd>, so in the example lab, we are going to enter this as <kbd>pvolab\username</kbd>.</li>
<li>Click <span class="packt_screen">OK</span> to continue.</li>
<li>You will now see the join process start, and a visual representation of the progress displayed as a % bar across the screen, as well as the status, being shown as <span class="packt_screen">Pending</span><strong><span class="ScreenTextPACKT">.</span></strong></li>
</ol>
<ol start="8">
<li>Once the <span class="packt_screen">Cloud Pod Architecture</span> feature has completed the join to the pod federation, you will see the <span class="packt_screen">Reload</span> <span>dialog box.</span></li>
<li><span>Click the</span> <span class="packt_screen">OK</span> <span>button to reload the client. You will now see the Cloud Pod Architecture screen in the View Administrator, as shown in the following screenshot:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/0987d34e-ab6b-41b9-9ea0-efd0be785a74.png"/></div>
<p><span>As you can see, both pods are now listed, along with the site information. In the example</span> lab<span>, we now have the <kbd>HZN7-CS1</kbd> and <kbd>HZN-CS1B</kbd> Connection Servers listed.</span></p>
<p><span>If you were to now look at the <span class="packt_screen">Sites</span> screen, you would see that the site is listed with the number of pods that make up that site, as well as the details of the pods in the site.</span></p>
<p><span>You will also be able to see the <span class="packt_screen">Global Entitlements</span></span>, <span>as shown in the following screenshot:</span></p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/0b1ee366-f439-4904-a11d-7a5baf43ce22.png"/></div>
<p>Now that you have created a pod federation by initializing the Cloud Pod Architecture feature and added a second pod to the pod federation, you can now create <span class="packt_screen">Global Entitlements</span>, which we will cover in the next section.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Entitling users to the Cloud Pod</h1>
                </header>
            
            <article>
                
<p>In this section, we are going to add a Global Entitlement by creating a desktop pool and then entitling a user to connect to desktops within the pool. To do this, follow these steps:</p>
<ol>
<li>From the View Administrator console, in the <span class="packt_screen">Inventory</span> pane on the left, expand the <span class="packt_screen">Catalog</span> section, and then click on <span class="packt_screen">Global Entitlement</span> (<strong>1</strong>).</li>
</ol>
<ol start="2">
<li>Next<span>, click the</span> <span class="packt_screen">Add…</span> <span>button (<strong>2</strong>), as shown in the following screenshot:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/e15c5a15-80ad-4e7c-bb52-8eb5e9f9b2f9.png"/></div>
<ol start="3">
<li>You will now see t<span>he</span> <span class="packt_screen">Add Global Entitlement</span> <span>dialog</span> box <span>and the first section where you choose the type of entitlement you want to create, as shown in the following screenshot:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/fca48d6a-1d55-4a99-8c89-ecced54c4452.png" style=""/></div>
<p class="mce-root"/>
<ol start="4">
<li>In this example, we are going to create a desktop entitlement, so click the radio button for <span class="packt_screen">Desktop Entitlement</span> (<strong>3</strong>), and then click the <span class="packt_screen">Next &gt;</span> button. You will now see the <span class="packt_screen">Name and Policies</span> configuration screen, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/b61344d1-b5ed-41ac-ad1c-5800a33752a5.png" style=""/></div>
<ol start="5">
<li>In the <span class="packt_screen">General</span> <span>section, enter a</span> <span class="packt_screen">Name</span> <span>(<strong>4</strong>) for the policy name. In the example lab, we will call this</span> <kbd>Global Desktop Pool</kbd><span>.</span></li>
</ol>
<ol start="6">
<li>In the <span class="packt_screen">Policies</span> section, under <span class="packt_screen">User assignment,</span> click the radio button for <span class="packt_screen">Dedicated</span> (<strong>5</strong>). You can specify the user assignment and whether the desktop pool is floating or dedicated. Under <span class="packt_screen">Scope</span>, click the radio button for <span class="packt_screen">All sites</span> (<strong>6</strong>). You can choose from either <span class="packt_screen">All sites</span>, <span class="packt_screen">Within site</span>, or <span class="packt_screen">Within pod</span>.</li>
<li>Check the box for <span class="packt_screen">Use Home Site</span> (<strong>7</strong>).</li>
<li>You then have the option to choose the <span class="packt_screen">Default display protocol</span>. In the example lab, we are going to select <span class="packt_screen">PCoIP</span>, so from the dropdown menu, select <span class="packt_screen">PCoIP</span>.</li>
<li>From the <span class="packt_screen">Allow users to choose protocol</span> option, choose whether you want users to change protocol. In the example lab, from the dropdown menu (<strong>9</strong>), select <span class="packt_screen">Yes</span>.</li>
<li>Finally, check the box if you want to enable <span class="packt_screen">HTML Access</span> (<strong>10</strong>).</li>
<li>Click the <span class="packt_screen">Next &gt;</span> button to continue.</li>
<li>You will now see the <span class="packt_screen">Users and Groups</span> configuration screen, as shown on the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/5fb2cb99-99d6-485b-bf92-05c8680c2d63.png"/></div>
<ol start="13">
<li>Clic<span>k the</span> <span class="packt_screen">Add…</span> <span>button (<strong>11</strong>).</span> <span>You will now see the</span> <span class="packt_screen">Find User or Group</span> <span>configuration screen, as shown in the following screenshot:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/64df7aa6-0d4f-46e1-b7f0-9fdfb3cabcf1.png"/></div>
<ol start="14">
<li>Click the drop<span>down arrow (<strong>12</strong>) and select the domain in which the user resides. In the example lab, this is</span> <kbd>pvolab.com</kbd><span>. Then, in the</span> <span class="packt_screen">Name/User name</span> <span>box (<strong>13</strong>), enter the name of the user you want to entitle to this pool, and then click the</span> <span class="packt_screen">Find</span> <span>button (<strong>14</strong>). The details of the user are then displayed. Click to highlight and select the user (<strong>15</strong>), and then click the</span> <span class="packt_screen">OK</span> <span>button.</span></li>
</ol>
<ol start="15">
<li>You will return to the <span class="packt_screen">Users and Groups</span> screen, which now shows the selected user, as shown in the following screenshot:</li>
</ol>
<div class="mce-root CDPAlignCenter CDPAlign"><img src="assets/1f598aa0-850d-4aea-8181-1305a266481f.png"/></div>
<ol start="16">
<li>Click the <span class="packt_screen">Next &gt;</span> button to continue. You will now see the <span class="packt_screen">Ready to Complete</span> screen, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/ae76a00c-2618-4e10-95ac-8b7b6979d830.png"/></div>
<ol start="17">
<li>Check that the details have been entered correctly and then click the <span class="packt_screen">Finish</span> button. You will return to the <span class="packt_screen">Global Entitlements</span> screen, which will now show the <span class="packt_screen">Global Desktop Poo</span><strong>l</strong> and the number of assigned users, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/a4fc4396-b2be-48ad-a8ae-8df35c22fa37.png"/></div>
<p>You have now successfully configured a Cloud Pod federation.</p>
<p>In the final section of this chapter, we are going to finish off the installation by configuring the ESXi host servers with NVIDIA graphics cards.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Configuring View for GPU-enabled virtual desktops</h1>
                </header>
            
            <article>
                
<p class="NormalPACKT"><span>In</span> <span class="ChapterrefPACKT"><span><a href="5d942e5b-dda5-4e5a-8278-62a64210aeef.xhtml" target="_blank">Chapter 2</a>, <em>Understanding Horizon 7 Architecture and Components</em></span></span><span>, we discussed that Horizon View virtual desktop machines can be configured to use hardware that's been installed in the ESXi host server hosting those desktops. In this case, the hardware in question is a graphics card.</span></p>
<p class="mce-root"/>
<p class="NormalPACKT"><span>As we discussed earlier, an advanced feature of Horizon View is its ability to use dedicated hardware installed that's been on the ESXi host servers, configured with PCI pass-through so that the virtual desktop machine can see the hardware.</span></p>
<p class="NormalPACKT"><span>In this section, we will perform the initial steps to install a NVIDIA GRID GPU card into one of the host servers. Later on, in</span> <span class="ChapterrefPACKT"><span><a href="d42ce468-eec2-4d43-ba82-25b90b59f936.xhtml">Chapter 7</a>, <em>Building and Optimizing the Virtual Desktop OS</em></span></span><span>, we will create a virtual desktop machine image, which will have a dedicated assignment and access to the GPU resource.</span></p>
<div class="NormalPACKT packt_tip packt_infobox"><span>If you are going to be using vGPU, you will need vSphere 6 installed as the hypervisor to support this.</span></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Configuring the ESXi host servers</h1>
                </header>
            
            <article>
                
<p class="NormalPACKT"><span>Before you build the virtual desktop machine, you need to have the graphics card</span> <span>physically installed and configured into the ESXi host in preparation to build the new virtual desktop machines that will use it.</span></p>
<p>In the example lab, we are using the NVIDIA GRID K2 card. These cards are available via the OEM route and come already configured from the server vendors due to them requiring additional power connectors, cooling fans, and specific BIOS settings.</p>
<p>It's worth checking these before you start, as just retrofitting the cards to an existing server might mean that they do not work. You will find the list of certified servers by clicking on the following link: <a href="http://www.nvidia.com/object/grid-partners.html">http://www.nvidia.com/object/grid-partners.html</a>.</p>
<p>With the hardware installed, log in to the vSphere Web Client, select the host that the card has been installed on, and perform the following steps:</p>
<ol>
<li><span>Login</span> into <span>the vSphere Web Client and then navigate to the host server that has the NVIDIA card installed. In the example lab, this is host</span> <kbd>esx-1.pvolab.com</kbd>, <span>as shown in the following screenshot:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/5e6570e3-f4ac-4029-a72f-618c00171952.png"/></div>
<ol start="2">
<li>Select <span>the ESXi host server</span> <kbd>esx-1.pvolab.com</kbd> <span>(<strong>1</strong>) and then click the</span> <span class="packt_screen">Manage</span> <span>tab (<strong>2</strong>). Click the</span> <span class="packt_screen">Settings</span> <span>button (<strong>3</strong>) and expand the <span class="packt_screen">Hardware</span> section. Click on</span> <span class="packt_screen">PCI Devices</span> <span>(<strong>4</strong>) and then click the pencil icon (<strong>5</strong>) to edit the settings.</span> You will now see the <span class="packt_screen">Edit PCI Device Availability</span> screen, as shown in the following screenshot<span>:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/295bc235-0edb-41db-8db6-937f0716ffe8.png"/></div>
<p>As you can see, this host server has been configured with two NVIDIA GRID K2 graphics cards. Check boxes (<strong>6</strong>) and (<strong>7</strong>) to enable the cards on the host server.</p>
<p><span>You now configured the ESXi host server to use the NVIDIA GRID K2 GPU</span> <span>cards. These will be used when we build the virtual desktop machines in later this book, in <a href="d42ce468-eec2-4d43-ba82-25b90b59f936.xhtml" target="_blank">Chapter 7</a>, <em>Building and Optimizing the Virtual Desktop OS</em>.</span></p>
<p class="mce-root"/>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article>
                
<p>In this chapter, we completed the installation of the Horizon View Environment, including the Replica Server, the Security Server, and the Enrollment Server.</p>
<p>We discussed the initial configuration items that you will need to undertake, such as licensing your environment, connecting your vCenter and View Composer Servers, and configuring the View Security Server for external connections. We also looked at the configuration items that are needed to prepare our environment for advanced graphics with NVIDIA GRID.</p>
<p>The final part of this chapter covered how to initialize and configure the Cloud Pod Architecture feature.</p>
<p>Having completed this chapter, you should have built a fully functioning View deployment, which is ready to deliver virtual desktop machines to your end users. The next steps are to start building the virtual desktops, preparing them for delivery before configuring Horizon View to deliver them.</p>
<p>But before we start building our virtual desktop machines, we are going to look at the security considerations in the next chapter, <a href="8b824015-c1b0-4107-9c9d-dd5cdb4b3221.xhtml">Chapter 6</a>, <em>Securing Horizon View with SSL Certificates</em>, where we are going to configure SSL certificates across our environment to ensure it is secure. We will also take a look at configuring the True SSO feature.</p>


            </article>

            
        </section>
    </body></html>