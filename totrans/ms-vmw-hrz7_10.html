<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Configuring and Managing Desktop Pools - Part 1</h1>
                </header>
            
            <article>
                
<p class="mce-root">Now that you have prepared a number of desktop images in the previous chapter, the next step is to configure desktop pools that will deliver these desktops to the end users, and so, in this chapter, we will look at how to create and manage desktop pools within Horizon View.</p>
<p class="mce-root">To recap, desktop pools are collections of one or more virtual desktop machines that have similar attributes. By this, we mean that they have the same operating system versions, applications, memory, CPU, or other configuration.</p>
<p>In this chapter, we will cover the following topics:</p>
<ul>
<li>Automated desktop pools</li>
<li>Creating a manual desktop pool</li>
<li>Managing Linked Clone desktop pools</li>
<li>Reviewing the infrastructure post-deployment</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Types of desktop pools</h1>
                </header>
            
            <article>
                
<p class="mce-root"><span>Different desktop pools can also be built and assigned differently. For example, one pool may be built using Linked Clones, and another could have a dedicated user assignment.</span> The types of desktop pools available are as follows:</p>
<ul>
<li>Automated desktop pool</li>
<li>Manual desktop pool</li>
<li>RDS desktop pool</li>
</ul>
<p>So, let's take a minute to describe what each of these types of desktop pools is used for.</p>
<p class="mce-root"/>
<p>An <strong>automated desktop pool</strong> is a collection of desktops that are automatically created from a snapshot or a virtual machine template by Horizon View. Desktops within an automated pool may be created on demand or built in advance. They can also be deleted or refreshed on logoff. Automated pools are generally the most widely used pools within Horizon View deployments, as they allow great flexibility for administration.</p>
<p>A <strong>manual desktop pool</strong> provides access to an existing desktop, whether it is virtual or physical, just so long as it has the View Agent installed on it. A manual pool is used for niche use cases due to the administrative overhead. Also, you would generally use an image management tool, such as VMware Mirage or SCCM, with these machines to simplify the management as far as possible.</p>
<p>Finally, an <strong>RDS desktop pool</strong> is a great way of offering high levels of consolidation for task workers within your Horizon View environment. An example of where an RDS desktop might be suitable would be for call center users, where the user is using one or two simple applications and doesn't require a full-blown desktop. We will cover RDS desktops in <a href="https://www.packtpub.com/sites/default/files/downloads/Delivering_Published_Desktops_with_Horizon_7.pdf">Chapter 18</a>, <em>Delivering Published Desktops with Horizon 7</em>.</p>
<p>In the next sections, we are going to configure the different pool options using the example lab and the parent desktop images created in the previous chapter. We are going to build the following desktop pools:</p>
<ul>
<li>Automated desktop pools for the following:
<ul>
<li>Windows 7 dedicated, Linked Clone desktop pool</li>
<li>Windows 7 dedicated, Full Clone desktop pool</li>
<li>Windows 7 floating, Linked Clone desktop pool</li>
<li>Windows 7 floating, Full Clone desktop pool</li>
<li>Windows 10 floating, Instant Clone desktop pool</li>
</ul>
</li>
<li>Manual desktop pool</li>
</ul>
<p>We are also going to show you how to build the desktop pools using the Horizon View administrator classic console, as well as the new web-client style Horizon Console.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Automated desktop pools</h1>
                </header>
            
            <article>
                
<p class="mce-root">Automated desktop pools will be the largest use case within our Horizon View environment, and so we will start by looking at how to create and manage those first.</p>
<p class="mce-root"/>
<p class="mce-root">As you start running through the configuration wizards to create the automated desktop pools, you will be asked a number of questions that will further define how the users will use the desktop pool. The first of these questions is how is the desktop going to be assigned to the end users?</p>
<p class="mce-root">The first option is for creating dedicated desktop assignments. Along with this option, you will get the choice of having an automatic assignment. Dedicated desktops are generally used due to something being stored or configured within the user's desktop that is important for that user, or due to application-specific nuances (for example, a licensing restriction that requires a specific MAC address to be used). This means that every time the user wants to connect to a desktop, they will always be given the same desktop.</p>
<div class="packt_infobox">Dedicated desktops can be built using either Full Clones, Linked Clones, or Instant Clones.</div>
<p class="mce-root">With a dedicated virtual desktop machine that is built using Linked Clones, you can also add a persistent disk to the virtual desktop to save all the changes that happen to the desktop while the user is using it. If you then need to refresh or recompose the desktop operating system, then the user won't lose the customizations or their personal data stored on their desktop as they are stored on a separate disk. However, you need to keep in mind that there is no easy way to back up the persistent disks and, as such, you might decide to use another tool to protect and update these desktops.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Creating dedicated, Linked Clone desktop pools</h1>
                </header>
            
            <article>
                
<p>In this section, we will work through the configuration wizard to create the first desktop pool to build a dedicated Windows 7 desktop, built using Linked Clones and taking the Windows 7 Gold Image snapshot created in the previous chapter as the parent image from which to create the virtual desktop.</p>
<p>To create the desktop pool, we are going to work through the following steps using the Horizon View Administrator console first, and then the new Horizon Console.</p>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Using the Horizon View Administrator Console</h1>
                </header>
            
            <article>
                
<p>To set up the desktop pool using the Horizon View Administrator, perform the following steps:</p>
<ol>
<li>From a workstation, open a browser and enter the address details of the View Connection Server. In the example lab, the address of the Connection Server is <kbd>https://hzn7-cs1.pvolab.com/admin</kbd>. Don't forget the <kbd>/admin</kbd> at the end; otherwise, you will end up on the Horizon Client page.</li>
<li>You will now see the View Administrator login screen, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/2093339c-eafe-4a14-9660-7631c30b81d0.png"/></div>
<ol start="3">
<li>Log in using the administrator account that was set up for the View Administrator. You will now see the Horizon View Administrator <span class="packt_screen">Dashboard</span> screen, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/5a3ea4a5-d3c7-45d9-b595-4e452337a467.png"/></div>
<p class="mce-root"/>
<ol start="4">
<li>From the Horizon View Administrator, click to expand the <span class="packt_screen">Catalog</span> option (<strong>1</strong>), and then click on <span class="packt_screen">Desktop Pools</span> (<strong>2</strong>). Then from the <span class="packt_screen">Desktop Pools</span> pane that is now displayed, click the <span class="packt_screen">Add...</span> button (3).</li>
<li>You will now see the <span class="packt_screen">Add Desktop Pool</span> screen, starting with the <span class="packt_screen">Type</span> section where we select the type of desktop pool you want to create:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/119715bd-67a3-4bcc-8349-c89d04f75be3.png" style=""/></div>
<ol start="6">
<li>Click the radio button for <span class="packt_screen">Automated Desktop Pool</span> (<strong>4</strong>). When selecting the various types of desktop pools that are available, the description on the right-hand side will change, reminding you of the differences between the pool types, as well as the features that are supported within each desktop pool.</li>
<li>Now click the <span class="packt_screen">Next &gt;</span> button to continue.</li>
</ol>
<ol start="8">
<li>You will now see the <span class="packt_screen">User Assignment</span> screen, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/8fe03bd0-62a0-45a4-b874-22824b0b9805.png" style=""/></div>
<ol start="9">
<li>Click the radio button for <span class="packt_screen">Dedicated</span> (<strong>5</strong>). The <span class="packt_screen">Enable automatic assignment</span> option (<strong>6</strong>) will already be selected by default. This means the desktops will be assigned to the users on a first come, first served, as they log in. If, for some reason, you need to ensure a user is assigned a specific desktop, then you will need to uncheck this box, and manually assign them a virtual desktop machine.</li>
</ol>
<ol start="10">
<li>Click the <span class="packt_screen">Next&gt;</span> button to continue the configuration. You will now configure how the virtual desktop machines will be built, using the vCenter Server linked with this Connection Server, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/4ede4b78-2000-41e1-82c1-cb1df155afb0.png" style=""/></div>
<p style="padding-left: 60px">On this configuration screen, you have the option to build either <span class="packt_screen">Instant clones</span>, <span class="packt_screen">View Composer linked clones</span>, or <span><span class="packt_screen">Full virtual machines</span>.</span></p>
<ol start="11">
<li>For this first desktop pool, we are going to use Linked Clones, so click the radio button for <span class="packt_screen">View Composer linked clones</span> (<strong>7</strong>).</li>
<li>Next, you need to select the relevant vCenter Server from the list. In the example lab, the vCenter <kbd>192.168.1.178</kbd> is shown, along with the vCenter user account we set up for the View (<strong>8</strong>).</li>
</ol>
<ol start="13">
<li>Click the <span class="packt_screen">Next&gt;</span> button to continue the configuration. The next configuration screen is for the <span class="packt_screen">Desktop Pool Identification<strong>,</strong></span> as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/2affd716-9d00-4d3c-933e-c2533c59dd0d.png" style=""/></div>
<ol start="14">
<li>In the <span class="packt_screen">ID</span> box (<strong>9</strong>), type in an ID for this desktop pool. In the example lab, we have entered the ID of <kbd>Win7-dedicated-lc</kbd>.</li>
</ol>
<div class="packt_infobox">You can only use the characters <em>a</em>-<em>z</em>, <em>A</em>-<em>Z</em>, <em>0</em>-<em>9</em>, <em>-</em>, and <em>_</em> in the pool ID.</div>
<ol start="15">
<li>In the <span class="packt_screen">Display name</span> box (<strong>10</strong>), type in a name for this pool. Bear in mind that the display name is what is displayed to the end users, so make sure you give it a non-technical name that the users will understand.</li>
<li>Finally, in the <span class="packt_screen">Description</span> box (<strong>13</strong>), type in a detailed description that describes the desktop pool and what it is used for.</li>
</ol>
<ol start="17">
<li>Click the <span class="packt_screen">Next&gt;</span> button to continue the configuration. You will now see the <span class="packt_screen">Desktop Pool Settings</span> configuration screen, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/05b74d84-e71a-4501-b4c0-28dbcc7c8f89.png" style=""/></div>
<p class="mce-root"/>
<p class="mce-root"/>
<p>This configuration page is where we start to configure the settings that will define the way the virtual desktop machines behave within the desktop pool. It provides configuration options for before users connect, while they are using their virtual desktop machine, and finally, once they disconnect from it.</p>
<p>There a number of options to configure on this screen so we are going to break them down into individual sections.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">General settings</h1>
                </header>
            
            <article>
                
<p>We are going to start by configuring the <span class="packt_screen">General</span> settings first, by performing the following steps:</p>
<ol>
<li>First, in the <span class="packt_screen">General</span> section, you can configure the <span class="packt_screen">State</span> of the desktop pool. From the drop-down menu, select the <span class="packt_screen">Enabled</span> option (<strong>12</strong>) to enable this pool, meaning that it will be available to users who are entitled to use it and, therefore, any virtual desktop machines will be provisioned within the pool and made available for end users to use. If you set the <strong>State</strong> to <span class="packt_screen">Disabled</span>, virtual desktop machines will not be provisioned and will not be made available to end users. You might want to set the <strong>State</strong> to <strong>Disabled</strong> if you are pre-configuring a new pool for users and then go back and enable it once you are happy it is configured correctly:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/c9a34eff-1bc3-4961-a659-cfa813001349.png" style=""/></div>
<ol start="2">
<li>The second option under the <span class="packt_screen">General</span> section is for <span class="packt_screen">Connection Server restrictions</span>, where you are able to select tags associated with the Connection Server to restrict where the users can connect from. Click the <span class="packt_screen">Browse…</span> button to configure the restrictions. If you want to allow this desktop pool to be accessed from any Connection Server, then you would click the radio button for <span class="packt_screen">No Restrictions</span> (<strong>13</strong>). If you click the radio button for <span class="packt_screen">Restricted to these tags</span> (<strong>14</strong>) then you would see a list of the configured tags. Simply highlight the tag from the list and then click <span class="packt_screen">OK</span>.</li>
</ol>
<ol start="3">
<li>The final setting under the <span class="packt_screen">General</span> section is for <span class="packt_screen">Category Folder</span>. This setting allows you to create a shortcut directly onto the client device, with the details of this desktop pool so the end users can easily access their resources. To configure this option, click the <span class="packt_screen">Browse...</span> button. The first radio button option is for <span class="packt_screen">Disabled</span> (<strong>15</strong>) to turn this feature off. To enable the feature, click the radio button for <span class="packt_screen">Select a category folder from the folder list</span> (<strong>16</strong>). You then have the option to select the <span class="packt_screen">Category Folder</span> from the list, or you can create a new one by starting to type in the name of the folder you want to create in the <span class="packt_screen">New Folder</span> box (<strong>17</strong>). Once you have typed in the name, you can click the <span class="packt_screen">Add</span> button. Finally, you can select the <span class="packt_screen">Shortcut Locations</span> (<strong>18</strong>). You can choose from the <span class="packt_screen">Start Menu/Launcher</span> or the <span class="packt_screen">Desktop</span> of the client device onto which to place the shortcut.</li>
<li>Click the <span class="packt_screen">OK</span> button once you have completed configuring your options.</li>
</ol>
<p>The next section to configure is for the <span class="packt_screen">Remote Settings</span>.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Remote Settings</h1>
                </header>
            
            <article>
                
<p>These settings define the power state of the virtual desktop machines and what happens when end users connect and disconnect. The settings options are shown in the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/ef7856d0-1367-4c6a-86d8-4d91323b4b58.png"/></div>
<p class="mce-root"/>
<p class="mce-root"/>
<p>You then have the following options for configuring the <span class="packt_screen">Remote Settings</span>:</p>
<ol>
<li>The first option is for the <span class="packt_screen">Remote Machine Power Policy</span> option, which defines the power state of the virtual desktop machine when users connect and disconnect. Click on the drop-down menu (<strong>19</strong>) and you will see the following options:
<ul>
<li><span class="packt_screen">Take no power action</span>: The virtual desktop machine will remain in the last state it was left in. For example, if the desktop was left powered on, then it will remain powered on.</li>
<li><span class="packt_screen">Ensure</span> <span class="packt_screen">machines are always powered on</span>: The virtual desktop machines will always be restored to a powered on status after being shut down by an end user or an administrative task.</li>
<li><span class="packt_screen">Suspend</span>: Virtual desktop machines will be suspended when a user logs off. Note, <strong>Suspend</strong> is not available when using NVIDIA GRID vGPU desktops.</li>
<li><span class="packt_screen">Power Off</span>: Virtual desktop machines will be powered off when a user logs off.</li>
</ul>
</li>
</ol>
<p style="padding-left: 60px">When configuring power policies, the most important thing to do is to understand your use case and choose the correct options as appropriate. For example, if you have 200 users, all planning on logging in within a 10-minute window at 9:00 A.M., and the desktops are powered off or suspended, then this could cause some delay and a large performance spike while the desktops are resumed or powered on. Alternatively, if you are using a dedicated desktop model with a shift-based work pattern and choose to leave the desktops always powered on, this could cause your environment to be over-allocated <span>in terms of desktop resources, as well as you potentially having more OS and software application licenses than you actually need or use.</span></p>
<ol start="2">
<li>The next setting is for <span class="packt_screen">Automatically logoff after disconnect</span> (<strong>20</strong>). This option allows you to define what happens when a user simply disconnects from their desktop and doesn't choose to log off. Click the drop-down <span>menu to see the following available options:</span>
<ul>
<li><span class="packt_screen">Immediately</span>: When the user disconnects from the virtual desktop machine, it is immediately logged off.</li>
<li><span class="packt_screen">Never</span>: When the user disconnects from the virtual desktop machine, it is never logged off.</li>
<li><span class="packt_screen">After...</span>: When the user disconnects from the virtual desktop machine, it is logged off after a set period of time. You can choose how many minutes before the desktop will be logged off.</li>
</ul>
</li>
</ol>
<p style="padding-left: 60px">Again, how you configure this setting will very much depend on how your users will use the desktop. Very rarely would you choose to log off the desktop immediately in case the user has only temporarily disconnected from their desktop or has been disconnected due to a network connection glitch. You should give them at least a 5- to 10-minute window to allow them to reconnect rather than just logging them out straight away.</p>
<ol start="3">
<li>The next setting to configure is the <span class="packt_screen">Allow users to reset/restart their machines</span> (<strong>21</strong>) option. If this option is set to <span class="packt_screen">Yes</span>, it means that the users are able to effectively use a reset button to hard reset their virtual desktop machine. This can be a useful feature to allow end users to perform troubleshooting steps without the assistance of IT. However, it can also cause some confusion when the end user believes they are simply resetting the endpoint device but instead they are resetting their virtual desktop machine. If this is a Linked Clone desktop, then they could end up with a completely new virtual desktop machine being provisioned resulting in them potentially losing any current work.</li>
<li>The final setting in this section is for <span class="packt_screen">Refresh OS disk after logoff</span> (<strong>22</strong>). As this pool is going to be created using Linked Clone images, this option defines how the operating system disk of the Linked Clone behaves when a user logs off.</li>
<li>To configure this option, click the drop-down menu for the following available options:
<ul>
<li><span class="packt_screen">Never</span>: The operating system disk will never be refreshed automatically; this will result in the Linked Clone growing over time, especially if a persistent disk and/or a disposable disk isn't configured in the later stages of this wizard. By refreshing the OS disk, the disk is refreshed to a snapshot that is taken when the desktop is originally created. Without a persistent disk, redirected profiles, and so on, all user settings/data will be lost.</li>
<li><span class="packt_screen">Always</span>: The desktop will be refreshed every time the user logs off.</li>
<li><span class="packt_screen">Every...</span>: Allows you to define the number of days after which the desktop will be refreshed.</li>
<li><span class="packt_screen">At...</span>: Allows you to set at what percentage of OS disk utilization should the desktop be refreshed.</li>
</ul>
</li>
</ol>
<p style="padding-left: 120px">Again, as with the other configuration settings, how you configure these settings will depend greatly on your use cases and how your users work.</p>
<p>The next section in this configuration screen is to configure the <strong><span class="packt_screen">Remote Desktop Protocol</span></strong>.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Remote Desktop Protocol settings</h1>
                </header>
            
            <article>
                
<p><span>These settings define the behavior of the delivery protocol for the virtual desktop machines and any user configurable options. The settings options are shown in the following screenshot:</span></p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/e0874499-7b8d-4c8e-90c6-8b172c5376d4.png" style=""/></div>
<p>You then have the following options for configuring the <span class="packt_screen">Remote Display Protocol</span>:</p>
<ol start="1">
<li>The first option in the <span class="packt_screen">Re</span><span class="packt_screen">mote Display Protocol</span> section is to select the <span class="packt_screen">Default display protocol</span>. From the drop-down menu (<strong>23</strong>), you have the options of <span class="packt_screen">Microsoft RDP</span>, <span class="packt_screen">PCoIP</span>, or <span class="packt_screen">VMware Blast</span>. Note that some of the display-based features are dependent on which protocol you choose. For example, session collaboration is only available when you use the Blast protocol.</li>
</ol>
<ol start="2">
<li>Next, you have the option to <span class="packt_screen">Allow users to choose pr</span><span class="packt_screen">otocol</span> (<strong>24</strong>). If you set this to <span class="packt_screen">Yes</span>, then the end user can choose the protocol. Typically, you would use PCoIP or VMware Blast as the default protocol, and not let the end user change this unless there is a specific use case that determines where another protocol is required. For example, if more than four screens are required, then you would use RDP, as this is the protocol that supports this, or maybe the end user could be connected behind a very strict outbound firewall that blocked the PCoIP port, <kbd>4172</kbd>, and therefore would not be able to see their virtual desktop machine. In these use cases, allowing the end user to change the default protocol means that they can continue to work.</li>
<li>You can then choose the <span class="packt_screen">3D Renderer</span> model you want the desktop pool to use <strong>(25)</strong>. <span>Click the drop-down arrow to select the required 3D renderer. You have the following options:</span>
<ul>
<li><span class="packt_screen">Manage using vSphere Client</span>: T<span>he</span> <strong><span class="ph uicontrol">Configure VRAM for 3D Guests</span></strong><span>,</span> <strong><span class="ph uicontrol">Max number of monitors</span></strong><span>, and</span> <strong><span class="ph uicontrol">Max resolution of any one monitor</span></strong> <span>configuration settings are not available in the Horizon Administrator when you select this setting. Settings are instead managed using the vSphere Web Client.</span></li>
</ul>
<ul>
<li><span class="packt_screen">Automatic</span>: 3D rendering is enabled and is managed by the host server, which automatically selects the best model to use is. For example, the host server will reserve GPU resources on a, first served basis as a virtual desktop machine is powered on. If there are no GPU resources available when a virtual desktop machine is powered on, then the host server will revert to using software-based rendering. This setting comes in useful in a DR scenario where the host server at the DR site has not been configured with any hardware-based GPU resources. This allows users to revert to software rendering, meaning they can continue to work.</li>
<li><span class="packt_screen">Software</span>: The <span>host server will always use software 3D graphics rendering.</span></li>
<li><span class="packt_screen">Hardware</span>: T<span><span>he host server will reserve GPU hardware resources on a first come, first served basis as virtual desktop machines are powered on. In the scenario where there are hardware resources available from the host server, then the virtual desktop machine will not power on.</span></span></li>
<li><span class="packt_screen">NVIDIA GRID VGPU</span>: The host server will again reserve GPU hardware resources on a first come, first served basis as virtual desktop machines are powered on. If a user logs on and connects to a virtual desktop machine, and GPU hardware resources are already allocated to another virtual desktop machine on the same host server, then the Connection Server will attempt to move the virtual desktop machine to a different host server in the same cluster and then power it on once it has the resources. By s<span>electing the <strong>NVIDIA GRID VGPU</strong></span> <span>option, you will lose the</span> <span class="ph uicontrol">Configure <strong>VRAM for 3D Guests</strong></span><span>,</span> <strong><span class="ph uicontrol">Max number of monitors</span></strong><span>, and</span> <strong><span class="ph uicontrol">Max resolution of any one monitor</span></strong> <span>settings. You will also need to ensure that you configure the parent virtual desktop machine or virtual desktop machine template to reserve all the memory.</span></li>
<li><span class="packt_screen">Disabled</span>: 3D rendering is switched off.</li>
</ul>
</li>
</ol>
<p class="mce-root"/>
<ol start="4">
<li>When you choose one of the valid 3D Renderer options (does not work with <strong>NVIDIA GRID VGPU</strong> or <strong>Manage using vSphere Client</strong>), you will also now see that the <span class="packt_screen">Configure...</span> button next to the chosen model is now active. If you click on this, then you will see the <span class="packt_screen">Configure VRAM for 3D guests</span> box, which allows you to specify an amount of video memory to use, up to a maximum of <span class="packt_screen">512 MB<strong>,</strong></span> as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/f316fa59-76d9-4d33-8d24-98f113568daf.png" style=""/></div>
<ol start="5">
<li>The next option is to select the <span class="packt_screen">Max number of monitors</span>. If you click the drop-down arrow, you can choose from <span class="packt_screen">1</span>, <span class="packt_screen">2</span>, or <span class="packt_screen">4</span> monitors. Note that this setting only applies to the PCoIP and Blast protocols. When 3D is disabled, the <span class="packt_screen">Max number of monitors</span> and <span class="packt_screen">Max resolution of any one monitor</span> settings determine the amount of VRAM assigned to the virtual desktop machines in the desktop pool. The greater these values are, the more memory will be consumed on the associated ESXi host servers.</li>
</ol>
<p style="padding-left: 60px">If 3D is disabled, up to three monitors are supported running at a resolution of 3,840 x 2,160 on a Windows 7 guest operating system, with Aero disabled. For other operating systems, or for Windows 7 with Aero enabled, only one monitor is supported at this resolution. When 3D is enabled, one monitor is supported at 3,840 x 2,160 resolution. Multiple monitors are best supported at a lower resolution.</p>
<ol start="6">
<li>The next option is for <span class="packt_screen">Max resolution of any one monitor</span> (<strong>26</strong>). Click the drop-down arrow to select the required resolution, noting the previous discussion in point 3.</li>
<li>Next, you have the option to enable <span class="packt_screen">HTML Access</span> (<strong>27</strong>). To enable HTML, check the box. Note that the Connection Server will need to have HTML Access installed on it for this to work.</li>
<li>Finally, you have the option to <span class="packt_screen">Allow Session Collaboration</span> (<strong>28</strong>). <span>To enable this feature, check the box. Session collaboration allows users of this desktop pool to invite other users to join their session. Note that this feature only works with the VMware</span> Blast pr<span>otocol.</span></li>
</ol>
<p class="mce-root"><span>The next section in this configuration screen is to configure the</span> <span class="packt_screen">Adobe Flash Settings for Sessions</span><span>.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Adobe Flash Settings</h1>
                </header>
            
            <article>
                
<p class="mce-root"><span>These settings define the behavior of Adobe Flash within the virtual desktop machine sessions. The settings options are shown in the following screenshot:</span></p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/116cd2eb-422e-4a41-828a-63f8c7303a08.png" style=""/></div>
<p>The configuration options for <strong>Adobe Flash Settings for Sessions</strong> are detailed here:</p>
<ol>
<li>On the option for <span class="packt_screen">Adobe Flash Quality</span>, click the drop-down menu <strong>(29)</strong> for the available options:
<ul>
<li><strong><span class="packt_screen">Do not control</span></strong>: This allows the web page to determine the best setting</li>
<li><strong><span class="packt_screen">Low</span> (default)</strong>: Low quality means less bandwidth consumption</li>
<li><strong><span class="packt_screen">Medium</span></strong>: Medium quality means average bandwidth consumption</li>
<li><strong><span class="packt_screen">High</span></strong>: High quality means more bandwidth consumption</li>
</ul>
</li>
<li>The other configurable setting is for <span class="packt_screen">Adobe Flash throttling</span>. Adobe Flash updates the screen by default, using a timer service to determine the update interval. By changing this time interval setting, you can control the frame rate of the screen updates and therefore reduce the bandwidth requirements. Click the drop-down <span>menu (<strong>30</strong>) for the available options:</span>
<ul>
<li><span class="packt_screen">Disabled</span>: Throttling is turned off</li>
<li><span class="packt_screen">Conservative</span>: The update interval is set to 100 ms</li>
<li><span class="packt_screen">Moderate</span>: The update interval is set to 500 ms</li>
<li><span class="packt_screen">Aggressive</span>: The update interval is set to 2,500 ms</li>
</ul>
</li>
</ol>
<p class="mce-root"><span>The final section in this configuration screen is to configure the</span> <span class="packt_screen">Mirage Settings</span><span>.</span> <span>These settings define how VMware Mirage interacts with the virtual desktop machine images. The settings options are shown in the following screenshot:</span></p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/4679a798-4418-43ee-b68b-a81c00b1fa8d.png" style=""/></div>
<p>The Mirage Settings are described here:</p>
<ol>
<li>The only option here is to <span class="packt_screen">Override global Mirage settings (31)</span>. To enable the override, check the box.</li>
<li>Then, in the <span class="packt_screen">Mirage Server configuration</span> box (<strong>32</strong>), enter the address of the Mirage server you want to use. To find out more about the VMware Mirage solution, you can read the book titled <em>Learning VMware Mirage</em>, by Packt Publishing.</li>
</ol>
<div class="packt_infobox">This setting only applies to those who have a current Mirage deployment, as Mirage is now end of life.</div>
<p>Once you have completed the configuration settings on this screen, then click on <span class="packt_screen">Next &gt;</span> button to continue to the next configuration screen. This next screen is where you configure <span class="packt_screen">Provisioning Settings<strong>,</strong></span> as shown in the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/7229fabc-865f-4181-8652-8cb322fa5cb1.png" style=""/></div>
<p>As done previously, we are going to break this screen down into its different configuration sections, starting with the <span class="packt_screen">Basic</span> section, as shown in the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/5514fa7a-1e1d-4a51-aa9d-3dfa7a685f13.png" style=""/></div>
<p>The <strong>Provisioning Settings</strong> are described here:</p>
<ol>
<li>The first setting in the <span class="packt_screen">Basic</span> section is to <span class="packt_screen">Enable provisioning</span>. Tick the <span class="packt_screen">Enable provisioning</span> box <strong>(33)</strong> to basically switch provisioning on. This setting means that virtual desktop machines can be provisioned as per the configuration settings.</li>
<li>The next setting is for <span class="packt_screen">Stop provisioning on error</span> (<strong>34</strong>). By checking this box, it means that provisioning will stop if there is an error during the provisioning process. This is quite important, as rather than going ahead to continue provisioning hundreds of virtual desktop machines that have errors, you would want to stop provisioning so that you can go back in and fix the issues first.</li>
</ol>
<p>The next section to configure is for the <span class="packt_screen">Virtual Machine Naming<strong>,</strong></span> as shown in the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/0442982e-1c2f-483b-8a55-2e6950670426.png"/></div>
<p>In this section, there are two options for configuring how newly built virtual desktop machines are named, either manually, or automatically. The name we are referring to here is the machine name that will also appear as the computer account in Active Directory. With this in mind, it's worthwhile picking a suitable naming convention.</p>
<p>In the first example, we are going to take a look at the manual option, before configuring the naming pattern method, as this method is the recommended way to name your virtual desktop machines unless there is some reason your desktops need unique non-contiguous names. To do this, perform the following steps:</p>
<ol>
<li>Click the radio button for <span class="packt_screen">Specify names manually</span> (<strong>35</strong>).</li>
<li>You will now see the <span class="packt_screen">Enter Machine Names</span> box. In the empty box (<strong>36</strong>), type in a name for the first virtual desktop machine. In this example, we have called this machine <kbd>Windows-7-001</kbd>. You could also add a username to this machine if it is going to be a dedicated assignment. So in the example lab, we could enter this machine name as <kbd>Windows-7-001,pvolab.com\peter</kbd>.</li>
<li>Continue entering machines as required and then click <span class="packt_screen">Next &gt;</span> (<strong>37</strong>) when you have entered all the machine names you want to add.</li>
<li>Now you will see a list of the entered names (<strong>38</strong>). You can now either go back and enter more names or, if you have completed entering names, click the <span class="packt_screen">Finish</span> button (<strong>39</strong>).</li>
<li>Finally, you will return to the <span class="packt_screen">Virtual Machine Naming</span> screen where you will see that it now says <span class="packt_screen">1 names entered</span> (<strong>40</strong>) to show how many machine names have been manually entered.</li>
<li>You also have a couple of other options under the manual section. You can <span class="packt_screen">Start machines in maintenance mode</span>, which allows virtual desktop machines to be customized manually before users can log in. This mode must be exited manually. You also have the option to configure <span class="packt_screen"># Unassigned machine kept powered on</span>. This allows you to keep virtual desktop machines powered on ready, even if they have not been assigned to an end user yet. This option would allow you to quickly assign a machine that had already been built and customized, thereby speeding up the process.</li>
</ol>
<p>Now we have looked at how to enter a machine name manually, we are going to look at the option to use a naming pattern, as shown in the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/2d4fd66b-5673-4ed8-aa82-762bcec5373d.png" style=""/></div>
<p>Configure the <span class="packt_screen">Virtual Machine Naming</span> using the following settings:</p>
<ol>
<li>Click the radio button for <span class="packt_screen">Use a naming pattern</span> (<strong>41</strong>).</li>
<li>In the <span class="packt_screen">Naming Pattern</span> box (<strong>42</strong>), type in a name for the virtual desktop machines. In the example lab, and for this pool, we are going to enter <kbd>Win7-VM-{n}</kbd>. This will result in the virtual desktop machines being named <kbd>Win7-VM-1</kbd>, <kbd>Win7-VM-2</kbd>, and so on, up to the number of machines you specify that you want to build. By using <kbd>{n}</kbd> somewhere in the machine name, Horizon View will add a single digit to the name in the required location. By adding <kbd>{n:fixed=2}</kbd>, you can allow for for two digits, and <kbd>{n:fixed=3}</kbd> for three, and so on. This will ensure the desktops appear in numerical order.</li>
</ol>
<p>The next section is the <strong><span class="packt_screen">Desktop Pool Sizing</span></strong> section.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Desktop Pool Sizing</h1>
                </header>
            
            <article>
                
<p>In this section, you can specify the number of virtual desktop machines that are created and provisioned, as shown in the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/9de1088e-6d5a-4056-9370-05693fc8b69b.png" style=""/></div>
<p>Configure the <span class="packt_screen">Desktop Pool Sizing</span> using the following settings:</p>
<ol>
<li>In the <span class="packt_screen">Max number of machines</span> box (<strong>43</strong>), enter the maximum number of machines that can be provisioned in this desktop pool. This sets the limit of the number of virtual desktop machines in this desktop pool.</li>
<li>Next is the setting for the <span class="packt_screen">Number of spare (powered on) machines</span>. In the box (<strong>44</strong>), enter the number of machines that should be powered on and waiting for users to connect to them.</li>
<li>Finally, in this section, is the <span class="packt_screen">Minimum number of ready (provisioned) machines during View Composer maintenance operations</span> option. Here you can enter the number of virtual desktop machines (<strong>45</strong>) that you want to have still available during maintenance operations. So, for example, if you initiated a recompose operation, Horizon View could ensure that there was a minimum number of virtual desktop machines still available for end users to log in to.</li>
</ol>
<p>How you configure these options is going to be critical to the success of the pool within your View Solution. You need to ensure that there are enough virtual desktop machines provisioned and available for the users as and when they are required. This also means ensuring that you are able to meet user demand even during maintenance operations.</p>
<p>The final section to configure is for <span class="packt_screen">Provisioning Timing</span>. You have the option of provisioning machines on demand, as users log in and request them, or pre-provision them in advance, as shown in the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/91697960-65bb-4b0a-b5eb-c7547b4ed398.png" style=""/></div>
<p>Let's start with the configuration:</p>
<ol>
<li>To provision on demand, click the radio button for <span class="packt_screen">Provision all machines on demand</span> (<strong>46</strong>). This means that the virtual desktop machines will be created and provisioned in advance ready for users to connect and log in to. You can select a number of machines to have as a minimum in the <span class="packt_screen">Min number of machines</span> box (<strong>47</strong>). <span>If you choose to provision</span> on demand<span>, then you need to ensure there are enough desktops already provisioned in order to meet user demand without causing long delays. This is where making sure you have enough provisioned up-front versus</span> the number <span>of spares as per what you would have configured in the desktop pool sizing section previously.</span></li>
<li>In the example lab, we are going to provision up-front, so click on the radio button for <span class="packt_screen">Provision all machines up-front</span> (<strong>48</strong>). If you are going to provision all the virtual desktop machines up-front, you need to ensure that you do this at a time when the increase in performance that will result on a large number of virtual desktop machines being built, is not going to have a knock-on effect on your end users.</li>
</ol>
<p>Once you have completed the configuration settings on this screen, then click the <span class="packt_screen">Next &gt;</span> button to continue to the next configuration screen. As this desktop pool is going to use virtual desktop machines built from Linked Clones, then the next configuration screen is the <span class="packt_screen">View Composer Disks</span> configuration screen, as shown in the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/f359ec95-a29a-4aef-b123-f609efdac436.png"/></div>
<p>On this configuration screen, there are two options. One OS to configure the persistent disk, and the disposable file redirection. Careful consideration needs to be given as to whether or not you need to utilize these settings within your desktop pool architecture or not, and also depending on whether you are planning on using any additional VMware or third-party solutions to deliver the same functionality.</p>
<p>The first section to configure is for <span class="packt_screen">Persistent Disk<strong>,</strong></span> as shown in the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/2823ee58-01d8-49da-bfc4-8dec883e54e6.png" style=""/></div>
<p>With a persistent disk, the Windows profile will be redirected to a dedicated disk that will be kept even if the OS disk is refreshed during a View Composer operation. This can be a great way to protect user configuration. However, you might also wish to investigate other solutions for this, such as VMware View Persona Management, VMware UEM, or Liquidware ProfileUnity that can offer you similar, if not better, functionality:</p>
<ol>
<li>To configure this setting, click the radio button for <span class="packt_screen">Redirect Windows profile to a persistent disk</span> (<strong>49</strong>).</li>
<li>In the <span class="packt_screen">Disk size</span> box (<strong>50</strong>), enter a size for the persistent disk.</li>
<li>Lastly, in the <span class="packt_screen">Drive letter</span> drop-down box (<strong>51</strong>), you can select a drive letter for this persistent disk.</li>
<li>To disable the profile redirection, or if you are using another profile management tool, then click the radio button for <span class="packt_screen">Do not redirect Windows profile</span> (<strong>52</strong>).</li>
</ol>
<p>The next section to configure is for <span class="packt_screen">Disposable File Redirection</span>. The disposable disk contains all page and temporary files and is refreshed after every desktop reboot. This can be a great way to reduce the size of the Linked Clone between desktop refreshes. The <span class="packt_screen">Disposable File Redirection</span> settings are shown in the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/b7ff7741-4363-4820-b868-78d215ab2105.png" style=""/></div>
<p><span>To</span> configure <span>the <strong>Disposable File Redirection</strong> setting, perform the following this steps:</span></p>
<ol>
<li>Click the radio button for <span class="packt_screen">Redirect Windows profile to a persistent disk</span> (<strong>53</strong>).</li>
<li>In the <span class="packt_screen">Disk size</span> box (<strong>54</strong>), enter a size for the persistent disk.</li>
<li>Lastly, in the <span class="packt_screen">Drive letter</span> drop-down box, you can select a drive letter for this persistent disk. If you click the arrow <span>(<strong>55</strong>), you will see the drive letter options (<strong>56</strong>).</span> The letter assigned to a disposable disk drive is not necessarily visible to the end user.</li>
<li><span>To disable the</span> <span class="packt_screen">Disposable File Redirection</span> <span>feature, click the radio button for</span> <span class="packt_screen">Do not redirect disposable files</span> <span><span>(<strong>57</strong>).</span></span></li>
</ol>
<div class="packt_infobox">When configuring either of these, ensure you set the sizes appropriate <span>for your use cases. This is where the POC or desktop assessment will help you understand how large these need to be. Items such as whether an Outlook local cache is being used can affect the size of the persistent disk dramatically.</span></div>
<ol start="5">
<li>Once you have completed the configuration settings on this screen, then click the <span class="packt_screen">Next &gt;</span> button to continue to the next configuration screen.</li>
</ol>
<p>The next configuration screen is for <span class="packt_screen">Storage Optimization</span>. On this screen, you are able to configure advanced options with regard to storage management and the placement of the OS, persistent, and replica disks. <span>You have the option to select the location of the various different disks that get created for the virtual desktops in this desktop pool. Horizon View effectively allows you to tier your storage and so, depending on your storage design, you might want to place the replica images on faster, local SSD-based storage, and the OS disks on a different tier of storage, such as spinning hard drives.</span></p>
<p>These configuration options are shown in the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/902dacf7-b4e1-4593-ac8f-05148c1b082b.png"/></div>
<p><span>To</span> configure <span>the <strong>Storage Policy Management</strong> setting, perform the following steps:</span></p>
<ol>
<li>The only option on this screen is to configure the <span class="packt_screen">Storage Policy Management</span>, starting with VMware Virtual SAN. To enable VSAN, click the radio button for <span class="packt_screen">Use VMware Virtual SAN</span> (<strong>58</strong>). As we don't have this configured in the example lab, then we will click the radio button for <span class="packt_screen">Do not use VMware Virtual SAN</span> (<strong>59</strong>).</li>
<li>You can then configure the locations for where the different disk types are stored. Here you have two options. The first is for <span class="packt_screen">Select separate datastores for persistent and OS disks</span> (<strong>60</strong>). This allows the persistent disks and OS disks to be stored on different datastores. The second option is for <span class="packt_screen">Select separate datastores for replica and OS disks</span> (<strong>61</strong>). It is recommended that a high-performance datastore be chosen for these images, such as a flash-based array. Depending on your hardware configuration, storing replica disks on a separate datastore might create a single point of failure.</li>
<li>Check the relevant box to configure where you want to store the different disks or leave the boxes unchecked to use a single datastore for all disks. As the example lab only has a single datastore, we will leave them unchecked.</li>
</ol>
<p class="NormalPACKT"><span>The next configuration screen is the <strong><span class="ScreenTextPACKT"><span class="packt_screen">vCenter Settings</span></span></strong> configuration screen.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">vCenter Settings</h1>
                </header>
            
            <article>
                
<p class="NormalPACKT"><span>On the <strong>vCenter Settings</strong> screen, we are going to select the parent VM from which to build the virtual desktop machines, and then the location and resources that are going to run them. As such, the configuration options fall into three categories.</span> <span class="packt_screen">Default Image</span><span>,</span> <span class="packt_screen">Virtual Machine Location</span><span>, and</span> <span class="packt_screen">Resource Settings<strong>,</strong></span> <span>as shown in the following screenshot:</span></p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/eae20409-2fe3-407d-bda3-2e003ab53e56.png"/></div>
<p>The first thing to configure is the details of the <span class="packt_screen">Default Image</span> to be used as the parent image from which to create the virtual desktop machines for this desktop pool. This section is shown in the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/8945d81c-0bb4-49d1-a2c5-db4caca46117.png" style=""/></div>
<p class="mce-root"/>
<p class="mce-root"/>
<p>So, let's start with the configuration:</p>
<ol start="1">
<li>On the first box, <span class="packt_screen">Parent VM</span>, click the <span class="packt_screen">Browse...</span> button (<strong>62</strong>). You will now see the <strong>Select Parent VM</strong> box, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/3a9d58ae-1ac3-4668-bf71-5dbfdc4baa25.png"/></div>
<ol start="2">
<li>You will now see a list of the available <strong>valid</strong> parent VMs. By valid, this means that these will be VMs that contain snapshots and have the Horizon View Agent installed within them. The VMs that will be filtered by default are virtual machines running on ESX/ESXi hosts older than 4.0, VMs that don't have a snapshot, VMs with an unsupported guest OS, VMs already used by another desktop pool, and View Composer Replicas. It is possible to add these VMs to the configuration by clicking on the <span class="packt_screen">Show all parent VMs</span> button. However, if they are not compatible, you will not be able to select them.</li>
<li>The images displayed using the example lab are the gold images that we created previously. As we are building the Windows 7 desktop pool, we are going to use the Windows 7 parent machine, so select the entry for <span class="packt_screen">Windows 7 Gold Image</span> <strong>(63)</strong>.</li>
<li>Once you have selected the parent VM you want to use, click <span class="packt_screen">OK</span> to continue.</li>
<li>You will now return to the <span class="packt_screen">vCenter Settings</span> screen, where we can configure the second of the options on the <span class="packt_screen">Default Image</span> section. You will also see that the <span class="packt_screen">Parent VM</span> box (<strong>64</strong>) has now been populated with the details of the Windows 7 gold image, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/6e351b77-5695-45c7-85f2-9eab304cd278.png"/></div>
<ol start="6">
<li>As this is a Linked Clone virtual desktop machine, the next configuration task is to configure the details of the snapshot that was created from the parent image.</li>
<li>On the <span class="packt_screen">Snapshot</span> box, click the <span class="packt_screen">Browse...</span> button (<strong>65</strong>). You will now see the <strong>Select default image</strong>, box as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/08be8f2a-dd25-45b0-aa48-6b592cdaacfb.png" style=""/></div>
<ol start="8">
<li>The first thing you can see is the details of the parent image (<strong>66</strong>).</li>
<li>Below that, you will see the list of snapshots created from this parent VM. In this case, we have just one, the snapshot for <span class="packt_screen">Windows 7 Gold Image</span>, which we will click to select (<strong>67</strong>). If you had more than one snapshot for this image, then they will all be listed, allowing you to select the correct one.</li>
<li>When you click the snapshot, you will see the <span class="packt_screen">Snapshot Details</span> button (<strong>68</strong>) is now available to click. If you click this, then you will see the full details of the snapshot, as shown. Click <span class="packt_screen">OK</span> to close the <span class="packt_screen">Snapshot Details</span> box.</li>
</ol>
<ol start="11">
<li>Click <span class="packt_screen">OK</span> on the <span class="packt_screen">Select default image</span> box to complete the configuration.</li>
<li>You will now see that the snapshot has been added, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/c26b727f-5041-4de4-b3a7-d306893941a6.png"/></div>
<p>The next part of the <strong>vCenter Settings</strong> is the <span class="packt_screen">Virtual Machine Location</span> setting, as shown in the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/0cd2be8e-ca66-462d-990f-d3b9abdc6074.png"/></div>
<p>To proceed further, perform the following steps:</p>
<ol>
<li>On the <span class="packt_screen">VM folder location</span> box, click the <span class="packt_screen">Browse...</span> button (<strong>69</strong>).</li>
<li>You will now see the <span class="packt_screen">Select the folder to store the VM</span> box, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/902d1516-33fb-4fc8-b7c4-17847c7c1b67.png" style=""/></div>
<ol start="3">
<li>Expand <span class="packt_screen">PVO's Datacenter</span> by clicking the arrow (<strong>70</strong>) and then select the folder in which you want to create the virtual desktop machine. In the example lab, this folder has been called <span class="packt_screen">Horizon Desktops</span> (<strong>71</strong>).</li>
</ol>
<div class="packt_tip">You might want to consider a folder structure for the virtual machines to help with management; otherwise, you could end up creating hundreds of different virtual desktop machines that reside in different pools, all in the same folder.</div>
<ol start="4">
<li>Click <span class="packt_screen">OK</span> to continue.</li>
<li>You will return to the <span class="packt_screen">vCenter Settings</span> screen where you will see that the <span class="packt_screen">VM folder location</span> has now been added, as you can see in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/d7d2c1a0-b66e-42a7-a8a8-d04010205a21.png" style=""/></div>
<p>The next configuration section is for the resources that are going to host and run the virtual desktop machines in the pool:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/ec08a96b-72e7-40c4-82a5-1efe06ed6c87.png" style=""/></div>
<p><span>The options shown are as follows:</span></p>
<ol>
<li>First, in the <span class="packt_screen">Host or cluster</span> box, click the <span class="packt_screen">Browse...</span> button (<strong>72</strong>).</li>
<li>You will then see the <span class="packt_screen">Host or Cluster</span> box appear, listing the available host resources. The host resources are the ESXi servers available. In this example, we can see the IP address of the example lab ESXi server.</li>
</ol>
<div class="packt_infobox">In a production environment, the hosting infrastructure used in this part of the configuration would be part of the desktop block hosting infrastructure.</div>
<ol start="3">
<li>Click on the IP address <kbd>192.168.1.131</kbd> (<strong>73</strong>).</li>
<li>Click <span class="packt_screen">OK</span> to continue.</li>
<li>You will now return to the <span class="packt_screen">vCenter Settings</span> <span>screen, where you will see that the</span> <span class="packt_screen">Host or cluster</span> <span>has now bee</span><span>n added, as you can see in the following screenshot:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/62a9ebd2-1a9b-493e-a7c2-a4ea06a06312.png" style=""/></div>
<ol start="6">
<li>Next, we are going to configure the resource pool for this desktop pool to use.</li>
</ol>
<ol start="7">
<li>In the <span class="packt_screen">Resource pool</span> <span>box, click the</span> <span class="packt_screen">Browse...</span> <span>button (<strong>74</strong>). You will now see the</span> <span class="packt_screen">Select a resource pool to use for this desktop pool</span> <span>box, from where you can select the resource pool, as shown in the following screenshot:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/4b2af10b-19e1-4cdc-87f0-8158a312893f.png" style=""/></div>
<ol start="8">
<li>The resource pool for the example lab is the ESXi host server again, so click the IP address <kbd>192.168.1.131</kbd> to select this from the list (<strong>75</strong>).</li>
<li>Click <span class="packt_screen">OK</span> to continue.</li>
<li>You will now return to the <span class="packt_screen">vCenter Settings</span> <span>screen, where you will see that the</span> <span class="packt_screen">Resource pool</span> <span>has now been added, as you can see in the following screenshot:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/7276919c-71ca-4e54-86f4-4938c3c77544.png" style=""/></div>
<p>The final configuration option in this section is for <strong>Datastores</strong>. In the example lab, we are using a single datastore, which was selected from the <strong>Storage Optimization</strong> settings screen. If you had opted to place the different disks on different datastores, then you would now see options to configure the location for the OS disk datastore, persistent disk datastore, and replica disk datastore:</p>
<ol>
<li>In the <span class="packt_screen">Datastores</span> box, click the <span class="packt_screen">Browse...</span> button (<strong>76</strong>).</li>
<li>You will now see the <strong><span class="ScreenTextPACKT">Select Linked Clone Datastores</span></strong> <span>configuration screen, which shows all available datastores, as shown in the following screenshot:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/7a3d42df-53af-4895-938f-8abea150bbb0.png"/></div>
<ol start="3">
<li>Check the box for <span class="packt_screen">VM Datastore</span> (<strong>77</strong>). You then have the option to configure <span class="packt_screen">Storage Overcommit</span>. The overcommit level represents the multiplier that, when applied to the capacity of the full desktop, gives you the amount you wish to allow in the datastore.</li>
<li>To configure an overcommit, click the drop-down menu (<strong>78</strong>), from where you can select from the following options:
<ul>
<li><span class="packt_screen">None</span>: No overcommit allowed</li>
<li><span class="packt_screen">Conservative</span>: Allows four-time overcommit</li>
<li><span class="packt_screen">Moderate</span>: Allows seven-time overcommit</li>
<li><span class="packt_screen">Aggressive</span>: Allows 14-time overcommit</li>
<li><span class="packt_screen">Unbounded</span>: Has no restriction</li>
</ul>
</li>
</ol>
<ol start="5">
<li>For example, if the size of your full desktop was 10 GB and you had a 100 GB datastore, then selecting <span class="packt_screen">None</span> would allow you to provision 10 desktops, <span class="packt_screen">Conservative</span> would allow you 40 desktops, <span class="packt_screen">Moderate</span> would allow 70 desktops, <span class="packt_screen">Aggressive</span> would allow 150 desktops, and <span class="packt_screen">Unbounded</span> would have no restriction.</li>
</ol>
<div class="packt_tip">You need to be careful with choosing how you are going to configure the overcommit setting, and the only real way to judge this is to monitor Linked Clone growth during the POC.</div>
<ol start="6">
<li>Once configured, click the <span class="packt_screen">OK</span> button. You will return to the <strong>vCenter Settings</strong> configuration screen, where you will see that the details of the Linked Clone datastores have now been entered by displaying the text <span class="packt_screen">1 selected (79)<strong>,</strong></span> as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/dbb25cc4-ac15-4910-9e38-4fc768ab089a.png"/></div>
<ol start="7">
<li>With the <strong>vCenter Settings</strong> configuration now complete, click the <span class="packt_screen">Next &gt;</span> button to continue to the next configuration screen.</li>
</ol>
<p>The next configuration screen is for <strong><span class="packt_screen">Advanced Storage Options.</span></strong></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Advanced Storage Options</h1>
                </header>
            
            <article>
                
<p><span>In the next screen, we are going to configure the</span> <strong>Advanced Storage Options</strong>, <span>as shown in the following screenshot:</span></p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/82b29ddd-57f0-4b15-b78d-9037960f7b66.png"/></div>
<p>In the first section of this configuration screen, you can configure the <span class="packt_screen">View Storage Accelerator</span> and how to manage disk space. <span><span class="packt_screen">View Storage Accelerator</span> allows y</span><span>ou to configure desktop pools to enable ESXi hosts (vSphere 5.x or later) to cache virtual machine disk data. This feature uses the <strong>Content Based Read Cache</strong> (<strong>CBRC</strong>) feature of the ESXi host server. The View Storage Accelerator, or VSA, reduces the disk IOPS and therefore improves the performance during boot storms.</span></p>
<p class="mce-root"/>
<p class="mce-root"/>
<p><span>A boot storm occurs when a large number of virtual desktop machines all start up and boot at the same time, and they all run an anti-virus scan at the same time. The feature is also beneficial when administrators or users load applications or data frequently:</span></p>
<ol>
<li>To enable the <span class="packt_screen">View Storage Accelerator</span>, check the box for <span class="packt_screen">Use View Storage Accelerator</span> (<strong>80</strong>), as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/2f30cc3a-12c2-4610-9fbf-f00c212ac808.png" style=""/></div>
<ol start="2">
<li>In the <span class="packt_screen">Disk Types</span> section, you then have the option of which particular disks you want the <span class="packt_screen">View Storage Accelerator</span> to apply to. From the drop-down menu (<strong>81</strong>), you can choose from <span class="packt_screen">OS disks</span> or <span class="packt_screen">OS and persistent disks</span>. In the example lab, we are going to choose the <span class="packt_screen">OS disks</span> option.</li>
<li>The <span class="packt_screen">Regenerate storage accelerator after</span> option, then allows you to specify a time limit on when you want to regenerate the data that has been cached. This basically clears the cache and rebuilds it. By default, this is set to <kbd>7</kbd> days.</li>
<li>If you check the <span class="packt_screen">Other Options</span> box (<strong>82</strong>), you have two options here. The first, which is grayed out in the example lab, is for <strong>Use native NFS snapshots</strong> (<strong>VAAI</strong>). VAAI, or vStorage API for Array Integration, is a hardware feature integrated into specific hardware-based arrays. It uses native snapshotting technology to provide Linked Clone functionality. You would only choose this option if you have appropriate hardware devices that support VAAI. This is grayed out in the example lab, as we don't have any supported devices.</li>
</ol>
<ol start="5">
<li>The next option in this section is for <span class="packt_screen">Reclaim VM disk space</span>. Virtual desktop machines hosted on vSphere 5.x and later can be configured to use a space-efficient disk format that supports reclamation of unused disk space (such as deleted files). Enabling this option, by clicking the radio button, reclaims unused disk space on each virtual machine and is initiated when an estimate of used disk space exceeds the disk size specified in this setting. By default, this threshold is set to <kbd>1</kbd> GB.</li>
<li>The next setting under <span class="packt_screen">Advanced Storage Options</span> is to configure blackout times for cache regeneration and space reclamation. This should be set to ensure that these operations won't be scheduled during working hours and ensure users are not affected. The <span class="packt_screen">Blackout Times</span> configuration box is shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/f6a17b5e-a22c-47bd-a85a-7fcb4df8ea43.png" style=""/></div>
<ol start="7">
<li>Click the <span class="packt_screen">Add...</span> button (<strong>83</strong>) to add a blackout time.</li>
<li>You will then see the <span class="packt_screen">Set Blackout Days</span> configuration box. Here, you can select the days by checking the box to configure the days you <strong>DO NOT</strong> want to run regeneration or space reclamation tasks. You can also select specific times not to run the tasks.</li>
<li>Click <span class="packt_screen">OK</span> once you have configured your blackout days and times. You will return to the <span class="packt_screen">Blackout Times</span> configuration box, which will detail your configured times, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/2f662637-39da-476b-bf76-be781581a266.png" style=""/></div>
<ol start="10">
<li>In this example, we have configured the blackout for weekdays between <kbd>08:00</kbd> and <kbd>19:00</kbd>. You can add additional blackout times as well as delete or edit existing configurations.</li>
</ol>
<p class="mce-root" style="padding-left: 60px"><span>The final setting under</span> <span class="packt_screen">Advanced Storage Options</span> <span>is to configure a</span> <span class="packt_screen">Transparent Page Sharing Scope<strong>,</strong></span> <span>as shown in the following screenshot:</span></p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/d57f8ffb-6561-480b-9e2c-d8d9549ac620.png" style=""/></div>
<p style="padding-left: 60px">What is transparent page sharing, or TPS? TPS is a memory management technology that is used in virtualization solutions. In desktop virtualization, you are running potentially thousands of copies of exactly the same operating system, all consuming memory, and using exactly the same memory pages. TPS reduces the number of redundant memory pages on a host server down to a single page. <span>The ESXi hypervisor looks for these duplicate pages and if it identifies identical memory pages on multiple virtual machines (VMs) on the same host server, then it shares the single page across the virtual desktop machines, putting in place memory pointers to refer back to the page. This is a much more efficient use of memory, and frees up space to allow more virtual desktops to run.</span></p>
<ol start="11">
<li>From the drop-down menu (<strong>84</strong>), select the scope for TPS. You have the option of sharing memory across a <span class="packt_screen">Virtual Machine</span>, the virtual desktop machines in a <span class="packt_screen">Desktop Pool</span>, t<span>he virtual</span> desktop <span>machines in a</span> <span class="packt_screen">Pod</span><span>, or at a</span> <span class="packt_screen">Global</span> <span>level.</span></li>
<li>Click the <span class="packt_screen">Next &gt;</span> button once you have completed configuring the <strong>Advanced Storage Options</strong>.</li>
</ol>
<p>The next configuration screen is for <span class="packt_screen">Guest Customization<strong>,</strong></span> as shown in the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/1c2c37db-d2e3-412f-8e60-4ff9c6a18bc6.png"/></div>
<p>On this configuration screen, you can configure where in Active Directory virtual desktop machines reside, as well as how to customize the guest OS:</p>
<ol>
<li>In the <span class="packt_screen">Domain</span> section, on the drop-down menu (<strong>85</strong>), select the domain where you want the machine accounts to reside. In the example lab, this is our <kbd>pvolab.com</kbd> domain.</li>
<li>Next, you can choose the <span class="packt_screen">AD container</span> where you want the <span>machine accounts to reside. The default setting for this is the</span> computers <span>container, so you will see</span> <kbd>CN=Computers</kbd><span>. To change this, click the</span> <span class="packt_screen">Browse...</span> <span>button (<strong>86</strong>).</span></li>
</ol>
<ol start="3">
<li>You will now see the AD container box. If you expand out the domain, you will see all your containers, so select the appropriate container where you want to store the virtual desktops created with this desktop pool. For example, this desktop pool could be for the technical department, and so you may have a container in AD that reflects this. It's worth creating a folder/container structure that reflects your organization and makes it easier to manage your virtual desktop machines rather than have them all in the standard computers container.</li>
<li>Click to highlight the container you want to use and then click <span class="packt_screen">OK</span>.</li>
<li>You will now return to the <span class="packt_screen">Guest Customization</span> <span>screen.</span></li>
<li>Check the box for <span class="packt_screen">Allow reuse of pre-existing computer accounts</span>. This allows you to reuse existing AD computer accounts if the virtual desktop machine names of newly created Linked Clones match the existing computer account names. This is particularly useful when creating non-persistent desktops.</li>
<li>Next, click the radio button for <span class="packt_screen">Use QuickPrep</span> (<strong>87</strong>). QuickPrep will allow you to prepare your desktops in a quicker fashion than Sysprep. However, no unique SID will be created. Sysprep will create a new SID but will take longer for each desktop to prepare. Which one you choose to use will depend on your use cases. It is recommended that you test your configuration during the POC. As part of QuickPrep, you can also specify additional scripts along with any parameters you want to use for those scripts.</li>
<li>The final option is to use SysPrep instead of QuickPrep. To use this feature, click the radio button for <span class="packt_screen">Use a customization specification (SysPrep)</span>. This will utilize an existing script from the vCenter Server. In the following example, we have used a pre-built script called <strong>Virtual Desktop Customization:</strong></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/5a6f295a-62d9-4122-8730-5f22b40ee1a9.png"/></div>
<ol start="9">
<li>To use this script, click to highlight it. In the example lab, we are going to use QuickPrep, so ensure this option is selected.</li>
<li>Click the <span class="packt_screen">Next &gt;</span> button when you have completed the configuration.</li>
<li>You will now see the final screen, the <span class="packt_screen">Ready to Complete</span> screen, as shown in the following screenshot:</li>
</ol>
<div class="mce-root CDPAlignCenter CDPAlign"><img src="assets/c0b008f8-561c-45ce-be62-52c3ade24ee0.png"/></div>
<p class="NormalPACKT"><span>Review your configuration settings, and then click the</span> <span class="packt_screen">Finish</span> <span>button to create the desktop pool.</span></p>
<p class="NormalPACKT"><span>You also have the option of ticking the</span> <span class="packt_screen">Entitle users after this wizard finishes</span> <span>box (<strong>88</strong>) at the top of the screen, which will automatically launch th</span>e entitlement configuration s<span>creen so you can give end users access to the virtual desktop machines in this pool. However, in the example lab, we will do this later, after we have created some additional desktop pools.</span></p>
<p class="NormalPACKT"><span>You will now see that the pool has been created, as shown in the following screenshot:</span></p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/9a06bb6b-ce85-46a5-9a46-c990639c9c52.png"/></div>
<p>You will also see on the vCenter Server, that the folder structure for Linked Clones has been set up. You will see, under the <kbd>Horizon Desktops</kbd> folder, a new folder called <kbd>Win7-dedicated-lc</kbd>, the name reflecting the ID you entered for the pool. The virtual desktop machines to be built will reside in this folder. This is shown in the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/0098ad44-5aa6-483f-a200-d1b3005183e7.png" style=""/></div>
<p class="NormalPACKT"><span>In the next section, we are going to show you how to create another desktop pool, but this time we will use the Horizon Console instead of the View Administrator.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Horizon Console method</h1>
                </header>
            
            <article>
                
<p class="mce-root">As well as the current Horizon View Administrator management console, there is a new web-based console. This is called the <strong>Horizon Console</strong>. However, at the time of writing this book, there are several features that are <strong>not</strong> supported by the Horizon Console, including the following:</p>
<ul>
<li>Automated, floating-assignment pools of full virtual machines</li>
<li>Automated Linked Clone desktop pools</li>
<li>Automated Linked Clone farms</li>
<li>Cloning an automated desktop pool</li>
<li>Cloud pod architecture configuration</li>
<li>Manual desktop pools</li>
<li>ThinApp applications</li>
</ul>
<p>In this section, we are going to create the same desktop pool that we created previously, but this time using the Horizon Console. We will run through the screenshots and configuration options, but for more details on each configuration option, please refer back to the previous section.</p>
<p>The first thing to do is to launch the Horizon Console. There are two ways of doing this. The first way is to log in to the classic View Administrator and click on the link for <span class="packt_screen">Horizon Console</span> (<strong>1</strong>), as shown in the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/7c93d62d-f8e8-426c-8dc3-23c6441be72b.png" style=""/></div>
<p>The other way is to use your browser to navigate directly to the URL of the Connection Server, but this time add <kbd>/newadmin</kbd> to the end of the URL. So, for the example lab, you would type <kbd>https://hzn7-cs1/newadmin</kbd>. You will then see the login screen, as shown in the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/133c2a5b-fbd8-4bb3-91c7-b9e6de6c9cbf.png" style=""/></div>
<p class="mce-root"/>
<p class="mce-root"/>
<p>Enter the username and password, ensuring you select the correct domain from the drop-down menu, and then click on the green <span class="packt_screen">Sign in</span> button. Now you are logged in, you will now see the <strong>Horizon Console</strong> main screen, as shown in the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/820e6aba-5683-4f5c-a9b2-320b74af3399.png" style=""/></div>
<p>We are now going to configure a desktop pool by performing the following steps:</p>
<ol>
<li>Unlike with the classic View Administrator console, desktop pools in the Horizon Console come under the general heading of desktops, so, from the menu options on the left-hand side, expand <span class="packt_screen">Inventory</span> and then click on <span class="packt_screen">Desktops</span> (<strong>2</strong>). You will now see the <strong>Desktop Pools</strong> configuration screen, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/83a7a0a5-0489-4d22-be2e-56462ef34b69.png"/></div>
<ol start="2">
<li>Click the <span class="packt_screen">Add</span> button (<strong>3</strong>). You will now see the <span class="packt_screen">Add Pool</span> <span>screen</span> with the first section highlighted for <span class="packt_screen">Type<strong>,</strong></span> as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/b8f705be-d55e-41ce-93e7-96d29e093772.png"/></div>
<ol start="3">
<li>Click on <span class="packt_screen">Automated desktop pool</span> (<strong>4</strong>). Remember, currently, there is no option to configure a manual desktop pool.</li>
<li>Click the <span class="packt_screen">Next</span> button to continue.</li>
</ol>
<ol start="5">
<li>You will now move onto the next item on the list, <span class="packt_screen">vCenter Server<strong>,</strong></span> as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/e2268634-5270-410c-9381-932bdf3e1da4.png" style=""/></div>
<ol start="6">
<li>Click the radio button for <span class="packt_screen">Instant Clone</span> (<strong>5</strong>). Remember, the version of the Horizon Console used in the example lab currently does not support Linked Clone configuration.</li>
<li>Next, from the list, select the vCenter Server you want to use for creating the Instant Clones from. In the example lab, the vCenter Server is listed by its IP address, so click on <kbd>192.168.1.178</kbd> <strong>(6)</strong> and then click <span class="packt_screen">Next</span> to continue. You will now see the <span class="packt_screen">User Assignment</span> configuration, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/0dd3ce8b-72b7-4891-acab-2eb5b2e16bcf.png" style=""/></div>
<ol start="8">
<li>Click the radio button for <span class="packt_screen">Dedicated</span> (<strong>7</strong>) and also ensure that you check the box for <span class="packt_screen">Enable automatic assignment</span>.</li>
<li>Click <span class="packt_screen">Next</span> to continue. You will now see the <span class="packt_screen">Storage Optimization</span> option, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/d0d1e1bf-aa0a-4063-b5ed-16b56c733974.png"/></div>
<ol start="10">
<li>Click the radio button to select whether you want to use VMware Virtual SAN or not. In the example lab, this has not been configured. Also on this configuration screen, you can choose whether or not to use separate datastores for replica and OS disks.</li>
<li>Click <span class="packt_screen">Next</span> to continue.</li>
<li>You will now see the <span class="packt_screen">Desktop Pool Identification<strong>,</strong></span> screen as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/0ac63c5f-b7b0-47d8-b109-e8c1cb2f8dcb.png"/></div>
<ol start="13">
<li>In the <span class="packt_screen">ID</span> box <strong>(8)</strong>, enter a name to use to identify this desktop pool. In this example, we have called it <kbd>Win-7-Desktop-IC</kbd>.</li>
<li>Next, in the <span class="packt_screen">Display</span> <span class="packt_screen">name</span> box <strong>(9)</strong>, enter a name that end users will see to identify this particular desktop pool. In this example, we have called it <kbd>Windows 7 Desktop</kbd>.</li>
<li>If you have configured an <span class="packt_screen">Access group<strong>,</strong></span> <span>then select it from here by clicking on the drop-down menu.</span></li>
<li>Finally, in the <span class="packt_screen">Description</span> box <span>(<strong>10</strong>), enter a description to describe this desktop pool.</span></li>
<li>Click <span class="packt_screen">Next</span> to continue.</li>
</ol>
<ol start="18">
<li>You will now see the <span class="packt_screen">Provisioning Settings</span> screen, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/aff74318-918d-4cd4-a3a5-aabbb9916566.png"/></div>
<ol start="19">
<li>Under the <span class="packt_screen">Basic</span> section, check the box for <span class="packt_screen">Enable provisioning</span> <strong>(11)</strong> and the box for <span class="packt_screen">Stop provisioning on error</span> (<strong>12</strong>).</li>
<li>Then, in the <span class="packt_screen">Virtual Machine Naming</span> box (13), type in a name that you want to call the virtual desktop machines that get built. In the example lab, we have entered the name <kbd>Win7-IC</kbd>.</li>
<li>In the <span class="packt_screen">Provisioning Timing</span> section, click the radio button for <span class="packt_screen">Provision all machines up-front</span> (<strong>14</strong>).</li>
<li>And finally, in the <span class="packt_screen">Desktop Pool Sizing</span> section, in the <span class="packt_screen">Max number of machines</span> box (<strong>15</strong>), type in the number of machines you want as a maximum in this desktop pool, and then type in the number of spare virtual desktop machines you want in the <span class="packt_screen">Number of spare (powered on) machines box</span> (<strong>16</strong>).</li>
</ol>
<ol start="23">
<li>Click <span class="packt_screen">Next</span> to continue.</li>
<li>You will now see the <span class="packt_screen">vCenter Settings</span> screen, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/c721d639-2050-4dbe-b910-37a3bc5bd08f.png"/></div>
<ol start="25">
<li>The first task is to select the <span class="packt_screen">Default image</span> from the gold images we have already created. To do this, click the <span class="packt_screen">Browse...</span> button (<strong>17</strong>) next to the <span class="packt_screen">Parent VM</span> box. You will now see the <span class="packt_screen">Select a Parent VM</span> screen, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/aa5b48a1-1db2-499d-8199-ddf7a7adc2b6.png"/></div>
<ol start="26">
<li>In this example, we are going to create a desktop pool using Windows 7 as the operating system, so click to select the option for <span class="packt_screen">Windows 7 Gold Image</span> from the list of available images, and then click the <span class="packt_screen">Submit</span> button.</li>
<li>You will now return to the <span class="packt_screen">vCenter Settings</span> screen, where we can configure the next option for <span class="packt_screen">Snapshot</span>. You will also see that the <span class="packt_screen">Parent VM</span> box (<strong>19</strong>) has now been populated, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/8203a231-3844-49b3-8d8a-905d80bfc1bc.png"/></div>
<ol start="28">
<li>The next <span class="packt_screen">Default image</span> setting is to configure which snapshot to use. Click the <span class="packt_screen">Browse...</span> button next to the <strong>Snapshot</strong> box (<strong>20</strong>). You will now see the <span class="packt_screen">Parent VM in vCenter</span> screen, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/46678e82-6cee-46ff-9d50-d8024943a240.png" style=""/></div>
<ol start="29">
<li>From the list of snapshots for this image, select the one you want to use. In the example lab, we only have the one snapshot that we have created, so click the <span class="packt_screen">Windows 7 Gold Image</span> option from the list (<strong>21</strong>).</li>
<li>Click the <span class="packt_screen">Submit</span> button to continue. You will now return to the <span class="packt_screen">vCenter Settings</span> <span><span>screen, where you will see that the snapshot has been added to the configuration (<strong>22</strong>), as shown in the following screenshot:</span></span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/b88f404f-d23b-46f0-8f00-c45f85e2dd22.png"/></div>
<ol start="31">
<li>Next, we are going to configure <span>the next set of options for</span> <span class="packt_screen">Virtual Machine Location</span><span>. <span>Click the</span></span> <span class="packt_screen">Browse...</span> <span><span>button next to the</span></span> <span class="packt_screen">VM Folder Location</span> <span><span>box (<strong>23</strong>). You will now see the</span></span> <span class="packt_screen">Select the folder to store the VM</span> <span><span>screen, as shown in the following screenshot:</span></span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/ecbfcc5a-7b5b-43ce-a286-6b51b401bf24.png"/></div>
<ol start="32">
<li>Select the folder where you want to store the virtual desktop machines that will be created as part of this desktop pool. In the example lab, expand out the entry for <span class="packt_screen">PVO's Datacenter</span> and then click on the <span class="packt_screen">Horizon Desktops</span> folder (<strong>24</strong>).</li>
</ol>
<ol start="33">
<li>Click the <span class="packt_screen">Submit</span> button to continue. You will now return to the <span class="packt_screen">vCenter Settings</span> <span>screen, where you will see that the VM folder location has been added to the configuration, as shown in the following screenshot:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/d1941cd2-b1d7-4f60-ac55-11048ae71245.png" style=""/></div>
<ol start="34">
<li>The next set of configuration options are for <span class="packt_screen">Resource Settings<strong>,</strong></span> as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/426ac3f2-bc84-46a5-924a-cece201d9f60.png"/></div>
<ol start="35">
<li>First, we are going to configure which cluster is going to host the virtual desktop machines in this desktop pool. Click the <span class="packt_screen">Browse...</span> button next to the <span class="packt_screen">Cluster</span> box (<strong>25</strong>). You will now see the <span class="packt_screen">Select Cluster</span> screen, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/89057587-8d8f-4102-b8df-b813d7fea3af.png"/></div>
<ol start="36">
<li>In the example lab, expand out the entry for <span class="packt_screen">PVO's Datacenter</span> and then click on the <span class="packt_screen">PVO Desktop Cluster</span> option (<strong>26</strong>). Now click the <span class="packt_screen">Submit</span> button. You will now return to the <span class="packt_screen">vCenter Settings</span> screen, where you will see that the details of the <strong>Cluster</strong> (<strong>27</strong>) have been added to the configuration, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/6987e061-6fc2-4784-b403-5d5c6ad08514.png"/></div>
<p class="mce-root"/>
<p class="mce-root"/>
<ol start="37">
<li>Next, we are going to select the <span class="packt_screen">Resource Pool</span>. <span>Click the</span> <span class="packt_screen">Browse...</span> <span>button next to the</span> <strong><span class="packt_screen">Resource Pool</span></strong> <span>box (<strong>28</strong>). You will now see the</span> <span class="packt_screen">Select a resource pool to use for this Desktop Pool</span> <span>screen, as shown in the following screenshot:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/b2a83409-4928-43de-80f8-ab058904fed3.png"/></div>
<ol start="38">
<li>From the list, click on the resource pool you want to use. In the example lab, click on the entry for <span class="packt_screen">PVO Desktop Cluster</span> (<strong>29</strong>).</li>
<li>Click the <span class="packt_screen">Submit</span> button to continue. You will now return to the <span class="packt_screen">vCenter Settings</span> <span>screen, where you will see that the <strong>Resource pool</strong> details have been added to the con</span><span>figuration (<strong>30</strong>), as shown in the following screenshot:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/64f9c7ca-a9aa-4baa-9d33-6976de8f9c2d.png" style=""/></div>
<ol start="40">
<li>Next to configure is the datastore where the virtual desktop machines in this desktop pool are going to be stored. <span>Click the</span> <span class="packt_screen">Browse...</span> <span>button next to the</span> <span class="packt_screen">Datastores</span> <span>box (<strong>31</strong>). You will now see the</span> <span class="packt_screen">Select Datastores</span> <span>screen, as shown in the following screenshot:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/e6bc878e-6b86-4fed-a770-557cda72e7ad.png"/></div>
<ol start="41">
<li>From the list, check the box for the datastore that you want to use. In the example lab, this is the <span class="packt_screen">VM Datastore</span> (<strong>32</strong>).</li>
<li><span>Click the</span> <span class="packt_screen">Submit</span> <span>button.</span></li>
</ol>
<ol start="43">
<li>In the example lab, as we are using a local datastore, you will see the following warning message:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/17d37315-6b6f-4cf6-a408-3a14dc4ac48c.png" style=""/></div>
<ol start="44">
<li>Click <span class="packt_screen">OK</span> to acknowledge the warning message and to close the box.</li>
</ol>
<ol start="45">
<li>You will now return to the <span class="packt_screen">vCenter Settings</span> <span>screen, where you will see that the</span> <span class="packt_screen">Datastore</span> <span>section now shows that a datastore has been selected (<strong>33</strong></span><span>), as shown in the following screenshot:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/42832a19-0d69-4681-876f-29a46e1b8876.png" style=""/></div>
<ol start="46">
<li>The final thing to configure is the <span class="packt_screen">Network</span> section, which allows you to configure which virtual network the virtual desktop machines in this desktop pool are going to connect to.</li>
<li>By default, this is configured as the same virtual network that the parent VM was set to. To change the network configuration, click the <span class="packt_screen">Browse...</span> button (<strong>34</strong>) and then select the relevant network. In the example lab, we are going to leave this as the default configuration setting.</li>
</ol>
<ol start="48">
<li>Click <span class="packt_screen">Next</span> to continue to the next configuration option. You will now see the <span class="packt_screen">Desktop Pools</span> <span>configuration</span> screen, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/3c47f9d7-cf4f-4c3d-8cdd-524316bd5696.png"/></div>
<ol start="49">
<li>The first thing to configure is to enable the desktop pool so that users can access the virtual desktop machines within the desktop pool. In the <span class="packt_screen">State</span> box (<strong>35</strong>), from the drop-down menu, ensure that <span class="packt_screen">Enabled</span> is selected.</li>
<li>You can then configure the <span class="packt_screen">Connection Server restrictions</span> and the <span class="packt_screen">Category Folder</span>.</li>
<li>Next, in the <span class="packt_screen">Automatically logoff after disconnect</span> box (<strong>36</strong>), f<span>rom the drop-down menu, choose the appropriate action to take. In this example, we have chosen</span> <span class="packt_screen">Never</span> <span>so that the user never logs off when they disconnect from their virtual desktop machine.</span></li>
<li>Then, in the <span class="packt_screen">Allow users to restart/reset machines</span> box (<strong>37</strong>), <span>f</span><span>rom the drop-down menu, choose the appropriate action to take. In this example, we have chosen</span> <span class="packt_screen">No</span><span>, so users cannot restart or reset their virtual desktop machines.</span></li>
</ol>
<ol start="53">
<li>Click <span class="packt_screen">Next</span> to continue. <span>You will now see the</span> <span class="packt_screen">Remote Display Settings</span> <span>configuration</span> <span>screen, as shown in the following screenshot:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/799402e9-6081-4001-928b-0b6e0a1daf8d.png"/></div>
<ol start="54">
<li>First, on the <span class="packt_screen">Default display protocol</span> box (<strong>38</strong>), from the drop-down menu, choose the display protocol that you want this desktop pool to use. In the example lab, we have chosen <span class="packt_screen">PCoIP</span>.</li>
<li>Next, on the <strong>Allow users to choose protocol</strong> box (<strong>39</strong>), <span>from the drop-down menu, choose the whether you want to allow users to change from the default protocol. In the example lab, we have chosen</span> <span class="packt_screen">Yes</span><span>.</span></li>
<li>On the <span class="packt_screen">3D Renderer</span> box (<strong>40</strong>), choose the relevant 3D rendering model for this desktop pool.</li>
<li>Finally, check the <span class="packt_screen">Enabled</span> boxes for <span class="packt_screen">HTML Access</span> (<strong>41</strong>) and also <span class="packt_screen">Allow Session Collaboration</span> (<strong>42</strong>). Note that session collaboration requires the VMware Blast protocol.</li>
</ol>
<ol start="58">
<li>Click <span class="packt_screen">Next</span> to continue <span>to the next configuration option. You will now see the</span> <span class="packt_screen">Guest Customization</span> <span>screen, as shown in the following screenshot:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/c808001a-6f87-4673-b762-7af1e95a07a2.png"/></div>
<ol start="59">
<li>On this configuration screen, you can select where the virtual desktop machines are going to reside in Active Directory. In the <span class="packt_screen">Domain</span> box (<strong>43</strong>), from the drop-down menu, select the domain name of where they will live. In the example lab, this is the domain called <kbd>pvolab.com</kbd>.</li>
<li>Next, in the <span class="packt_screen">AD Container</span> box, click the <span class="packt_screen">Browse...</span> button and then choose the relevant container into which the virtual desktop machines in the desktop pool are <span>going to reside. In the</span> example lab<span>, this is the default setting of</span> <kbd>CN=Computers</kbd><span>.</span></li>
</ol>
<ol start="59">
<li><span>Click</span> <span class="packt_screen">Next</span> <span>to continue</span> <span>to the</span> <span class="packt_screen">Ready to Complete</span> <span>screen, as shown in the following screenshot:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/24217737-09a4-4039-85d5-d6d47485a9b0.png" style=""/></div>
<ol start="62">
<li>The only option on this screen is to check the box (<strong>45</strong>) to choose whether or not you <span class="packt_screen">Entitle users after this wizard finishes</span>. We will cover the configuring of entitlements later in this chapter, using both the classic View Administrator console and the new Horizon Console.</li>
</ol>
<p>You have now successfully configured a desktop pool using the Horizon Console. In the next section, we are going to create additional desktop pools to reflect the different types of pools.</p>
<p class="mce-root"/>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Creating dedicated, Full Clone desktop pools</h1>
                </header>
            
            <article>
                
<p>The process for creating a dedicated, Full Clone desktop pool is pretty much the same as we covered in the previous section, where we configured a dedicate Linked Clone desktop pool. There are a few changes, however, as we configuring a Full Clone virtual machine, which will use a template to create the virtual machines from, rather than a snapshot. As we work through this section, we will just highlight the different configuration options in more detail using screenshots, and for the tasks that we have covered previously, we will just describe these using text. You can refer back to the previous section for the screenshots.</p>
<p>To set up the desktop pool using the Horizon View Administrator, perform the following steps:</p>
<ol>
<li>From a workstation, open a browser and enter the address details of the View Connection Server. In the example lab, the address of the Connection Server is <kbd>https://hzn7-cs1.pvolab.com/admin</kbd>. Don't forget the <kbd>/admin</kbd> at the end; otherwise, you will end up on the Horizon Client page.</li>
<li>You will now see the View Administrator login screen. Log in using the administrator account.</li>
<li>You will now see the Horizon View Administrator dashboard screen.</li>
<li>From the Horizon View Administrator, click to expand the <span class="packt_screen">Catalog</span> option, and then click on <span class="packt_screen">Desktop Pools</span>. Then from the <span class="packt_screen">Desktop Pools</span> pane that is now displayed, click the <span class="packt_screen">Add...</span> button.</li>
<li>You will now see the <span class="packt_screen">Add Desktop Pool</span> screen, starting with the <span class="packt_screen">Type</span> section where we select which type of desktop pool you want to create.</li>
<li>Click the radio button for <span class="packt_screen">Automated Desktop Pool</span>. When selecting the various types of desktop pools that are available, the description on the right-hand side will change, reminding you of the differences between types.</li>
<li>Now click the <span class="packt_screen">Next &gt;</span> button to continue.</li>
<li>You will now see the <span class="packt_screen">User Assignment</span> screen.</li>
<li>Click the radio button for <span class="packt_screen">Dedicated</span>. The <span class="packt_screen">Enable automatic assignment</span> option will already be selected by default. This means the desktops will be assigned to the users on a first come, first served basis, as they log in. If, for some reason, you need to ensure a user is assigned a specific desktop, then you will need to uncheck this box, and manually assign them a virtual desktop machine.</li>
</ol>
<ol start="10">
<li>Click the <span class="packt_screen">Next&gt;</span> button to continue the configuration. On the <span class="packt_screen">vCenter Server</span> screen, you will now configure how the virtual desktops machines will be built, using the vCenter Server linked with this Connection Server, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/04b349e3-bfa5-4b1b-9978-43e06a0718e5.png"/></div>
<p style="padding-left: 60px">On this configuration screen, you again have the option to build either Instant Clones, View Composer Linked Clone virtual desktop machines, or <span>Full Clone virtual desktop machines.</span></p>
<ol start="11">
<li>For this second pool, we are going to use full virtual machines, so click the radio button for <span class="packt_screen">Full virtual machines</span> (<strong>1</strong>).</li>
<li>Next, you need to select the relevant vCenter Server from the list. In the example lab, the vCenter <kbd>192.168.1.178</kbd> is shown, along with the vCenter user account we set up for the View. Click to highlight and select this vCenter Server (<strong>2</strong>).</li>
</ol>
<ol start="13">
<li>Click the <span class="packt_screen">Next&gt;</span> button to continue the configuration. The next configuration screen is for the <span class="packt_screen">Desktop Pool Identification<strong>,</strong></span> as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/3bafcdb9-477e-4094-93cb-bf236ba20524.png" style=""/></div>
<ol start="14">
<li>In the <span class="packt_screen">ID</span> box (<strong>3</strong>), type in an ID for this desktop pool. In the example lab, we have entered the ID of <kbd>Win7-dedicated-full</kbd>.</li>
</ol>
<div class="packt_infobox">Remember, you can only use the characters <em>a</em>-<em>z</em>, <em>A</em>-<em>Z</em>, <em>0</em>-<em>9</em>, <em>-</em>, and <em>_</em> in the pool ID.</div>
<ol start="15">
<li>In the <span class="packt_screen">Display name</span> box (<strong>4</strong>), type in a name for this pool. Bear in mind that the display name is what is displayed to the end users, so make sure you give it a non-technical name that the users will understand.</li>
<li>Finally, in the <span class="packt_screen">Description</span> box (<strong>5</strong>), type in a more detailed description which describes the desktop pool.</li>
<li>Click the <span class="packt_screen">Next&gt;</span> button to continue the configuration. You will now see the <span class="packt_screen">Desktop Pool Settings</span> configuration screen.</li>
<li><span>This configuration page is where we start to configure the settings that will define the way the desktop behaves within the desktop pool for the end users. Configure the setting you want to apply to this pool and then click the</span> <span class="packt_screen">Next &gt;</span> <span>button to continue.</span></li>
<li><span>You will now see</span> the <span class="packt_screen">Provisioning Settings</span> <span>screen.</span></li>
</ol>
<ol start="20">
<li>The first setting in the <span class="packt_screen">Basic</span> <span>section is to</span> <span class="packt_screen">Enable provisioning</span><span>. Tick the</span> <span class="packt_screen">Enable provisioning</span> <span>box to switch provisioning on. This setting means that virtual desktop machines can be provisioned as per the configuration settings.</span></li>
<li>The next setting is for <span class="packt_screen">Stop provisioning on error</span>. By checking this box, it means that provisioning will stop if there is an error during the provisioning process.</li>
<li>The next section to configure is for the <span class="packt_screen">Virtual Machine Naming<strong>,</strong></span> <span>as shown in the following screenshot:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/4adffc26-19d1-4e31-8c6f-474354eadf61.png" style=""/></div>
<ol start="23">
<li>Click the radio button for <span class="packt_screen">Use a naming pattern</span> and then, in the <span class="packt_screen">Naming Pattern</span> box (<strong>6</strong>), enter the name pattern you want to use. In the example lab, we have called this <kbd>Win7-VM-Full-{n}</kbd>. <span>This will result in the virtual desktop machines being named <kbd>Win7-VM-Full-1</kbd>, <kbd>Win7-VM-Full-2</kbd>, and so on, up to the number of machines you specify that you want to build.</span></li>
<li>Next, in the <span class="packt_screen">Max number of machines</span> box, enter the maximum number of machines that can be provisioned in this desktop pool. This sets the limit of the number of virtual desktop machines in this desktop pool.</li>
<li>Next is the setting for the <span class="packt_screen">Number of spare (powered on) machines</span>. In the box, enter the number of machines that should be powered on and waiting for users to connect to them.</li>
<li><span class="packt_screen">Provisioning Timing</span> is the next option to configure. Either click the radio button for <span class="packt_screen">Provision machines on demand</span> and then enter the minimum number of machines or click the radio button for <span class="packt_screen">Provision all machines up-front</span>.</li>
</ol>
<ol start="27">
<li>The next option, as we are configuring Full Clone virtual desktop machines, is for a <strong>Virtual Device</strong>. The option in question is for <strong>A</strong><span class="packt_screen">dd a Trusted Platform Module (vTPM) device to the VMs<strong>,</strong></span> as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/c83de015-1960-4d82-9f92-21e6c3725e0d.png" style=""/></div>
<ol start="28">
<li>TPM is recognized for securing cryptoprocessors. <span>It is basically designed for securing hardware with the help of integrated cryptographic keys. It</span> is located on the motherboard of a physical machine in the form of dedicated microcontroller or microchip. A virtual TPM relies on the hypervisor (available with vCenter version 6.7) to provide virtual desktop machines with an isolated execution environment hidden from the software that is running within the virtual desktop machines. This feature secures their code from the software in the virtual desktop machines, providing a security level that is comparable to a firmware-based TPM.</li>
<li>Click the <span class="packt_screen">Next &gt;</span> button to continue to the next configuration screen.</li>
</ol>
<p><span>The next configuration screen is for</span> <span class="packt_screen">Storage Optimization</span>:</p>
<ol>
<li>The only option on this screen is to configure the <span class="packt_screen">Storage Policy Management</span>, starting with VMware Virtual SAN. To enable VSAN, click the radio button for <span class="packt_screen">Use VMware Virtual SAN</span>. As we don't have this configured in the example lab, we will click the radio button for <span class="packt_screen">Do not use VMware Virtual SAN</span>.</li>
<li>Click the <span class="packt_screen">Next &gt;</span> button to continue to the next configuration screen.</li>
</ol>
<p>The next configuration screen is the <span class="packt_screen">vCenter Setting</span><strong><span class="ScreenTextPACKT">s</span></strong> <span>configuration screen. On this screen, we are going to select the parent VM from which to build the virtual desktop machines, and then the location and resources that are going to run them. As such, the configuration options fall into three categories. <strong>Virtual Machine Template</strong></span><span>,</span> <span class="packt_screen">Virtual Machine Location</span><span>, and</span> <span class="packt_screen">Resource Settings<strong>,</strong></span> <span>as shown in the following screenshot:</span></p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/447aba0d-9d04-443a-a544-f86cd1df2387.png"/></div>
<p>Let's look at all the configuration options:</p>
<ol>
<li>The first thing to configure are the details of the <span class="packt_screen">Virtual Machine Template</span> to be used as the parent image from which to create the virtual desktop machines for this desktop pool. This section is shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/6e354893-ed4e-4017-86a1-5df8ad168164.png"/></div>
<ol start="2">
<li>On the <span class="packt_screen">Template</span> box, click the <span class="packt_screen">Browse...</span> button (<strong>7</strong>).</li>
</ol>
<ol start="3">
<li>You will now see the <span class="packt_screen">Select template</span> screen, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/ba3b1636-48f1-4b18-96e1-7d455fe4c78d.png"/></div>
<ol start="4">
<li>On this screen, you will see a list of all the templates that have been created in vCenter. As we are going to build a Windows 7 virtual desktop machine for this pool, select the option for <span class="packt_screen">Windows 7 Gold Image Template</span> (<strong>8</strong>) by clicking and highlighting it.</li>
<li>Click <span class="packt_screen">OK</span> to accept and close the <span class="packt_screen">Select template</span> screen.</li>
<li>You will now return to the <span class="packt_screen">vCenter Settings</span> screen, where we can now configure the second of the options. This is for <span class="packt_screen">Virtual Machine Location</span>. You will also see that the <span class="packt_screen">Template</span> box (<strong>9</strong>) has now been populated with the details of the <span class="packt_screen">Windows 7 Gold Image Template</span>, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/75195027-22ff-449e-b6b9-9fde59ea682a.png"/></div>
<ol start="7">
<li>Under the <span class="packt_screen">Virtual Machine Location</span> section, on the VM folder location box, click the <span class="packt_screen">Browse...</span> button (<strong>10</strong>).</li>
<li>You will now see the <span class="packt_screen">Select the folder to store the VM</span> screen, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/deda31bd-d5db-4fa6-810d-3f579593e8ab.png"/></div>
<ol start="9">
<li>Expand <span class="packt_screen">PVO's Datacenter</span> by clicking the down arrow and then select the folder in which you want to create the virtual desktop machines. In the example lab, this folder has been called <kbd>Horizon Desktops</kbd> (<strong>11</strong>).</li>
</ol>
<div class="packt_tip">Don't forget to consider a folder structure for the virtual machines to help with management; otherwise<span>, you could end up creating hundreds of different virtual desktop machines that reside in different pools, all in the same folder.</span></div>
<ol start="10">
<li>Click <span class="packt_screen">OK</span> to continue.</li>
<li>You will return to the <span class="packt_screen">vCenter Settings</span> screen, where you will see that the <span class="packt_screen">VM Folder Location</span> has now been added:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/686926b8-cbd6-4f88-973d-8af96de575c6.png"/></div>
<p class="mce-root"/>
<p class="mce-root"/>
<p>The next configuration section is for the resources that are going to host and run the virtual desktop machines in the pool:</p>
<ol start="1">
<li>First, in the <span class="packt_screen">Host or cluster</span> box, click the <span class="packt_screen">Browse...</span> button.</li>
<li>You will then see the <span class="packt_screen">Host or Cluster</span> box appear, listing the available host resources. The host resources are the ESXi servers available. In this example, we can see the IP address of the example lab ESXi server. Click on the IP address <kbd>192.168.1.131</kbd>.</li>
<li>Click <span class="packt_screen">OK</span> to continue.</li>
<li>You will now return to the <span class="packt_screen">vCenter Settings</span> <span>screen, where you will see that the</span> <span class="packt_screen">Host or cluster</span> <span>has now been added.</span></li>
<li>Next, we are going to configure the resource pool for this desktop pool to use.</li>
<li>In the <span class="packt_screen">Resource pool</span> <span>box, click the</span> <span class="packt_screen">Browse...</span> <span>button. You will now see the</span> <span class="packt_screen">Select a resource pool to use for this desktop pool</span> <span>box, from where you can select the resource pool.</span> The resource pool for the example lab is the ESXi host server again, so click the IP address <kbd>192.168.1.131</kbd> to select this from the list.</li>
<li>Click <span class="packt_screen">OK</span> to continue.</li>
<li>You will now return to the <span class="packt_screen">vCenter Settings</span> <span>screen, where you will see that the</span> <span class="packt_screen">Resource pool</span> <span>has now been added.</span></li>
</ol>
<p>The final configuration option in this section is for <strong>Datastores</strong>. In the example lab, we are using a single datastore, which was selected from the <span class="packt_screen">Storage Optimization</span> settings screen:</p>
<ol>
<li>In the <span class="packt_screen">Datastores</span> box, click the <span class="packt_screen">Browse...</span> button.</li>
<li>You will now see the <span class="packt_screen">Select Datastores</span> <span>configuration screen, which shows all available datastores, as shown in the following screenshot:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/46d37346-c94a-4014-ba56-f2e8bbc31e8d.png"/></div>
<ol start="3">
<li>The first option on this configuration screen is for <span class="packt_screen">Select the Datastore type</span> (<strong>12</strong>). Here, you can choose between an <span class="packt_screen">Individual Datastore</span> or <span class="packt_screen">Storage DRS</span>. DRS (Distributed Resource Scheduler) load balances storage resources and moves storage workloads to other available datastores rather than using the same one. In the example lab, select the option for <span class="packt_screen">Individual Datastore</span>.</li>
<li>Check the box for <span class="packt_screen">VM Datastore</span> (<strong>13</strong>), as this is the datastore we are going to use to store virtual desktop machines from this desktop pool.</li>
<li>Once configured, click the <span class="packt_screen">OK</span> button. You will return to the <strong>vCenter Settings</strong> configuration screen, where you will see that the details of the Linked Clone datastores have now been entered by displaying the text 1 selected.</li>
<li>With the <strong>vCenter Settings</strong> configuration complete, click the <strong><span class="packt_screen">Next &gt;</span></strong> button to continue to the next configuration screen.</li>
</ol>
<p>The next configuration screen is for <span class="packt_screen">Advanced Storage Options</span>:</p>
<ol start="1">
<li>To enable the <span class="packt_screen">View Storage Accelerator</span>, check the box for <span class="packt_screen">Use View Storage Accelerator</span>.</li>
<li>Leave the <span class="packt_screen">Regenerate storage accelerator after</span> option set to the default option of <kbd>7</kbd> days.</li>
</ol>
<ol start="3">
<li>If you want to configure a blackout time, then under <span class="packt_screen">Blackout Times</span>, Click the <span class="packt_screen">Add...</span> button.</li>
<li>The final setting under <span class="packt_screen">Advanced Storage Options</span> <span>is to configure a</span> <span class="packt_screen">Transparent Page Sharing Scope</span>. <span>Leave this as the default setting of</span> <span class="packt_screen">Virtual Machine</span><span>.</span></li>
<li>Click the <span class="packt_screen">Next &gt;</span> button once you have completed configuring the <span class="packt_screen">Advanced Storage Options</span>.</li>
</ol>
<p>The next configuration screen is for <span class="packt_screen">Guest Customization</span><span>,</span> as shown in the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/21d2d643-a188-48e0-96d0-76aa68c3c616.png"/></div>
<p>The screen shows following the options:</p>
<ol>
<li>The first configuration option on this screen is for <span class="packt_screen">None - Customization will be done manually</span> (<strong>14</strong>). Click the radio button to select this option if you want to manually configure each virtual desktop machine.</li>
<li>Under the previous option, you have the option for <span class="packt_screen">Do not power on virtual machines after creation</span>. Check this box to prevent the virtual desktop machines from powering on when they have been created. If you are going to manually configure the machines, then it's worth selecting this option, as there is no point powering on machines that have not been configured.</li>
</ol>
<ol start="3">
<li>Next, you have the option for <span class="packt_screen">Use this customization specification</span> (<strong>15</strong>). This option allows you to select a pre-built SysPrep script from vCenter. In the example lab, we have a script created called <span class="packt_screen">Virtual Desktop Customization</span> (<strong>16</strong>). Click this option to highlight and select it. Under this option, you can also configure the ability to use pre-existing computer accounts. To enable this option, simply check the box for <span class="packt_screen">Allow reuse of pre-existing computer accounts</span><span>.</span></li>
<li>Click the <span class="packt_screen">Next &gt;</span> button once you have completed configuring the <span class="packt_screen">Guest Customization</span>.</li>
<li>You will now see the final screen, the <span class="packt_screen">Ready to Complete</span> screen, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/5001773e-6908-431a-8aeb-52ffd8bbd61a.png" style=""/></div>
<p class="NormalPACKT"><span>Review your configuration settings, and then click the</span> <span class="packt_screen">Finish</span> <span>button to create the desktop pool.</span></p>
<p class="NormalPACKT"><span>You also have the option of ticking the</span> <span class="packt_screen">Entitle users after this wizard finishes</span> <span>box at the top of the screen, which will automatically launch the</span> entitlement <span>configuration screen, so you can give end users access to the virtual desktop machines in this pool. However, in the example lab, we will do this later, after we have created some additional desktop pools.</span></p>
<p class="NormalPACKT"><span>You will now see that the pool has been created, as shown in the following screenshot:</span></p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/25e1e731-24fb-4123-ad53-4ede1f60481d.png"/></div>
<p><span>You will also see on the vCenter Server, that the various folder structure for the desktop pool has been set up, and that the first virtual desktop machine,</span> <kbd>Win7-VM-Full-1</kbd>, <span>has been created and is powered on ready, for end users to log in to, as shown in the following screenshot:</span></p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/9a47c64d-8a0f-4374-b5da-526bd54d29cd.png"/></div>
<p>You have now successfully created a dedicated, Full Clone desktop pool.</p>
<p class="mce-root"/>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article>
                
<p><span>In this chapter</span>, we have configured the Horizon View Administrator to deliver our virtual desktop machines by means of creating desktop pools. We have built and configured a dedicated Full Clone desktop pool and a dedicated Linked Clone desktop pool. As part of the configuration of the desktop pools, we looked at how to create these using the classic Horizon View Administrator console, as well as the new web-client style Horizon Console.</p>
<p><span>In the next chapter</span>, we will look at how to build a number of floating desktop pools, using Linked Clones and Instant Clones. We will also configure a manual desktop pool before going on to look at some of the key management tasks you will need to perform when using Linked Clone desktop pools, and then entitling end users to the newly created desktop pools.</p>


            </article>

            
        </section>
    </body></html>