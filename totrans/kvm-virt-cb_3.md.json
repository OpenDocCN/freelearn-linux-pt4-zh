["```\nroot@kvm:~# cat /boot/config-`uname -r` | grep -i bridg\n# PC-card bridges\nCONFIG_BRIDGE_NETFILTER=y\nCONFIG_NF_TABLES_BRIDGE=m\nCONFIG_BRIDGE_NF_EBTABLES=m\nCONFIG_BRIDGE_EBT_BROUTE=m\nCONFIG_BRIDGE_EBT_T_FILTER=m\nCONFIG_BRIDGE_EBT_T_NAT=m\nCONFIG_BRIDGE_EBT_802_3=m\nCONFIG_BRIDGE_EBT_AMONG=m\nCONFIG_BRIDGE_EBT_ARP=m\nCONFIG_BRIDGE_EBT_IP=m\nCONFIG_BRIDGE_EBT_IP6=m\nCONFIG_BRIDGE_EBT_LIMIT=m\nCONFIG_BRIDGE_EBT_MARK=m\nCONFIG_BRIDGE_EBT_PKTTYPE=m\nCONFIG_BRIDGE_EBT_STP=m\nCONFIG_BRIDGE_EBT_VLAN=m\nCONFIG_BRIDGE_EBT_ARPREPLY=m\nCONFIG_BRIDGE_EBT_DNAT=m\nCONFIG_BRIDGE_EBT_MARK_T=m\nCONFIG_BRIDGE_EBT_REDIRECT=m\nCONFIG_BRIDGE_EBT_SNAT=m\nCONFIG_BRIDGE_EBT_LOG=m\n# CONFIG_BRIDGE_EBT_ULOG is not set\nCONFIG_BRIDGE_EBT_NFLOG=m\nCONFIG_BRIDGE=m\nCONFIG_BRIDGE_IGMP_SNOOPING=y\nCONFIG_BRIDGE_VLAN_FILTERING=y\nCONFIG_SSB_B43_PCI_BRIDGE=y\nCONFIG_DVB_DDBRIDGE=m\nCONFIG_EDAC_SBRIDGE=m\n# VME Bridge Drivers\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# lsmod | grep bridge\nbridge 110925 0\nstp 12976 2 garp,bridge\nllc 14552 3 stp,garp,bridge\nroot@kvm:~#\nroot@kvm:~# modinfo bridge\nfilename: /lib/modules/3.13.0-107-generic/kernel/net/bridge/bridge.ko\nalias: rtnl-link-bridge\nversion: 2.3\nlicense: GPL\nsrcversion: 49D4B615F0B11CA696D8623\ndepends: stp,llc\nintree: Y\nvermagic: 3.13.0-107-generic SMP mod_unload modversions\nsigner: Magrathea: Glacier signing key\nsig_key: E1:07:B2:8D:F0:77:39:2F:D6:2D:FD:D7:92:BF:3B:1D:BD:57:0C:D8\nsig_hashalgo: sha512\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# apt install bridge-utils\n\n```", "```\nroot@kvm:~# virt-install --name kvm1 --ram 1024 --disk path=/tmp/debian.img,format=raw --graphics vnc,listen=146.20.141.158 --noautoconsole --hvm --import\n\nStarting install...\nCreating domain... | 0 B 00:00\nDomain creation completed. You can restart your domain by running:\n virsh --connect qemu:///system start kvm1\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# brctl show\nbridge name      bridge id             STP enabled     interfaces\nvirbr0           8000.fe5400559bd6     yes             vnet0\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# ifconfig virbr0 down\nroot@kvm:~# brctl delbr virbr0\nroot@kvm:~# brctl show\nbridge name bridge id STP enabled interfaces\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# brctl addbr virbr0\nroot@kvm:~# brctl show\nbridge name     bridge id            STP enabled interfaces\nvirbr0          8000.000000000000    no\nroot@kvm:~# ifconfig virbr0 up\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# ip addr add 192.168.122.1 dev virbr0\nroot@kvm:~# ip addr show virbr0\n39: virbr0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UNKNOWN group default\n link/ether 32:7d:3f:80:d7:c6 brd ff:ff:ff:ff:ff:ff\n inet 192.168.122.1/32 scope global virbr0\n valid_lft forever preferred_lft forever\n inet6 fe80::307d:3fff:fe80:d7c6/64 scope link\n valid_lft forever preferred_lft forever\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# ip a s | grep vnet\n38: vnet0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UNKNOWN group default qlen 500\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# brctl addif virbr0 vnet0\nroot@kvm:~# brctl show virbr0\nbridge name     bridge id             STP enabled     interfaces\nvirbr0          8000.fe5400559bd6     no              vnet0\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# brctl stp virbr0 on\nroot@kvm:~# brctl showstp virbr0\nvirbr0\n bridge id 8000.fe5400559bd6\n designated root 8000.fe5400559bd6\n root port 0 path cost 0\n max age 20.00 bridge max age 20.00\n hello time 2.00 bridge hello time 2.00\n forward delay 15.00 bridge forward delay 15.00\n ageing time 300.00\n hello timer 0.26 tcn timer 0.00\n topology change timer 0.00 gc timer 90.89\n flags\n\nvnet0 (1)\n port id 8001 state forwarding\n designated root 8000.fe5400559bd6 path cost 100\n designated bridge 8000.fe5400559bd6 message age timer 0.00\n designated port 8001 forward delay timer 0.00\n designated cost 0 hold timer 0.00\n flags\n\nroot@kvm:~#\n\n```", "```\nroot@debian:~# ifconfig eth0 up\nroot@debian:~# dhclient eth0\nroot@debian:~# ip a s eth0\n2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP group default qlen 1000\n link/ether 52:54:00:55:9b:d6 brd ff:ff:ff:ff:ff:ff\n inet 192.168.122.92/24 brd 192.168.122.255 scope global eth0\n valid_lft forever preferred_lft forever\n inet6 fe80::5054:ff:fe55:9bd6/64 scope link\n valid_lft forever preferred_lft forever\nroot@debian:~#\nroot@debian:~# ping 192.168.122.1 -c 3\nPING 192.168.122.1 (192.168.122.1) 56(84) bytes of data.\n64 bytes from 192.168.122.1: icmp_seq=1 ttl=64 time=0.276 ms\n64 bytes from 192.168.122.1: icmp_seq=2 ttl=64 time=0.226 ms\n64 bytes from 192.168.122.1: icmp_seq=3 ttl=64 time=0.259 ms\n\n--- 192.168.122.1 ping statistics ---\n3 packets transmitted, 3 received, 0% packet loss, time 1999ms\nrtt min/avg/max/mdev = 0.226/0.253/0.276/0.027 ms\nroot@debian:~#\n\n```", "```\nroot@kvm:~# cat /etc/libvirt/qemu/networks/default.xml\n<network>\n <name>default</name>\n <bridge name=\"virbr0\"/>\n <forward/>\n <ip address=\"192.168.122.1\" netmask=\"255.255.255.0\">\n <dhcp>\n <range start=\"192.168.122.2\" end=\"192.168.122.254\"/>\n </dhcp>\n </ip>\n</network>\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# pgrep -lfa dnsmasq\n38983 /usr/sbin/dnsmasq --conf-file=/var/lib/libvirt/dnsmasq/default.conf\nroot@kvm:~# cat /var/lib/libvirt/dnsmasq/default.conf\n##WARNING: THIS IS AN AUTO-GENERATED FILE. CHANGES TO IT ARE LIKELY TO BE\n##OVERWRITTEN AND LOST. Changes to this configuration should be made using:\n## virsh net-edit default\n## or other application using the libvirt API.\n##\n## dnsmasq conf file created by libvirt\nstrict-order\nuser=libvirt-dnsmasq\npid-file=/var/run/libvirt/network/default.pid\nexcept-interface=lo\nbind-dynamic\ninterface=virbr0\ndhcp-range=192.168.122.2,192.168.122.254\ndhcp-no-override\ndhcp-leasefile=/var/lib/libvirt/dnsmasq/default.leases\ndhcp-lease-max=253\ndhcp-hostsfile=/var/lib/libvirt/dnsmasq/default.hostsfile\naddn-hosts=/var/lib/libvirt/dnsmasq/default.addnhosts\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# brctl showmacs virbr0\nport no  mac addr               is local?      ageing timer\n 1      52:54:00:55:9b:d6      no             268.02\n 1      fe:54:00:55:9b:d6      yes            0.00\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# virsh console kvm1\nConnected to domain kvm1\nEscape character is ^]\n\nroot@debian:~# ip a s eth0\n2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP group default qlen 1000\n link/ether 52:54:00:55:9b:d6 brd ff:ff:ff:ff:ff:ff\n inet6 fe80::5054:ff:fe55:9bd6/64 scope link\n valid_lft forever preferred_lft forever\nroot@debian:~#\n\n```", "```\nroot@kvm:~# ifconfig | grep \"fe:54:00:55:9b:d6\"\nvirbr0 Link encap:Ethernet HWaddr fe:54:00:55:9b:d6\nvnet0  Link encap:Ethernet HWaddr fe:54:00:55:9b:d6\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# brctl setageing virbr0 600\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# brctl\nUsage: brctl [commands]\ncommands:\n addbr <bridge> add bridge\n delbr <bridge> delete bridge\n addif <bridge> <device> add interface to bridge\n delif <bridge> <device> delete interface from bridge\n hairpin <bridge> <port> {on|off} turn hairpin on/off\n setageing <bridge> <time> set ageing time\n setbridgeprio <bridge> <prio> set bridge priority\n setfd <bridge> <time> set bridge forward delay\n sethello <bridge> <time> set hello time\n setmaxage <bridge> <time> set max message age\n setpathcost <bridge> <port> <cost> set path cost\n setportprio <bridge> <port> <prio> set port priority\n show [ <bridge> ] show a list of bridges\n showmacs <bridge> show a list of mac addrs\n showstp <bridge> show bridge stp info\n stp <bridge> {on|off} turn stp on/off\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# cd /usr/src/\nroot@kvm:/usr/src# apt-get update && apt-get install build-essential automake pkg-config git\nroot@kvm:/usr/src# git clone git://git.kernel.org/pub/scm/linux/kernel/git/shemminger/bridge-utils.git\nCloning into 'bridge-utils'...\nremote: Counting objects: 654, done.\nremote: Total 654 (delta 0), reused 0 (delta 0)\nReceiving objects: 100% (654/654), 131.72 KiB | 198.00 KiB/s, done.\nResolving deltas: 100% (425/425), done.\nChecking connectivity... done.\nroot@kvm:/usr/src# cd bridge-utils/\nroot@kvm:/usr/src/bridge-utils# autoconf\nroot@kvm:/usr/src/bridge-utils# ./configure && make && make install\nroot@kvm:/usr/src/bridge-utils# brctl --version\nbridge-utils, 1.5\nroot@kvm:/usr/src/bridge-utils#\n\n```", "```\n[root@centos ~]# cd /usr/src/\n[root@centos src]#\n[root@centos src]# yum groupinstall \"Development tools\"\n[root@centos src]# git clone git://git.kernel.org/pub/scm/linux/kernel/git/shemminger/bridge-utils.git\nCloning into 'bridge-utils'...\nremote: Counting objects: 654, done.\nremote: Total 654 (delta 0), reused 0 (delta 0)\nReceiving objects: 100% (654/654), 131.72 KiB | 198.00 KiB/s, done.\nResolving deltas: 100% (425/425), done.\nChecking connectivity... done.\n[root@centos src]# cd bridge-utils\n[root@centos bridge-utils]# autoconf\n[root@centos bridge-utils]# ./configure && make && make install\n[root@centos bridge-utils]# brctl --version\nbridge-utils, 1.5\n[root@centos bridge-utils]#\n\n```", "```\nroot@kvm:~# brctl show\nbridge name      bridge id             STP enabled      interfaces\nvirbr0           8000.fe5400559bd6     yes              vnet0\nroot@kvm:~# ifconfig virbr0 down\nroot@kvm:~# brctl delbr virbr0\nroot@kvm:~# brctl show\nbridge name bridge id STP enabled interfaces\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# apt-get install openvswitch-switch\n...\nSetting up openvswitch-common (2.0.2-0ubuntu0.14.04.3) ...\nSetting up openvswitch-switch (2.0.2-0ubuntu0.14.04.3) ...\nopenvswitch-switch start/running\n...\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# pgrep -lfa switch\n22255 ovsdb-server /etc/openvswitch/conf.db -vconsole:emer -vsyslog:err -vfile:info --remote=punix:/var/run/openvswitch/db.sock --private-key=db:Open_vSwitch,SSL,private_key --certificate=db:Open_vSwitch,SSL,certificate --bootstrap-ca-cert=db:Open_vSwitch,SSL,ca_cert --no-chdir --log-file=/var/log/openvswitch/ovsdb-server.log --pidfile=/var/run/openvswitch/ovsdb-server.pid --detach --monitor\n22264 ovs-vswitchd: monitoring pid 22265 (healthy)\n22265 ovs-vswitchd unix:/var/run/openvswitch/db.sock -vconsole:emer -vsyslog:err -vfile:info --mlockall --no-chdir --log-file=/var/log/openvswitch/ovs-vswitchd.log --pidfile=/var/run/openvswitch/ovs-vswitchd.pid --detach --monitor\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# lsmod | grep switch\nopenvswitch       70989   0\ngre               13796   1 openvswitch\nvxlan             37611   1 openvswitch\nlibcrc32c         12644   1 openvswitch\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# ovs-vsctl show\ne5164e3e-7897-4717-b766-eae1918077b0\n ovs_version: \"2.0.2\"\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# ovs-vsctl add-br virbr1\nroot@kvm:~# ovs-vsctl show\ne5164e3e-7897-4717-b766-eae1918077b0\n Bridge \"virbr1\"\n Port \"virbr1\"\n Interface \"virbr1\"\n type: internal\n ovs_version: \"2.0.2\"\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# ovs-vsctl add-port virbr1 vnet0\nroot@kvm:~# ovs-vsctl show\ne5164e3e-7897-4717-b766-eae1918077b0\n Bridge \"virbr1\"\n Port \"virbr1\"\n Interface \"virbr1\"\n type: internal\n Port \"vnet0\"\n Interface \"vnet0\"\n ovs_version: \"2.0.2\"\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# ip addr add 192.168.122.1/24 dev virbr1\nroot@kvm:~# ip addr show virbr1\n41: virbr1: <BROADCAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UNKNOWN group default\n link/ether b2:52:e0:73:89:4e brd ff:ff:ff:ff:ff:ff\n inet 192.168.122.1/24 scope global virbr1\n valid_lft forever preferred_lft forever\n inet6 fe80::b0a8:c2ff:fed4:bb3f/64 scope link\n valid_lft forever preferred_lft forever\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# virsh console kvm1\nConnected to domain kvm1\nEscape character is ^]\n\nroot@debian:~# ifconfig eth0 up && ip addr add 192.168.122.210/24 dev eth0\nroot@debian:~# ip addr show eth0\n2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP group default qlen 1000\n link/ether 52:54:00:55:9b:d6 brd ff:ff:ff:ff:ff:ff\n inet 192.168.122.210/24 scope global eth0\n valid_lft forever preferred_lft forever\n inet6 fe80::5054:ff:fe55:9bd6/64 scope link\n valid_lft forever preferred_lft forever\nroot@debian:~# ping 192.168.122.1\nPING 192.168.122.1 (192.168.122.1) 56(84) bytes of data.\n64 bytes from 192.168.122.1: icmp_seq=1 ttl=64 time=0.711 ms\n64 bytes from 192.168.122.1: icmp_seq=2 ttl=64 time=0.394 ms\n64 bytes from 192.168.122.1: icmp_seq=3 ttl=64 time=0.243 ms\n^C\n--- 192.168.122.1 ping statistics ---\n3 packets transmitted, 3 received, 0% packet loss, time 2001ms\nrtt min/avg/max/mdev = 0.243/0.449/0.711/0.195 ms\nroot@debian:~#\n\n```", "```\nroot@kvm:~# ovsdb-client list-dbs\nOpen_vSwitch\nroot@kvm:~# ovsdb-client list-tables\nTable\n-------------------------\nPort\nManager\nBridge\nInterface\nSSL\nIPFIX\nOpen_vSwitch\nQueue\nNetFlow\nMirror\nQoS\nController\nFlow_Table\nsFlow\nFlow_Sample_Collector_Set\nroot@kvm:~# ovsdb-client dump Open_vSwitch\n...\nPort table\n_uuid bond_downdelay bond_fake_iface bond_mode bond_updelay external_ids fake_bridge interfaces lacp mac name other_config qos statistics status tag trunks vlan_mode\n------------------------------------ -------------- --------------- --------- ------------ ------------ ----------- -------------------------------------- ---- --- -------- ------------ --- ---------- ------ --- ------ ---------\n9b4b743d-66b2-4779-9dd8-404b3aa55e18 0 false [] 0 {} false [e7ed4e2b-a73c-46c7-adeb-a203be56587c] [] [] \"virbr1\" {} [] {} {} [] [] []\nf2a033aa-9072-4be3-808e-6e0fce67ce7b 0 false [] 0 {} false [86a10eed-698f-4ccc-b3b7-dd20c13e3ee3] [] [] \"vnet0\" {} [] {} {} [] [] []\n...\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# ovs-vsctl del-port virbr1 vnet0\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# ovs-vsctl del-br virbr1 && ovs-vsctl show\ne5164e3e-7897-4717-b766-eae1918077b0\n ovs_version: \"2.0.2\"\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# virsh net-list --all\n Name       State    Autostart     Persistent\n----------------------------------------------------------\n default    active    yes          yes\n\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# virsh net-dumpxml default\n<network connections='1'>\n <name>default</name>\n <uuid>2ab5d22c-5928-4304-920e-bc43b8731bcf</uuid>\n <forward mode='nat'>\n <nat>\n <port start='1024' end='65535'/>\n </nat>\n </forward>\n <bridge name='virbr0' stp='on' delay='0'/>\n <ip address='192.168.122.1' netmask='255.255.255.0'>\n <dhcp>\n <range start='192.168.122.2' end='192.168.122.254'/>\n </dhcp>\n </ip>\n</network>\n\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# cat /etc/libvirt/qemu/networks/default.xml\n<network>\n <name>default</name>\n <bridge name=\"virbr0\"/>\n <forward/>\n <ip address=\"192.168.122.1\" netmask=\"255.255.255.0\">\n <dhcp>\n <range start=\"192.168.122.2\" end=\"192.168.122.254\"/>\n </dhcp>\n </ip>\n</network>\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# virsh list --all\n Id    Name    State\n----------------------------------------------------\n 3    kvm1     running\n\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# brctl show\nbridge name    bridge id           STP enabled    interfaces\nvirbr0         8000.fe5400559bd6   yes            vnet0\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# cat nat_net.xml\n<network>\n <name>nat_net</name>\n <bridge name=\"virbr1\"/>\n <forward/>\n <ip address=\"10.10.10.1\" netmask=\"255.255.255.0\">\n <dhcp>\n <range start=\"10.10.10.2\" end=\"10.10.10.254\"/>\n </dhcp>\n </ip>\n</network>\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# virsh net-define nat_net.xml\nNetwork nat_net defined from nat_net.xml\n\nroot@kvm:~# virsh net-list --all\n Name       State      Autostart    Persistent\n----------------------------------------------------------\n default    active     yes          yes\n nat_net    inactive   no           yes\n\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# virsh net-start nat_net\nNetwork nat_net started\n\nroot@kvm:~# virsh net-autostart nat_net\nNetwork nat_net marked as autostarted\n\nroot@kvm:~# virsh net-list\n Name      State     Autostart    Persistent\n----------------------------------------------------------\n default   active    yes          yes\n nat_net   active    yes          yes\n\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# virsh net-info nat_net\nName: nat_net\nUUID: fba2ca2b-8ca7-4dbb-beee-14799ee04bc3\nActive: yes\nPersistent: yes\nAutostart: yes\nBridge: virbr1\n\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# virsh edit kvm1\n...\n <interface type='network'>\n ...\n <source network='nat_net'/>\n ...\n </interface>\n...\n\nDomain kvm1 XML configuration edited.\n\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# virsh destroy kvm1\nDomain kvm1 destroyed\n\nroot@kvm:~# virsh start kvm1\nDomain kvm1 started\n\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# brctl show\nbridge name     bridge id         STP enabled interfaces\nvirbr0          8000.000000000000 yes\nvirbr1          8000.525400ba8e2c yes         virbr1-nic\n vnet0\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# virsh console kvm1\nConnected to domain kvm1\nEscape character is ^]\n\nDebian GNU/Linux 8 debian ttyS0\n\ndebian login: root\nPassword:\n...\nroot@debian:~# ip a s eth0 | grep inet\n inet 10.10.10.92/24 brd 10.10.10.255 scope global eth0\n inet6 fe80::5054:ff:fe55:9bd6/64 scope link\nroot@debian:~# ifconfig eth0 up && dhclient eth0\nroot@debian:~# ping 10.10.10.1 -c 3\nPING 10.10.10.1 (10.10.10.1) 56(84) bytes of data.\n64 bytes from 10.10.10.1: icmp_seq=1 ttl=64 time=0.313 ms\n64 bytes from 10.10.10.1: icmp_seq=2 ttl=64 time=0.136 ms\n64 bytes from 10.10.10.1: icmp_seq=3 ttl=64 time=0.253 ms\n\n--- 10.10.10.1 ping statistics ---\n3 packets transmitted, 3 received, 0% packet loss, time 2000ms\nrtt min/avg/max/mdev = 0.136/0.234/0.313/0.073 ms\nroot@debian:~#\n\n```", "```\nroot@kvm:~# pgrep -lfa dnsmasq\n38983 /usr/sbin/dnsmasq --conf-file=/var/lib/libvirt/dnsmasq/default.conf\n40098 /usr/sbin/dnsmasq --conf-file=/var/lib/libvirt/dnsmasq/nat_net.conf\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# ip a s virbr1\n43: virbr1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP group default\n link/ether 52:54:00:ba:8e:2c brd ff:ff:ff:ff:ff:ff\n inet 10.10.10.1/24 brd 10.10.10.255 scope global virbr1\n valid_lft forever preferred_lft forever\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# iptables -L -n -t nat\nChain PREROUTING (policy ACCEPT)\ntarget prot opt source destination\n\nChain INPUT (policy ACCEPT)\ntarget prot opt source destination\n\nChain OUTPUT (policy ACCEPT)\ntarget prot opt source destination\n\nChain POSTROUTING (policy ACCEPT)\ntarget prot opt source destination\nRETURN all -- 10.10.10.0/24 224.0.0.0/24\nRETURN all -- 10.10.10.0/24 255.255.255.255\nMASQUERADE tcp -- 10.10.10.0/24 !10.10.10.0/24 masq ports: 1024-65535\nMASQUERADE udp -- 10.10.10.0/24 !10.10.10.0/24 masq ports: 1024-65535\nMASQUERADE all -- 10.10.10.0/24 !10.10.10.0/24\nRETURN all -- 192.168.122.0/24 224.0.0.0/24\nRETURN all -- 192.168.122.0/24 255.255.255.255\nMASQUERADE tcp -- 192.168.122.0/24 !192.168.122.0/24 masq ports: 1024-65535\nMASQUERADE udp -- 192.168.122.0/24 !192.168.122.0/24 masq ports: 1024-65535\nMASQUERADE all -- 192.168.122.0/24 !192.168.122.0/24\nRETURN all -- 192.168.122.0/24 224.0.0.0/24\nRETURN all -- 192.168.122.0/24 255.255.255.255\nMASQUERADE tcp -- 192.168.122.0/24 !192.168.122.0/24 masq ports: 1024-65535\nMASQUERADE udp -- 192.168.122.0/24 !192.168.122.0/24 masq ports: 1024-65535\nMASQUERADE all -- 192.168.122.0/24 !192.168.122.0/24\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# ifdown eth1\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# vim /etc/network/interfaces\n...\n auto virbr2\n iface virbr2 inet static\n address 192.168.1.2\n netmask 255.255.255.0\n network 192.168.1.0\n broadcast 192.168.1.255\n gateway 192.168.1.1\n bridge_ports eth1\n bridge_stp on\n bridge_maxwait 0\n...\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# cat /etc/sysconfig/ifcfg-eth1\nDEVICE=eth1\nNAME=eth1\nNM_CONTROLLED=yes\nONBOOT=yes\nTYPE=Ethernet\nBRIDGE=virbr2\nroot@kvm:~# cat /etc/sysconfig/ifcfg-bridge_net\nDEVICE=virbr2\nNAME=virbr2\nNM_CONTROLLED=yes\nONBOOT=yes\nTYPE=Bridge\nSTP=on\nIPADDR=192.168.1.2\nNETMASK=255.255.255.0\nGATEWAY=192.168.1.1\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# ifup virbr2\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# sysctl -w net.bridge.bridge-nf-call-iptables=0\nnet.bridge.bridge-nf-call-iptables = 0\nroot@kvm:~# sysctl -w net.bridge.bridge-nf-call-iptables=0\nnet.bridge.bridge-nf-call-iptables = 0\nroot@kvm:~# sysctl -w net.bridge.bridge-nf-call-arptables=0\nnet.bridge.bridge-nf-call-arptables = 0\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# # brctl show\n bridge name     bridge id            STP enabled     interfaces\n virbr0          8000.000000000000    yes\n virbr2          8000.000a0ac60210    yes             eth1\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# virsh edit kvm1\n...\n <interface type='bridge'>\n <source bridge='virbr2'/>\n </interface>\n...\n\nDomain kvm1 XML configuration edited.\n\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# virsh destroy kvm1\nDomain kvm1 destroyed\n\nroot@kvm:~# virsh start kvm1\nDomain kvm1 started\n\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# virsh nodedev-list --tree\ncomputer\n |\n +- net_lo_00_00_00_00_00_00\n +- net_ovs_system_0a_c6_62_34_19_b4\n +- net_virbr1_nic_52_54_00_ba_8e_2c\n +- net_vnet0_fe_54_00_55_9b_d6\n ...\n |\n +- pci_0000_00_03_0\n | |\n | +- pci_0000_03_00_0\n | | |\n | | +- net_eth0_58_20_b1_00_b8_61\n | |\n | +- pci_0000_03_00_1\n | |\n | +- net_eth1_58_20_b1_00_b8_61\n |\n ...\n root@kvm:~#\n\n```", "```\nroot@kvm:~# lspci | grep Ethernet\n03:00.0 Ethernet controller: Intel Corporation 82599ES 10-Gigabit SFI/SFP+ Network Connection (rev 01)\n03:00.1 Ethernet controller: Intel Corporation 82599ES 10-Gigabit SFI/SFP+ Network Connection (rev 01)\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# virsh nodedev-dumpxml pci_0000_03_00_1\n<device>\n <name>pci_0000_03_00_1</name>\n <path>/sys/devices/pci0000:00/0000:00:03.0/0000:03:00.1</path>\n <parent>pci_0000_00_03_0</parent>\n <driver>\n <name>ixgbe</name>\n </driver>\n <capability type='pci'>\n <domain>0</domain>\n <bus>3</bus>\n <slot>0</slot>\n <function>1</function>\n <product id='0x10fb'>82599ES 10-Gigabit SFI/SFP+ Network Connection</product>\n <vendor id='0x8086'>Intel Corporation</vendor>\n </capability>\n</device>\n\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# printf %x 0\n0\nroot@kvm:~# printf %x 3\n3\nroot@kvm:~# printf %x 0\n0\nroot@kvm:~# printf %x 1\n1\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# cat passthrough_net.xml\n<network>\n <name>passthrough_net</name>\n <forward mode='hostdev' managed='yes'>\n <pf dev='eth1'/>\n </forward>\n</network>\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# virsh net-define passthrough_net.xml\nNetwork passthrough_net defined from passthrough_net.xml\n\nroot@kvm:~# virsh net-start passthrough_net\nNetwork passthrough_nett started\n\nroot@kvm:~# virsh net-autostart passthrough_net\nNetwork passthrough_net marked as autostarted\n\nroot@kvm:~# virsh net-list\n Name               State      Autostart    Persistent\n----------------------------------------------------------\n default            active    yes           yes\n passthrough_net    active    yes           yes\n\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# virsh edit kvm1\n...\n <devices>\n ...\n <interface type='hostdev' managed='yes'>\n <source>\n <address type='pci' domain='0x0' bus='0x00' slot='0x07' function='0x0'/>\n </source>\n <virtualport type='802.1Qbh' />\n </interface>\n <interface type='network'>\n <source network='passthrough_net'>\n </interface>\n ...\n </devices>\n...\n\nDomain kvm1 XML configuration edited.\n\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# virsh destroy kvm1\nDomain kvm1 destroyed\n\nroot@kvm:~# virsh start kvm1\nDomain kvm1 started\n\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# virsh net-dumpxml passthrough_net\n<network connections='1'>\n <name>passthrough_net</name>\n <uuid>a4233231-d353-a112-3422-3451ac78623a</uuid>\n <forward mode='hostdev' managed='yes'>\n <pf dev='eth1'/>\n <address type='pci' domain='0x0000' bus='0x02' slot='0x10' function='0x1'/>\n <address type='pci' domain='0x0000' bus='0x02' slot='0x10' function='0x3'/>\n <address type='pci' domain='0x0000' bus='0x02' slot='0x10' function='0x5'/>\n <address type='pci' domain='0x0000' bus='0x02' slot='0x10' function='0x7'/>\n <address type='pci' domain='0x0000' bus='0x02' slot='0x11' function='0x1'/>\n <address type='pci' domain='0x0000' bus='0x02' slot='0x11' function='0x3'/>\n <address type='pci' domain='0x0000' bus='0x02' slot='0x11' function='0x5'/>\n </forward>\n</network>\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# cat test_bridge.xml\n<interface type='bridge' name='test_bridge'>\n <start mode=\"onboot\"/>\n <protocol family='ipv4'>\n <ip address='192.168.1.100' prefix='24'/>\n </protocol>\n <bridge>\n <interface type='ethernet' name='vnet0'>\n <mac address='fe:54:00:55:9b:d6'/>\n </interface>\n </bridge>\n</interface>\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# virsh iface-define test_bridge.xml\nInterface test_bridge defined from test_bridge.xml\n\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# virsh iface-list --all\n Name            State       MAC Address\n---------------------------------------------------\n bond0           active      58:20:b1:00:b8:61\n bond0.129       active      bc:76:4e:20:10:6b\n bond0.229       active      bc:76:4e:20:17:7e\n eth0            active      58:20:b1:00:b8:61\n eth1            active      58:20:b1:00:b8:61\n lo              active      00:00:00:00:00:00\n test_bridge     inactive\n\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# virsh iface-start test_bridge\nInterface test_bridge started\n\nroot@kvm:~# virsh iface-list --all | grep test_bridge\n test_bridge    active    4a:1e:48:e1:e7:de\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# brctl show\nbridge name       bridge id           STP enabled   interfaces\ntest_bridge       8000.000000000000   no\nvirbr0            8000.000000000000   yes\nvirbr1            8000.525400ba8e2c   yes           virbr1-nic\n vnet0\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# ip a s test_bridge\n46: test_bridge: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UNKNOWN group default\n link/ether 4a:1e:48:e1:e7:de brd ff:ff:ff:ff:ff:ff\n inet 192.168.1.100/24 brd 192.168.1.255 scope global test_bridge\n valid_lft forever preferred_lft forever\n inet6 fe80::481e:48ff:fee1:e7de/64 scope link\n valid_lft forever preferred_lft forever\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# virsh iface-mac test_bridge\n4a:1e:48:e1:e7:de\n\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# virsh iface-name 4a:1e:48:e1:e7:de\ntest_bridge\n\nroot@kvm:~#\n\n```", "```\nroot@kvm:~# virsh iface-destroy test_bridge\nInterface test_bridge destroyed\n\nroot@kvm:~# virsh iface-list --all | grep test_bridge\n test_bridge inactive\nroot@kvm:~# virsh iface-undefine test_bridge\nInterface test_bridge undefined\n\nroot@kvm:~# virsh iface-list --all | grep test_bridge\nroot@kvm:~#\n\n```"]