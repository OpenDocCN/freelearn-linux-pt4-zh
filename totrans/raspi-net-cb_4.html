<html><head></head><body><div class="chapter" title="Chapter&#xA0;4.&#xA0;File Sharing"><div class="titlepage"><div><div><h1 class="title"><a id="ch04"/>Chapter 4. File Sharing</h1></div></div></div><p>In this chapter, we will cover:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Mounting USB disks (<code class="literal">pmount</code>)</li><li class="listitem" style="list-style-type: disc">Accessing another computer's files (<code class="literal">smbclient</code>)</li><li class="listitem" style="list-style-type: disc">Sharing folders from other computers (<code class="literal">mount.cifs</code>)</li><li class="listitem" style="list-style-type: disc">Auto-mounting USB disks at boot (<code class="literal">/etc/fstab</code>)</li><li class="listitem" style="list-style-type: disc">Auto-mounting a shared folder at boot </li><li class="listitem" style="list-style-type: disc">Creating a file server (Samba)</li><li class="listitem" style="list-style-type: disc">Sharing an attached USB disk (Samba)</li></ul></div><div class="section" title="Introduction"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec36"/>Introduction</h1></div></div></div><p>The Raspberry Pi recipes in this chapter are for sharing files with other computers on the same local network.</p><p>The chapter begins with a recipe for mounting USB disks that are attached to the Raspberry Pi. The next recipes show how files are exchanged with other computers using the SMB (CIFS) protocol. Then, there are two recipes showing how disks can be automatically mounted during boot. The chapter ends with a couple of recipes for setting up the Raspberry Pi as a file server.</p><p>After completing the recipes in this chapter, you will be able to automatically mount local USB disks and exchange files between the Raspberry Pi and other computers using the SMB (CIFS) protocol.</p></div></div>
<div class="section" title="Mounting USB disks (pmount)"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec37"/>Mounting USB disks (pmount)</h1></div></div></div><p>This<a class="indexterm" id="id272"/> recipe installs and applies <code class="literal">pmount</code>, a command that mounts USB disks attached directly to the Raspberry Pi in the same manner as the desktop file manager.</p><p>If a disk is connected to the Raspberry Pi via a USB port when using the Raspberry Pi's <span class="strong"><strong>graphical user interface</strong></span> (<span class="strong"><strong>GUI</strong></span>), the desktop file manager will ask the user's permission to mount the disk. However, when using a Raspberry Pi remotely (or when the Raspberry Pi has <a class="indexterm" id="id273"/>been booted in text mode), there is no GUI to ask if <a class="indexterm" id="id274"/>a file should be mounted.</p><p>This recipe does not rely on the Raspberry Pi GUI or the desktop file manager to mount a disk. Instead, the command-line utility <code class="literal">pmount</code> is used to mount a USB drive in the same way that the GUI would—in the <code class="literal">/media</code> directory.</p><p>Once you've completed this recipe, you will be able to use both large USB storage devices and small USB flash drives to exchange files with other computers without relying on the Raspberry Pi graphical user interface or the desktop file manager.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec124"/>Getting ready</h2></div></div></div><p>Here are the ingredients used in this recipe:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">An initial setup or basic networking setup for the Raspberry Pi that has been powered on. You have also logged in as the user <code class="literal">pi</code> (see the recipes in <a class="link" href="ch01.html" title="Chapter 1. Installation and Setup">Chapter 1</a>, <span class="emphasis"><em>Installation and Setup</em></span>, for how to boot and log in and the recipes in <a class="link" href="ch02.html" title="Chapter 2. Administration">Chapter 2</a>, <span class="emphasis"><em>Administration</em></span>, for how to log in remotely).</li><li class="listitem" style="list-style-type: disc">A powered USB hub (recommended).</li><li class="listitem" style="list-style-type: disc">At least one USB disk drive.</li></ul></div><p>This recipe does not require the desktop GUI and could either be run from the text-based console or from within an LXTerminal.</p><p>If the Raspberry Pi's Secure Shell server is running, this recipe can be completed remotely using a Secure Shell client (see the <span class="emphasis"><em>Remote Access (SSH)</em></span> recipe in <a class="link" href="ch02.html" title="Chapter 2. Administration">Chapter 2</a>, <span class="emphasis"><em>Administration</em></span>).</p><p>The examples in this recipe use two USB drives: a 32 GB flash drive and a 500 GB disk.</p><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note17"/>Note</h3><p>Beware! The Raspberry Pi has power limits.</p><p>The <a class="indexterm" id="id275"/>Raspberry Pi does not have enough internal power to reliably power a large USB disk that has been directly connected to the Raspberry Pi's USB ports.</p><p>To ensure that the Raspberry Pi continues to function optimally, you should attach any device that requires power (including USB disks) indirectly to the Raspberry Pi via a powered USB hub.</p><p>A powered USB hub provides enough power to run several large USB drives without draining extra power from the Raspberry Pi.</p><p>If you see a large colorful square glowing in the top-right corner of the GUI, it is a warning that your Raspberry Pi does not have enough power.</p></div></div></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec125"/>How to do it...</h2></div></div></div><p>The steps <a class="indexterm" id="id276"/>to mount USB disks are as follows:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Log in to the Raspberry Pi either directly or remotely.</li><li class="listitem">Use <code class="literal">apt-get</code> to install the <code class="literal">pmount</code> command.<div class="informalexample"><pre class="programlisting">pi@raspberrypi ~ $ <span class="strong"><strong>sudo apt-get install pmount</strong></span>
[sudo] password for pi: </pre></div></li><li class="listitem">The <code class="literal">apt-get install</code> command downloads and installs <code class="literal">pmount</code>.<div class="informalexample"><pre class="programlisting">Reading package lists... Done
Building dependency tree       
Reading state information... Done
Suggested packages:
  cryptsetup
The following NEW packages will be installed:
  pmount
0 upgraded, 1 newly installed, 0 to remove and 0 not upgraded.
Need to get 98.0 kB of archives.
After this operation, 727 kB of additional disk space will be used.
Get:1 http://mirrordirector.raspbian.org/raspbian/ wheezy/main pmount armhf 0.9.23-2 [98.0 kB]
Fetched 98.0 kB in 1s (93.3 kB/s)
Selecting previously unselected package pmount.
(Reading database ... 89035 files and directories currently installed.)
Unpacking pmount (from .../pmount_0.9.23-2_armhf.deb) ...
Processing triggers for man-db ...
Setting up pmount (0.9.23-2) ...

pi@raspberrypi ~ $ </pre></div></li><li class="listitem">Connect one or more USB disks to the Raspberry Pi. The example includes two disks: a 32 GB flash drive and a 500 GB disk.</li><li class="listitem">Use the <code class="literal">fdisk –l</code> command to list the disks that are currently attached to the Raspberry Pi.<div class="informalexample"><pre class="programlisting">pi@raspberrypi ~ $ <span class="strong"><strong>sudo apt-get install pmount</strong></span></pre></div></li><li class="listitem">The <code class="literal">fdisk</code> command displays information about the disks that are attached to the Raspberry Pi.<div class="informalexample"><pre class="programlisting">Disk /dev/mmcblk0: 31.9 GB, 31914983424 bytes
4 heads, 16 sectors/track, 973968 cylinders, total 62333952 sectors
Units = sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disk identifier: 0x0009bf4f

        Device Boot      Start         End      Blocks   Id  System
/dev/mmcblk0p1            8192      122879       57344    c  W95 FAT32 (LBA)
/dev/mmcblk0p2          122880    62333951    31105536   83  Linux

Disk /dev/sda: 128 MB, 128974848 bytes
2 heads, 63 sectors/track, 1999 cylinders, total 251904 sectors
Units = sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disk identifier: 0x002d7aa3

   Device Boot      Start         End      Blocks   Id  System
/dev/sda1   *          32      251903      125936    6  FAT16

Disk /dev/sdb: 500.1 GB, 500107862016 bytes
255 heads, 63 sectors/track, 60801 cylinders, total 976773168 sectors
Units = sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disk identifier: 0x002317d5

   Device Boot      Start         End      Blocks   Id  System
/dev/sdb1            2048   976773167   488385560    7  HPFS/NTFS/exFAT</pre></div></li><li class="listitem">The<a class="indexterm" id="id277"/> command output in the preceding example shows three disks:<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">/dev/mmcblk0</code>: The 31.9 GB SD card (the boot disk) has two partitions: <code class="literal">/dev/mmcblk0p1</code> and <code class="literal">/dev/mmcblk0p2</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">/dev/sda</code>: The 128 MB flash drive has one partition</li><li class="listitem" style="list-style-type: disc"><code class="literal">/dev/sdb</code>: The 500.1 GB disk also has one partition</li></ul></div></li><li class="listitem">Use the freshly installed <code class="literal">pmount</code> command to mount the primary partition of the flash drive (<code class="literal">/dev/sda1</code>) and the primary partition of the USB disk (<code class="literal">/dev/sdb1</code>). The <code class="literal">sudo</code> command is not required.<div class="informalexample"><pre class="programlisting">pi@raspberrypi ~ $ <span class="strong"><strong>ls -l /media</strong></span>
total 0

pi@raspberrypi ~ $ <span class="strong"><strong>pmount /dev/sda1</strong></span>
pi@raspberrypi ~ $ <span class="strong"><strong>pmount /dev/sdb1</strong></span>

pi@raspberrypi ~ $ <span class="strong"><strong>ls -l /media</strong></span>
total 20
drwx------ 4 pi pi 16384 Dec 31  1969 sda1
drwxr-xr-x 6 pi pi  4096 May 30 12:23 sdb1

pi@raspberrypi ~ $</pre></div></li><li class="listitem">The preceding command output shows the contents of the <code class="literal">/media</code> directory before and after the <code class="literal">pmount</code> command is used to mount the two disks. After the <code class="literal">pmount</code> command is executed, each disk appears in the <code class="literal">/media</code> directory.</li><li class="listitem">The <code class="literal">df –h</code> command can also be used to display a list of the currently mounted disks with their mount points. In the following command output, the two disks, <code class="literal">/dev/sda1</code> and <code class="literal">/dev/sdb1</code>, are shown mounted on <code class="literal">/media/sda1</code> and <code class="literal">/media/sdb1</code>:<div class="informalexample"><pre class="programlisting">pi@raspberrypi ~ $ df –h
Filesystem      Size  Used Avail Use% Mounted on
rootfs           30G  4.2G   24G  15% /
/dev/root        30G  4.2G   24G  15% /
devtmpfs        484M     0  484M   0% /dev
tmpfs            98M  252K   98M   1% /run
tmpfs           5.0M     0  5.0M   0% /run/lock
tmpfs           195M     0  195M   0% /run/shm
/dev/mmcblk0p1   56M   19M   37M  34% /boot
/dev/sdb1       459G  172G  264G  40% /media/sdb1
/dev/sda1       123M   71M   53M  58% /media/sda1

pi@raspberrypi ~ $</pre></div></li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec126"/>How it works...</h2></div></div></div><p>After<a class="indexterm" id="id278"/> logging in to the Raspberry Pi, the <code class="literal">pmount</code> command is installed, the two disk drives are attached, and the command <code class="literal">fdisk –l</code> is used to display the partition tables of the disks attached to the Raspberry Pi. In the example, three disks are displayed:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">/dev/mmcblk0</code> is the boot disk</li><li class="listitem" style="list-style-type: disc"><code class="literal">/dev/sda</code> is the 128 MB flash drive</li><li class="listitem" style="list-style-type: disc"><code class="literal">/dev/sdb</code> is the 500 GB disk</li></ul></div><p>The flash drive has one partition (<code class="literal">/dev/sda1</code>) and so does the disk (<code class="literal">/dev/sdb1</code>). Within disk partitions, is where files are stored.</p><p>The <code class="literal">pmount</code> command is used to mount disk partitions. The disk partitions are mounted in the <code class="literal">/media</code> directory. The <code class="literal">ls –l</code> command is used before and after the disks are mounted to show where the disk partitions appear once they have been mounted.</p><p>The mount points in the <code class="literal">/media</code> directory are given names that correspond to the disk partitions that have been mounted there. The disk partition of the flash drive, <code class="literal">/dev/sda1</code>, is mounted on <code class="literal">/media/sda1</code> and the disk partition of the 500 GB disk, <code class="literal">/dev/sdb1</code>, is mounted on <code class="literal">/media/sdb1</code>.</p><p>Finally, the <code class="literal">df –h</code> command is used to demonstrate another way of seeing where the disk partitions have been mounted. The <code class="literal">df</code> command also shows the amount of free disk space that is available on each of the mounted disks. The <code class="literal">–h</code> option tells <code class="literal">df</code> to display the size of each disk in bytes, instead of in disk blocks. The 500 GB disk is 40% full; it has 264 GB available. The flash drive is 58% full with only 53 MB available.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec127"/>There's more...</h2></div></div></div><p>Let's learn something more about the disks.</p><div class="section" title="Device files"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl3sec25"/>Device files</h3></div></div></div><p>As each <a class="indexterm" id="id279"/>disk or disk partition is mounted, a device file is created for it and stored in the <code class="literal">/dev</code> directory. The names of each of these device files are assigned sequentially as the disks are mounted.</p><p>The assigned names of USB drives all begin with the characters <code class="literal">sd</code>. The first USB disk drive is assigned the device file <code class="literal">/dev/sda</code>, the second <code class="literal">/dev/sdb</code>, and so on. </p><p>The assigned names of the SD card drives begin with <code class="literal">mmcblk</code>, and a digit is added for each unique device starting with <code class="literal">0</code> (zero). The only SD card drive in the Raspberry Pi (the boot disk) has its device file located at <code class="literal">/dev/mmcblk0</code>.</p><p>For each disk partition discovered in a disk's partition table, a device file is also created. Each of these disk partition device files has the same name as the disk's device file with a digit attached corresponding to its location in the partition table.</p><p>In the example, the 32 GB SD card is assigned the device file <code class="literal">/dev/mmcblk0</code>. It has two partitions: <code class="literal">/dev/mmcblk0p1</code> and <code class="literal">/dev/mmcblk0p2</code>. If the SD card had yet another partition, the third partition's device file would be <code class="literal">/dev/mmcblk0p3</code>.</p><p>When a disk has a partition table, each partition needs to be mounted separately. Use the <code class="literal">pmount</code> command with the partition's device file, not the disk device file. The 500 GB disk in the example has one partition that is mounted with the command <code class="literal">pmount /dev/sdb1</code>.</p><p>When a disk has no partition table, use the <code class="literal">pmount</code> command with the device file assigned to the disk drive.</p></div><div class="section" title="Mount points"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl3sec26"/>Mount points</h3></div></div></div><p>When <a class="indexterm" id="id280"/>disk partitions are mounted, by default a mount point is created for each partition in the <code class="literal">/media</code> directory. The name of the default mount point is the same as the name of the device file used to mount the disk partition.</p><p>The only partition of the 128 MB flash drive was assigned the device file <code class="literal">/dev/sda1</code>, so by default its mount point is <code class="literal">/media/sda1</code>. The 500 GB disk also has one partition, <code class="literal">/dev/sdb1</code>, mounted at <code class="literal">/media/sdb1</code>.</p><p>To create a mount point under the <code class="literal">/media</code> directory with a name other than the default name, you need to pass the desired mount point as a second parameter of the <code class="literal">pmount</code> command, as in the following example:</p><div class="informalexample"><pre class="programlisting">pi@raspberrypi ~ $ <span class="strong"><strong>pmount /dev/sdb1 mydisk</strong></span>


pi@raspberrypi ~ $ <span class="strong"><strong>ls -l /media</strong></span>
total 20
drwx------ 4 pi pi 16384 Dec 31  1969 sda1
drwxr-xr-x 6 pi pi  4096 May 30 12:23 mydisk

pi@raspberrypi ~ $</pre></div></div><div class="section" title="Unmounting disks"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl3sec27"/>Unmounting disks</h3></div></div></div><p>Use the <code class="literal">pumount</code> command to unmount the disks (there is no <code class="literal">n</code> in the command name). After<a class="indexterm" id="id281"/> the disks are unmounted, their mount points are deleted from the <code class="literal">/media</code> directory.</p><div class="informalexample"><pre class="programlisting">pi@raspberrypi ~ $ <span class="strong"><strong>ls -l /media</strong></span>
total 20
drwx------ 4 pi pi 16384 Dec 31  1969 sda1
drwxr-xr-x 6 pi pi  4096 May 30 12:23 mydisk

pi@raspberrypi ~ $ <span class="strong"><strong>pumount /dev/sda1</strong></span>

pi@raspberrypi ~ $ <span class="strong"><strong>ls -l /media</strong></span>
total 4
drwxr-xr-x 6 pi pi 4096 May 30 12:23 mydisk

pi@raspberrypi ~ $ <span class="strong"><strong>pumount /media/mydisk</strong></span>

pi@raspberrypi ~ $ <span class="strong"><strong>ls -l /media</strong></span>
total 0

pi@raspberrypi ~ $</pre></div><p>As shown in the preceding example, the <code class="literal">pumount</code> command accepts either the disk device (<code class="literal">/dev/sda1</code>) or the mount point (<code class="literal">/media/mydisk</code>).</p></div><div class="section" title="The plugdev group"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl3sec28"/>The plugdev group</h3></div></div></div><p>Use <a class="indexterm" id="id282"/>of the <code class="literal">pmount</code> command does not require super user privileges. However, it does require some privileges. The privilege to execute the <code class="literal">pmount</code> command is reserved for members of the system group <code class="literal">plugdev</code>. Users who are not in the group <code class="literal">plugdev</code> cannot execute the <code class="literal">pmount</code> command. </p><div class="informalexample"><pre class="programlisting">Here is an example of how to add a user to the <code class="literal">plugdev</code> group:
pi@raspberrypi ~ $ <span class="strong"><strong>groups golden</strong></span>
golden : golden sudo

pi@raspberrypi ~ $ <span class="strong"><strong>adduser golden plugdev</strong></span>

pi@raspberrypi ~ $ <span class="strong"><strong>groups golden</strong></span>
golden : golden sudo plugdev

pi@raspberrypi ~ $ </pre></div><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note18"/>Note</h3><p>On Raspbian, the default user, <code class="literal">pi</code>, is already a member of the <code class="literal">plugdev</code> group.</p></div></div></div><div class="section" title="Other mount commands"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl3sec29"/>Other mount commands</h3></div></div></div><p>The system<a class="indexterm" id="id283"/> command <code class="literal">mount</code> requires super user privileges. During the boot process, the mount command is used to automatically mount disks like the SD card from which the Raspberry Pi boots. The next recipe shows how to configure the Raspberry Pi to automatically mount attached drives when it boots.</p><p>The file manager included with the Raspberry Pi desktop, PCManFM, will also mount disks in the <code class="literal">/media</code> directory. However, the PCManFM file manager uses the disk's label instead of the disk's device name as the name of the mount point.</p></div><div class="section" title="Disk performance"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl3sec30"/>Disk performance</h3></div></div></div><p>A Class 10 SD card has a transfer rate of 10 MB per second, yet an external hard disk can transfer data to the computer at 300 MB/sec. The hard disk is almost 30x faster than an SD card!</p><p>Even<a class="indexterm" id="id284"/> though SD cards can be purchased in increasingly large sizes, they are not the best choice for high-speed performance. Even the Ultra High Speed SD cards at 30 MB/sec are 10x slower than a hard disk. Most of the recipes in this book will perform better if the data that they depend on is stored on an external hard disk.</p></div><div class="section" title="The Raspberry Pi's power is limited"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl3sec31"/>The Raspberry Pi's power is limited</h3></div></div></div><p>External <a class="indexterm" id="id285"/>disks and flash drives that have no power supply of their own draw power from the Raspberry Pi's USB connection. The power needed by devices without their own power supply is taken from the Raspberry Pi. The Raspberry Pi's power is limited; it cannot reliably support larger USB devices if the devices have no power supply of their own.</p><p>The amount of power needed by an external USB device could easily exceed the amount of power that is available from the Raspberry Pi. If too much power is drawn from the Raspberry Pi, other USB devices, including the network interface (which internally uses the USB bus), may cease to function properly or they may cease to function at all.</p><p>For best performance and reliability, it is recommended that all USB devices, including external disk drives and flash drives, be connected <span class="emphasis"><em>indirectly</em></span> to the Raspberry Pi via a powered USB hub instead of being connected to the Raspberry Pi directly.</p><p>A powered USB hub is the power source for all of the USB devices that are connected to it. Only data is transferred to the Raspberry Pi. A powered USB hub does not draw power from the Raspberry Pi. Instead, it protects the Raspberry Pi from the power drain of other devices. By connecting USB devices <span class="emphasis"><em>indirectly</em></span> via a powered USB hub, the Raspberry Pi can perform optimally and reliably.</p></div></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec128"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Hard disk drive</strong></span> (<a class="ulink" href="http://en.wikipedia.org/wiki/Hard_disk_drive">http://en.wikipedia.org/wiki/Hard_disk_drive</a>): This <a class="indexterm" id="id286"/>Wikipedia article has more information about disk drives.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>USB flash drive</strong></span> (<a class="ulink" href="http://en.wikipedia.org/wiki/USB_flash_drive">http://en.wikipedia.org/wiki/USB_flash_drive</a>): This <a class="indexterm" id="id287"/>Wikipedia article provides detailed information about USB drives.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>SD cards</strong></span> (<a class="ulink" href="http://en.wikipedia.org/wiki/Secure_Digital">http://en.wikipedia.org/wiki/Secure_Digital</a>): This Wikipedia <a class="indexterm" id="id288"/>article is about the <span class="strong"><strong>Secure Digital</strong></span> (<span class="strong"><strong>SD</strong></span>) card format.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>mount (Unix)</strong></span> (<a class="ulink" href="http://en.wikipedia.org/wiki/Mount_(Unix)">http://en.wikipedia.org/wiki/Mount_(Unix)</a>): This Wikipedia <a class="indexterm" id="id289"/>article is about the <code class="literal">mount</code> command.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>df – report filesystem disk space usage</strong></span> (<a class="ulink" href="http://manpages.debian.net/cgi-bin/man.cgi?query=df">http://manpages.debian.net/cgi-bin/man.cgi?query=df</a>): The Debian <a class="indexterm" id="id290"/>man page for <code class="literal">df</code> has more information about the command and its options.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>fdisk – partition table manipulator for Linux</strong></span> (<a class="ulink" href="http://manpages.debian.net/cgi-bin/man.cgi?query=fdisk">http://manpages.debian.net/cgi-bin/man.cgi?query=fdisk</a>): The Debian<a class="indexterm" id="id291"/> man page for <code class="literal">fdisk</code> has more information about the command.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>pmount – mount arbitrary hotpluggable devices as normal user</strong></span> (<a class="ulink" href="http://manpages.debian.net/cgi-bin/man.cgi?query=pmount">http://manpages.debian.net/cgi-bin/man.cgi?query=pmount</a>): The<a class="indexterm" id="id292"/> Debian man page for <code class="literal">pmount</code> has more information about the command.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>pumount – unmount arbitrary hotpluggable devices</strong></span> (<a class="ulink" href="http://manpages.debian.net/cgi-bin/man.cgi?query=pumount">http://manpages.debian.net/cgi-bin/man.cgi?query=pumount</a>): The<a class="indexterm" id="id293"/> Debian man page for <code class="literal">pumount</code> has more information about the command.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>udev – Linux dynamic device management</strong></span> (<a class="ulink" href="http://manpages.debian.net/cgi-bin/man.cgi?query=udev">http://manpages.debian.net/cgi-bin/man.cgi?query=udev</a>): The Debian <a class="indexterm" id="id294"/>man page for <code class="literal">udev</code> explains in more detail how devices are mounted.</li></ul></div></div></div>
<div class="section" title="Accessing another computer's files (smbclient)"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec38"/>Accessing another computer's files (smbclient)</h1></div></div></div><p>The<a class="indexterm" id="id295"/> goal of this recipe is to transfer files between the Raspberry Pi and other computers using the command <code class="literal">smbclient</code>.</p><p>This recipe shows how to list the available network shared folders, to copy individual files, and how to copy entire directories of files from a computer with shared folders to the Raspberry Pi using the <code class="literal">smbclient</code> command.</p><p>After completing this recipe, you will be able to list the available file shares on the local network and transfer files directly between another computer and the Raspberry Pi using the SMB (CIFS) protocol.</p><div class="section" title="Getting ready..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec129"/>Getting ready...</h2></div></div></div><p>Here are the ingredients for this recipe:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">An initial setup or basic networking setup for the Raspberry Pi that has been powered on. You have also logged in as the user <code class="literal">pi</code> (see the recipes in <a class="link" href="ch01.html" title="Chapter 1. Installation and Setup">Chapter 1</a>, <span class="emphasis"><em>Installation and Setup</em></span>, for how to boot and log in and the recipes in <a class="link" href="ch02.html" title="Chapter 2. Administration">Chapter 2</a>, <span class="emphasis"><em>Administration</em></span>, for how to log in remotely).</li><li class="listitem" style="list-style-type: disc">A network connection.</li><li class="listitem" style="list-style-type: disc">A client PC connected to the same network as the Raspberry Pi.</li></ul></div><p>This <a class="indexterm" id="id296"/>recipe does not require the desktop GUI and could either be run from the text-based console or from within an LXTerminal.</p><p>If the Raspberry Pi's Secure Shell server is running, this recipe can be completed remotely using a Secure Shell client (see the recipe <span class="emphasis"><em>Remote access (SSH)</em></span> in <a class="link" href="ch02.html" title="Chapter 2. Administration">Chapter 2</a>, <span class="emphasis"><em>Administration</em></span>).</p><p>The examples in this recipe will connect the Raspberry Pi to a local network computer, golden-mackbook, and a home file server, <code class="literal">terragolden</code>. Configuration for other computers using the SMB (CIFS) protocol will be similar.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec130"/>How to do it...</h2></div></div></div><p>The steps to accessing another computer's files are as follows:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Log in to the Raspberry Pi either directly or remotely.</li><li class="listitem">Use the command <code class="literal">apt-get install</code> to download and install the <code class="literal">smbclient</code> software package.<div class="informalexample"><pre class="programlisting">pi@raspberrypi ~ $ <span class="strong"><strong>sudo apt-get install smbclient</strong></span></pre></div></li><li class="listitem">Use the command <code class="literal">smbclient</code> to list the services (<code class="literal">-L</code>) on the home file server, <code class="literal">terragolden</code>. No password is required (<code class="literal">-N</code>) for guest access.<div class="informalexample"><pre class="programlisting">pi@raspberrypi ~ $ <span class="strong"><strong>smbclient -N -L terragolden</strong></span></pre></div></li><li class="listitem">A list of SMB (CIFS) services from the home file server, <code class="literal">terrgolden</code>, is displayed.<div class="informalexample"><pre class="programlisting">Anonymous login successful
Domain=[GOLDEN] OS=[Unix] Server=[Samba 3.2.5]

    Sharename       Type      Comment
    ---------       ----      -------
    IPC$            IPC       IPC Service (Golden Family Media Drive)
    backups         Disk      
    livemusic       Disk      
    photos          Disk      
    public          Disk      

Anonymous login successful
Domain=[GOLDEN] OS=[Unix] Server=[Samba 3.2.5]

    Server               Comment
    ---------            -------
    TERRAGOLDEN          Golden Family Media Drive

    Workgroup            Master
    ---------            -------
    GOLDEN               

pi@raspberrypi ~ $ </pre></div></li><li class="listitem">Use the command <code class="literal">smbclient</code> to list the services (<code class="literal">-L</code>) on the home computer, golden-macbook. A valid username (<code class="literal">-U</code>) and password is required for access.<div class="informalexample"><pre class="programlisting">pi@raspberrypi ~ $ <span class="strong"><strong>smbclient –U golden -L golden-macbook –-signing=off</strong></span>

Enter golden's password: </pre></div></li><li class="listitem">A list of SMB (CIFS) services from the golden-macbook is displayed.<div class="informalexample"><pre class="programlisting">Domain=[GOLDEN-MACBOOK] OS=[Darwin] Server=[@(#)PROGRAM:smbd  PROJECT:smbx-276.92.2]

    Sharename       Type      Comment
    ---------       ----      -------
    IPC$            IPC       
    Macintosh HD    Disk      
    xfer            Disk      
    golden          Disk      

pi@raspberrypi ~ $ </pre></div></li><li class="listitem">Now, use <a class="indexterm" id="id297"/>the <code class="literal">mkdir</code> command to create a new directory (<code class="literal">xfer</code>) on the Raspberry Pi, use the <code class="literal">cd</code> command to switch to the new directory, and then use the <code class="literal">ls</code> command to show that there are no files in the newly created directory (<code class="literal">~/xfer</code>).<div class="informalexample"><pre class="programlisting">pi@raspberrypi ~ $ <span class="strong"><strong>mkdir xfer</strong></span>

pi@raspberrypi ~ $ <span class="strong"><strong>cd xfer</strong></span>

pi@raspberrypi ~/xfer $ <span class="strong"><strong>ls -l</strong></span>
total 0

pi@raspberrypi ~/xfer $ </pre></div></li><li class="listitem">Use the <code class="literal">smbclient</code> command to begin a conversation with the home file server, <code class="literal">terragolden</code>, about files in the file share <code class="literal">livemusic</code>.<div class="informalexample"><pre class="programlisting">pi@raspberrypi ~/xfer $ <span class="strong"><strong>smbclient -N //teragolden/livemusic</strong></span>
smb: \&gt; </pre></div></li><li class="listitem">The command prompt, <code class="literal">smb: \&gt;</code>, is displayed showing that the <code class="literal">smbclient</code> command is ready to converse with <code class="literal">terragolden</code>.</li><li class="listitem">Use the <code class="literal">ls</code> command to list the files and folders in the <code class="literal">livemusic</code> share of <code class="literal">terragolden</code>.<div class="informalexample"><pre class="programlisting">smb: \&gt; ls
  .                                   D        0  Fri Oct 28 15:45:43 2011
  ..                                  D        0  Tue Oct  9 22:03:55 2012
  catalog.txt                         A     5119  Mon Jul 24 18:04:30 2017
  dso040424                           D        0  Wed Mar  9 19:46:22 2011
  dtb2005-03-04                       D        0  Wed Mar  9 19:43:35 2011
  franti2010-06-11.flac16             D        0  Fri Mar 25 08:43:13 2011
  garaj2005-04-10_16bit_64kb_mp3      D        0  Wed Mar  9 19:50:28 2011
  JackJohnson2010-07-17               D        0  Mon Mar 14 14:04:25 2011
  JasonMraz-FarmAid                   D        0  Thu Apr 28 16:03:48 2011
  JasonMrazGrandRex_vbr_mp3           D        0  Thu Apr 28 16:04:59 2011
  jgb2008-07-19_64kb_mp3              D        0  Wed Mar  9 19:41:06 2011
  jj2010-12-13.aud.flac16             D        0  Wed Mar  2 11:46:06 2011
  MF2010-10-06_Nak30016BitFlac        D        0  Fri Mar 25 10:31:05 2011
  mFranti2006-11-13                   D        0  Wed Mar  9 19:55:00 2011
  mfs2005-01-15                       D        0  Wed Mar  9 19:48:50 2011
  particle2010-04-15                  D        0  Fri Mar 25 09:13:14 2011
  particle2010-10-30                  D        0  Fri Mar 25 08:45:00 2011
  skb2005-10-01matrix_64kb_mp3        D        0  Mon Mar 14 14:12:01 2011
  Soulive2011-03-08                   D        0  Fri Mar 25 08:33:21 2011
  Soulive2011-03-10                   D        0  Fri Mar 25 08:34:11 2011
  tenaciousd2005-09-22.flac16_64kb    D        0  Wed Mar  9 20:32:06 2011
  um2007-04-21                        D        0  Wed Mar  9 19:47:59 2011
  ymsb2001-02-02                      D        0  Wed Mar  9 09:23:13 2011
  ymsb2007-06-22                      D        0  Wed Mar  9 19:50:18 2011
  .DS_Store                          AH     6148  Fri Oct 28 15:45:43 2011
  ._.DS_Store                        AH     4096  Fri Oct 28 15:45:43 2011

        59356 blocks of size 16777216. 4490 blocks available

smb: \&gt;</pre></div></li><li class="listitem">Use the <code class="literal">get</code> command to download the <code class="literal">catalog.txt</code> file from <code class="literal">terragolden</code> to the Raspberry Pi.<div class="informalexample"><pre class="programlisting">smb: \&gt; <span class="strong"><strong>get catalog.txt</strong></span>
getting file \catalog.txt of size 5119 as catalog.txt (208.3 KiloBytes/sec) (average 208.3 KiloBytes/sec)

smb: \&gt; </pre></div></li><li class="listitem">Now, use <a class="indexterm" id="id298"/>the <code class="literal">mget</code> command to download an entire directory of files, <code class="literal">particle2010-04-15</code>, from <code class="literal">terragolden</code> to the Raspberry Pi. The <code class="literal">mget</code> command first requires that the <code class="literal">tarmode</code>, <code class="literal">recurse</code>, and <code class="literal">prompt</code> options are set.<div class="informalexample"><pre class="programlisting">smb: \&gt; <span class="strong"><strong>tarmode</strong></span>
tarmode is now full, system, hidden, noreset, verbose
smb: \&gt; <span class="strong"><strong>recurse</strong></span>
smb: \&gt; <span class="strong"><strong>prompt</strong></span>
smb: \&gt; <span class="strong"><strong>mget particle2010-04-15</strong></span>
getting file \particle2010-04-15\particle2010-04-15.ffp of size 594 as particle2010-04-15.ffp (11.8 KiloBytes/sec) (average 11.8 KiloBytes/sec)
getting file \particle2010-04-15\particle2010-04-15t01.flac of size 70373980 as particle2010-04-15t01.flac (8086.2 KiloBytes/sec) (average 8039.9 KiloBytes/sec)
getting file \particle2010-04-15\particle2010-04-15t02.flac of size 58391723 as particle2010-04-15t02.flac (8070.1 KiloBytes/sec) (average 8053.6 KiloBytes/sec)
getting file \particle2010-04-15\particle2010-04-15t03.flac of size 100964559 as particle2010-04-15t03.flac (4672.9 KiloBytes/sec) (average 6110.7 KiloBytes/sec)
getting file \particle2010-04-15\particle2010-04-15t04.flac of size 82562641 as particle2010-04-15t04.flac (8648.2 KiloBytes/sec) (average 6624.5 KiloBytes/sec)
getting file \particle2010-04-15\particle2010-04-15t05.flac of size 115649970 as particle2010-04-15t05.flac (5859.4 KiloBytes/sec) (average 6398.7 KiloBytes/sec)
getting file \particle2010-04-15\particle2010-04-15t06.flac of size 57681372 as particle2010-04-15t06.flac (4870.3 KiloBytes/sec) (average 6168.8 KiloBytes/sec)
getting file \particle2010-04-15\particle2010-04-15t07.flac of size 46807245 as particle2010-04-15t07.flac (8770.2 KiloBytes/sec) (average 6333.9 KiloBytes/sec)
getting file \particle2010-04-15\text.txt of size 491 as text.txt (10.0 KiloBytes/sec) (average 6346.5 KiloBytes/sec)

smb: \&gt; </pre></div></li><li class="listitem">Use<a class="indexterm" id="id299"/> the <code class="literal">quit</code> command to end the SMB (CIFS) conversation with the <code class="literal">terragolden</code> home file server and return to the Raspberry Pi command prompt.<div class="informalexample"><pre class="programlisting">smb: \&gt; quit

pi@raspberrypi ~/xfer $ </pre></div></li><li class="listitem">Use the <code class="literal">ls –l</code> command to display the contents of the current directory on the Raspberry Pi.<div class="informalexample"><pre class="programlisting">pi@raspberrypi ~/xfer $ <span class="strong"><strong>ls –l</strong></span>

total 20
-rw------- 1 pi pi 13564 Jul 19 13:52 catalog.txt
drwxr-xr-x 2 pi pi  4096 Jul 19 13:45 particle2010-04-15

pi@raspberrypi ~/xfer $</pre></div></li></ol></div></div><div class="section" title="How it works…"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec131"/>How it works…</h2></div></div></div><p>After logging in to the Raspberry Pi, the software distribution package <code class="literal">smbclient</code> is installed using the <code class="literal">apt-get install</code> command. For more information on how the <code class="literal">apt-get</code> command works, see <a class="link" href="ch03.html" title="Chapter 3. Maintenance">Chapter 3</a>, <span class="emphasis"><em>Maintenance</em></span>.</p><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note19"/>Note</h3><p>Your software distribution may already have <code class="literal">smbclient</code> installed.</p></div></div><p>The <code class="literal">smbclient</code> software distribution package contains the command-line application <code class="literal">smbclient</code>. This application is used to communicate with other computers using the SMB protocol.</p><p>After the software distribution package is installed, the <code class="literal">smbclient</code> command is used to list the available services on a home file server named <code class="literal">terragolden</code>. The <code class="literal">–N</code> option tells the command that no password is required for the remote computer, and the <code class="literal">–L</code> option tells the command to just list the available shares and printers.</p><p>For comparison, the <code class="literal">smbclient</code> command is also used to list the available services on another computer attached to the local network, golden-macbook. This time, a username (<code class="literal">-U golden</code>) and a password (no <code class="literal">–N</code> option) are required for access to the computer and the <code class="literal">smbclient</code> command also requires the <code class="literal">--signing=off</code> option to turn off a security feature that the computer does not support.</p><p>Before the <code class="literal">smbclient</code> command is used to start a conversation with <code class="literal">terragolden</code>, a transfer directory (<code class="literal">xfer</code>) is created using the <code class="literal">mkdir</code> command to receive the transferred files and its (empty) contents are displayed using the <code class="literal">ls –l</code> command. The <code class="literal">–l</code> option tells the <code class="literal">ls</code> command to use the long listing format that includes a total count of files (<code class="literal">0</code>).</p><p>The <a class="indexterm" id="id300"/>command <code class="literal">smbclient –N //terragolden/livemusic</code> is used to start a conversation between the Raspberry Pi and the remote computer, <code class="literal">terragolden</code>, using the file share named <code class="literal">livemusic</code>. The command prompt changes to <code class="literal">smb: \&gt;</code> telling the user that the conversation has begun.</p><p>The <code class="literal">ls</code> command of <code class="literal">smbclient</code> is used to list the files on the home file server. The command <code class="literal">dir</code> could be used instead and will return the same result as the <code class="literal">ls</code> command.</p><p>The command <code class="literal">get catalog.txt</code> is used to transfer the file <code class="literal">catalog.txt</code> from the file server to the Raspberry Pi. The <code class="literal">smbclient</code> command reports that the file transferred has a size of 5119 bytes and was transferred at a rate of 208.3 KB per second.</p><p>After the <code class="literal">catalog.txt</code> file has been transferred, three options are set to prepare for a multi-file transfer. The <code class="literal">tarmode</code> option is reset to its default setting to ensure that all files are transferred. The <code class="literal">recurse</code> option is toggled so that the upcoming <code class="literal">mget</code> command will copy subdirectories as well as files. And the <code class="literal">prompt</code> option is toggled so that the upcoming <code class="literal">mget</code> command does not prompt for validation before transferring each file.</p><p>Once the transfer options have been set, the <code class="literal">mget</code> command is used to transfer the <code class="literal">particle2010-04-15</code> directory of files to the Raspberry Pi. As each file is transferred, the size of the file and its rate of transfer are displayed.</p><p>After all of the files have been transferred, the <code class="literal">quit</code> command is used to tell the <code class="literal">smbclient</code> application that the conversation with the remote computer, <code class="literal">terragolden</code>, is now over.</p><p>The command prompt returns to <code class="literal">pi@raspberrypi ~ $</code> showing that the conversation is complete.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec132"/>There's more...</h2></div></div></div><p>The <code class="literal">smbclient</code> application has its own rich set of commands for communicating with remote computers via the SMB protocol.</p><div class="section" title="help"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl3sec32"/>help</h3></div></div></div><p>The <code class="literal">help</code> command can<a class="indexterm" id="id301"/> be used to list the commands available from the <code class="literal">smb: \&gt;</code> prompt.</p><div class="informalexample"><pre class="programlisting">smb: \&gt; <span class="strong"><strong>help</strong></span>
?              allinfo        altname        archive        blocksize      
cancel         case_sensitive cd             chmod          chown          
close          del            dir            du             echo           
exit           get            getfacl        geteas         hardlink       
help           history        iosize         lcd            link           
lock           lowercase      ls             l              mask           
md             mget           mkdir          more           mput           
newer          open           posix          posix_encrypt  posix_open     
posix_mkdir    posix_rmdir    posix_unlink   print          prompt         
put            pwd            q              queue          quit           
readlink       rd             recurse        reget          rename         
reput          rm             rmdir          showacls       setea          
setmode        stat           symlink        tar            tarmode        
translate      unlock         volume         vuid           wdel           
logon          listconnect    showconnect    ..             !              

smb: \&gt; <span class="strong"><strong>help help</strong></span>
HELP help:
    [command] give help on a command

smb: \&gt; </pre></div><p>Each of the <code class="literal">smbclient</code> application's commands has its own help page displayed using the <code class="literal">help</code> command. Type <code class="literal">help</code> followed by a command name to display more information about the command.</p></div><div class="section" title="Changing remote directories"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl3sec33"/>Changing remote directories</h3></div></div></div><p>The <code class="literal">cd</code> command in <code class="literal">smbclient</code> can be used to change directories on the remote computer in<a class="indexterm" id="id302"/> the same way <code class="literal">cd</code> is used to change directories on the Raspberry Pi. Notice that the current remote directory path is reflected in the <code class="literal">smbclient</code> command prompt.</p><div class="informalexample"><pre class="programlisting">smb: \&gt; <span class="strong"><strong>ls golden/stuff/astrology</strong></span>
  .                                   D        0  Wed Jun 29 22:20:25 2011
  ..                                  D        0  Wed Oct 26 13:49:49 2011
  astrolog data                      DR        0  Mon Dec 12 07:13:40 2005
  ephall-astrolog                    DR        0  Mon Jan 10 08:01:24 2005
  ephcom-1.0                         DR        0  Thu Apr  7 00:39:03 2005
  experiments                        DR        0  Mon Jan 10 21:45:51 2005
  jpl                                DR        0  Fri Mar  4 03:48:43 2005
  SwissEphemeris                     DR        0  Thu Apr  7 06:03:14 2005
  zodiac                             DR        0  Thu Apr  7 00:34:28 2005

        59356 blocks of size 16777216. 4490 blocks available

smb: \ &gt; <span class="strong"><strong>cd golden/stuff/astrology/zodiac</strong></span>

smb: \golden\stuff\astrology\zodiac\&gt; <span class="strong"><strong>ls</strong></span>
  .                                  DR        0  Thu Apr  7 00:34:28 2005
  ..                                  D        0  Wed Jun 29 22:20:25 2011
  .classpath                        AHR      236  Thu Apr  7 00:33:05 2005
  .project                          AHR      382  Thu Apr  7 00:33:05 2005
  classes                            DR        0  Wed Apr 20 10:14:10 2005
  src                                DR        0  Thu Apr  7 00:34:28 2005

        59356 blocks of size 16777216. 4490 blocks available

smb: \golden\stuff\astrology\zodiac\&gt; </pre></div></div><div class="section" title="Fetching a single file"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl3sec34"/>Fetching a single file</h3></div></div></div><p>If the <a class="indexterm" id="id303"/>location of a file on the remote computer is already known, it can be fetched directly with a single <code class="literal">smbclient</code> command.</p><div class="informalexample"><pre class="programlisting">pi@raspberrypi ~/xfer $ <span class="strong"><strong>smbclient –N //terragolden –c 'get /livemusic/Seeed/03-seed-aufstehen.mp3'</strong></span>

getting file \livemusic\Seeed\03-seed-aufstehen.mp3 of size 650317 as \livemusic\Seeed\03-seed-aufstehen.mp3 (10414.8 KiloBytes/sec) (average 10414.8 KiloBytes/sec)

pi@raspberrypi ~/xfer $</pre></div></div><div class="section" title="/ versus \"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl3sec35"/>/ versus \</h3></div></div></div><p>Notice that the SMB (CIFS) protocol uses <code class="literal">\</code> instead of <code class="literal">/</code> as a path separator.</p><p>The <a class="indexterm" id="id304"/>path separator is one of the major differences between the Windows operating system and Linux-based operating systems like Raspbian Linux, which is used by the Raspberry Pi.</p><p>Either character can be used within the <code class="literal">smbclient</code> application, if used consistently. However, it is much easier to use <code class="literal">/</code> as it is the path separator on the Raspberry Pi.</p></div></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec133"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>cd – change the working directory</strong></span> (<a class="ulink" href="http://manpages.debian.net/cgi-bin/man.cgi?query=cd">http://manpages.debian.net/cgi-bin/man.cgi?query=cd</a>): The Debian<a class="indexterm" id="id305"/> manual page for <code class="literal">cd</code> has more information about the command and its options.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>smbclient – client to access SMB/CIFS resources on servers</strong></span> (<a class="ulink" href="http://manpages.debian.net/cgi-bin/man.cgi?query=smbclient">http://manpages.debian.net/cgi-bin/man.cgi?query=smbclient</a>): The Debian manual page for <code class="literal">smbclient</code> has<a class="indexterm" id="id306"/> more information about the command.</li></ul></div></div></div>
<div class="section" title="Sharing folders from other computers (mount.cifs)"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec39"/>Sharing folders from other computers (mount.cifs)</h1></div></div></div><p>This <a class="indexterm" id="id307"/>recipe shows how to mount folders that have been shared from another computer.</p><p>Recent Linux kernels, including the kernel used by the Raspbian Linux distribution for the Raspberry Pi, have built-in support for mounting shared folders using the SMB (CIFS) protocol. This is the file sharing protocol used commonly by Windows computers and home file sharing devices. It is also used on OS X when sharing files.</p><p>This is the simplest recipe for mounting a shared folder from the command line on the Raspberry Pi.</p><p>Once you've completed this recipe, you will be able to share files with other computers on the same network using the SMB (CIFS) protocol.</p><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note20"/>Note</h3><p>SMB and CIFS are synonyms for the same file sharing protocol.</p></div></div><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec134"/>Getting ready</h2></div></div></div><p>Here are the ingredients for this recipe:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">An initial setup or basic networking setup for the Raspberry Pi that has been powered on. You have also logged in as the user <code class="literal">pi</code> (see the recipes in <a class="link" href="ch01.html" title="Chapter 1. Installation and Setup">Chapter 1</a>, <span class="emphasis"><em>Installation and Setup</em></span>, for how to boot and log in and the recipes in <a class="link" href="ch02.html" title="Chapter 2. Administration">Chapter 2</a>, <span class="emphasis"><em>Administration</em></span>, for how to log in remotely).</li><li class="listitem" style="list-style-type: disc">A powered USB hub (recommended).</li><li class="listitem" style="list-style-type: disc">At least one USB disk drive.</li></ul></div><p>This recipe does not require the desktop GUI and could either be run from the text-based console or from within an LXTerminal.</p><p>If the Raspberry Pi's Secure Shell server is running, this recipe can be completed remotely using a Secure Shell client (see the recipe <span class="emphasis"><em>Remote access (SSH)</em></span> in <a class="link" href="ch02.html" title="Chapter 2. Administration">Chapter 2</a>, <span class="emphasis"><em>Administration</em></span>).</p><p>The examples in this recipe will connect the Raspberry Pi to a home file server named <code class="literal">terragolden</code> sharing one folder, <code class="literal">livemusic</code>, which is configured for guest access.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec135"/>How to do it...</h2></div></div></div><p>The steps to sharing folders from other computers are as follows:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Log in to the Raspberry Pi either directly or remotely.</li><li class="listitem">Create a mount point for the shared folder using the <code class="literal">mkdir</code> command: <div class="informalexample"><pre class="programlisting">pi@raspberrypi ~ $ <span class="strong"><strong>sudo mkdir /media/livemusic</strong></span></pre></div></li><li class="listitem">Use the <code class="literal">mount</code> command with the <code class="literal">guest</code> and <code class="literal">uid=pi options (-o)</code> to mount the remote file share <code class="literal">//terragolden/livemusic</code> on the local directory, <code class="literal">/media/livemusic</code>.<div class="informalexample"><pre class="programlisting">pi@raspberrypi ~ $ <span class="strong"><strong>sudo mount -o guest,uid=pi //terragolden/livemusic /media/livemusic</strong></span> </pre></div></li><li class="listitem">Use the <code class="literal">ls –l</code> command to list the files in the folder <code class="literal">/media/livemusic</code>.<div class="informalexample"><pre class="programlisting">pi@raspberrypi ~ $ <span class="strong"><strong>ls -l /media/livemusic</strong></span>
total 0
drwx------ 2 pi nogroup 0 Mar  9  2011 dso040424
drwx------ 2 pi nogroup 0 Mar  9  2011 dtb2005-03-04
drwxrwxrwx 2 pi nogroup 0 Mar 25  2011 franti2010-06-11.flac16
drwx------ 2 pi nogroup 0 Mar  9  2011 garaj2005-04-10_16bit_64kb_mp3
drwx------ 2 pi nogroup 0 Mar 14  2011 JackJohnson2010-07-17
drwx------ 2 pi nogroup 0 Apr 28  2011 JasonMraz-FarmAid
drwx------ 2 pi nogroup 0 Apr 28  2011 JasonMrazGrandRex_vbr_mp3
drwx------ 2 pi nogroup 0 Mar  9  2011 JGB2007-06-15
drwx------ 2 pi nogroup 0 Mar  9  2011 jgb2008-07-19_64kb_mp3
drwx------ 2 pi nogroup 0 Mar  2  2011 jj2010-12-13.aud.flac16
drwxrwxrwx 2 pi nogroup 0 Mar 25  2011 MF2010-10-06_Nak30016BitFlac
drwx------ 2 pi nogroup 0 Mar  9  2011 mFranti2006-11-13
drwx------ 2 pi nogroup 0 Mar  9  2011 mfs2005-01-15
drwxrwxrwx 2 pi nogroup 0 Mar 25  2011 particle2010-04-15
drwxrwxrwx 2 pi nogroup 0 Mar 25  2011 particle2010-10-30
drwx------ 2 pi nogroup 0 Mar 14  2011 skb2005-10-01matrix_64kb_mp3
drwx------ 2 pi nogroup 0 Mar 25  2011 Soulive2011-03-08
drwx------ 2 pi nogroup 0 Mar 25  2011 Soulive2011-03-10
drwx------ 2 pi nogroup 0 Mar  9  2011 tenaciousd2005-09-22.flac16_64kb
drwx------ 2 pi nogroup 0 Mar  9  2011 um2007-04-21
drwx------ 5 pi nogroup 0 Mar  9  2011 ymsb2001-02-02
drwx------ 2 pi nogroup 0 Mar  9  2011 ymsb2007-06-22

pi@raspberrypi ~ $ </pre></div></li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec136"/>How it works...</h2></div></div></div><p>After <a class="indexterm" id="id308"/>logging in to the Raspberry Pi, the <code class="literal">mkdir</code> command is used to create a mount point for the shared folder in the <code class="literal">/media</code> directory. A mount point is an empty directory (<code class="literal">/media/livemusic</code>) that serves as a placeholder in the filesystem. </p><p>Then, the file share, <code class="literal">//terragolden/livemusic</code>, from the home file server, <code class="literal">terragolden</code>, is mounted at the newly created mount point (<code class="literal">/media/livemusic</code>). The options to the <code class="literal">mount</code> command (<code class="literal">–o guest,uid=pi</code>) tell the command that the share is to be accessed without a username or password (<code class="literal">guest</code>) and that the mounted files will belong to the user <code class="literal">pi</code> (<code class="literal">uid=pi</code>).</p><p>Finally, the files in the mount point (<code class="literal">/media/livemusic</code>) are listed using the command <code class="literal">ls -l</code> to verify that they are indeed identical to the files on the home file server.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec137"/>There's more...</h2></div></div></div><p>Let's look at some other aspects related to the sharing of folders.</p><div class="section" title="Protected shares require a username and a password"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl3sec36"/>Protected shares require a username and a password</h3></div></div></div><p>If a<a class="indexterm" id="id309"/> file share is password protected, then the options on the mount command need to be expanded to include <code class="literal">username=USER</code> and <code class="literal">password=PASS</code> options. <code class="literal">USER</code> and <code class="literal">PASS</code> should be replaced with the respective username and password of a user who has access to the file share.</p><div class="informalexample"><pre class="programlisting">pi@raspberrypi ~/xfer $ <span class="strong"><strong>sudo mount -o uid=pi,user=golden //golden-macbook/xfer /media/xfer</strong></span>
Password:

pi@raspberrypi /media/xfer $ <span class="strong"><strong>ls -l /media/golden-macbook/</strong></span>
total 8200
drwxr-xr-x 2 pi root       0 Jul 17 16:58 Applications
drwxr-xr-x 2 pi root       0 Jul  9 09:33 bin
drwxr-xr-x 2 pi root       0 Aug 24  2013 cores
drwxr-xr-x 2 pi root       0 Jul 14 18:06 dev
-rwxr-xr-x 1 pi root       0 Mar 11 09:23 etc
-rwxr-xr-x 1 pi root       0 Mar 11 09:26 HGN.flag
drwxr-xr-x 2 pi root       0 Jul 14 18:06 home
drwxr-xr-x 2 pi root       0 Mar 27 10:35 Library
-rwxr-xr-x 1 pi root 8394688 Mar 18 16:20 mach_kernel
drwxr-xr-x 2 pi root       0 Jul 14 18:06 net
drwxr-xr-x 2 pi root       0 Aug 24  2013 Network
drwxr-xr-x 2 pi root       0 Mar 18 08:53 opt
drwxr-xr-x 2 pi root       0 Mar 11 09:35 private
drwxr-xr-x 2 pi root       0 Jul  9 09:33 sbin
drwxr-xr-x 2 pi root       0 Mar 11 09:30 System
-rwxr-xr-x 1 pi root       0 Mar 11 09:23 tmp
drwxr-xr-x 2 pi root       0 Mar 27 14:48 Users
drwxr-xr-x 2 pi root       0 Mar 11 09:23 usr
-rwxr-xr-x 1 pi root       0 Mar 11 09:23 var
drwxr-xr-x 2 pi root       0 Jul 19 11:18 Volumes

pi@raspberrypi /media/xfer $ </pre></div></div><div class="section" title="Unmounting disks"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl3sec37"/>Unmounting disks</h3></div></div></div><p>Use <a class="indexterm" id="id310"/>the <code class="literal">umount</code> command to unmount the disks (there is no <code class="literal">n</code> in the command name).</p><div class="informalexample"><pre class="programlisting">pi@raspberrypi /media/xfer $ <span class="strong"><strong>sudo umount /media/golden-macbook</strong></span>
pi@raspberrypi /media/xfer $ <span class="strong"><strong>ls -l /media/golden-macbook</strong></span>
total 0

pi@raspberrypi /media/xfer $ </pre></div><p>After the disks are unmounted, the mount points remain under the <code class="literal">/media</code> directory; however, they are once again empty. The command <code class="literal">umount</code> is privileged (use <code class="literal">sudo</code>).</p></div></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec138"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Filesystem</strong></span> (<a class="ulink" href="http://en.wikipedia.org/wiki/Filesystem">http://en.wikipedia.org/wiki/Filesystem</a>): The Wikipedia<a class="indexterm" id="id311"/> article on filesystems explains the differences in more detail.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Server Message Block</strong></span> (<a class="ulink" href="http://en.wikipedia.org/wiki/Server_Message_Block">http://en.wikipedia.org/wiki/Server_Message_Block</a>): The Wikipedia<a class="indexterm" id="id312"/> article on the <span class="strong"><strong>Server Message </strong></span><a class="indexterm" id="id313"/><span class="strong"><strong>Block</strong></span> (<span class="strong"><strong>SMB</strong></span>) protocol discusses the protocol's use and its history.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Uniform Naming Convention</strong></span> (<a class="ulink" href="http://en.wikipedia.org/wiki/Uniform_Naming_Convention">http://en.wikipedia.org/wiki/Uniform_Naming_Convention</a>): The Wikipedia<a class="indexterm" id="id314"/> article on the <span class="strong"><strong>Uniform Naming Convention</strong></span> (<span class="strong"><strong>UNC</strong></span>) protocol<a class="indexterm" id="id315"/> shows how it supports the SMB (CIFS) protocol.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>mount – mount a filesystem</strong></span> (<a class="ulink" href="http://manpages.debian.net/cgi-bin/man.cgi?query=mount">http://manpages.debian.net/cgi-bin/man.cgi?query=mount</a>): The Debian manual page for <code class="literal">mount</code> explains the<a class="indexterm" id="id316"/> command and its options.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>mount.cifs – mount using the CIFS filesystem</strong></span> (<a class="ulink" href="http://manpages.debian.net/cgi-bin/man.cgi?query=mount.cifs">http://manpages.debian.net/cgi-bin/man.cgi?query=mount.cifs</a>): The Debian manual page for <code class="literal">mount.cifs</code> explains<a class="indexterm" id="id317"/> the command in more detail.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>umount – unmounts filesystems</strong></span> (<a class="ulink" href="http://manpages.debian.net/cgi-bin/man.cgi?query=umount">http://manpages.debian.net/cgi-bin/man.cgi?query=umount</a>): The Debian manual page for <code class="literal">umount</code> shows the<a class="indexterm" id="id318"/> command and its options.</li></ul></div></div></div>
<div class="section" title="Auto-mounting USB disks at boot (/etc/fstab)"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec40"/>Auto-mounting USB disks at boot (/etc/fstab)</h1></div></div></div><p>This <a class="indexterm" id="id319"/>recipe shows how to configure the Raspberry Pi so that it automatically mounts attached USB disk drives during the boot process.</p><p>The goal of this recipe is to mount the example disks at boot time with the same configuration that is used by the command <code class="literal">pmount</code>.</p><p>The first few steps of this recipe use the <code class="literal">pmount</code> and <code class="literal">mount</code> commands to discover the correct filesystem table configuration parameters for two example disk drives. Once the correct configuration parameters are discovered, the filesystem table configuration file (<code class="literal">/etc/fstab</code>) is updated so that the disks are mounted when the Raspberry Pi boots.</p><p>This recipe does not provide details on the meaning of each configuration parameter. Instead, the recipe reuses the same configuration that is used by the <code class="literal">pmount</code> command. More detail on the configuration parameters can be found in the man pages for the <code class="literal">mount</code> command.</p><p>After completing this recipe, the Raspberry Pi will mount USB disk drives at boot time with a configuration that is consistent with the <code class="literal">pmount</code> utility.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec139"/>Getting ready</h2></div></div></div><p>Here are the ingredients for this recipe:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">An initial setup or basic networking setup for the Raspberry Pi that has been powered on. You have also logged in as the user <code class="literal">pi</code> (see the recipes in <a class="link" href="ch01.html" title="Chapter 1. Installation and Setup">Chapter 1</a>, <span class="emphasis"><em>Installation and Setup</em></span>, for how to boot and log in and the recipes in <a class="link" href="ch02.html" title="Chapter 2. Administration">Chapter 2</a>, <span class="emphasis"><em>Administration</em></span>, for how to log in remotely).</li><li class="listitem" style="list-style-type: disc">A Powered USB hub (recommended).</li><li class="listitem" style="list-style-type: disc">At least one USB disk drive.</li></ul></div><p>This recipe does not require the desktop GUI and could either be run from the text-based console or from within an LXTerminal.</p><p>If the Raspberry Pi's Secure Shell server is running, this recipe can be completed remotely using a Secure Shell client (see the recipe <span class="emphasis"><em>Remote access (SSH)</em></span> in <a class="link" href="ch02.html" title="Chapter 2. Administration">Chapter 2</a>, <span class="emphasis"><em>Administration</em></span>).</p><p>The<a class="indexterm" id="id320"/> examples in this recipe use two USB drives: a 128 MB flash drive and a 500 GB disk.</p><p>The <code class="literal">pmount</code> command should already be installed (see the recipe <span class="emphasis"><em>Mounting USB disks</em></span>).</p><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note21"/>Note</h3><p>Be careful! A broken <code class="literal">/etc/fstab</code> may prevent the system from booting. Make sure that you've tested the configuration before rebooting!</p></div></div></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec140"/>How to do it...</h2></div></div></div><p>The steps to auto-mount USB disks at boot are as follows:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Log in to the Raspberry Pi either directly or remotely.</li><li class="listitem">Use the <code class="literal">pmount</code> command to mount the 128 MB flash drive's primary partition <code class="literal">/dev/sda1</code> in the <code class="literal">/media</code> directory at the mount point <code class="literal">thumbdrive</code>.<div class="informalexample"><pre class="programlisting">pi@raspberrypi /media/xfer $ <span class="strong"><strong>pmount /dev/sda1 thumbdrive</strong></span></pre></div></li><li class="listitem">Use the <code class="literal">pmount</code> command to mount the 500 GB disk's primary partition <code class="literal">/dev/sdb1</code> in the <code class="literal">/media</code> directory at the mount point <code class="literal">bigdisk</code>.<div class="informalexample"><pre class="programlisting">pi@raspberrypi /media/xfer $ <span class="strong"><strong>pmount /dev/sdb1 bigdisk</strong></span></pre></div></li><li class="listitem">Show that the disks are mounted with the <code class="literal">ls –l</code> command.<div class="informalexample"><pre class="programlisting">pi@raspberrypi ~ $ <span class="strong"><strong>ls -l /media</strong></span>
total 20
drwxr-xr-x 6 pi pi  4096 May 30 12:23 bigdisk
drwx------ 4 pi pi 16384 Dec 31  1969 thumbdrive

pi@raspberrypi ~ $ </pre></div></li><li class="listitem">Display the configuration used to mount the two disks with the <code class="literal">mount</code> command.<div class="informalexample"><pre class="programlisting">pi@raspberrypi ~ $ <span class="strong"><strong>mount</strong></span></pre></div></li><li class="listitem">The <code class="literal">mount</code> command displays the filesystem table, including the mount parameters needed for each disk (or disk partition).<div class="informalexample"><pre class="programlisting">/dev/root on / type ext4 (rw,noatime,data=ordered)
devtmpfs on /dev type devtmpfs (rw,relatime,size=494800k,nr_inodes=123700,mode=755)
tmpfs on /run type tmpfs (rw,nosuid,noexec,relatime,size=99820k,mode=755)
tmpfs on /run/lock type tmpfs (rw,nosuid,nodev,noexec,relatime,size=5120k)
proc on /proc type proc (rw,nosuid,nodev,noexec,relatime)
sysfs on /sys type sysfs (rw,nosuid,nodev,noexec,relatime)
tmpfs on /run/shm type tmpfs (rw,nosuid,nodev,noexec,relatime,size=199620k)
devpts on /dev/pts type devpts (rw,nosuid,noexec,relatime,gid=5,mode=620,ptmxmode=000)
/dev/mmcblk0p1 on /boot type vfat (rw,relatime,fmask=0022,dmask=0022,codepage=437,iocharset=ascii,shortname=mixed,errors=remount-ro)
/dev/sda1 on /media/thumbdrive type vfat (rw,nosuid,nodev,noexec,relatime,uid=1001,gid=1004,fmask=0177,dmask=0077,codepage=437,iocharset=iso8859-1,shortname=mixed,quiet,utf8,errors=remount-ro)
/dev/sdb1 on /media/bigdisk type ext4 (rw,nosuid,nodev,noexec,relatime,errors=remount-ro,data=ordered)

pi@raspberrypi ~ $ </pre></div></li><li class="listitem">After<a class="indexterm" id="id321"/> the disk configuration parameters have been displayed, use the <code class="literal">pumount</code> command to unmount the two disks.<div class="informalexample"><pre class="programlisting">pi@raspberrypi ~ $ <span class="strong"><strong>pumount /media/thumbdrive</strong></span>
pi@raspberrypi ~ $ <span class="strong"><strong>pumount /media/bigdisk</strong></span>

pi@raspberrypi ~ $ <span class="strong"><strong>ls -l /media</strong></span>
total 0</pre></div></li><li class="listitem">Make a copy of the current filesystem configuration with the <code class="literal">cp</code> command. Files can only be created in (or copied into) the <code class="literal">/etc</code> directory by a privileged user (so use <code class="literal">sudo</code>).<div class="informalexample"><pre class="programlisting">pi@raspberrypi ~ $ <span class="strong"><strong>sudo cp /etc/fstab /etc/fstab.orig</strong></span></pre></div></li><li class="listitem">Use the <code class="literal">vi</code> command to edit the filesystem configuration table <code class="literal">fstab</code>. <div class="informalexample"><pre class="programlisting">pi@raspberrypi ~ $ <span class="strong"><strong>sudo vi /etc/fstab</strong></span></pre></div></li><li class="listitem">The vi editor displays the contents of the <code class="literal">/etc/fstab</code> configuration file. Instructions for using the editor can be found in the vi man pages. See the recipe <span class="emphasis"><em>Reading the built-in documentation</em></span> in <a class="link" href="ch02.html" title="Chapter 2. Administration">Chapter 2</a>, <span class="emphasis"><em>Administration</em></span>.<div class="informalexample"><pre class="programlisting">proc            /proc           proc    defaults          0       0
/dev/mmcblk0p1  /boot           vfat    defaults          0       2
/dev/mmcblk0p2  /               ext4    defaults,noatime  0       1
# a swapfile is not a swap partition, so no using swapon|off from here on, use  dphys-swapfile swap[on|off]  for that
~                                                                               
~                                                                               
~                                                                               
"/etc/fstab" 4 lines, 322 characters</pre></div></li><li class="listitem">Add the configuration parameters for each disk to the bottom of the configuration file. The parameters for each disk can be copied from the output of the <code class="literal">mount</code> command.<div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note22"/>Note</h3><p>Each disk configuration should be a single line with fields separated by spaces or tabs. The example does not fit the page width.</p></div></div><div class="informalexample"><pre class="programlisting">proc            /proc           proc    defaults          0       0
/dev/mmcblk0p1  /boot           vfat    defaults          0       2
/dev/mmcblk0p2  /               ext4    defaults,noatime  0       1
# a swapfile is not a swap partition, so no using swapon|off from here on, use  dphys-swapfile swap[on|off]  for that
/dev/sda1       /media/thumbdrive  vfat  rw,nosuid,nodev,noexec,relatime,uid=1001,gid=1004,fmask=0177,dmask=0077,codepage=437,iocharset=iso8859-1,shortname=mixed,quiet,utf8,errors=remount-ro 0 2
/dev/sdb1       /media/bigdisk  ext4    rw,nosuid,nodev,noexec,relatime,errors=remount-ro,data=ordered 0 2
~                                                                               
~
"/etc/fstab" 6 lines, 605 characters</pre></div></li><li class="listitem">After<a class="indexterm" id="id322"/> entering the configuration parameters for each disk, save the file and exit the editor.<div class="informalexample"><pre class="programlisting">pi@raspberrypi ~ $ </pre></div></li><li class="listitem">Before the disks can be mounted, they need to have mount points. Create mount points using the <code class="literal">mkdir</code> command.<div class="informalexample"><pre class="programlisting">pi@raspberrypi ~ $ <span class="strong"><strong>sudo mkdir /etc/thumbdrive</strong></span>
pi@raspberrypi ~ $ <span class="strong"><strong>sudo mkdir /etc/bigdisk</strong></span>

pi@raspberrypi ~ $ <span class="strong"><strong>ls –l /media</strong></span>
total 8
drwxr-xr-x 2 root root 4096 Jul 19 19:14 bigdisk
drwxr-xr-x 2 root root 4096 Jul 19 19:15 thumbdrive

pi@raspberrypi ~ $ <span class="strong"><strong>ls -l /media/thumbrioe/</strong></span>
total 0

pi@raspberrypi ~ $ <span class="strong"><strong>ls -l /media/bigdisk/</strong></span>
total 0</pre></div></li><li class="listitem">Use the <code class="literal">mount –a</code> command to mount all of the configured disks.<div class="informalexample"><pre class="programlisting">pi@raspberrypi ~ $ <span class="strong"><strong>sudo mount -a</strong></span>

pi@raspberrypi ~ $ <span class="strong"><strong>ls -l /media</strong></span>
total 20
drwxr-xr-x 6 pi staff   4096 May 30 12:23 bigdisk
drwx------ 4 pi pi     16384 Dec 31  1969 thumbdrive

pi@raspberrypi ~ $ <span class="strong"><strong>ls -l /media/bigdisk/</strong></span>
total 24
drwxrwsr-x 11 pi pi  4096 Apr 26  2012 archive
drwxrws--- 20 pi pi  4096 Jan 23  2010 Live
drwx------  2 pi pi 16384 Oct  4  2010 lost+found

pi@raspberrypi ~ $ <span class="strong"><strong>ls -l /media//thumbdrive/</strong></span>
total 71278
-rw------- 1 pi pi 72988392 Mar  7 00:34 docker.tgz

pi@raspberrypi ~ $ </pre></div></li><li class="listitem">Use <a class="indexterm" id="id323"/>the <code class="literal">reboot</code> command to reboot the system, then log back in and use the <code class="literal">ls –l</code> command to display the contents of the two mount points <code class="literal">/media/thumdrive</code> and <code class="literal">/media/bigdisk</code>.<div class="informalexample"><pre class="programlisting">pi@raspberrypi ~ $ <span class="strong"><strong>sudo reboot</strong></span>

Broadcast message from root@raspberrypi (pts/2) (Sun Jul 19 18:40:55 2015):
The system is going down for reboot NOW!
pi@raspberrypi ~ $ Connection to 192.168.2.7 closed by remote host.
Connection to 192.168.2.7 closed.

golden-macbook:~ golden$ <span class="strong"><strong>ssh pi@raspberrypi.local</strong></span>
Linux raspberrypi 3.18.11-v7+ #781 SMP PREEMPT Tue Apr 21 18:07:59 BST 2015 armv7l

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Sun Jul 19 18:44:50 2015 from 192.168.2.1

pi@raspberrypi ~ $ <span class="strong"><strong>ls -l /media</strong></span>
total 20
drwxr-xr-x 6 pi staff   4096 May 30 12:23 bigdisk
drwx------ 4 pi pi     16384 Dec 31  1969 thumbdrive

pi@raspberrypi ~ $ <span class="strong"><strong>ls -l /media/bigdisk</strong></span>
total 24
drwxrwsr-x 11 pi staff  4096 Apr 26  2012 archive
drwxrws--- 20 pi staff  4096 Jan 23  2010 Live
drwx------  2 pi staff 16384 Oct  4  2010 lost+found

pi@raspberrypi ~ $ <span class="strong"><strong>ls -l /media/thumbdrive</strong></span>
total 71278
-rw------- 1 pi pi 72988392 Mar  7 00:34 docker.tgz

pi@raspberrypi ~ $ </pre></div></li><li class="listitem">The disks are now mounted automatically at boot!</li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec141"/>How it works...</h2></div></div></div><p>After logging in to the Raspberry Pi, two example disks are mounted using the personal mount command, <code class="literal">pmount</code> (see the recipe <span class="emphasis"><em>Mounting USB disks</em></span> for more information on the <code class="literal">pmount</code> command).</p><p>The 128 MB flash drive (<code class="literal">/dev/sda1</code>) is mounted at <code class="literal">/media/thumbdrive</code>.</p><p>The 500 GB disk (<code class="literal">/dev/sdb1</code>) is mounted at <code class="literal">/media/bigdisk</code>.</p><p>The system <code class="literal">mount</code> command is used to display the filesystem table configuration parameters of all the disks attached to the Raspberry Pi including the <code class="literal">bigdisk</code> and the <code class="literal">thumbdrive</code>.</p><p>After the configuration parameters are displayed, the two USB disks (<code class="literal">/dev/sda1</code> and <code class="literal">/dev/sdb1</code>) are unmounted using the <code class="literal">pumount</code> command. The <code class="literal">/media</code> directory is once again empty.</p><p>Before any changes are made to the filesystem configuration, the <code class="literal">cp</code> command is used to create a backup copy of <code class="literal">/etc/fstab</code>.</p><p>The vi editor is then used to add the configuration parameters for each disk to the bottom of the filesystem table configuration file (<code class="literal">/etc/fstab</code>).</p><p>Before the disks can be mounted, they first need to have mount points within the filesystem. The <code class="literal">mkdir</code> command is used to create a mount point for each of the USB disks at <code class="literal">/media/thumbdrive and /media/bigdisk</code>.</p><p>Once <a class="indexterm" id="id324"/>the mount points have been created, the <code class="literal">mount all disks</code> command, <code class="literal">mount –a</code>, is used to mount the example disks.</p><p>After the disks are mounted, the contents of the disks are displayed by using the <code class="literal">ls –l</code> command.</p><p>Everything looks good, so the Raspberry Pi is rebooted using the <code class="literal">reboot</code> command.</p><p>When the Raspberry Pi is finished rebooting, the user logs back in to the Raspberry Pi using the <code class="literal">ssh</code> command.</p><p>Finally, the <code class="literal">ls –l</code> command is used once again to list the contents of the two disks' mount points, <code class="literal">/media/thumbdrive</code> and <code class="literal">/media/bigdisk</code>.</p><p>The disks have been mounted successfully during boot!</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec142"/>There's more...</h2></div></div></div><p>We will look at how we can recover from an error.</p><div class="section" title="Error recovery"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl3sec38"/>Error recovery</h3></div></div></div><p>If the <code class="literal">mount</code> command displays an error, edit the <code class="literal">/etc/fstab</code> file again and look for typos<a class="indexterm" id="id325"/> and extra spaces. Correct any errors and try again.</p><p>If there are still errors, replace the configuration file with its original version using the following command:</p><div class="informalexample"><pre class="programlisting">pi@raspberrypi ~ $ <span class="strong"><strong>sudo cp –f /etc/fstab.orig /etc/fstab</strong></span></pre></div></div><div class="section" title="The fstab file format"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl3sec39"/>The fstab file format</h3></div></div></div><p>Each<a class="indexterm" id="id326"/> line of the <code class="literal">fstab</code> configuration file is used to configure where one disk (or disk partition) is mounted. Each line has six fields separated by blanks (or tabs):</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The first field is the device file. The device file is assigned automatically to each disk and can be discovered using the <code class="literal">fdisk –l</code> command (see the previous recipe). The 128 MB <code class="literal">thumbdrive</code> has one partition; its mountable device file is <code class="literal">/dev/sda1</code>. The 500 GB disk also has one partition with the mountable device file <code class="literal">/dev/sdb1</code>.</li><li class="listitem" style="list-style-type: disc">The second field is the mount point. Mount points can be located anywhere in the filesystem; however, current convention is to locate them in the <code class="literal">/media</code> directory. The mount point for the 128 MB flash drive is <code class="literal">/media/thumbdrive</code>. The mount point for the 500 GB disk is <code class="literal">/media/bigdisk</code>.</li><li class="listitem" style="list-style-type: disc">The third field is the type of filesystem on the device. The 128 MB flash drive has the <code class="literal">vfat</code> filesystem and the 500 GB drive has an <code class="literal">ext4</code> filesystem.</li><li class="listitem" style="list-style-type: disc">The fourth field is a comma-separated list of configuration parameters. They should be copied from the parenthetical list of parameters in the output of the <code class="literal">mount</code> command. There should be no spaces in this field and no parentheses. </li><li class="listitem" style="list-style-type: disc">The fifth field is a dump flag. It is usually zero (<code class="literal">0</code>), indicating that the filesystem does not need to be dumped. Both disks have <code class="literal">0</code> in this field.</li><li class="listitem" style="list-style-type: disc">The sixth field selects the boot phase in which the disk will be mounted. The disk mounted as the root filesystem (<code class="literal">/</code>) is mounted in phase one; all other disks should be mounted in phase two. The example disks will not be mounted as the root filesystem, so they both have <code class="literal">2</code> in this field.</li></ul></div><p>For the 128 MB flash drive, the configuration parameters are as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>The device file</strong></span>: <code class="literal">/dev/sda1</code></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>The mount point</strong></span>: <code class="literal">/media/thumbdrive</code></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>The filesystem type</strong></span>: <code class="literal">vfat</code></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>The mount options</strong></span>: <code class="literal">rw,nosuid,nodev,noexec,relatime,uid=1001,gid=1004,fmask=0177,dmask=0077,codepage=437,iocharset=iso8859-1,shortname=mixed,quiet,utf8,errors=remount-ro</code></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Dump option</strong></span>: (<code class="literal">0</code>)</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Boot phase</strong></span>: (<code class="literal">2</code>)</li></ul></div><p>For the 500 GB USB disk, the configuration parameters are as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>The device file</strong></span>: <code class="literal">/dev/sdb1</code></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>The mount point</strong></span>: <code class="literal">/media/bigdisk</code></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>The filesystem type</strong></span>: <code class="literal">ext4</code></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>The mount options</strong></span>: <code class="literal">rw,nosuid,nodev,noexec,relatime,errors=remount-ro,data=ordered</code></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Dump option</strong></span>: (<code class="literal">0</code>)</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Boot phase</strong></span>: (<code class="literal">2</code>)</li></ul></div></div></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec143"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>fstab – static information about the filesystems</strong></span> (<a class="ulink" href="http://manpages.debian.net/cgi-bin/man.cgi?query=fstab">http://manpages.debian.net/cgi-bin/man.cgi?query=fstab</a>): The Debian manual page for the <code class="literal">fstab</code> command has detailed information about the <a class="indexterm" id="id327"/>command <a class="indexterm" id="id328"/>and its options.</li></ul></div></div></div>
<div class="section" title="Auto-mounting a shared folder at boot"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec41"/>Auto-mounting a shared folder at boot</h1></div></div></div><p>The goal of this recipe is to mount a shared folder from another computer at boot time.</p><p>The <a class="indexterm" id="id329"/>previous recipe showed how to configure <code class="literal">/etc/fstab</code> for mounting USB disks. This recipe shows how a similar configuration can be used to auto-mount a Windows share at boot time (or any other set of files shared using the SMB (CIFS) protocol).</p><p>At home <a class="indexterm" id="id330"/>or at the office, it is common for a local network to have some form of <span class="strong"><strong>Networked Attached Storage</strong></span> (<span class="strong"><strong>NAS</strong></span>) available to network users as shared folders using the SMB (CIFS) protocol. This recipe shows how the Raspberry Pi can be configured to automatically mount a shared folder at boot time. </p><p>After completing this recipe, a shared folder from another computer will be attached to the root filesystem every time the Raspberry Pi boots.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec144"/>Getting ready</h2></div></div></div><p>Here are the ingredients:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">An initial setup or basic networking setup for the Raspberry Pi that has been powered on. You have also logged in as the user <code class="literal">pi</code> (see the recipes in <a class="link" href="ch01.html" title="Chapter 1. Installation and Setup">Chapter 1</a>, <span class="emphasis"><em>Installation and Setup</em></span>, for how to boot and log in and the recipes in <a class="link" href="ch02.html" title="Chapter 2. Administration">Chapter 2</a>, <span class="emphasis"><em>Administration</em></span>, for how to log in remotely).</li><li class="listitem" style="list-style-type: disc">A network connection.</li><li class="listitem" style="list-style-type: disc">A client PC connected to the same network as the Raspberry Pi.</li></ul></div><p>This recipe does not require the desktop GUI and could either be run from the text-based console or from within an LXTerminal.</p><p>If the Raspberry Pi's Secure Shell server is running, this recipe can be completed remotely using a Secure Shell client (see the recipe <span class="emphasis"><em>Remote access (SSH)</em></span> in <a class="link" href="ch02.html" title="Chapter 2. Administration">Chapter 2</a>, <span class="emphasis"><em>Administration</em></span>).</p><p>The examples in this recipe will connect the Raspberry Pi to a home file-sharing device named <code class="literal">terragolden</code>. This file server has several shares available, including backups. The shared folder is configured for guest access so no username or password is required.</p><p>Configuration for other computers using the SMB (CIFS) protocol will be similar.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec145"/>How to do it...</h2></div></div></div><p>The steps for auto-mounting shared folders at boot are as follows:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Log<a class="indexterm" id="id331"/> in to the Raspberry Pi either directly or remotely.</li><li class="listitem">Use the <code class="literal">cp</code> command to make a backup copy of the <code class="literal">/etc/fstab</code> configuration file named <code class="literal">/etc/fstab.orig</code>. Files can only be created in (or copied into) the <code class="literal">/etc</code> directory by a privileged user (so use <code class="literal">sudo</code>).<div class="informalexample"><pre class="programlisting">pi@raspberrypi ~ $ <span class="strong"><strong>sudo cp /etc/fstab /etc/fstab.orig</strong></span></pre></div></li><li class="listitem">Execute the command: <div class="informalexample"><pre class="programlisting">nano /etc/fstab</pre></div><p>Edit the filesystem configuration table <code class="literal">fstab</code>. The file <code class="literal">fstab</code> may only be modified by a privileged user (use <code class="literal">sudo</code>).</p></li><li class="listitem">Use the <code class="literal">vi</code> command to edit the filesystem configuration table <code class="literal">fstab</code>.<div class="informalexample"><pre class="programlisting">pi@raspberrypi ~ $ <span class="strong"><strong>sudo vi /etc/fstab</strong></span></pre></div></li><li class="listitem">The vi editor displays the contents of the <code class="literal">/etc/fstab</code> configuration file. Instructions for using the editor can be found in the vi man pages. See the recipe <span class="emphasis"><em>Reading the built-in documentation</em></span> in <a class="link" href="ch02.html" title="Chapter 2. Administration">Chapter 2</a>, <span class="emphasis"><em>Administration</em></span>.<div class="informalexample"><pre class="programlisting">proc            /proc           proc    defaults          0       0
/dev/mmcblk0p1  /boot           vfat    defaults          0       2
/dev/mmcblk0p2  /               ext4    defaults,noatime  0       1
# a swapfile is not a swap partition, so no using swapon|off from here on, use  dphys-swapfile swap[on|off]  for that
//terragolden/backups /media/backups cifs guest,uid=pi 0 2
~                                                                                                                                                 
~                                                                               
"/etc/fstab" 4 lines, 322 characters</pre></div></li><li class="listitem">For the example home file server, the configuration is as follows:<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The network location is <code class="literal">//terragolden/backups</code></li><li class="listitem" style="list-style-type: disc">The mount point is <code class="literal">/media/backups</code></li><li class="listitem" style="list-style-type: disc">The filesystem type is <code class="literal">cifs</code></li><li class="listitem" style="list-style-type: disc">The mount options are <code class="literal">guest,uid=pi</code></li><li class="listitem" style="list-style-type: disc">The dump option is <code class="literal">0</code></li><li class="listitem" style="list-style-type: disc">The boot phase is <code class="literal">2</code></li></ul></div></li><li class="listitem">After entering the configuration parameters for file share, save the file and exit the editor.<div class="informalexample"><pre class="programlisting">pi@raspberrypi ~ $ </pre></div></li><li class="listitem">Before<a class="indexterm" id="id332"/> the file share can be mounted, it needs to have a mount point. Create a mount point at <code class="literal">/media/backups</code> using the <code class="literal">mkdir</code> command.<div class="informalexample"><pre class="programlisting">pi@raspberrypi ~ $ <span class="strong"><strong>sudo mkdir /etc/backups</strong></span>

pi@raspberrypi ~ $ <span class="strong"><strong>ls –l /media</strong></span>
total 4
drwxr-xr-x 2 root root 4096 Jul 19 19:15 backups

pi@raspberrypi ~ $ <span class="strong"><strong>ls -l /media/thumbdrive/</strong></span>
total 0

pi@raspberrypi ~ $ <span class="strong"><strong>ls -l /media/bigdisk/</strong></span>
total 0</pre></div></li><li class="listitem">Use the <code class="literal">mount –a</code> command to mount all of the configured disks.<div class="informalexample"><pre class="programlisting">pi@raspberrypi ~ $ <span class="strong"><strong>sudo mount -a</strong></span>

pi@raspberrypi ~ $ <span class="strong"><strong>ls -l /media</strong></span>
total 0
drwxrwxrwx 14 pi 254 0 Jul 24  2017 backups

pi@raspberrypi ~ $ <span class="strong"><strong>ls -l /media/backups</strong></span>
total 3072
drwxrwxrwx 44 pi nogroup      0 Oct 28  2011 0 - live music
drwxr-xr-x  9 pi nogroup      0 Oct 26  2011 1 - family video
drwxr-xr-x  4 pi nogroup      0 Oct  1  2011 3 - golden studios
drwxrwxrwx  5 pi nogroup      0 Mar 29  2012 8 - software
drwxrwxrwx  2 pi nogroup      0 May 19  2011 9 - virtual machines
drwxrwxrwx  8 pi nogroup      0 May 11  2011 Alex
drwxrwxrwx 21 pi nogroup      0 Jan 20  2012 Barbara
drwxrwxrwx  4 pi nogroup      0 Feb 19 19:53 Michael
drwxrwxrwx  2 pi nogroup      0 May 19  2011 Patrick
drwxr-xr-x 30 pi nogroup      0 Apr  2  2012 Richard
drwxr-xr-x  4 pi nogroup      0 Dec 10  2011 xfer

pi@raspberrypi ~ $ </pre></div></li><li class="listitem">Use<a class="indexterm" id="id333"/> the <code class="literal">reboot</code> command to reboot the system.<div class="informalexample"><pre class="programlisting">pi@raspberrypi ~ $ <span class="strong"><strong>sudo reboot</strong></span>
Broadcast message from root@raspberrypi (pts/2) (Sun Jul 19 18:40:55 2015):
The system is going down for reboot NOW!</pre></div></li><li class="listitem">Log back in to the Raspberry Pi and then use the <code class="literal">ls –l</code> command to display the contents of the file share /media/backups.<div class="informalexample"><pre class="programlisting">pi@raspberrypi ~ $ <span class="strong"><strong>ls -l /media/backups</strong></span>
total 3072
drwxrwxrwx 44 pi nogroup      0 Oct 28  2011 0 - live music
drwxr-xr-x  9 pi nogroup      0 Oct 26  2011 1 - family video
drwxr-xr-x  4 pi nogroup      0 Oct  1  2011 3 - golden studios
drwxrwxrwx  5 pi nogroup      0 Mar 29  2012 8 - software
drwxrwxrwx  2 pi nogroup      0 May 19  2011 9 - virtual machines
drwxrwxrwx  8 pi nogroup      0 May 11  2011 Alex
drwxrwxrwx 21 pi nogroup      0 Jan 20  2012 Barbara
drwxrwxrwx  4 pi nogroup      0 Feb 19 19:53 Michael
drwxrwxrwx  2 pi nogroup      0 May 19  2011 Patrick
drwxr-xr-x 30 pi nogroup      0 Apr  2  2012 Richard
drwxr-xr-x  4 pi nogroup      0 Dec 10  2011 xfer

pi@raspberrypi ~ $ </pre></div></li><li class="listitem">The remote file share is now mounted automatically at boot!</li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec146"/>How it works...</h2></div></div></div><p>After logging in to the Raspberry Pi, a backup is made of the filesystem table configuration file <code class="literal">/etc/fstab</code>. The configuration file is copied to <code class="literal">/etc/fstab.orig</code>.</p><p>The vi editor is used to add the configuration parameters for the shared folder to the bottom of the configuration file.</p><p>The configuration used in the example is as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The first field is the network location: <code class="literal">//terragolden/xfer</code>. The second field is the mount point: <code class="literal">/media/backups</code>. </li><li class="listitem" style="list-style-type: disc">The third field is the type of filesystem: <code class="literal">cifs</code>. This is the protocol used by the file server to share folders.</li><li class="listitem" style="list-style-type: disc">The fourth field is a comma-separated list of options: <code class="literal">guest,uid=pi</code>. Additional options include <code class="literal">user=</code> and <code class="literal">password=</code> for specifying the username and password when a shared folder is protected.</li><li class="listitem" style="list-style-type: disc">The fifth field is a dump flag. It is set to zero (<code class="literal">0</code>), indicating that the shared folder does not need to be dumped at boot. </li><li class="listitem" style="list-style-type: disc">The sixth field selects the boot phase in which the disk will be mounted. The disk mounted as the root filesystem (<code class="literal">/</code>) is mounted in phase one; all other disks should be mounted in phase two (<code class="literal">2</code>).</li></ul></div><p>Once <a class="indexterm" id="id334"/>the filesystem table configuration file (<code class="literal">/etc/fstab</code>) has been updated, the configuration is tested before rebooting the system. The <code class="literal">mount all disks</code> command, <code class="literal">mount –a</code>, is used to mount the example disks.</p><p>If there is no error, the system can be rebooted.</p><p>If the mount command displays an error, edit the <code class="literal">/etc/fstab</code> file again and look for typos and extra spaces. Correct any errors and try again.</p><p>If there are still errors, replace the configuration file with its original version using the following command:</p><div class="informalexample"><pre class="programlisting">pi@raspberrypi ~ $ <span class="strong"><strong>sudo cp –f /etc/fstab.orig /etc/fstab</strong></span></pre></div></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec147"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Network Attached Storage</strong></span> (<a class="ulink" href="http://en.wikipedia.org/wiki/Network_Attached_Storage">http://en.wikipedia.org/wiki/Network_Attached_Storage</a>): Here is <a class="indexterm" id="id335"/>an interesting Wikipedia article on <span class="strong"><strong>Network Attached Storage</strong></span> (<span class="strong"><strong>NAS</strong></span>).</li></ul></div></div></div>
<div class="section" title="Creating a file server (Samba)"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec42"/>Creating a file server (Samba)</h1></div></div></div><p>This<a class="indexterm" id="id336"/> recipe shows how the Raspberry Pi can be configured to become a file server on the local network.</p><p>The Raspberry Pi, with attached file storage, functions well as a file server. Such a file server could be used as a central location for sharing files and documents, for storing backups of other computers, and for storing large media files, such as photo, music, and video files.</p><p>This recipe installs and configures samba and samba-common-bin. The Samba software distribution package, samba, contains a server for the SMB (CIFS) protocol used by modern computers for setting up <span class="emphasis"><em>shared drives</em></span> or <span class="emphasis"><em>shared folders</em></span>. The samba-common-bin package contains a small collection of utilities for managing access to shared files.</p><p>The recipe includes setting a file sharing password for the logged-in user and providing read/write access to the files in the user's home directory. However, it does not set up a new file share or show how to share a USB disk. The next recipe shows how to do that.</p><p>After completing this recipe, other computers on the local network can exchange files with the Raspberry Pi.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec148"/>Getting ready</h2></div></div></div><p>Here are the ingredients for this recipe:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">An initial setup or basic networking setup for the Raspberry Pi that has been powered on. You have also logged in as the user <code class="literal">pi</code> (see the recipes in <a class="link" href="ch01.html" title="Chapter 1. Installation and Setup">Chapter 1</a>, <span class="emphasis"><em>Installation and Setup</em></span>, for how to boot and log in and the recipes in <a class="link" href="ch02.html" title="Chapter 2. Administration">Chapter 2</a>, <span class="emphasis"><em>Administration</em></span>, for how to log in remotely.</li><li class="listitem" style="list-style-type: disc">A network connection.</li><li class="listitem" style="list-style-type: disc">A client PC connected to the same network as the Raspberry Pi.</li></ul></div><p>This recipe does not require the desktop GUI and could either be run from the text-based console or from within an LXTerminal.</p><p>If the Raspberry Pi's Secure Shell server is running, this recipe can be completed remotely using a Secure Shell client (see the recipe <span class="emphasis"><em>Remote access (SSH)</em></span> in <a class="link" href="ch02.html" title="Chapter 2. Administration">Chapter 2</a>, <span class="emphasis"><em>Administration</em></span>).</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec149"/>How to do it...</h2></div></div></div><p>The steps to creating a file server are as follows:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Log in to the Raspberry Pi either directly or remotely.</li><li class="listitem">Use<a class="indexterm" id="id337"/> the <code class="literal">apt-get install</code> command to install the software packages samba and samba-common-bin.<div class="informalexample"><pre class="programlisting">pi@raspberrypi ~ $ <span class="strong"><strong>sudo apt-get install –y samba samba-common-bin</strong></span>

Reading package lists... Done
Building dependency tree       
Reading state information... Done
The following extra packages will be installed:
  tdb-tools
Suggested packages:
  openbsd-inetd inet-superserver smbldap-tools ldb-tools ctdb
The following NEW packages will be installed:
  samba samba-common-bin tdb-tools
0 upgraded, 3 newly installed, 0 to remove and 0 not upgraded.
Need to get 6,119 kB of archives.
After this operation, 36.1 MB of additional disk space will be used.
Get:1 http://mirrordirector.raspbian.org/raspbian/ wheezy/main samba armhf 2:3.6.6-6+deb7u5 [3,356 kB]
Get:2 http://mirrordirector.raspbian.org/raspbian/ wheezy/main samba-common-bin armhf 2:3.6.6-6+deb7u5 [2,737 kB]
Get:3 http://mirrordirector.raspbian.org/raspbian/ wheezy/main tdb-tools armhf 1.2.10-2 [25.9 kB]
Fetched 6,119 kB in 2s (2,236 kB/s)
Preconfiguring packages ...
Selecting previously unselected package samba.
(Reading database ... 89348 files and directories currently installed.)
Unpacking samba (from .../samba_2%3a3.6.6-6+deb7u5_armhf.deb) ...
Selecting previously unselected package samba-common-bin.
Unpacking samba-common-bin (from .../samba-common-bin_2%3a3.6.6-6+deb7u5_armhf.deb) ...
Selecting previously unselected package tdb-tools.
Unpacking tdb-tools (from .../tdb-tools_1.2.10-2_armhf.deb) ...
Processing triggers for man-db ...
Setting up samba (2:3.6.6-6+deb7u5) ...
Generating /etc/default/samba...
Adding group `sambashare' (GID 110) ...
Done.
update-alternatives: using /usr/bin/smbstatus.samba3 to provide /usr/bin/smbstatus (smbstatus) in auto mode
[ ok ] Starting Samba daemons: nmbd smbd.
Setting up samba-common-bin (2:3.6.6-6+deb7u5) ...
update-alternatives: using /usr/bin/nmblookup.samba3 to provide /usr/bin/nmblookup (nmblookup) in auto mode
update-alternatives: using /usr/bin/net.samba3 to provide /usr/bin/net (net) in auto mode
update-alternatives: using /usr/bin/testparm.samba3 to provide /usr/bin/testparm (testparm) in auto mode
Setting up tdb-tools (1.2.10-2) ...
update-alternatives: using /usr/bin/tdbbackup.tdbtools to provide /usr/bin/tdbbackup (tdbbackup) in auto mode

pi@raspberrypi ~ $ </pre></div></li><li class="listitem">Use the <code class="literal">vi</code> command to edit the Samba configuration file (<code class="literal">/etc/samba/smb.conf</code>).<div class="informalexample"><pre class="programlisting">pi@raspberrypi ~ $ <span class="strong"><strong>sudo vi /etc/samba/smb.conf</strong></span></pre></div></li><li class="listitem">The vi editor displays the contents of the <code class="literal">/etc/samba/smb.conf</code> file. Instructions for using the editor can be found in the vi man pages; see the recipe <span class="emphasis"><em>Reading the built-in documentation</em></span> in <a class="link" href="ch02.html" title="Chapter 2. Administration">Chapter 2</a>, <span class="emphasis"><em>Administration</em></span>.<div class="informalexample"><pre class="programlisting">#
# Sample configuration file for the Samba suite for Debian GNU/Linux.
#
#
# This is the main Samba configuration file. You should read the
# smb.conf(5) manual page in order to understand the options listed
# here. Samba has a huge number of configurable options most of which
# are not shown in this example
#
"/etc/samba/smb.conf" 333 lines, 12173 characters</pre></div></li><li class="listitem">Change<a class="indexterm" id="id338"/> the security <code class="literal">= user</code> line. Uncomment the line. (Remove the hash, <code class="literal">#</code>, from the beginning of the line.)<div class="informalexample"><pre class="programlisting"># "security = user" is always a good idea. This will require a Unix account
# in this server for every user accessing the server. See
# /usr/share/doc/samba-doc/htmldocs/Samba3-HOWTO/ServerType.html
# in the samba-doc package for details.
security = user</pre></div></li><li class="listitem">Change <a class="indexterm" id="id339"/>the <code class="literal">read only = yes</code> line to be <code class="literal">read only = no</code>.<div class="informalexample"><pre class="programlisting">[homes]
   comment = Home Directories
   browseable = no

# By default, the home directories are exported read-only. Change the
# next parameter to 'no' if you want to be able to write to them.
   read only = no</pre></div></li><li class="listitem">Save (<code class="literal">:w</code>) and exit (<code class="literal">:q</code>) the vi editor.</li><li class="listitem">Use the <code class="literal">/etc/init.d/samba</code> initialization script to tell the Samba server to reload its configuration file.<div class="informalexample"><pre class="programlisting">pi@raspberrypi ~ $ <span class="strong"><strong>sudo /etc/init.d/samba reload</strong></span>
[ ok ] Reloading /etc/samba/smb.conf: smbd only.</pre></div></li><li class="listitem">Use the <code class="literal">smbpasswd –a</code> command to create an SMB (CIFS) password for the logged-in user, <code class="literal">pi</code>. Enter the password (twice).<div class="informalexample"><pre class="programlisting">pi@raspberrypi ~ $ <span class="strong"><strong>sudo smbpasswd -a pi</strong></span>
New SMB password:
Retype new SMB password:
Added user pi.

pi@raspberrypi ~ $ </pre></div></li><li class="listitem">The Raspberry Pi is now accessible as a file server!</li><li class="listitem">From a Windows computer, use <span class="strong"><strong>Map network drive</strong></span> to mount the Raspberry Pi as a network disk.<p> </p><div class="mediaobject"><img alt="How to do it..." src="graphics/B04547_04_01.jpg"/><div class="caption"><p>The above screenshot shows the mapping of a network drive to the Raspberry Pi on Windows 7.</p></div></div></li><li class="listitem">Enter<a class="indexterm" id="id340"/> the UNC address <code class="literal">\\raspberrypi\pi</code> as the network folder. Choose an appropriate drive letter. The following example uses the <code class="literal">R:</code> drive. Select <span class="strong"><strong>Connect using different credentials</strong></span>. Click on <span class="strong"><strong>Finish</strong></span>.<div class="mediaobject"><img alt="How to do it..." src="graphics/B04547_04_02.jpg"/><div class="caption"><p>The above screenshot finishes mapping a network drive to the Raspberry Pi.</p></div></div></li><li class="listitem">Log in using the newly configured SMB (CIFS) password (from step 7).<div class="mediaobject"><img alt="How to do it..." src="graphics/B04547_04_03.jpg"/></div><p>In the screenshot, a dialog box is displayed for logging in to the Raspberry Pi with the SMB (CIFS) username and password.</p></li><li class="listitem">The<a class="indexterm" id="id341"/> Raspberry Pi is now accessible as a Windows share! Only the home directory of the user <code class="literal">pi</code> is accessible at this point. The next recipe configures a USB disk for use as a shared drive.</li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec150"/>How it works...</h2></div></div></div><p>After logging in to the Raspberry Pi, the recipe installs two software distribution packages: samba and samba-common-bin, using the <code class="literal">apt-get install</code> command.</p><p>The samba<a class="indexterm" id="id342"/> package contains an implementation of the <span class="strong"><strong>Server Message Block</strong></span> (<span class="strong"><strong>SMB</strong></span>) protocol (also known as the <span class="strong"><strong>Common Internet File System</strong></span>, <span class="strong"><strong>CIFS</strong></span>). For sharing files and printers, Microsoft Windows <a class="indexterm" id="id343"/>computers use the SMB (CIFS) protocol.</p><p>After the packages are installed, the Samba configuration file <code class="literal">/etc/samba/smb.conf</code> is updated. The file is updated to turn on user security (<code class="literal">security = user</code>) and to enable writing files to user home directories (<code class="literal">readonly = no</code>).</p><p>After the configuration file is updated, the Samba server is told to reload its configuration using the server's initialization file, <code class="literal">/etc/init.d/samba</code>.</p><p>At this point, the Raspberry Pi should be visible to other machines on the local network that are using the SMB protocol. However, the passwords for the authorized users have not yet been configured.</p><p>The <code class="literal">smbpasswd</code> command is used to add (<code class="literal">-a</code>) the user <code class="literal">pi</code> to the list of users authorized to share files with the Raspberry Pi using the SMB protocol. The passwords for file sharing are managed separately from the login passwords used to log in to the Raspberry Pi either directly or remotely.</p><p>After the password has been added for the user <code class="literal">pi</code>, the Raspberry Pi should be accessible from any machine on the local network that is configured for the SMB protocol. </p><p>The last steps of the recipe configure access to the Raspberry Pi from a Windows 7 PC using a mapped network drive. The UNC name for the file share, <code class="literal">\\raspberrypi\pi</code>, could also be used to access the share directly from Windows Explorer.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec151"/>There's more...</h2></div></div></div><p>This is a very simple configuration for sharing files. It enables file sharing for users with a login to the Raspberry Pi. However, it only permits the files in the user home directories to be shared. The next recipe describes how to add a new file share.</p><p>In addition <a class="indexterm" id="id344"/>to the SMB protocol server <code class="literal">smbd</code>, the Samba software distribution package also contains a NetBIOS name server, <code class="literal">nmbd</code>. The NetBIOS name server provides naming services to computers using the SMB protocol. The <code class="literal">nmbd</code> server broadcasts the configured name of the Raspberry Pi, <code class="literal">raspberrypi</code>, to other computers on the local network.</p><p>In<a class="indexterm" id="id345"/> addition to file sharing, a Samba server could also be used as a <span class="strong"><strong>Primary Domain Controller</strong></span> (<span class="strong"><strong>PDC</strong></span>)—a central network server that is used to provide logins and security for all computers on a LAN. More information on using the samba package as a PDC can be found in the following links.</p></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec152"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Samba (software)</strong></span> (<a class="ulink" href="http://en.wikipedia.org/wiki/Samba_(software)">http://en.wikipedia.org/wiki/Samba_(software)</a>): A Wikipedia article <a class="indexterm" id="id346"/>on the Samba software suite.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>nmbd – NetBIOS over IP naming service</strong></span> (<a class="ulink" href="http://manpages.debian.net/cgi-bin/man.cgi?query=nmbd">http://manpages.debian.net/cgi-bin/man.cgi?query=nmbd</a>): The Debian <a class="indexterm" id="id347"/>manual page for <code class="literal">nmbd</code>.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>samba – a Windows SMB/CIFS file server for Unix</strong></span> (<a class="ulink" href="http://manpages.debian.net/cgi-bin/man.cgi?query=samba">http://manpages.debian.net/cgi-bin/man.cgi?query=samba</a>): The Debian <a class="indexterm" id="id348"/>man page for samba.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>smb.conf – the configuration file for the Samba suite</strong></span> (<a class="ulink" href="http://manpages.debian.net/cgi-bin/man.cgi?query=smb.conf">http://manpages.debian.net/cgi-bin/man.cgi?query=smb.conf</a>): The <a class="indexterm" id="id349"/>Debian manual page for <code class="literal">smb.conf</code>.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>smbd – server to provide SMB/CIFS services to clients</strong></span> (<a class="ulink" href="http://manpages.debian.net/cgi-bin/man.cgi?query=smbd">http://manpages.debian.net/cgi-bin/man.cgi?query=smbd</a>): The Debian <a class="indexterm" id="id350"/>manual page for <code class="literal">smbd</code>.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>smbpasswd – change a user's SMB password</strong></span> (<a class="ulink" href="http://manpages.debian.net/cgi-bin/man.cgi?query=smbpasswd">http://manpages.debian.net/cgi-bin/man.cgi?query=smbpasswd</a>): The Debian manual <a class="indexterm" id="id351"/>page for <code class="literal">smbpasswd</code>.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>System initialization</strong></span> (<a class="ulink" href="http://www.debian.org/doc/manuals/debian-reference/ch04.en.html">http://www.debian.org/doc/manuals/debian-reference/ch04.en.html</a>): The <span class="emphasis"><em>Debian Reference Manual</em></span> article on system <a class="indexterm" id="id352"/>initialization.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Samba.org</strong></span> (<a class="ulink" href="http://www.samba.org">http://www.samba.org</a>): The Samba software<a class="indexterm" id="id353"/> website.</li></ul></div></div></div>
<div class="section" title="Sharing an attached USB disk (Samba)"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec43"/>Sharing an attached USB disk (Samba)</h1></div></div></div><p>This<a class="indexterm" id="id354"/> recipe extends the default Samba configuration to include sharing a USB disk.</p><p>The previous recipe showed how to install Samba and set up basic file sharing. However, the Samba configuration used only shared files that are in the user's home directory. Other directories on the Raspberry Pi are not yet accessible via the SMB (CIFS) protocol.</p><p>This recipe extends the Samba configuration used in the previous recipe to include a new file share definition that points to a USB hard disk mounted on the Raspberry Pi.</p><p>After completing this recipe, the Raspberry Pi can be used as a file server for any computer that shares its files via the SMB (CIFS) protocol (for example, Windows, Mac, and Linux computers).</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec153"/>Getting ready</h2></div></div></div><p>Ingredients:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">An initial setup or basic networking setup for the Raspberry Pi that has been powered on. You have also logged in as the user <code class="literal">pi</code> (see the recipes in <a class="link" href="ch01.html" title="Chapter 1. Installation and Setup">Chapter 1</a>, <span class="emphasis"><em>Installation and Setup</em></span>, for how to boot and log in and the recipes in <a class="link" href="ch02.html" title="Chapter 2. Administration">Chapter 2</a>, <span class="emphasis"><em>Administration</em></span>, for how to log in remotely).</li><li class="listitem" style="list-style-type: disc">A network connection (optional).</li><li class="listitem" style="list-style-type: disc">A client PC connected to the same network as the Raspberry Pi (optional).</li><li class="listitem" style="list-style-type: disc">A powered USB hub (recommended).</li><li class="listitem" style="list-style-type: disc">At least one USB disk drive (the example uses a 500 GB USB disk).</li></ul></div><p>This recipe does not require the desktop GUI and could either be run from the text-based console or from within an LXTerminal.</p><p>If the Raspberry Pi's Secure Shell server is running and it has a network connection, this recipe can be completed remotely using a Secure Shell client (see the preceding).</p><p>The example in this recipe uses a USB disk mounted at <code class="literal">/media/bigdisk</code> (see the recipe <span class="emphasis"><em>Mounting USB disks</em></span> at the beginning of this chapter).</p><p>The example in this recipe also includes test access to the new file share from another computer on the local network, golden-macbook.</p><p>The Raspberry Pi should already have Samba installed (see the previous recipe).</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec154"/>How to do it...</h2></div></div></div><p>The steps <a class="indexterm" id="id355"/>for sharing an attached USB disk are as follows:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Log in to the Raspberry Pi either directly or remotely.</li><li class="listitem">Use the <code class="literal">ls –l</code> command to list the disk drives that have been mounted in the <code class="literal">/media</code> directory.<div class="informalexample"><pre class="programlisting">pi@raspberrypi ~ $ <span class="strong"><strong>ls –l /media</strong></span>
total 4
drwxr-xr-x  6 pi staff 4096 May 30 12:23 bigdisk

pi@raspberrypi ~ $ </pre></div></li><li class="listitem">Use the vi editor to edit the Samba configuration file, <code class="literal">/etc/samba/smb.conf</code>.<div class="informalexample"><pre class="programlisting">pi@raspberrypi ~ $ <span class="strong"><strong>vi /etc/samba/smb.conf</strong></span></pre></div></li><li class="listitem">The vi editor displays the contents of the configuration file. Instructions for using the editor can be found in the vi man pages; see the recipe <span class="emphasis"><em>Reading the built-in documentation</em></span> in <a class="link" href="ch02.html" title="Chapter 2. Administration">Chapter 2</a>, <span class="emphasis"><em>Administration</em></span>.<div class="informalexample"><pre class="programlisting">#
# Sample configuration file for the Samba suite for Debian GNU/Linux.
#
#
# This is the main Samba configuration file. You should read the
# smb.conf(5) manual page in order to understand the options listed
"/etc/samba/smb.conf" 333 lines, 12173 characters</pre></div></li><li class="listitem">Add a new share configuration to the bottom of the file:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>[bigdisk]</strong></span>
<span class="strong"><strong>        comment = A really big disk!</strong></span>
<span class="strong"><strong>        path = /media/bigdisk</strong></span>
<span class="strong"><strong>	valid users = pi</strong></span>
<span class="strong"><strong>	admin users = pi</strong></span>
<span class="strong"><strong>	read only = No</strong></span>
</pre></div><div class="informalexample"><pre class="programlisting">#======================= Share Definitions =======================

[bigdisk]
   comment = A really big disk!
   path = /media/bigdisk
   valid users = pi
   admin users = pi
   read only = no

[homes]
   comment = Home Directories
   browseable = no

"/etc/samba/smb.conf" 340 lines, 12294 characters</pre></div></li><li class="listitem">Save and exit the vi editor.</li><li class="listitem">Use the <code class="literal">/etc/init.d/samba reload</code> command to tell the Samba server to reload its configuration file.<div class="informalexample"><pre class="programlisting">pi@raspberrypi ~ $ <span class="strong"><strong>sudo /etc/init.d/samba reload</strong></span>
[ ok ] Reloading /etc/samba/smb.conf: smbd only.

pi@raspberrypi ~ $</pre></div></li><li class="listitem">The file share <code class="literal">\\raspberrypi\bigdisk</code> is now accessible from the local network! Connect as the user <code class="literal">pi</code>.<div class="informalexample"><pre class="programlisting">golden-macbook:~ golden$ <span class="strong"><strong>smbutil view //pi@raspberrypi</strong></span>
Password for 192.168.2.7: 
Share                                     Type    Comments
-------------------------------
print$                                    Disk    Printer Drivers
pi                                        Disk    Home Directories
IPC$                                      Pipe    IPC Service (raspberrypi server)
bigdisk                                   Disk    A really big disk!

4 shares listed

golden-macbook:~ golden$ </pre></div></li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec155"/>How it works...</h2></div></div></div><p>After<a class="indexterm" id="id356"/> logging in to the Raspberry Pi, the recipe lists the disks that have been mounted in the <code class="literal">/media</code> directory. This is the directory used by the Raspberry Pi desktop (GUI) when auto-mounting USB disks. It is also the directory used by the <code class="literal">pmount</code> command (and the recipe auto-mounting USB disks at boot).</p><p>Then, the vi editor is used to modify the Samba configuration file, <code class="literal">smb.conf</code>. The configuration for a new share <code class="literal">[bigdisk]</code> is added to the file. </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">[bigdisk]</code> starts a new section in the <code class="literal">config</code> file and sets the name of the share: <code class="literal">bigdisk</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">Comment =</code> A really big disk! defines a comment to display when users browse the share from another computer</li><li class="listitem" style="list-style-type: disc"><code class="literal">Path = /media/bigdisk</code> is the location of the files on the Raspberry Pi</li><li class="listitem" style="list-style-type: disc"><code class="literal">valid users = pi</code> declares that only the user <code class="literal">pi</code> can access the files</li><li class="listitem" style="list-style-type: disc"><code class="literal">admin users = pi</code> gives the user <code class="literal">pi</code> administrative access to the files</li><li class="listitem" style="list-style-type: disc"><code class="literal">read only = no</code> allows files to be written to and deleted from the share</li></ul></div><p>After the configuration is saved and the vi editor has been exited, the Samba server is told to reload its configuration with the command <code class="literal">/etc/init.d/samba</code> reload.</p><p>Once the configuration file is reloaded, the Samba server is ready to share files from the <code class="literal">/media/bigdata</code> directory over the file share, <code class="literal">bigdata</code>, at the UNC address <code class="literal">\\raspberrypi\bigdata</code>.</p><p>Finally, the <code class="literal">smbutil</code> command is used on another computer (golden-macbook) to validate that the new bigdisk share is accessible from the local network.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec156"/>There's more...</h2></div></div></div><p>The files<a class="indexterm" id="id357"/> in the new share are protected and require that users on other computers connect to the share using the Samba password of the <code class="literal">pi</code> user.</p><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note23"/>Note</h3><p>Remember: the Samba password of a user is maintained separately from the login password.</p><p>Use the <code class="literal">smbpasswd</code> command to create and manage Samba passwords (see the previous recipe, <span class="emphasis"><em>Creating a file server for an example</em></span>).</p></div></div></div></div></body></html>