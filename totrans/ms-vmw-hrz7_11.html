<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Configuring and Managing Desktop Pools - Part 2</h1>
                </header>
            
            <article>
                
<p>Following on from <a href="d44c9a7b-bcae-4758-a857-197be388a4be.xhtml">Chapter 8</a>, <span class="cdp-organizer-chapter-title"><span class="cdp-organize-title-label"><em>Configuring and Managing Desktop Pools - Part 1</em></span></span>, where we configured dedicated desktop pools, in this chapter, we are going to create a number of floating desktop pools using <span>Linked Clone</span>s, Instant Clones, and also a manual desktop pool. Then, we will entitle end users to these desktop pools and therefore allow them to connect to a virtual desktop machine.</p>
<p>We will also look at some of the management tasks that you will need to undertake when deploying <span>Linked Clone</span> desktop pools, before finally looking at how to review the deployment.</p>
<p>In this chapter, we will cover following topics:</p>
<ul>
<li>Creating floating, <span>Linked Clone</span> desktop pools</li>
<li>Creating floating, Full Clone desktop pools</li>
<li>Creating floating, <span>Instant Clone</span> desktop pools</li>
<li>Creating a manual desktop pool</li>
<li>Adding end user entitlements</li>
<li>Managing <span>Linked Clone</span> desktop pools</li>
<li>Reviewing the infrastructure post-deployment</li>
</ul>
<p class="mce-root"/>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Creating floating, Linked Clone desktop pools</h1>
                </header>
            
            <article>
                
<p>As with the other pools we have created, the process for creating a floating, <span>Linked Clone</span> desktop pool is pretty much the same as we covered in the previous section, with a few changes to reflect this pool having a floating assignment. As such, in this section, we will just highlight the different configuration options:</p>
<ol>
<li>From a workstation, open a browser and enter the address details of the View Connection server. In the example lab, the address of the connection server is <kbd>https://hzn7-cs1.pvolab.com/admin</kbd>. Don't forget the <kbd>/admin</kbd> at the end; otherwise, you will end up on the Horizon Client page.</li>
<li>You will now see the <span class="packt_screen">View Administrator</span> login screen.</li>
<li>From Horizon View Administrator, click to expand the <span class="packt_screen">Catalog</span> option, and then click on <span class="packt_screen">Desktop Pools</span>. Then from the <span class="packt_screen">Desktop Pools</span> pane that is now displayed, click the <span class="packt_screen">Add...</span> button.</li>
<li>You will now see the <span class="packt_screen">Add Desktop Pool</span> screen, starting with the <span class="packt_screen">Type</span> section where we select which type of desktop pool you want to create. In this example, we are creating an automated pool.</li>
<li>Click the radio button for <span class="packt_screen">Automated Desktop Pool</span>.</li>
<li>Now click the <span class="packt_screen">Next &gt;</span> button to continue.</li>
<li>You will now see the <span class="packt_screen">User Assignment</span> screen.</li>
<li>For this pool, we are going to click the radio button for <span class="packt_screen">Floating</span> (<strong>1</strong>) as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/4b2d198e-e681-4439-8541-37ec2f3ed6c8.png" style=""/></div>
<ol start="9">
<li>Click the <span class="packt_screen">Next &gt;</span> button to continue.</li>
<li>For this pool, we are going to use <span>Linked Clone</span> virtual machines, so click the radio button for <span class="packt_screen">View Composer linked clones</span>, and select the relevant vCenter server from the list. In the example lab, the <kbd>vCenter 192.168.1.178</kbd> is shown, along with the vCenter user account we set up for View. Click to highlight and select this vCenter server.</li>
<li>Click the <span class="packt_screen">Next &gt;</span> button to continue the configuration. The next configuration screen is for the <span class="packt_screen">Desktop Pool Identification</span> as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/5f847aad-54ff-4c88-b173-d597c5fd2956.png" style=""/></div>
<ol start="12">
<li>In the <span class="packt_screen">ID</span> box (<strong>2</strong>), enter a name for this desktop pool. In the example lab, for this pool, we are going to call it <kbd>Win7-Floating-lc</kbd>.</li>
<li>In the <span class="packt_screen">Display name</span> box (<strong>3</strong>), enter a name for this desktop pool that the end users will see. In the example lab, we have called this <kbd>Windows 7 Floating Linked Clone</kbd>.</li>
<li>Finally, in the <span class="packt_screen">Description</span> box (<strong>4</strong>), enter a description to describe the function of this desktop pool.</li>
<li>Click the <span class="packt_screen">Next &gt;</span> button to continue.</li>
<li>You will now see the <span class="packt_screen">Desktop Pool Settings</span> screen.</li>
<li><span>Configure the setting you want to apply to this desktop pool and then click the</span> <span class="packt_screen">Next &gt;</span> <span>button to continue.</span></li>
<li><span>You will now see</span> the <span class="packt_screen">Provisioning Settings</span> <span>screen.</span></li>
</ol>
<ol start="19">
<li>The first setting in the <span class="packt_screen">Basic</span> <span>section is to</span> <span class="packt_screen">Enable provisioning</span><span>. Tick the</span> <span class="packt_screen">Enable provisioning</span> <span>box to switch provisioning on. This setting means that virtual desktop machines can be provisioned as per the configuration settings.</span></li>
<li>The next setting is for <span class="packt_screen">Stop provisioning on error</span>. By checking this box, it means that provisioning will stop if there is an error during the provisioning process.</li>
<li>The next section to configure is for the <span class="packt_screen">Virtual Machine Naming</span><strong>.</strong></li>
<li>Click the radio button for <span class="packt_screen">Use a naming pattern</span> and then in the <span class="packt_screen">Naming Pattern</span> box (<strong>6</strong>), enter the name pattern you want to use. In the example lab, we have called this <kbd>W7-Float-lc-{n}</kbd>. <span>This will result in the virtual desktop machines being named <kbd>W7-Float-lc-1</kbd>, <kbd>W7-Float-lc-2</kbd>, and so on, up to the number of machines you specify that you want to build, as shown in the following screenshot:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/94de6f08-fc72-4602-951a-171f900874bb.png" style=""/></div>
<ol start="23">
<li>Next, in the <span class="packt_screen">Max number of machines</span> box, enter the maximum number of machines that can be provisioned in this desktop pool. This sets the limit of the number of virtual desktop machines in this desktop pool.</li>
<li>Next is the setting for <span class="packt_screen">Number of spare (powered on) machines</span>. In the box, enter the number of machines that should be powered on and waiting for users to connect to them.</li>
<li><span class="packt_screen">Provisioning Timing</span> is the next option to configure. Either click the radio button for <span class="packt_screen">Provision machines on demand</span> and then enter the minimum number of machines, or click the radio button for <span class="packt_screen">Provision all machines up-front</span>.</li>
<li>Click the <span class="packt_screen">Next &gt;</span> button to continue.</li>
<li>You will now see the <span class="packt_screen">View Composer Disks</span> screen and the <span class="packt_screen">Disposable File Redirection</span> configuration setting.</li>
<li>To configure this setting, click the radio button for <span class="packt_screen">Redirect disposable files to a non-persistent disk</span> (<strong>7</strong>), as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/8084883a-228e-42d1-85e5-715791c11455.png" style=""/></div>
<ol start="29">
<li>In the <span class="packt_screen">Disk size</span> box, enter a size for the persistent disk, and in the <span class="packt_screen">Drive letter</span> drop-down box, select a drive letter for this persistent disk.</li>
<li><span>To disable the <span class="packt_screen">Disposable File Redirection</span> feature, then click the radio button for</span> <span class="packt_screen">Do not redirect disposable files</span> <span>(<strong>8</strong>).</span></li>
<li>Click the <span class="packt_screen">Next &gt;</span> button to continue. The next configuration screen is for <span class="packt_screen">Storage Optimization</span><span>.</span></li>
<li>The only option on this screen is to configure the <span class="packt_screen">Storage Policy Management</span>, starting with VMware Virtual SAN. To enable VSAN, then click the radio button for <span class="packt_screen">Use VMware Virtual SAN</span>. As we don't have this configured in the example lab, then we will click the radio button for <span class="packt_screen">Do not use VMware Virtual SAN</span>. You can then choose if you want to use separate datastores for replica and OS disks. To enable this, check the box for <span class="packt_screen">Select separate datastores for replica and OS disks</span><span>.</span></li>
<li>Click the <span class="packt_screen">Next &gt;</span> button to continue to the next configuration screen.</li>
<li>You will now see the <span class="packt_screen">vCenter Settings</span>.</li>
<li>First, select the <span class="packt_screen">Parent VM</span>, in this example our <span class="packt_screen">Windows 7 Gold Image</span>, and then from the <span class="packt_screen">Snapshot</span> box, choose which snapshot of the Windows 7 Gold Image virtual desktop machine you want to use.</li>
<li>In the <span class="packt_screen">Virtual Machine Location</span> section, under <span class="packt_screen">VM Folder Location</span>, select the folder where you want to store these new virtual desktop machines. In the example lab, we are going to use the <kbd>Horizon Desktops</kbd> folder.</li>
<li>Finally, under the <span class="packt_screen">Resource Settings</span> section, select the <span class="packt_screen">Host or cluster</span> to run the virtual desktops machines, the <span class="packt_screen">Resource pool</span>, and then the <span class="packt_screen">Datastore</span>.</li>
</ol>
<ol start="38">
<li>Click the <span class="packt_screen">Next &gt;</span> button to continue to the next configuration screen.</li>
<li>You will now see the <span class="packt_screen">Advanced Storage Options</span> configuration screen. Leave the default settings and click the <span class="packt_screen">Next &gt;</span> button to continue.</li>
<li>You will see the <span class="packt_screen">Guest Customization</span> configuration screen. Leave the default settings and click the <span class="packt_screen">Next &gt;</span> button.</li>
<li>You will now see the <span class="packt_screen">Ready to Complete</span> screen. Review your configuration settings, and then click the <span class="packt_screen">Finish</span> <span>button to create the desktop pool.</span></li>
<li>You will now see that the pool has been created as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/ceb6faf4-b3a7-4ad6-937f-77a71aa30a7d.png"/></div>
<p class="NormalPACKT"><span>In the next section, we are going to create another automated desktop pool, but this time, we will create a pool with a floating assignment, and built using Full Clone virtual desktop machines.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Creating floating, Full Clone desktop pools</h1>
                </header>
            
            <article>
                
<p class="NormalPACKT"><span>As with the previous pools we have created, the process for creating a floating, full-clone desktop pool is pretty much the same as we covered previously, with a few changes to reflect this pool having a floating assignment. As such, in this section, we will just highlight the key differences in the configuration options:</span></p>
<ol>
<li>From a workstation, open a browser and enter the address details of the View Connection server. In the example lab, the address of the connection server is <kbd>https://hzn7-cs1.pvolab.com/admin</kbd>. Don't forget the <kbd>/admin</kbd> at the end; otherwise, you will end up on the Horizon Client page.</li>
<li>You will now see the View Administrator login screen.</li>
</ol>
<ol start="3">
<li>From Horizon View Administrator, click to expand the <span class="packt_screen">Catalog</span> option, and then click on <span class="packt_screen">Desktop Pools</span>. Then from the <span class="packt_screen">Desktop Pools</span> pane that is now displayed, click the <span class="packt_screen">Add...</span> button.</li>
<li>You will now see the <span class="packt_screen">Add Desktop Pool</span> screen, starting with the <span class="packt_screen">Type</span> section where we select which type of desktop pool you want to create. In this example, we are creating an automated pool.</li>
<li>Click the radio button for <span class="packt_screen">Automated Desktop Pool</span>.</li>
<li>Now click the <span class="packt_screen">Next &gt;</span> button to continue.</li>
<li>You will now see the <span class="packt_screen">User Assignment</span> screen.</li>
<li>For this pool, we are going to click the radio button for <span class="packt_screen">Floating</span>.</li>
<li>Click the <span class="packt_screen">Next &gt;</span> button to continue. You will now see the <span class="packt_screen">vCenter Server</span> screen.</li>
<li>For this pool, we are going to use full-clone virtual machines, so click the radio button for <span class="packt_screen">Full virtual machines</span>, and then select the relevant vCenter server from the list. In the example lab, the <kbd>vCenter 192.168.1.178</kbd> is shown, along with the vCenter user account we set up for View. Click to highlight and select this vCenter server.</li>
<li>Click the <span class="packt_screen">Next &gt;</span> button to continue the configuration. The next configuration screen is for the <span class="packt_screen">Desktop Pool Identification</span> as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/239e5bab-beea-4d2c-af3d-2a662e8df98f.png" style=""/></div>
<ol start="12">
<li>In the <span class="packt_screen">ID</span> box (<strong>1</strong>), enter a name for this desktop pool. In the example lab, for this pool, we are going to call it <kbd>Win7-Floating-fc</kbd>.</li>
<li>In the <span class="packt_screen">Display name</span> box (<strong>2</strong>), enter a name for this desktop pool that the end users will see. In the example lab, we have called this <kbd>Windows 7 Floating Full Clones</kbd>.</li>
<li>Finally, in the <span class="packt_screen">Description</span> box (<strong>3</strong>), enter a description to describe the function of this desktop pool.</li>
<li>Click the <span class="packt_screen">Next &gt;</span> button to continue.</li>
</ol>
<ol start="16">
<li>You will now see the <span class="packt_screen">Desktop Pool Settings</span> screen. In the <span class="packt_screen">Remote Settings</span> section, there are a couple of new configurations options as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/dc683b55-4bb0-49fe-8b0a-4b22b12ab3d5.png" style=""/></div>
<ol start="17">
<li>The first three configuration options have been described previously, but we now have the <span class="packt_screen">Allow user to initiate separate sessions from different client devices</span> <span>option</span> (<strong>4</strong>). If this option is set to <span class="packt_screen">Yes</span>, from the drop-down menu, then if a user connects to the same desktop pool but from a different client device, then they will get a different/new desktop session. The user can only reconnect to an existing session by using the same client device from where the session was originally initiated. When this option is set to <span class="packt_screen">No</span>, the user will be reconnected to their existing session regardless of the client device used.</li>
<li>The final configuration setting is to <span class="packt_screen">Delete machine after logoff</span> (<strong>5</strong>). <span>If this option is set to</span> <span class="packt_screen">Yes</span><span>, from the drop-down menu, then when the user logs off, the virtual desktop machine is deleted. When this option is set to</span> <span class="packt_screen">No</span><span>, then the virtual desktop machine is not deleted when they log off. This feature is only supported for desktop pools that use manual naming, as dynamic creation and deletion of virtual desktop machines is not supported.</span></li>
<li>Configure the remaining desktop pool settings so that they are appropriate to your environment; in the example lab, we will leave them as the defaults.</li>
<li>Click the <span class="packt_screen">Next &gt;</span> button to continue.</li>
<li><span>You will now see</span> the <span class="packt_screen">Provisioning Settings</span> <span>screen.</span></li>
<li>The first setting in the <strong><span class="packt_screen">Basic</span></strong> <span>section is to</span> <span class="packt_screen">Enable provisioning</span><span>. Tick the</span> <span class="packt_screen">Enable provisioning</span> <span>box to switch provisioning on.</span></li>
</ol>
<ol start="23">
<li>Next, check the box for <span class="packt_screen">Stop provisioning on error</span>.</li>
<li>The next section to configure is <span class="packt_screen">Virtual Machine Naming</span><strong>.</strong></li>
<li>Click the radio button for <span class="packt_screen">Use a naming pattern</span> and then in the <span class="packt_screen">Naming Pattern</span> box (<strong>6</strong>), enter the name pattern you want to use. In the example lab, we have called this <kbd>W7-Float-fc-{n}</kbd>. <span>This will result in the virtual desktop machines being named <kbd>W7-Float-fc-1</kbd>, <kbd>W7-Float-fc-2</kbd>, and so on, up to the number of machines you specify that you want to build, as shown in the following screenshot:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/74c909f0-3860-4c4f-9be8-2b408e4531a7.png" style=""/></div>
<ol start="26">
<li>Complete the remaining s<span>ettings so that they are appropriate to your environment, or in the example lab, we will leave them as the defaults.</span></li>
<li>Click the <span class="packt_screen">Next &gt;</span> button to continue.</li>
<li>You will now see the <span class="packt_screen">Storage Optimization</span> configuration screen. Leave the default settings and click <span class="packt_screen">Next &gt;</span><strong>.</strong></li>
<li>You will now see the <span class="packt_screen">vCenter Settings</span>.</li>
<li>First, from the <span class="packt_screen">Virtual Machine Template</span> section, select the template you want to use. In this example, we are going to use the Windows 7 Gold Image template.</li>
<li>In the <span class="packt_screen">Virtual Machine Location</span> section, under <span class="packt_screen">VM Folder Location</span>, select the folder where you want to store these new virtual desktop machines. In the example lab, we are going to use the <kbd>Horizon Desktops</kbd> folder.</li>
<li>Finally, under the <span class="packt_screen">Resource Settings</span> section, select the <span class="packt_screen">Host or cluster</span> to run the virtual desktops machines, the <span class="packt_screen">Resource pool</span>, and then the <span class="packt_screen">Datastore</span>.</li>
<li>Click the <span class="packt_screen">Next &gt;</span> button to continue to the next configuration screen. You will now see the <span class="packt_screen">Advanced Storage Options</span> configuration screen. Leave the default settings and then click the <span class="packt_screen">Next &gt;</span> button to continue.</li>
<li>You will now see the <span class="packt_screen">Guest Customization</span> configuration screen. Leave the default settings and click the <span class="packt_screen">Next &gt;</span> button.</li>
<li>Finally, you will now see the <span class="packt_screen">Ready to Complete</span> screen. Review your configuration settings, and then click the <span class="packt_screen">Finish</span> <span>button to create the desktop pool.</span></li>
</ol>
<ol start="36">
<li>You will now see that the pool has been created as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/bbd2ec35-9286-417c-8d65-c9164820793a.png"/></div>
<p class="NormalPACKT"><span>In the final section of <em>Creating Automated Desktop Pools</em>, we are going to create another automated desktop pool, but, this time, we will create a pool with a floating assignment, now built using Instant Clone virtual desktop machines.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Creating floating, Instant Clone desktop pools</h1>
                </header>
            
            <article>
                
<p>In this section, we are going to create an automated desktop pool that has a floating assignment and is built using <span>Instant Clone</span>s. There are two steps to this configuration. First, we need to configure a domain administrator before we then configure the actual pool itself.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Configuring the Instant Clone domain administrator</h1>
                </header>
            
            <article>
                
<p>Before you can configure a desktop pool using <span>Instant Clone</span>s, you first have to add an <span>Instant Clone</span> domain administrator. This account is used to perform the Active Directory tasks required to create new virtual desktop machines. It's similar to the service account used in View Composer, but as <span>Instant Clone</span>s don't use Composer, you need to add the account within the View Administrator. The account needs the following permissions:</p>
<ul>
<li><span class="packt_screen">Create Computer Objects</span></li>
<li><span class="packt_screen">Delete Computer Objects</span></li>
<li><span class="packt_screen">Write All Properties</span></li>
</ul>
<p>To configure the Instant Clone domain admin, complete the following tasks:</p>
<ol>
<li>From a workstation, open a browser and enter the address details of the View Connection server. In the example lab, the address of the connection server is <kbd>https://hzn7-cs1.pvolab.com/admin</kbd>. Don't forget the <kbd>/admin</kbd> at the end; otherwise, you will end up on the Horizon Client page.</li>
<li>You will now see the <span class="packt_screen">View Administrator</span> login screen.</li>
<li>To add the account, from the <span class="packt_screen">View Administrator</span> dashboard, expand the option for <span class="packt_screen">View Configuration</span> from the <span class="packt_screen">Inventory</span> menu in the left-hand pane, and then click on the option for <span class="packt_screen">Instant Clone Domain Admins</span> (<strong>1</strong>).</li>
<li>Then click on the <span class="packt_screen">Add…</span> button (<strong>2</strong>), as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/3fef61ca-3e19-4f85-8ab0-6ce925484491.png" style=""/></div>
<ol start="5">
<li>You will then see the <span class="packt_screen">Add Domain Admin</span> box.</li>
<li>In the <span class="packt_screen">Full domain</span> name section, click the drop-down arrow (<strong>3</strong>) and select the domain. In the example lab, this is our <kbd>pvolab.com</kbd> domain.</li>
<li>In the <span class="packt_screen">User name</span> box (<strong>4</strong>), enter a username that has the permissions as outlined at the beginning of this section.</li>
<li>Finally, in the <span class="packt_screen">Password</span> box (<strong>5</strong>), enter the password for the username account you just entered.</li>
<li>Click <span class="packt_screen">OK</span> when you have completed the details.</li>
</ol>
<ol start="10">
<li>You will now see that the domain administrator account has now been added as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/e4b0e41a-fa8e-48ab-b05d-b0f921261c7c.png"/></div>
<p>You have now successfully configured the domain admin account for <span>Instant Clone</span>s. We can now continue with the process of creating an <span>Instant Clone</span> desktop pool.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Creating the Instant Clone desktop pool</h1>
                </header>
            
            <article>
                
<p>As with the other pools we have created, the process for creating a floating, <span>Instant Clone</span> desktop pool is pretty much the same as we covered in the previous section, with a few changes to reflect this pool being built using <span>Instant Clone</span>s. As such, in this section, we will just highlight the main differences in the configuration options:</p>
<ol>
<li>From a workstation, open a browser and enter the address details of the View Connection server. In the example lab, the address of the connection server is <kbd>https://hzn7-cs1.pvolab.com/admin</kbd>. Don't forget the <kbd>/admin</kbd> at the end; otherwise, you will end up on the <span class="packt_screen">Horizon Client</span> page.</li>
<li>You will now see the <span class="packt_screen">View Administrator</span> login screen.</li>
<li>From the Horizon View administrator, click to expand the <span class="packt_screen">Catalog</span> option, and then click on <span class="packt_screen">Desktop Pools</span>. Then, from the <span class="packt_screen">Desktop Pools</span> pane that is now displayed, click the <span class="packt_screen">Add...</span> button.</li>
<li>You will now see the <span class="packt_screen">Add Desktop Pool</span> screen, starting with the <span class="packt_screen">Type</span> section where we select which type of desktop pool you want to create. In this example, we are creating an automated pool.</li>
<li>Click the radio button for <span class="packt_screen">Automated Desktop Pool</span>.</li>
<li>Now click the <span class="packt_screen">Next &gt;</span> button to continue.</li>
<li>You will now see the <span class="packt_screen">User Assignment</span> screen.</li>
<li>For this pool, we are going to click the radio button for <span class="packt_screen">Floating</span>.</li>
<li>Click the <span class="packt_screen">Next &gt;</span> button to continue. You will now see the <span class="packt_screen">vCenter Server</span> screen where you will configure how the virtual desktops machine will be built, In this example, click the radio button for <span class="packt_screen">Instant Clones</span> (<strong>1</strong>) as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/00335435-3c99-4dae-8d9a-91eb8a620c98.png" style=""/></div>
<ol start="10">
<li>Click and select the vCenter Server (<strong>2</strong>), and then click the <span class="packt_screen">Next &gt;</span> button to continue.</li>
<li>The next configuration screen is for the <span class="packt_screen">Desktop Pool Identification</span> as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/9031fb62-8e0d-4fea-9883-59968e9e4a18.png" style=""/></div>
<ol start="12">
<li>In the <span class="packt_screen">ID</span> <span>box (<strong>3</strong>), enter a name for this desktop pool. In the example lab, for this pool, we are going to call it</span> <kbd>Win10-Floating-ic</kbd><span>.</span></li>
<li>In the <span class="packt_screen">Display name</span> box (<strong>4</strong>), enter a name for this desktop pool that the end users will see. In the example lab, we have called this <kbd>Windows 10 Instant Clone</kbd>.</li>
<li>Finally, in the <span class="packt_screen">Description</span> box (<strong>5</strong>), enter a description to describe the function of this desktop pool.</li>
<li>Click the <span class="packt_screen">Next &gt;</span> button to continue.</li>
<li>You will now see the <span class="packt_screen">Desktop Pool Settings</span> screen. Complete the configuration details as per your required settings and then click the <span class="packt_screen">Next &gt;</span> button to continue.</li>
<li>The next section to configure is for <span class="packt_screen">Virtual Machine Naming</span><strong>.</strong></li>
<li>Click the radio button for <span class="packt_screen">Provisioning Settings</span>. Ensure that you check the box for <span class="packt_screen">Enable provisioning</span> and the box for <span class="packt_screen">Stop provisioning on error</span>.</li>
</ol>
<ol start="19">
<li><span>In the</span> <span class="packt_screen">Naming Pattern</span> <span>box (<strong>6</strong></span>), enter the name pattern you want to use. In the example lab, we have called this <kbd>W10-Float-ic-{n}</kbd>. This will result in the virtual desktop machines being named <kbd>W10-Float-ic-1</kbd>, <kbd>W10-Float-ic-2</kbd>, and so on, up to the number of machines you specify that you want to build, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/0f2a9d75-ae8e-40a4-aea8-634f5de4544e.png" style=""/></div>
<ol start="20">
<li>Complete the remaining s<span>ettings so that they are appropriate to your environment, or in the example lab, we will leave them as the defaults.</span></li>
<li>Click the <span class="packt_screen">Next &gt;</span> button to continue.</li>
<li>You will now see the <span class="packt_screen">Storage Optimization</span> configuration screen. Leave the default settings and click the <span class="packt_screen">Next &gt;</span> button to continue. You will now see the <span class="packt_screen">vCenter Settings</span><span>.</span></li>
<li>The next configuration screen is the <span class="ScreenTextPACKT"><span class="packt_screen">vCenter Settings</span></span> <span>configuration screen. On this screen, we are going to select the parent VM from which to build the virtual desktop machines, and then the location and resources that are going to run them</span> <span>as shown in the following screenshot:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/cc710c39-8c6e-4422-918f-35ceacf81919.png" style=""/></div>
<ol start="24">
<li>The first thing to configure is the details of the <span class="packt_screen">Default Image</span> to be used as the parent image from which to create the virtual desktop machines for this desktop pool. This section is shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/83b5efb0-6ec3-4a32-b184-1cee41b8f7a3.png" style=""/></div>
<ol start="25">
<li>On the first box, <span class="packt_screen">Parent VM in vCenter</span>, click the <span class="packt_screen">Browse...</span> button (<strong>7</strong>). You will now see the <span class="packt_screen">Select Parent VM</span> box as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/485b1fa0-6c57-4698-b80e-f96ec7026c18.png" style=""/></div>
<ol start="26">
<li>For this desktop pool, we are going to use Windows 10 as the virtual desktop machine operating system, so select the entry for <span class="packt_screen">Windows 10 Gold Image</span> <span>(<strong>8</strong>).</span></li>
<li>Once you have selected the parent VM you want to use, click <span class="packt_screen">OK</span> to continue.</li>
</ol>
<ol start="28">
<li>You will now return to the <span class="packt_screen">vCenter Settings</span> screen, where we can now configure the second of the options on the <span class="packt_screen">Default Image</span> section for <span class="packt_screen">Snapshot</span>. You will also see that the <span class="packt_screen">Parent VM</span> box (<strong>9</strong>) has now been populated with the details of the Windows 10 Gold Image as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/d0a7ec30-f5ad-4d78-afeb-34daf3a99bc8.png" style=""/></div>
<ol start="29">
<li>As this is an <span>Instant Clone</span> virtual desktop machine, the next configuration task is to configure the details of the snapshot that was created from the parent image.</li>
<li>On the <span class="packt_screen">Snapshot</span> box, click the <span class="packt_screen">Browse...</span> button (<strong>10</strong>). You will now see the <span class="packt_screen">Select default image</span> box as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/ac6f04fc-9206-489b-8eca-3a6b2e1ec829.png" style=""/></div>
<p class="mce-root"/>
<ol start="31">
<li>Click to highlight the snapshot you want to use (<strong>11</strong>) and then Click <span class="packt_screen">OK</span>. You will now see that the snapshot has been added as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/26e6de70-bd12-458c-95a0-3f2bb7d83c52.png" style=""/></div>
<p style="padding-left: 60px">The next part of the vCenter Settings is the <span class="packt_screen">Virtual Machine Location</span> setting as shown in the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/a952f8a9-070e-4721-86c9-4390d8e17663.png" style=""/></div>
<ol start="32">
<li>On the <span class="packt_screen">VM folder location</span> box, click the <span class="packt_screen">Browse...</span> button (<strong>12</strong>).</li>
<li>You will now see the <span class="packt_screen">Select the folder to store the VM</span> box. Expand <span class="packt_screen">PVO's Datacenter</span> by clicking the arrow and then select the folder in which you want to create the virtual desktop machines into. In the example lab, this folder has been called <kbd>Horizon Desktops</kbd>.</li>
<li>Click <span class="packt_screen">OK</span> to continue.</li>
<li>You will return to the <span class="packt_screen">vCenter Settings</span> screen where you will see that the <span class="packt_screen">VM Folder Location</span> has now been added as you can see in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/656437a8-3530-4225-a492-e9982a5b307c.png" style=""/></div>
<p>The next configuration section is for the resources that are going to host and run the virtual desktop machines in the pool:</p>
<ol start="1">
<li>First, in the <span class="packt_screen">Cluster</span> box, click the <span class="packt_screen">Browse...</span> button (<strong>13</strong>), as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/0f344fe0-1f7d-4809-9ed2-8b494b0c502a.png" style=""/></div>
<ol start="2">
<li>You will now see the <span class="packt_screen">Cluster</span> box appear, listing the available cluster resources as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/637c675e-de3c-4ac4-a43d-1a62f4816496.png" style=""/></div>
<ol start="3">
<li>Click and highlight on the cluster you want to run this <span>Instant Clone</span> desktop pool on. In the example lab, the cluster is called <span class="packt_screen">PVO Desktop Cluster</span> (<strong>14</strong>).</li>
</ol>
<div class="mce-root packt_infobox">When it comes to configuring the Resource Settings section of this configuration, it's worth noting that you need to have a host cluster and resource pool configured. You cannot use standalone hosts for <span>Instant Clone</span> desktop pools.</div>
<ol start="4">
<li>Click <span class="packt_screen">OK</span> to continue.</li>
</ol>
<ol start="5">
<li>You will now return to the <span class="packt_screen">vCenter Settings</span> <span>screen where you will see that the</span> <span class="packt_screen">Cluster</span> <span>has now been added.</span></li>
<li>Next, we are going to configure the resource pool for this desktop pool to use.</li>
<li>In the <span class="packt_screen">Resource <span>pool</span></span> <span>box, click the <span class="packt_screen">Browse...</span> button. You will now see the <span class="packt_screen">Select a resource pool to use for this desktop pool</span> box from where you can select the resource pool to run the desktop pool.</span> The resource pool for the example lab is the cluster again, so click and highlight <span class="packt_screen">PVO Desktop Cluster</span> from the list.</li>
<li>Click <span class="packt_screen">OK</span> to continue.</li>
<li>You will now return to the <span class="packt_screen">vCenter Settings</span> <span>screen where you will see that the</span> <span class="packt_screen">Resource pool</span> <span>has now been added.</span></li>
<li>The next configuration option in this section is for <span class="packt_screen">Datastores</span>. In the <span class="packt_screen">Datastores</span> box, click the <span class="packt_screen">Browse...</span> button.</li>
<li>You will now see the <span class="ScreenTextPACKT"><span class="packt_screen">Select Instant Clone Datastores</span></span> <span>configuration screen, which shows all available datastores.</span></li>
<li>Check the box for <span class="packt_screen">VM Datastore</span> and click the <span class="packt_screen">OK</span> button. You will return to the <span class="packt_screen">vCenter Settings</span> configuration screen, where you will see that the details of the <span>Instant Clone</span> datastores have now been entered by displaying the text <span class="packt_screen">1 selected</span><strong>.</strong></li>
<li>Finally, on the <span>Instant Clone</span> configuration of the <span class="packt_screen">vCenter Settings</span> screen, you can configure <span class="packt_screen">Networks</span> as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/2de8a7e7-a644-441c-b6e6-105be4ae013e.png" style=""/></div>
<ol start="14">
<li>In the <span class="packt_screen">Networks</span> box, click the <span class="packt_screen">Browse ...</span> button (<strong>15</strong>). You will then see the <span class="packt_screen">Select Networks</span> box. Here, you can use the network that is currently configured within the virtual desktop machine image, or you can select another network from the list. Click <span class="packt_screen">OK</span> to continue and to return to the <span class="packt_screen">vCenter Settings</span> <span>screen.</span></li>
<li>Now click the <span class="packt_screen">Next &gt;</span> button to continue to the next configuration screen.</li>
<li>You will now see the <span class="packt_screen">Guest Customization</span> configuration screen. Leave the default settings and click the <span class="packt_screen">Next &gt;</span> button to continue.</li>
<li>Finally, you will now see the <span class="packt_screen">Ready to Complete</span> screen. Review your configuration settings, and then click the <span class="ScreenTextPACKT"><span class="packt_screen">Finish</span></span> <span>button to create the desktop pool.</span></li>
<li>You will now see that the pool has been created as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/8f5f8604-1367-435f-b423-81db445ac84c.png"/></div>
<p>You can also see from within the folder view of the vCenter Server, that the <span>Instant Clone</span> folder structure has been created, as shown in the following screenshot, by the folder names starting with <span class="packt_screen">ClonePrep</span>:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/27d386f6-7715-42f1-8e4b-a856bb0cd4fe.png" style=""/></div>
<p><span>You have now successfully configured a desktop pool for Instant Clone virtual desktop machines, running Windows 10. In the next section, we are going to work through the steps to create a manual desktop pool.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Creating a manual desktop pool</h1>
                </header>
            
            <article>
                
<p>In the previous sections, we have talked about creating automated desktop pools. Horizon View also has the ability to create desktop pools from already existing virtual desktop machines, or even physical desktop machines.</p>
<p>The process for creating manual desktop pools is not too dissimilar to the process we covered previously for automated desktop pools, so, in the following section, we will create a manual pool and highlight where the process differs:</p>
<ol>
<li>From a workstation, open a browser and enter the address details of the View Connection server. In the example lab, the address of the connection server is <kbd>https://hzn7-cs1.pvolab.com/admin</kbd>. Don't forget the <kbd>/admin</kbd> at the end; otherwise, you will end up on the <span class="packt_screen">Horizon Client</span> page.</li>
<li>You will now see the View Administrator login screen. Log in using the administrator account.</li>
<li>Once logged in, from the Horizon View administrator, click to expand the <span class="packt_screen">Catalog</span> option, and then click on <span class="packt_screen">Desktop Pools</span>. Then, from the <span class="packt_screen">Desktop Pools</span> pane that is now displayed, click the <span class="packt_screen">Add...</span> button.</li>
<li>You will now see the <span class="packt_screen">Add Desktop Pool</span> screen, starting with the <span class="packt_screen">Type</span> section where we select which type of desktop pool you want to create. In this example, we are creating a manual pool.</li>
<li>Click the radio button for <span class="packt_screen">Manual Desktop Pool</span> (<strong>1</strong>) as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/7a5b1059-d8b7-415c-b01c-18625b81567c.png" style=""/></div>
<ol start="6">
<li>Now click the <span class="packt_screen">Next &gt;</span> button to continue.</li>
<li>You will now see the <span class="packt_screen">User Assignment</span> screen. Select whether or not you want a dedicated assignment with an automatic assignment or a floating assignment. In the example lab, we are going to click the radio button to select the option for <span class="packt_screen">Dedicated</span>, and also check the box for <span class="packt_screen">Enable automatic assignment</span>.</li>
<li>Click the <span class="packt_screen">Next &gt;</span> button to continue.</li>
<li>Next, you will see the <span class="packt_screen">Machine Source</span> screen as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/e1d936b4-a9af-47a3-bb21-6e7963fca109.png" style=""/></div>
<ol start="10">
<li>On this configuration screen, there are two options. The first is the option to select virtual desktop machines that are managed by vCenter but are not built using some form of cloning technology. As the virtual desktop machine we are going to use resides on the vCenter server, then in the example lab, click the radio button for <span class="packt_screen">vCenter virtual machines</span> (<strong>2</strong>).</li>
<li>The second option is for <span class="packt_screen">Other sources</span> (<strong>3</strong>). This option is for non-vCenter-managed desktops that you want users to connect to using Horizon View. An example of this may be something such as a blade- or rack-mounted workstation machine that resides in the datacenter and that you want users to connect to remotely using a protocol capable of the high-performance graphics. All you need do is ensure that the Horizon Agent is installed on these machines.</li>
</ol>
<ol start="12">
<li>Click the <span class="packt_screen">Next &gt;</span> button to continue.</li>
<li>You will now see the <span class="packt_screen">vCenter Server</span> configuration screen. Select the example lab vCenter server by clicking on it and then click the <span class="packt_screen">Next &gt;</span> button to continue.</li>
<li>Next, you will see the <span class="packt_screen">Desktop Pool ID</span> screen as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/960bb58a-f48a-4635-8732-ace34de09d2c.png" style=""/></div>
<ol start="15">
<li>In the <span class="packt_screen">ID</span> <span>box (<strong>4</strong>), enter a name for this desktop pool. In the example lab, for this pool, we are going to call it</span> <kbd>Win7-Manual</kbd><span>.</span></li>
<li>In the <span class="packt_screen">Display name</span> box (<strong>5</strong>), enter a name for this desktop pool that the end users will see. In the example lab, we have called this <kbd>Windows 7 Manual Desktop</kbd><strong>.</strong></li>
<li>Finally, in the <span class="packt_screen">Description</span> box (<strong>6</strong>), enter a description to describe the function of this desktop pool.</li>
<li>Click the <span class="packt_screen">Next &gt;</span> button to continue.</li>
<li>You will now see the <span class="packt_screen">Desktop Pool Settings</span> screen. Complete the configuration details as per your required settings and then click the <span class="packt_screen">Next &gt;</span> button to continue.</li>
</ol>
<ol start="20">
<li>The next section to configure is for the <span class="packt_screen">Virtual Machine</span>, where we add the virtual desktop machines that we want to include as part of this desktop pool, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/af817e7e-9d6b-454f-9cca-7afcd425b2e1.png" style=""/></div>
<ol start="21">
<li>In the first table, you will see a list of the available virtual machines. This table does not include any virtual desktop machines that are already part of another desktop pool.</li>
<li>Click and highlight the virtual desktop machine you want to include in the desktop pool. In the example lab<span>, this virtual desktop machine is called <kbd>Windows 7 Manual Desktop</kbd> (<strong>7</strong>).</span></li>
<li>Now click the <span class="packt_screen">Add</span> button (<strong>8</strong>).</li>
<li>You will now see the virtual desktop machine has been added to the table at the bottom, meaning that it has been selected and added to the desktop pool (9). If you wanted to remove it, then simply click and highlight the machine in the lower table and click the <span class="packt_screen">Remove</span> button.</li>
<li><span>Click the</span> <span class="packt_screen">Next &gt;</span> <span>button to continue.</span></li>
</ol>
<ol start="26">
<li>You will now see the <span class="packt_screen">Advanced Storage Options</span> configuration screen. Leave the default settings and then click the <span class="packt_screen">Next &gt;</span> button to continue.</li>
<li>Finally, you will now see the <span class="packt_screen">Ready to Complete</span> screen. Review your configuration settings, and then click the <span class="ScreenTextPACKT"><span class="packt_screen">Finish</span></span> <span>button to create the desktop pool.</span></li>
<li>You will now see that the pool has been created as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/f11a9b9e-0be1-4778-82da-8c0614930666.png"/></div>
<p><span>You have now successfully configured a manual desktop pool using an existing, pre-built virtual desktop machine running Windows 7.</span></p>
<p><span>Now that we have a number of desktop pool configured, and virtual desktop machines created, in the next section, we are going to work through the steps to entitle end users to desktop pool.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Adding end user entitlements</h1>
                </header>
            
            <article>
                
<p>Now that you have created a number of desktop pools that contain virtual desktop machines, the next step is to allow the users to have access to the pools and virtual desktop machines.</p>
<p>We are going to look at how to entitle end users, first using Horizon View Administrator, and then using the new Horizon Console web-based client.</p>
<p class="mce-root"/>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Adding user entitlement using the Horizon View Administrator Classic console</h1>
                </header>
            
            <article>
                
<p>To entitle end users to desktop pools using Horizon View Administrator, we are going to follow the steps described:</p>
<ol>
<li>From a workstation, open a browser and enter the address details of the View Connection server. In the example lab, the address of the connection server is <kbd>https://hzn7-cs1.pvolab.com/admin</kbd>. Don't forget the <kbd>/admin</kbd> at the end; otherwise, you will end up on the Horizon Client page.</li>
<li>You will now see the <span class="packt_screen">View Administrator</span> login screen. Log in using the administrator account.</li>
<li>Once logged in, from Horizon View Administrator, <span>click on <span class="packt_screen">Users and Groups</span> (<strong>1</strong>) from the <span class="packt_screen">Inventory</span> pane on the left-hand side as shown in the following screenshot:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/899712ec-e317-4c42-8155-0e0445f61618.png" style=""/></div>
<ol start="4">
<li>Now click the <span class="packt_screen">Entitlements...</span> button (<strong>2</strong>). From the drop-down menu options, click on <span class="packt_screen">Add Desktop Entitlement</span> (<strong>3</strong>). You will now see the <span class="packt_screen">Add Desktop Entitlement</span> as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/24af6f45-fdd1-46d6-a86d-6a6e6e9f3344.png" style=""/></div>
<ol start="5">
<li>On this screen, we can search for, and add users from Active Directory. The first option is for <span class="packt_screen">Type</span>. You have the option of searching for <span class="packt_screen">User</span>, <span class="packt_screen">Groups</span>, or <span class="packt_screen">Unauthenticated users</span>. Check the relevant box for the type of search.</li>
<li>Next, you can select the domain in which you want to search. In the <span class="packt_screen">Domain</span> box, click the down-arrow (<strong>4</strong>) and select the relevant domain from those that are listed. In the example lab, we are going to choose <kbd>pvolab.com</kbd> from the list.</li>
<li>You can then choose to search for either a name or username or by description. You also have the option of the criteria on which to filter using <strong>Contains</strong>, <strong>Starts with</strong>, or <strong>Is exactly</strong>. In the example lab, we are going to search for a specific user so in the <strong><span class="packt_screen">Name/User name</span></strong> box, select <strong><span class="packt_screen">Contains</span></strong> from the drop-down, and then type in the username <kbd>peter</kbd> and then click the <span class="packt_screen">Find</span> button.</li>
<li>The results are shown in the table below. In the example lab, you will see the details for the user entered (<strong>7</strong>).</li>
</ol>
<ol start="9">
<li>Once you have completed adding user and group entitlements, you want to add the desktop pool then click the <span class="packt_screen">Next &gt;</span> button. You will now see the <span class="packt_screen">Select the desktop pools to entitle</span> screen as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/475fe15b-2bfe-4ed1-a022-692e110d5ca2.png" style=""/></div>
<ol start="10">
<li>In the example lab, click and highlight the entry in the table for <span class="packt_screen">Win7-Manual</span> (<strong>8</strong>). If you want to entitle this user to more than one desktop pool, you can press and hold the <em>Ctrl</em> key while clicking on the pool you want to entitle them to.</li>
<li>Once you have finished adding users and desktop pools, click the <span class="packt_screen">Finish</span> button.</li>
<li>You will now return to the <span class="packt_screen">Users and Groups</span> screen, which now shows the entitled user(s) as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/b5efe0c0-02b1-4d60-b843-7a8c0f35f9b5.png"/></div>
<p class="mce-root"/>
<p class="mce-root"/>
<p style="padding-left: 60px">An alternative way of entitling users to a desktop pool is to do it from the <span class="packt_screen">Desktop Pools</span> screen as shown in the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/3fdb8296-2608-45d9-8b43-0caeb292ab14.png"/></div>
<ol start="13">
<li>Highlight the desktop pool you want to entitle users to. In the example lab, we will use the Windows 7 manual pool again, so click and select <span class="packt_screen">Win7-Manual</span> (<strong>9</strong>) from those listed in the table.</li>
<li>Then click the <span class="packt_screen">Entitlements...</span> <span>button (<strong>10</strong>), and then from the menu options, select</span> <span class="packt_screen">Add entitlement...</span> <span>(<strong>11</strong>). You will now see the <span class="packt_screen">Add Entitlements</span> box as shown in the following screenshot:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/7951ef1b-ad37-4c51-802b-8e9049168afd.png" style=""/></div>
<ol start="15">
<li>Now click the <span class="packt_screen">Add...</span> button (<strong>12</strong>).</li>
<li>You will now see the <span class="packt_screen">Find User or Group</span> box, the same box as the <span class="packt_screen">Add Desktop Entitlement</span> <span>in point <strong>4</strong>. Enter the users and/or groups you want to entitle to the desktop pool and then Click <span class="packt_screen">OK</span>. Then, on the <span class="packt_screen">Add Entitlements</span> box, click <span class="packt_screen">OK</span> again to complete entitling users to the desktop pool.</span></li>
</ol>
<p class="mce-root"/>
<p>There is one other final way to demonstrate entitling users to desktop pools, which we have seen already when we created the desktop pools. This is the option on the <span class="packt_screen">Ready to Complete</span> screen as shown in the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/a73d39ea-f349-4603-b027-b17740679da9.png" style=""/></div>
<p>Click the <span class="packt_screen">Entitle users after this wizard finishes</span> box (<strong>12</strong>), and once you complete the desktop pool configuration, the <span class="packt_screen">Add Desktop Entitlement</span> <span>will automatically be displayed.</span></p>
<p>You have now successfully entitled users to a desktop pool. If you were now to log in to Horizon View as a user that is entitled to a desktop pool, you would now see that the pool is available to select and connect to from Horizon Client. We will look at connecting to the virtual desktop machines in more detail in <a href="e1944fcc-6ae9-4db7-b51b-db75e37e01ab.xhtml" target="_blank">Chapter 12</a>, <em>Horizon Client Options</em>.</p>
<p>In the next section, we are going to look at how to entitle users from the new Horizon console.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Adding user entitlement using the new Horizon console</h1>
                </header>
            
            <article>
                
<p>In this section, we are going to repeat the previous task, but this time using the Horizon Console to configure the user entitlements, following the steps described:</p>
<ol>
<li>From a workstation, open a browser and enter the address details of the View Connection server. In the example lab, the address of the connection server is <kbd>https://hzn7-cs1.pvolab.com/admin</kbd>.</li>
</ol>
<ol start="2">
<li>You will now see the View Administrator login screen. Log in using the administrator account.</li>
<li>Once logged in, from Horizon View Administrator, <span>click on the option for Horizon Console as shown in the following screenshot:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/f3e454fb-8cca-4f23-8d2f-580820e00a08.png"/></div>
<ol start="4">
<li>Alternatively, you can navigate your browser directly to the Horizon console using the connection server URL <kbd>https://hzn7-cs1.pvolab.com/newadmin</kbd>. Then log in using <span>the administrator account.</span></li>
<li>You will now see the Horizon console screen.</li>
<li>From the menu options on the left-hand side of the screen, click on <span class="packt_screen">Users and Groups</span> (<strong>2</strong>) as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/211ee7ed-a373-4fc4-a8dc-a8817c0af1be.png" style=""/></div>
<ol start="7">
<li>The <span class="packt_screen">Users and Groups</span> screen is now displayed. Click on the <span class="packt_screen">Entitlements</span> button (<strong>3</strong>), and then from the drop-down menu options, select <span class="packt_screen">Add Desktop Entitlement</span> (<strong>4</strong>).</li>
</ol>
<ol start="8">
<li>You will now see the <span class="packt_screen">Add Desktop Entitlement</span> screen and the first of the configuration options for <span class="packt_screen">User</span> as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/2c2d47ae-f60b-4199-b007-55acab447f31.png" style=""/></div>
<ol start="9">
<li>First of all, select whether or not you want to entitle individual <span class="packt_screen">Users</span> or <span class="packt_screen">Groups</span> (from AD) by checking the relevant box (<strong>5</strong>).</li>
<li>Next, in the <span class="packt_screen">Domain</span> box, click the drop-down arrow (<strong>6</strong>) and select the domain where the user or group resides. In the example lab, this is the <kbd>pvolab.com</kbd> domain.</li>
<li>You then have the option to search for the user or group, either by name or by description. In this example, we are going to search for a username, so in the <span class="packt_screen">Name/User name</span> box, we are going to type the first part of the username, which is <kbd>peter</kbd>. We are also going to select the filter option for <span class="packt_screen">Contains</span>.</li>
</ol>
<ol start="12">
<li>Now click the <span class="packt_screen">Find</span> button (<strong>8</strong>).</li>
<li>The results of the search are then displayed. You will see that our user has been found so check the box (<strong>9</strong>) to select the user and then click <span class="packt_screen">Next</span> to continue.</li>
<li>You will now see the <span class="packt_screen">Desktop Pools</span> configuration option where we select which desktop pool the user will have access to as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/2763dbf0-65bf-4756-9b7e-3edb1f8162c9.png" style=""/></div>
<ol start="15">
<li>Check the box for the desktop pool you want to entitle this user to. In the example lab, this is the Windows 7 manual desktop pool, so check the box for <span class="packt_screen">Win7-Manual</span> (<strong>10</strong>).</li>
<li>Click the <span class="packt_screen">Submit</span> button to complete the entitlement configuration.</li>
</ol>
<ol start="17">
<li>You will now return to the <span class="packt_screen">Users and Groups</span> screen where you will see that the user has been entitled to the desktop pool. You will see in the <span class="packt_screen">Desktop Entitlements</span> column of the table that this particular user is actually entitled to two desktop pools as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/77f1864a-8a16-4a85-b887-52d57b0b1602.png" style=""/></div>
<p>You have now successfully entitled a user to a desktop pool using the Horizon console.</p>
<p>In the next section of this chapter, we are going to take a closer look at some of the management tasks required in managing Linked Clone desktop pools.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Managing Linked Clone desktop pools</h1>
                </header>
            
            <article>
                
<p>With a Linked Clone desktop pool, once you create and entitle your desktop pool, your desktops will be created, first by creating the replica and then by creating the Linked Clones virtual desktop machines. There are a number of management tasks that you will need to perform, which we will cover in this section. Before performing any of these, it's always worth checking the status of the desktop pool first:</p>
<ol>
<li>To do this, from the Horizon View Administrator dashboard screen, under the <span class="packt_screen">Inventory</span> section in the left-hand pane, expand the <span class="packt_screen">Catalog</span> section and then click on <span class="packt_screen">Desktop Pools</span> (<strong>1</strong>). You will now see the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/63ff8aca-0118-449c-988b-3bdf5494d5bf.png"/></div>
<ol start="2">
<li>From the list of desktop pools displayed, you can now select one by clicking on it. In the example lab, we are going to select the Linked Clone desktop pool, so click on the entry for <kbd>Win7-Floating-lc</kbd> (<strong>2</strong>). You will now see the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/d37f1bb1-89c9-4315-bacf-65f3d45bf194.png" style=""/></div>
<ol start="3">
<li>From the tabs across the top, click the <span class="packt_screen">Inventory</span> tab (<strong>3</strong>). You can then check the <span class="packt_screen">Status</span> of the desktop pool (<strong>4</strong>).</li>
</ol>
<p>In total, there are 24 different statuses that get reported on for the <span>Linked Clone</span> virtual desktop machines. You can see a breakdown of all the statuses taken from the Horizon View documentation:</p>
<ul>
<li><strong>Provisioning</strong>: The virtual machine is being provisioned.</li>
<li><strong>Customizing</strong>: The virtual machine in an automated pool is being customized as per the configuration.</li>
<li><strong>Deleting</strong>: The virtual machine is marked for deletion, but is not yet deleted. Once the process has completed, then it will be deleted.</li>
<li><strong>Waiting for Agent</strong>: The View Connection server is waiting to establish communication with the Horizon Agent running on a virtual desktop machine in a manual pool.</li>
<li><strong>Maintenance mode</strong>: The virtual machine is in maintenance mode. This means it is unavailable and therefore end users cannot log in or use the virtual desktop machine.</li>
<li><strong>Startup</strong>: The Horizon agent has started on the virtual desktop machine, but other required services such as the display protocol are still in the process of starting up.</li>
<li><strong>Agent disabled</strong>: This state can occur in two cases. First, in a desktop pool with the <span class="packt_screen">Delete or refresh machine on logoff</span> or the <span class="packt_screen">Delete machine after logoff</span> setting enabled, a desktop session is logged out, but the virtual machine is not yet refreshed or deleted. Second, the View Connection server disables the Horizon agent just before sending a request to power off the virtual desktop machine. This state ensures that a new desktop session cannot be started on the virtual desktop machine</li>
<li><strong>Agent unreachable</strong>: The View Connection server cannot establish communication with the Horizon agent running on a virtual desktop machine.</li>
<li><strong>Invalid IP</strong>: The subnet mask registry setting is configured on the virtual desktop machine, and no active network adapters have an IP address within the configured range.</li>
<li><strong>Agent needs reboot</strong>: A View component was upgraded, and the virtual desktop machine must be restarted to allow the Horizon agent to operate with the upgraded component.</li>
<li><strong>Protocol failure</strong>: A display protocol did not start before the Horizon agent startup period expired.</li>
<li><strong>Domain failure</strong>: The virtual desktop machine encountered a problem reaching the domain. The domain server was not accessible, or the domain authentication failed.</li>
<li><strong>Already used</strong>: In a desktop pool with the <span class="packt_screen">Delete or refresh machine on logoff</span> or <span class="packt_screen">Delete machine after logoff s</span>etting enabled, there is no session on the virtual desktop machine, but the session was not logged off. This could occur should a virtual desktop machine shut down unexpectedly or if the end user resets the machine in mid-session.</li>
<li><strong>Configuration error</strong>: The display protocol is not enabled.</li>
<li><strong>Provisioning error</strong>: An error occurred during provisioning.</li>
<li><strong>Error</strong>: An unknown error occurred in the virtual desktop machine.</li>
<li><strong>Unassigned user connected</strong>: A different user who is not the assigned user is logged into a virtual desktop machine in a dedicated desktop pool.</li>
<li><strong>Unassigned user disconnected</strong>: A user other than the assigned user is logged in and disconnected from a virtual machine in a dedicated desktop pool.</li>
<li><strong>Unknown</strong>: The virtual desktop machine state is unknown.</li>
<li><strong>Provisioned</strong>: The virtual desktop machine has been built but is powered off or suspended.</li>
<li><strong>Available</strong>: The virtual desktop machine is powered on and ready for an end user to connect to it.</li>
<li><strong>Connected</strong>: The virtual desktop machine already has a user session running and is connected to the Horizon client.</li>
<li><strong>Disconnected</strong>: The virtual machine is already being used in a session, but it is disconnected from the Horizon client device.</li>
<li><strong>In progress</strong>: The virtual machine is in a transitional state during a maintenance operation.</li>
</ul>
<p>There are also a number of tasks you can complete on each virtual desktop machine within the desktop pool. By right-clicking on any desktop listed in the table, you are able to undertake any of a number of tasks on that given desktop. You have the following options as shown in the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/56675f53-9a11-48a5-bfdf-85126dd93889.png" style=""/></div>
<p class="mce-root"/>
<p class="mce-root"/>
<p>These options are described in more detail in the following list:</p>
<ul>
<li><span class="packt_screen">Restart Desktop</span><span>:</span> Restarts that particular virtual desktop machine.</li>
<li><span class="packt_screen">Reset Virtual Machine</span>: Will complete a hard reset on the desktop and could be used in the case of a system lockup. This will also reset the virtual desktop machine back to the original snapshot state.</li>
<li><span class="packt_screen">Remove</span>: Will remove the virtual desktop machine from the pool.</li>
<li><span class="packt_screen">Refresh</span>, <span class="packt_screen">Recompose</span>, and <span class="packt_screen">Rebalance</span>: This options have been described in <a href="5d942e5b-dda5-4e5a-8278-62a64210aeef.xhtml" target="_blank">Chapter 2</a>, <em><span>Understanding Horizon 7 Architecture and Components</span></em>, and can be completed here on an individual desktop basis rather than performing them on the entire pool. We will look at these in more detail in the next section.</li>
<li><span class="packt_screen">Cancel task</span>: Cancels any outstanding task on the individual virtual machine.</li>
<li><span class="packt_screen">Assign User</span>: Can be used to allocate a desktop to a specific user.</li>
<li><span class="packt_screen">Unassign User</span>: Removes a user from being entitled to this desktop this allocation.</li>
<li><span class="packt_screen">Enter Maintenance Mode</span>: Places the desktop in a state where users cannot be allocated to the desktop or connect to it while maintenance is carried out.</li>
<li><span class="packt_screen">Exit Maintenance Mode</span>: Returns the desktop to the pool.</li>
<li><span class="packt_screen">Disconnect Session</span>: Disconnects the currently connected user from the pool without logging them off.</li>
<li><span class="packt_screen">Logoff Session</span>: Logs the user off.</li>
<li><span class="packt_screen">Send Message</span>: Sends a message to any given user.</li>
<li><span class="packt_screen">Export table contents</span>: Exports a copy of the table containing the virtual desktop machine details as a CSV file.</li>
<li><span class="packt_screen">Refresh table contents</span>: Updates the table with the latest information.</li>
</ul>
<p>In the next section, we are going to look at a couple of the more common, <span>Linked Clone</span> specific tasks for managing the desktop pools, starting with recomposing a desktop pool.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Recomposing a Linked Clone desktop pool</h1>
                </header>
            
            <article>
                
<p>One of the more common tasks you are likely to perform is to recompose a desktop pool to update the operating system or applications in the base image or, alternatively, to add new applications. It's always recommended to have test pools available for you to test updates prior to sending them out to your end users.</p>
<p>In this example, we are going to recompose one of the example desktop pools, but you could also perform a recompose operation on an individual virtual desktop:</p>
<ol>
<li>To recompose a desktop pool, from the Horizon View Administrator dashboard screen, under the <span class="packt_screen">Inventory</span> section in the left-hand pane, expand the option for <span class="packt_screen">Catalog</span>, and then click on <span class="packt_screen">Desktop Pools</span>. Double-click on the desktop pool on which you want to perform the recompose operation. In the example lab, we are going to select the <span>Linked Clone</span> desktop pool called <kbd>Win7-Floating-lc</kbd>. You will now see the details of the desktop pool in the <span class="packt_screen">Summary</span> tab of the chosen desktop pool as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/0867bbe5-9ccc-4846-a52d-e3f3d27c43fd.png" style=""/></div>
<ol start="2">
<li>Click the <span class="packt_screen">View Composer</span> button (<strong>1</strong>), and then from the menu options displayed, click on <span class="packt_screen">Recompose</span> (<strong>2</strong>).</li>
</ol>
<ol start="3">
<li>You will now see the <span class="packt_screen">Recompose</span> screen and the <span class="packt_screen">Image</span> option as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/284235e0-10d2-4bcb-89e8-b20e378a9b6f.png" style=""/></div>
<ol start="4">
<li>Here, you have the option to change the parent VM by clicking the <span class="packt_screen">Change...</span> button (<strong>3</strong>). You can then select a new parent VM to recompose from. You would then see the snapshots that are associated with the newly selected parent VM in the table (<strong>4</strong>), from where you would then click it to select it.</li>
<li>You can just select a new snapshot of the current image. This would reflect an updated version of the existing image that you then created a new snapshot from. To do this, again click the snapshot you want to use (<strong>4</strong>).</li>
<li>Click <span class="packt_screen">Next &gt;</span> to continue.</li>
</ol>
<ol start="7">
<li>You will now see the <span class="packt_screen">Scheduling</span> screen where you can configure the time of the recompose operation, and what happens if users are connected at the time of the recompose. This is shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/5897117c-7bb2-4e0e-8e6d-f7d9fe1960af.png" style=""/></div>
<ol start="8">
<li>The first option is to set the date and time that you want the recompose operation to start (<strong>5</strong>).</li>
<li>Next, you have the option to wait until users log off before the recompose starts. To enable this option, click the radio button for <span class="packt_screen">Wait for users to log off</span> (<strong>6</strong>). Or you can click the radio button for <span class="packt_screen">Force user to log off</span> (<strong>7</strong>), which will forcibly log users off. However, they may be given a grace period before actually being logged off to allow them to save any work.</li>
<li>You then have the option to check the box for <span class="packt_screen">Stop at first error</span> (<strong>8</strong>). Check this to stop the recompose if there are any errors. This would prevent rebuilding all the virtual desktop machines in the pool if there are any problems.</li>
</ol>
<ol start="11">
<li>If we just refer back to the force users to log off option, you can also configure a grace period before they are logged off. This can be edited in the <span class="packt_screen">Global Settings</span> section as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/30ae6747-a5f3-4da4-858f-5a445247611e.png" style=""/></div>
<ol start="12">
<li>To edit the global settings, from the <span class="packt_screen">Inventory</span> pane on the left-hand side, expand out the option for <span class="packt_screen">View Configuration</span>, and then click on <span class="packt_screen">Global Settings</span> (<strong>10</strong>). Then click on <span class="packt_screen">Edit...</span> (<strong>11</strong>), and in the <span class="packt_screen">General Settings</span> box, scroll down to the highlight section (<strong>12</strong>). You can then configure the message and the grace period.</li>
<li>On the <span class="packt_screen">Recompose</span> screen, now click <span class="packt_screen">Next &gt;</span> to continue.</li>
<li>You will now see the <span class="packt_screen">Ready to Complete</span> box as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/70caaf3d-7cc6-4925-b74a-beff6b4fa0a3.png" style=""/></div>
<ol start="15">
<li>Check the configuration settings and then click the <span class="packt_screen">Finish</span> button.</li>
<li>The recompose operation will now start depending on the start time configured and whether to wait for users to log off.</li>
</ol>
<p>You have now successfully performed a recompose operation on one of the <span>Linked Clone</span> <span>desktop pools in the</span> example lab. In the next section, we will look at the refresh operation.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Refreshing a Linked Clone desktop pool</h1>
                </header>
            
            <article>
                
<p><span>Another task you are likely to perform is to refresh a desktop pool.</span> By carrying out a refresh of the <span>Linked Clone</span> virtual desktops or desktop pools, you are effectively reverting them back to their initial state, when the original snapshot was taken after they had completed the customization phase. Only the operating system disk is refreshed and no other disks are affected:</p>
<ol>
<li>To recompose a desktop pool, from the Horizon View Administrator dashboard screen, under the <span class="packt_screen">Inventory</span> section in the left-hand pane, expand the option for <span class="packt_screen">Catalog</span>, and then click on <span class="packt_screen">Desktop Pools</span>. Double-click on the desktop pool on which you want to perform the refresh operation. In the example lab, we are going to select the <span>Linked Clone</span> desktop pool called <kbd>Win7-Floating-lc</kbd>. You will now see the details of the desktop pool in the <span class="packt_screen">Summary</span> tab of the chosen desktop pool.</li>
</ol>
<ol start="2">
<li>Click the <span class="packt_screen">View Composer</span> button, and then from the menu options displayed click on <span class="packt_screen">Refresh</span>.</li>
<li>You will now see the <span class="packt_screen">Scheduling</span> screen where you can configure the time of the recompose operation, and what happens if users are connected at the time of the refresh. This is shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/9dac8a67-b6e7-46f4-9a5f-d91bc212c2e8.png" style=""/></div>
<ol start="4">
<li>Click the <span class="packt_screen">Next &gt;</span> button to continue.</li>
</ol>
<ol start="5">
<li>You will now see the <span class="packt_screen">Ready to Complete</span> <span>box as shown in the following screenshot:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/94a05940-a46d-4a59-b454-6fcc31b9884a.png" style=""/></div>
<ol start="9"/>
<ol start="6">
<li>Check the configuration settings and then click the <span class="packt_screen">Finish</span> button.</li>
<li>The refresh operation will now start depending on the start time configured and whether to wait for users to log off.</li>
</ol>
<p>You have now successfully performed a refresh operation on one of the <span>Linked Clone</span> <span>desktop pools in the</span> example lab. In the next section, we will look at the rebalance operation.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Rebalancing a Linked Clone desktop pool</h1>
                </header>
            
            <article>
                
<p><span>The final task you will perform is to rebalance a desktop pool. The rebalance operation in View Composer is used to evenly distribute the Linked Clone virtual desktop machines across multiple</span> datastores i<span>n your environment.</span></p>
<p class="mce-root"/>
<p class="mce-root"/>
<p><span>You would perform this task if one of your datastores was becoming full while others have ample free space:</span></p>
<ol>
<li><span>To rebalance a desktop pool, from the Horizon View Administrator dashboard screen, under the</span> <span class="packt_screen">Inventory</span> <span>section in the left-hand pane, expand the option for</span> <span class="packt_screen">Catalog</span><span>, and then click on</span> <span class="packt_screen">Desktop Pools</span><span>. Double-click on the desktop pool in which you want to perform the rebalance operation. In the example lab, we are going to select the Linked Clone desktop pool called</span> <kbd>Win7-Floating-lc</kbd><span>. You will now see the details of the desktop pool in the</span> <span class="packt_screen">Summary</span> <span>tab of the chosen desktop pool.</span></li>
<li>Click the <span class="packt_screen">View Composer</span> button, and then from the menu options displayed, click on <span class="packt_screen">Rebalance</span>.</li>
<li>You will now see the following information box:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/6d0d6fac-6a2c-4522-9379-9eabdfd8ebca.png" style=""/></div>
<ol start="4">
<li>Click the <span class="packt_screen">Next &gt;</span> button to continue.</li>
<li>You will now see the <span class="packt_screen">Scheduling</span> screen where you can configure the time of the rebalance operation, and what happens if users are connected at the time of the rebalancing. This is the same screen as we have seen previously for the refresh and recompose operations.</li>
<li>Click the <span class="packt_screen">Next &gt;</span> button to continue.</li>
<li>You will now see the <span class="packt_screen">Ready to Complete</span> <span>box as shown in the following screenshot:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/59ea4eeb-85ca-4fb2-82cb-e52c7dca8e3d.png" style=""/></div>
<ol start="8">
<li>In the <span class="packt_screen">Ready to Complete</span> box, this time you will see the logoff message that will be displayed to the users. There is also an important information box at the bottom regarding the desktop pool settings and the number of virtual desktop machines available in the desktop pool during the rebalance operation.</li>
<li>Check the configuration settings and then click the <span class="packt_screen">Finish</span> button.</li>
<li>The rebalance operation will now start depending on how you configured the start time and whether to wait for users to log off.</li>
</ol>
<p>You have now successfully performed a rebalance operation on one of the <span>Linked Clone</span> <span>desktop pools in the</span> <span>example lab. In the next section, we will look at managing some of the additional disks that are created by View Composer.</span></p>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Managing persistent disks</h1>
                </header>
            
            <article>
                
<p>In the previous section, we discussed View Composer's operations, which are all about managing the OS side of what gets created for the virtual desktop machines. In this section, we are going to look at how to manage the non-OS disks or the persistent disk.</p>
<p>A persistent disk can be configured on a dedicated virtual hard disk per user, which will allow you to preserve user data and settings between recompose operations and more. There are a number of tasks that can be undertaken with regard to persistent disk management.</p>
<p>You are able to detach the virtual disk from a dedicated desktop. The main use case for this could be due to the end user leaving the company, and so the desktop is no longer needed but the data needs to be kept for compliance or audit reasons. It could also be because there is an issue with the desktop and you need to recreate it afresh without losing the user's data. Equally, you can attach an existing persistent disk to a virtual desktop machine in order to access the files and data stored on it. In the next sections, we are going to work through both attaching and detaching a persistent disk.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Detaching a persistent disk</h1>
                </header>
            
            <article>
                
<p>In the first instance, let's look at how you would detach a persistent disk from a user's virtual desktop machine, following these steps:</p>
<ol>
<li>From a workstation, open a browser and enter the address details of the View Connection server. In the example lab, the address of the connection server is <kbd>https://hzn7-cs1.pvolab.com/admin</kbd>.</li>
<li>You will now see the View Administrator login screen. Log in using the administrator account.</li>
<li>You will now see the Horizon View Administrator dashboard screen.</li>
</ol>
<ol start="4">
<li>From Horizon View Administrator, click to expand <span>the</span> <span class="packt_screen">C</span><span class="packt_screen">atalog</span> <span>option from the</span> <span class="packt_screen">Inventory</span> <span>on the left-hand side. From there, click on</span> <span class="packt_screen">Desktop Pools</span> <span>(<strong>1</strong>), as shown in the following screenshot:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/ff4f1f24-513c-4f6e-b085-0b4394380823.png" style=""/></div>
<ol start="5">
<li>Next, click on the <span class="packt_screen">Inventory</span> tab (<strong>2</strong>). You will now see a table listing the virtual desktop machines within the desktop pool, along with a number of clickable options across the top.</li>
<li>Click on the <span class="packt_screen">Persistent Disks</span> option (<strong>3</strong>).</li>
<li>The table view then switches to detail the persistent disks attached to these virtual desktop machines. Click and select one of the disks. In this example, we will select <span class="packt_screen">Win7-VM-1-vdm-user-disk-D</span> (<strong>4</strong>).</li>
<li>Now click the <span class="packt_screen">Detach...</span> button (<strong>5</strong>). The disk is now detached and is available as a standalone disk that can be attached to another virtual machine. The use case for this could be for keeping a user's data should they leave your organization and you need to keep their data for compliance purposes or to share it with other users.</li>
</ol>
<p>There is also another way to detach a persistent disk as described in the following steps:</p>
<ol>
<li>Once logged in to the Horizon View Administrator, from the dashboard, click to expand the resources option from the <span class="packt_screen">Inventory</span> on the left-hand side. From there, click on <span class="packt_screen">Persistent Disks</span> (<strong>6</strong>), as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/8fd3cda6-d977-43d7-a45d-6331535dbad9.png"/></div>
<ol start="2">
<li>You will now see the table detailing the persistent disks attached to these virtual desktop machines. Click and select one of the disks. In this example, we will select <span class="packt_screen">Win7-VM-2-vdm-user-disk-D</span> (<strong>7</strong>).</li>
<li>Now click the <span class="packt_screen">Detach...</span> button (<strong>8</strong>). The disk is now detached.</li>
</ol>
<p>In the next section, we are going to work through the reverse and show you how to attach a persistent disk.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Attaching a persistent disk</h1>
                </header>
            
            <article>
                
<p><span>To attach a persistent disk to a users virtual desktop machine, follow these steps:</span></p>
<ol>
<li>From a workstation, open a browser and enter the address details of the View connection server. In the example lab, the address of the connection server is <kbd>https://hzn7-cs1.pvolab.com/admin</kbd>.</li>
<li>You will now see the View Administrator login screen. Log in using the administrator account.</li>
<li>You will now see the Horizon View Administrator dashboard screen.</li>
</ol>
<ol start="4">
<li>From Horizon View Administrator, click to expand the resources option from the <span class="packt_screen">Inventory</span> on the left-hand side. From there, click on <span class="packt_screen">Persistent Disks</span> (<strong>1</strong>), as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/9fd45104-7a56-4a82-a42b-2a9ee1c2fc7c.png" style=""/></div>
<ol start="5">
<li>Now click on the <span class="packt_screen">Detached</span> tab (<strong>2</strong>). If you already had a number of detached disks, then you would see them listed in the table. In the example lab, we don't have any, but if we did, you would click the entry for the persistent disk from the list, and then click on the <span class="packt_screen">Attach...</span> button.</li>
<li><span>The next step is to select a Linked Clone virtual desktop machine to which to attach the persistent disk, select the</span> <span class="packt_screen">Attach as a secondary disk</span> <span class="ph uicontrol">option, and then click</span> <span class="packt_screen">Finish</span><span class="ph uicontrol">.</span></li>
<li>The disk will now be made available on the virtual desktop machine you selected.</li>
</ol>
<div class="packt_infobox">You cannot attach a persistent disk that is stored on a non-VMware Virtual <span class="ph productname">SAN</span> <span>datastore to a virtual desktop machine tha</span>t is stored on <span>a VMware Virtual</span> <span class="ph productname">SAN</span> <span>datastore. Also, you need to ensure that the virtual desktop machine you are attaching the persistent disk to uses the same operating system as the virtual desktop machine in which the persistent disk was created.</span></div>
<p class="mce-root"/>
<p class="mce-root"/>
<p>You also have the option to import an existing disk direct from vCenter. To do this, follow these steps:</p>
<ol start="1">
<li>Click the <span class="packt_screen">Import from vCenter...</span> button (<strong>3</strong>) as shown in the previous screenshot. You will now see the <span class="packt_screen">Import Persistent Disk from vCenter</span> configuration box as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/68e492af-a685-4c9c-ae2d-6821f1c966ce.png" style=""/></div>
<ol start="2">
<li>First, in the <span class="packt_screen">vCenter Server</span> box, click the drop-down arrow and select the vCenter server from <span>the list</span> shown that contains the virtual disk you want to import. In the example lab, this is shown by the IP address <kbd>192.168.1.178</kbd>. You will also see that it shows the vCenter user account.</li>
<li>Next, select the datacenter from the <span class="packt_screen">Datacenter</span> box (<strong>5</strong>) by clicking the <span>drop-down arrow and selecting the datacenter where the virtual disk resides. In the example lab, this is the</span> <span class="packt_screen">PVO's Datacenter</span> <span>option.</span></li>
<li>Now, in the <span class="packt_screen">Linked-clone desktop pool</span> box, <span>click the drop-down arrow (<strong>6</strong>) and select the desktop pool of where the virtual disk resides. In the example lab, this is the desktop pool called</span> <kbd>Win7-dedicated-lc</kbd><span>.</span></li>
</ol>
<ol start="5">
<li>Next, you need to choose the <span class="packt_screen">Persistent Disk File</span>. Click the <span class="packt_screen">Browse...</span> button (<strong>7</strong>). You will now see the <span class="packt_screen">Select Datastore Path</span> configuration box as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/81d677ec-2a5a-4821-929a-2c3dd3854377.png" style=""/></div>
<ol start="6">
<li>From the <span class="packt_screen">Datastore</span> box, click the down-arrow (<strong>9</strong>), and from the list, choose the datastore on which the persistent disk resides. In the example lab, this is the datastore called <span class="packt_screen">VM Datastore</span>.</li>
<li>Then, from the list, navigate <span>to the virtual disk you want to import and click the</span> <span class="packt_screen">OK</span> <span>button.</span></li>
<li>You will <span>now return to the</span> <span class="packt_screen">Import Persistent Disk from vCenter</span> <span>configuration box. The final thing to configure is the</span> <span class="packt_screen">User</span> <span>option.</span></li>
<li><span>Click the</span> <span class="packt_screen">Browse...</span> <span>button (<strong>8</strong>). You will now see the s</span>elect datastore path <span>configuration box as shown in the following screenshot:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/bfff01ef-4701-45e5-9bd7-34eb24bae65e.png" style=""/></div>
<ol start="10">
<li>In the <span class="packt_screen">Domain</span> box (<strong>10</strong>), click the drop-down arrow and select the domain in which the user resides. In the example lab, this is the <kbd>pvolab.com</kbd> domain.</li>
<li>Next, in the <span class="packt_screen">Name/User name</span> <span>box (<strong>11</strong>), type in the username of</span> <kbd>Peter</kbd> <span>and ensure that you select</span> <span class="packt_screen">Contains</span> <span>from the drop-down menu for the filter.</span></li>
<li>Now click the <span class="packt_screen">Find</span> button (<strong>12</strong>).</li>
<li>In the table, you will now see the results displayed. Click and select the relevant user (<strong>13</strong>) and then click <span class="packt_screen">OK</span>.</li>
<li><span>You will</span> <span>now return to the</span> <span class="packt_screen">Import Persistent Disk from vCenter</span> <span>configuration box.</span></li>
<li>Click <span class="packt_screen">OK</span> to complete the configuration. The disk will now be attached to a virtual desktop machine in the selected desktop pool when the associated user logs on.</li>
</ol>
<p>You have now successfully attached a persistent disk to an existing virtual desktop machine.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Reviewing the infrastructure post-deployment</h1>
                </header>
            
            <article>
                
<p class="NormalPACKT"><span>So, with the desktop pools created and the virtual desktop machines built and running, now is a good time to go back and review the infrastructure to check that everything is running as expected before you start adding end users and allowing them to log in. This is just to make sure your sizing of resources is as you expected it to be, but it also gives you another opportunity to tweak anything before it's too late and you have live users logged in.</span></p>
<p class="NormalPACKT"><span>Ideally, you should compare the assessment data with the current data from your environment. Back in</span> <a href="20877fa6-9a03-4c97-ab85-4a4338e2c680.xhtml" target="_blank">Chapter 3</a><span>, <em>Design and Deployment Considerations</em>, we looked at Liquidware Stratusphere as a solution for this, as not only will it give us the assessment data, it will also provide data on the infrastructure performance and will be useful in the next section when we come to fine-tuning the end user experience.</span></p>
<p class="NormalPACKT"><span>This will allow you to measure CPU, memory, and network performance so you can quickly understand the resources being used and identify any potential bottlenecks.</span></p>
<p class="mce-root"/>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article>
                
<p>In this, the second part of <a href="d44c9a7b-bcae-4758-a857-197be388a4be.xhtml" target="_blank">Chapter 8</a>, <em>Configuring and Managing Desktop Pools - Part 1</em>, we looked at how to create floating desktop pools, and then we looked at how to entitle end users to have access to the desktop pools and the virtual desktop machines in the pool. We looked at doing this from the View Admin console and also from the new Horizon Console.</p>
<p>Then, we went on to look at some the of the more common pool management tasks, particularly when it came to managing <span>Linked Clone</span> desktop pools.</p>
<p>We finished the chapter by looking at how to review your environment once you complete the initial deployment.</p>


            </article>

            
        </section>
    </body></html>