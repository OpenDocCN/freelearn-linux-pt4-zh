<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Using Python as a Bash Scripting Alternative</h1>
                </header>
            
            <article>
                
<p>In the previous chapter, we saw a practical example of using AWK and we saw how to process <kbd>lastlog</kbd> output to produce better reports. In this chapter, we will take a look at another scripting alternative for bash. We will talk about Python. Python is another scripting language and the newest that we have looked at so far. Similar to bash, Python is an interpreted language and makes use of the shebang. Although it does not have a shell interface, we can access a console called REPL where we can type Python code to interact with the system. In this chapter, we will cover the following topics:</p>
<ul>
<li>What is Python?</li>
<li>Saying Hello World the Python way</li>
<li>Pythonic arguments</li>
<li>Significant whitespace</li>
<li>Reading user input</li>
<li>String manipulation</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Technical requirements</h1>
                </header>
            
            <article>
                
<p>The source code for this chapter can be downloaded here:</p>
<p><a href="https://github.com/PacktPublishing/Mastering-Linux-Shell-Scripting-Second-Edition/tree/master/Chapter14">https://github.com/PacktPublishing/Mastering-Linux-Shell-Scripting-Second-Edition/tree/master/Chapter14</a></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">What is Python?</h1>
                </header>
            
            <article>
                
<p>Python is an object-oriented interpreted language that is designed to be easy to use and to aid <strong>Rapid Application Development</strong>. This is achieved by the use of simplified semantics in the language.</p>
<p>Python was created at the end of the 1980s, towards the very end of December 1989, by the Dutch developer Guido van Rossum. The majority of the design of the language aims for clarity and simplicity, and one of the main rules of the <em>Zen of Python</em> is:</p>
<p><em>There should be one, and preferable only one, obvious way to do it.</em></p>
<p>Often systems will have both Python 2 and Python 3 installed; however, all newer distributions are switching to Python 3. We will be working with Python 3.</p>
<p>Since we are using Linux Mint, it comes shipped with Python 3 already.</p>
<p>If you are using another Linux distribution or Python 3 is not found for any reason, you can install it like this:</p>
<ul>
<li>On RedHat based distributions:</li>
</ul>
<pre style="padding-left: 60px"><strong>$ sudo yum install python36</strong></pre>
<ul>
<li>On Debian based distributions:</li>
</ul>
<pre style="padding-left: 60px"><strong>$ sudo apt-get install python3.6</strong></pre>
<p>Although there is no shell, we can interact with Python using REPL—read, evaluate, print, and loop. We can access this by typing <kbd>python3</kbd> in the command line or <kbd>python36</kbd> if you are using CentOS 7. You should see something similar to the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-384 image-border" src="assets/f6f4a369-5ad2-417f-b7f3-c8c5d2f9c8f4.png" style="width:38.92em;height:9.00em;"/></div>
<p>We can see that we are presented with the <kbd>&gt;&gt;&gt;</kbd> prompt and this is known as the REPL console. We should emphasize that this is a scripting language and, like bash and Perl, we will normally execute code through the text files that we create<span>. Those text files will normally be expected to have a</span> <kbd>.py</kbd> <span>suffix to their name.</span></p>
<p>While working with REPL, we can print the version independently by importing a module. In Perl, we will use the keyword; in bash we will use the command source; and in Python we use import:</p>
<pre><strong>&gt;&gt;&gt;import sys</strong></pre>
<p>With the module loaded, we can now investigate the object-oriented nature of Python by printing the version:</p>
<pre><strong>&gt;&gt;&gt; sys.version</strong></pre>
<p>We will navigate to the <kbd>sys</kbd> object within our namespace and call the version method from that object.</p>
<p class="mce-root">Combining these two commands, we should see the following output:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-385 image-border" src="assets/244aaa63-2f2c-41d0-a43b-db41ce9bb335.png" style="width:32.58em;height:5.17em;"/></div>
<p>To close this section describing Python, we should take a look at the Zen of Python. From REPL, we can type <kbd>import this</kbd>, as shown in the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-386 image-border" src="assets/ee86f25a-9032-4709-918a-7890a7e289aa.png" style="width:34.50em;height:23.17em;"/></div>
<p>This is far more than just the Zen of Python; it's actually a good rule for all programming languages and a guide for developers.</p>
<p>Finally, to close the REPL, we will use <em>Ctrl</em> + <em>D</em> in Linux or <em>Ctrl</em> + <em>Z</em> in Windows.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Saying Hello World the Python way</h1>
                </header>
            
            <article>
                
<p>The code we write in Python should be clear and uncluttered: sparse is better than dense. We will need the shebang on the first line and then the <kbd>print</kbd> statement. The <kbd>print</kbd> function includes the newline and we do not need semicolons at the end of the line. We can see the edited version of <kbd>$HOME/bin/hello.py</kbd> in the following example:</p>
<pre>#!/usr/bin/python3<br/>print("Hello World")</pre>
<p>We will still need to add the execute permission, but we can run the code as earlier using <kbd>chmod</kbd>. This is shown in the following command but we should be a little used to this now:</p>
<pre><strong>$ chmod u+x $HOME/bin/hello.py</strong></pre>
<p>Finally, we can now execute the code to see our greeting.</p>
<p>Similarly, you can run the file using the Python interpreter from the command line like this:</p>
<pre><strong>$ python3 $HOME/bin/hello.py</strong></pre>
<p>Or in some Linux distributions, you can run it like this:</p>
<pre><strong>$ python36 $HOME/bin/hello.py</strong></pre>
<p>Again, knowing at least one language makes it easier to adapt to others and there aren't many new features in this.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Pythonic arguments</h1>
                </header>
            
            <article>
                
<p>We should know by now that we will want to pass command-line arguments to Python and we can do this using the <kbd>argv</kbd> array. However, we are more like bash; with Python we combine the program name into the array with the other arguments.</p>
<p>Python also uses lowercase instead of uppercase in the object name:</p>
<ul>
<li>The <kbd>argv</kbd> array is a part of the <kbd>sys</kbd> object</li>
<li><kbd>sys.argv[0]</kbd> is the script name</li>
<li><kbd>sys.argv[1]</kbd> is the first argument supplied to the script</li>
<li><kbd>sys.argv[2]</kbd> is the second supplied argument and so on</li>
<li>The argument count will always be at least 1, so, keep this in mind when checking for supplied arguments</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Supplying arguments</h1>
                </header>
            
            <article>
                
<p>If we create the <kbd>$HOME/bin/args.py</kbd> file we can see this in action. The file should be created as follows and made executable:</p>
<pre>#!/usr/bin/python3<br/>import sys<br/>print("Hello " + sys.argv[1])</pre>
<p>If we run the script with a supplied argument, we should see something similar to the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-387 image-border" src="assets/9f8f5f9c-a8b6-49eb-a3ef-71fe4a6f2b59.png" style="width:19.08em;height:4.33em;"/></div>
<p>Our code is still quite clean and simple; however, you may have noticed that we cannot combine the quoted text in the <kbd>print</kbd> statement with the argument. We use the <span class="packt_screen">+</span> symbol to join or concatenate the two strings together. As there is no specific symbol to denote a variable or any other type of object, they cannot appear as static text within quotes.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Counting arguments</h1>
                </header>
            
            <article>
                
<p>As previously mentioned, the script name is the first argument at index <kbd>0</kbd> of the array. So, if we try to count the arguments, then the count should always be at the very least 1. In other words, if we have not supplied arguments, the argument count will be 1. To count the items in an array, we can use the <kbd>len()</kbd> function.</p>
<p>If we edit the script to include a new line we will see this work, as follows:</p>
<pre>#!/usr/bin/python3<br/>import sys<br/>print("Hello " + sys.argv[1])<br/>print( "length is: " + str(len(sys.argv)) )</pre>
<p>Executing the code as we have earlier, we can see that we have supplied two arguments—the script name and then the string <kbd>Mokhtar</kbd>:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-388 image-border" src="assets/14f2ceb6-5e31-4896-a472-2e53ee8febc5.png" style="width:31.92em;height:7.17em;"/></div>
<p>If we try and have a single <kbd>print</kbd> statement to print the output and the number of arguments, then it will produce an error because we can't concatenate integers with strings. The length value is an integer and this cannot be mixed with strings without conversion. That's why we used the <kbd>str</kbd> function to convert the integer to a string. The following code will fail:</p>
<pre>#!/usr/bin/python3<br/>import sys<br/>print("Hello " + sys.argv[1] + " " + len(sys.argv))</pre>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-389 image-border" src="assets/586821ef-3beb-4361-ba75-a15d1f8a3c39.png" style="width:30.75em;height:9.58em;"/></div>
<p>If we try to run the script and omit to supply an argument, then there will be a null value in the array when we reference index <kbd>1</kbd>. This will give an error, as shown in the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-390 image-border" src="assets/3bcebb19-f36c-4b3e-8385-92cda7f2c297.png" style="width:31.50em;height:6.33em;"/></div>
<p>We of course need to handle this to prevent the error; enter the concept of significant whitespace.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Significant whitespace</h1>
                </header>
            
            <article>
                
<p>A major difference between Python and most other languages is that additional whitespace can mean something. The indent level of your code defines the block of code to which it belongs. So far, we have not indented the code we have created past the start of the line. This means that all of the code is at the same indent level and belongs to the same code block. Rather than using brace brackets or the do and done keywords to define the code block, we use indents. If we indent with two or four spaces or even tabs, then we must stick to those spaces or tabs. When we return to the previous indent level, we return to the previous code block.</p>
<p>This seems complex but it is really quite simple and keeps your code clean and uncluttered. If we edit the <kbd>arg.py</kbd> file to prevent unwelcomed errors, if an argument is not supplied, we can see this in action:</p>
<pre>#!/usr/bin/python3<br/>import sys<br/>count = len(sys.argv)<br/>if ( count &gt; 1 ):<br/>    print("Arguments supplied: " + str(count))<br/>    print("Hello " + sys.argv[1])<br/>print("Exiting " + sys.argv[0])</pre>
<p>The <kbd>if</kbd> statement checks if the argument count is greater than <kbd>1</kbd> or not. We now store for ease, the argument count has its own variable, which we call <kbd>count</kbd>. The code block starts with the colon and then all of the following code that is indented with four spaces is part of the code that will execute when the condition returns to true.</p>
<p>When we return to the previous indent level, we return to the main code block and we execute the code regardless of the status of the condition.</p>
<p>We can see this illustrated in the following screenshot, where we can execute the script with and without the argument:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-391 image-border" src="assets/5442796d-3c11-4c49-88ad-32943ce706a0.png" style="width:21.00em;height:7.17em;"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Reading user input</h1>
                </header>
            
            <article>
                
<p>If we want the welcome message to greet us by name, no matter whether we supply the argument to the script or not, we can add in a prompt to capture the data while the script is running. Python makes this simple and easy to implement. We can see, from the edited file shown in the screenshot that follows, how this is achieved:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-392 image-border" src="assets/73f82bf9-3d49-406b-a5b8-8769a66edd85.png" style="width:19.25em;height:13.67em;"/></div>
<p>We make use of a new variable in the script that we set in the main block, initially, to be an empty string. We set it here to make the variable available to the complete script and all code blocks:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-393 image-border" src="assets/055b7509-1ee2-44ea-91a3-7ebf5d557ee2.png" style="width:31.00em;height:10.50em;"/></div>
<p>The <kbd>input</kbd> function in Python 3 (or <kbd>raw_input</kbd> in Python 2) can be used to get user input. We store that input in the <kbd>name</kbd> variable. If we have supplied an argument we pick it up on the code in the <kbd>else</kbd> block and set the <kbd>name</kbd> variable to the first supplied argument. It is this that is used in the <kbd>print</kbd> statement back in the main block.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Using Python to write to files</h1>
                </header>
            
            <article>
                
<p>To add some variety to this chapter, we will now look at printing this data to a file. Again using Python, this is quite a simple and easy way to pick up. We will start by making a copy of our existing <kbd>args.py</kbd>. We will copy this to <kbd>$HOME/bin/file.py</kbd>. The new <kbd>file.py</kbd> should read similar to the following screenshot and have the execute permission set:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-394 image-border" src="assets/c2073b52-8953-4dfe-979d-8873f725f54a.png" style="width:20.50em;height:14.42em;"/></div>
<p>You will notice that we have just altered the final lines and instead of print we now open a file. We also see more of the object-orientated nature of Python, whereby it dynamically assigns the <kbd>write()</kbd> and <kbd>close()</kbd> methods to the object log, as it is seen as an instance of a file. When we open the file, we open it up for the purpose of appending, meaning that we do not overwrite the existing content if it is already there. If the file is not there, we will create a new file. If we use <kbd>w</kbd>, we will open the file for writing, which might translate to overwriting, so take care.</p>
<p>You can see that this is an easy task; this is why Python is used in many applications and is taught widely in schools.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">String manipulation</h1>
                </header>
            
            <article>
                
<p>Dealing with strings in Python is very simple: you can search, replace, change character case, and perform other manipulations with ease:</p>
<p>To search for a string, you can use the find method like this:</p>
<pre>#!/usr/bin/python3<br/>str = "Welcome to Python scripting world"<br/>print(str.find("scripting"))</pre>
<div class="mce-root CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-691 image-border" src="assets/409cba04-6f75-4ced-a2a0-f51c08178b79.png" style="width:31.83em;height:6.33em;"/></div>
<div>
<p class="NormalPACKT"><span>The string count in Python starts from zero too, so the position of the word <kbd>scripting</kbd> is at <kbd>18</kbd>.</span></p>
<p class="NormalPACKT"><span>You can get a specific substring using square brackets like this:</span></p>
<pre class="CodePACKT"><span>#!/usr/bin/python3<br/></span><span>str = "Welcome to Python scripting world"<br/></span><span>print(str[:2]) # Get the first 2 letters (zero based)<br/></span><span>print(str[2:]) # Start from the second letter<br/></span><span>print(str[3:5]) # from the third to fifth letter<br/></span><span>print(str[-1]) # -1 means the last letter if you don't know the length<br/></span></pre></div>
<div class="mce-root CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-692 image-border" src="assets/7d996f4c-71ac-4faa-8e65-b408841d8ae5.png" style="width:32.92em;height:9.92em;"/></div>
<p class="NormalPACKT"><span>To replace a string, you can use the replace method like this:</span></p>
<pre class="CodePACKT"><span>#!/usr/bin/python3<br/></span><span>str = "Welcome to Python scripting world" <br/></span><span>str2 = str.replace("Python", "Shell")<br/></span><span>print(str2)</span></pre>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-693 image-border" src="assets/ad30521f-0df5-49e6-b500-1f411b6ede49.png" style="width:33.25em;height:6.58em;"/></div>
<p>To change the character case, you can use <kbd>upper()</kbd> and <kbd>lower()</kbd> functions:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-398 image-border" src="assets/2da7c9f9-6718-4ff1-914d-505e3c3f3fca.png" style="width:36.00em;height:7.42em;"/></div>
<p>As you can see, working with strings in Python is very simple. Python as an alternative scripting language is an awesome choice.</p>
<p>The power of Python lies in the libraries available out there. Literally, there are thousands of libraries for everything you can imagine.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article>
                
<p>This now finishes our look at Python and it certainly has been a brief tour. We can again emphasize the similarities that you will see in many languages and the importance of learning any coding language. What you learn in one language will help in most other languages that you come across.</p>
<p>What we learn from the Zen of Python will help us design and develop great code. We can print the Zen of Python using the following Python code:</p>
<pre><strong>&gt;&gt;&gt;import this</strong></pre>
<p>We can type the code on the REPL prompt. Keeping your code clean and well spaced-out will aid readability and ultimately this will help with code maintenance.</p>
<p>We have also seen that Python likes you to be explicit in your code and will not implicitly convert data types.</p>
<p>Finally, we saw how to manipulate strings using Python.</p>
<p>We are also at the end of the book but hopefully, the start of your scripting career. Good luck and thank you for reading.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Questions</h1>
                </header>
            
            <article>
                
<ol>
<li>How many characters will be printed from the following code?</li>
</ol>
<pre style="padding-left: 60px">#!/usr/bin/python3<br/>str = "Testing Python.."<br/>print(str[8:])</pre>
<ol start="2">
<li>How many words will be printed from the following code?</li>
</ol>
<pre style="padding-left: 60px">#!/usr/bin/python3<br/>print( len(sys.argv) )<br/>Solution: Nothing</pre>
<p style="padding-left: 60px"/>
<ol start="3">
<li>How many words will be printed from the following code?</li>
</ol>
<pre style="padding-left: 60px">#!/usr/bin/python3<br/>import sys<br/>print("Hello " + sys.argv[-1])</pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Further reading</h1>
                </header>
            
            <article>
                
<p>Please see the following for further reading relating to this chapter:</p>
<ul>
<li><a href="https://www.python.org/about/gettingstarted/">https://www.python.org/about/gettingstarted/</a></li>
<li><a href="https://docs.python.org/3/">https://docs.python.org/3/</a></li>
</ul>
<p> </p>


            </article>

            
        </section>
    </body></html>