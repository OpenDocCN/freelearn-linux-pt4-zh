- en: Scripts for System Administration Tasks
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 系统管理任务的脚本
- en: 'In this chapter, we will introduce the following topics:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将介绍以下主题：
- en: Gathering and aggregating system information
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 收集和聚合系统信息
- en: Gathering network information and connectivity diagnostics
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 收集网络信息和连接诊断
- en: Configuring basic network connectivity
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 配置基础网络连接
- en: Monitoring directories and files
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 监控目录和文件
- en: Compressing and archiving files
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 压缩和归档文件
- en: Rotating files from RAM to storage for log rotation
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将日志文件从 RAM 转移到存储器进行日志轮转
- en: Using Linux iptables for a firewall
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 Linux iptables 作为防火墙
- en: Accessing SQL databases remotely or locally
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 远程或本地访问 SQL 数据库
- en: Creating SSH keys for password less remote access
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为无密码远程访问创建 SSH 密钥
- en: Creating and configuring cron jobs for task scheduling
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为任务调度创建和配置 cron 作业
- en: Creating users and groups systematically
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 系统地创建用户和组
- en: Introduction
  id: totrans-13
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 介绍
- en: This chapter is about performing system administration tasks common to nearly
    all users and we'll be looking at logs, archiving them, job/task management, network
    connectivity, securing systems using a firewall (IPtables), monitoring directories
    for changes, and creating users. We will also acknowledge that users and administrators
    often have to access resources from other systems for resources such as SQL or
    they have to use SSH to log in to another system using only cryptographic keys—no
    passwords required!
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将讨论执行几乎所有用户常见的系统管理任务，我们将查看日志、归档日志、作业/任务管理、网络连接、使用防火墙（IPtables）保护系统、监控目录变化、创建用户。我们还将承认，用户和管理员经常需要从其他系统访问资源，例如
    SQL，或者他们必须使用 SSH 通过加密密钥登录到另一个系统——无需密码！
- en: This chapter also serves as a crash course on some critical components in today's
    computing environment: **networking**.  Users might not know what a port is, an
    IP address, or how to find **network interfaces** (**NICs**) on their computer.
    By the end of this chapter, beginners should be able to configure a network, and
    will have an improved level of competency when working with a network terminology.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 本章还充当了关于今天计算环境中一些关键组件的速成课程：**网络**。用户可能不知道端口是什么，IP 地址是什么，或者如何查找计算机上的**网络接口**（**NICs**）。本章结束时，初学者应该能够配置网络，并且在使用网络术语时能够提高他们的技能水平。
- en: Gathering and aggregating system information
  id: totrans-16
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 收集和聚合系统信息
- en: In this section, we are going to discuss the `dmidecode` Linux tool, which will
    gather information about the system such as CPU information, server, memory, and
    networking.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将讨论 `dmidecode` Linux 工具，它将收集系统信息，如 CPU 信息、服务器、内存和网络。
- en: Getting ready
  id: totrans-18
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: 'Besides having a terminal open, we need to remember a few concepts:'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 除了保持终端打开外，我们还需要记住一些概念：
- en: We are going to use some commands that will give us information about the Kernel,
    Linux distribution, physical server information, system uptime, network information,
    memory information, and CPU information.
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们将使用一些命令，这些命令将为我们提供关于内核、Linux 发行版、物理服务器信息、系统运行时间、网络信息、内存信息和 CPU 信息等方面的信息。
- en: By using this, anyone can create scripts to gather system information.
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过使用此方法，任何人都可以创建脚本来收集系统信息。
- en: How to do it...
  id: totrans-22
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'We can get details about the Linux distribution that you are working on. These
    distributions have a release file that you can locate in the `/etc/` folder. Now,
    open a terminal and enter the following command to get the information regarding
    the Linux distribution you are working on:'
  id: totrans-23
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们可以获取关于您正在使用的 Linux 发行版的详细信息。这些发行版有一个发行文件，您可以在`/etc/`文件夹中找到它。现在，打开终端并输入以下命令来获取有关您正在使用的
    Linux 发行版的信息：
- en: '[PRE0]'
  id: totrans-24
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'The preceding option has an alternative, and the alternative is the version
    file that''s present in the `/proc` folder. So, run the following command:'
  id: totrans-25
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 上述选项有一个替代方案，替代方案是位于`/proc`文件夹中的版本文件。所以，运行以下命令：
- en: '[PRE1]'
  id: totrans-26
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Now, run the following command to get the Kernel''s information:'
  id: totrans-27
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，运行以下命令以获取内核信息：
- en: '[PRE2]'
  id: totrans-28
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'System `uptime`: for information about this, create a script called `server_uptime.sh`:'
  id: totrans-29
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 系统`uptime`：有关此信息，请创建一个名为`server_uptime.sh`的脚本：
- en: '[PRE3]'
  id: totrans-30
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'Now, we will run the following commands to get the physical server''s information:'
  id: totrans-31
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，我们将运行以下命令来获取物理服务器的信息：
- en: '[PRE4]'
  id: totrans-32
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'Then, we will run the following command to get the CPU''s information:'
  id: totrans-33
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后，我们将运行以下命令来获取 CPU 的信息：
- en: '[PRE5]'
  id: totrans-34
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: You can get each CPU's information from the `cpuinfo` file, which is present
    in the `/proc` directory.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以从`/proc`目录中的`cpuinfo`文件获取每个 CPU 的信息。
- en: 'Network information: We are going to get the IP address by running the following
    command:'
  id: totrans-36
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 网络信息：我们将通过运行以下命令来获取IP地址：
- en: '[PRE6]'
  id: totrans-37
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'To get the MAC address, run the following command:'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 要获取MAC地址，请运行以下命令：
- en: '[PRE7]'
  id: totrans-39
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: You may replace `ens33` with `eth0`, depending on your network interface's information.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以根据你的网络接口信息将`ens33`替换为`eth0`。
- en: 'Memory information: To get the total number of slots, run the following command:'
  id: totrans-41
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 内存信息：要获取插槽总数，请运行以下命令：
- en: '[PRE8]'
  id: totrans-42
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'To get the total populated slots, run the following command:'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 要获取已填充的插槽总数，请运行以下命令：
- en: '[PRE9]'
  id: totrans-44
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'To get the total unpopulated slots, run the following command:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 要获取未填充的插槽总数，请运行以下命令：
- en: '[PRE10]'
  id: totrans-46
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: How it works...
  id: totrans-47
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: 'After running the `cat /etc/*-release` command, press *Enter* and you will
    get the output according to your Linux distribution. In my case, the output is
    as follows:'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 在运行`cat /etc/*-release`命令后，按*Enter*键，你将根据你的Linux发行版得到相应的输出。在我的情况下，输出如下：
- en: '[PRE11]'
  id: totrans-49
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'There is an alternate way to get system information. You can get the system
    information by running a version file from the `/proc` directory. After running
    the command, press *Enter*, and you will get the output according to your Linux
    distribution. In my case, the output is as follows:'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 获取系统信息的另一种方式是通过运行`/proc`目录下的版本文件。运行命令后，按*Enter*键，你将根据你的Linux发行版得到相应的输出。在我的情况下，输出如下：
- en: '[PRE12]'
  id: totrans-51
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: '`uname` is the tool that we are using to gather this information. Press *Enter*
    after running the command and you will get the Kernel information. In my case,
    the output is as follows:'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: '`uname`是我们用来收集这些信息的工具。运行命令后按*Enter*键，你将得到内核信息。在我的情况下，输出如下：'
- en: '[PRE13]'
  id: totrans-53
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: Execute the `$ bash server_uptime.sh` script—press *Enter* at the prompt and
    you will get the uptime of the server.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 执行`$ bash server_uptime.sh`脚本——在提示符下按*Enter*键，你将得到服务器的运行时间。
- en: To get the physical server information, we used the `dmidecode` tool. The first
    command is used to get the manufacturer's information, the second command is to
    get the model name, and the third command gets the serial number. While running
    a `dmidecode` command, you must be the root user.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 为了获取物理服务器信息，我们使用了`dmidecode`工具。第一个命令用于获取制造商信息，第二个命令用于获取型号名称，第三个命令用于获取序列号。在运行`dmidecode`命令时，你必须是root用户。
- en: 'The output snippet will look as follows:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 输出片段如下所示：
- en: '[PRE14]'
  id: totrans-57
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: To get each CPU’s information, we created a script. Execute the `$ sudo bash
    cpu_info.sh` script—press *Enter* at the prompt and you will get information for
    each CPU.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 为了获取每个CPU的信息，我们创建了一个脚本。执行`$ sudo bash cpu_info.sh`脚本——在提示符下按*Enter*键，你将得到每个CPU的信息。
- en: 'The output snippet will look like the following:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 输出片段如下所示：
- en: '[PRE15]'
  id: totrans-60
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'Network information: We ran the `ip` command to get the IP address and MAC
    address.'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 网络信息：我们运行了`ip`命令以获取IP地址和MAC地址。
- en: 'Memory information: We used the `dmidecode` tool to get the memory information
    such as the total number of slots, and the total populated and unpopulated slots.
    You must be the root user to run this command.'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 内存信息：我们使用`dmidecode`工具来获取内存信息，如插槽的总数，以及已填充和未填充的插槽数量。你必须是root用户才能运行此命令。
- en: Gathering network information and connectivity diagnostics
  id: totrans-63
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 收集网络信息和连接诊断
- en: In this section, we are going to test IPv4's connectivity and write scripts
    for it.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将测试IPv4的连接性并为其编写脚本。
- en: Getting ready
  id: totrans-65
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: 'Besides having a terminal open, we need to remember a few concepts:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 除了打开终端外，我们还需要记住一些概念：
- en: The If..Else condition case in shell scripting
  id: totrans-67
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Shell脚本中的If..Else条件语句
- en: IP address of the device
  id: totrans-68
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 设备的IP地址
- en: '`curl` command must be installed (you can install it by using the following
    command: `sudo apt install curl`)'
  id: totrans-69
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`curl`命令必须已安装（你可以通过运行以下命令来安装它：`sudo apt install curl`）'
- en: The purpose of this section is to show you how you can check network connectivity.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 本节的目的是向你展示如何检查网络连接。
- en: How to do it...
  id: totrans-71
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'Open a terminal and create the `test_ipv4.sh`script:'
  id: totrans-72
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开终端并创建`test_ipv4.sh`脚本：
- en: '[PRE16]'
  id: totrans-73
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'Now, to test IP connectivity and DNS, create a script called `test_ip_dns.sh`:'
  id: totrans-74
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，为了测试IP连接性和DNS，创建一个名为`test_ip_dns.sh`的脚本：
- en: '[PRE17]'
  id: totrans-75
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'Lastly, create a script called `test_web.sh` to test web connectivity:'
  id: totrans-76
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，创建一个名为`test_web.sh`的脚本来测试网页连接：
- en: '[PRE18]'
  id: totrans-77
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: How it works...
  id: totrans-78
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: Execute the script as `$ bash test_ipv4.sh`. Here, we are checking the connection
    with the `8.8.8.8`  IP address. For that, we use the `ping` command in the `if`
    condition. If the condition is `true,` we will get the statement written and printed
    on the screen as an if block. If not, the statement in `else` will be printed.
  id: totrans-79
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 执行脚本命令`$ bash test_ipv4.sh`。在这里，我们通过`8.8.8.8` IP地址检查连接。我们使用`ping`命令在`if`条件中进行测试。如果条件为`true`，我们将在屏幕上显示`if`块中的语句。如果不是，`else`中的语句将被打印出来。
- en: Execute the script as `$ bash test_ip_dns.sh`. Here, we are testing the connectivity
    using the hostname. We are also passing the `ping` command in the `if` condition
    and checking if the network is up or not. If the condition is `true`, we will
    get the statement written in an `if` block that's printed on the screen. If not,
    the statement in `else` will be printed.
  id: totrans-80
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 执行脚本命令`$ bash test_ip_dns.sh`。在这里，我们通过主机名测试网络连接。同时，我们在`if`条件中传递`ping`命令，检查网络是否正常。如果条件为`true`，我们将在屏幕上打印`if`块中的语句。如果不是，`else`中的语句将被打印出来。
- en: Execute the script as `$ bash test_web.sh`. Here, we are testing the web connectivity.
    We use the `case` statement here. We are using the curl tool in this case, which
    is used to transfer data to and from a server.
  id: totrans-81
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 执行脚本命令`$ bash test_web.sh`。在这里，我们测试Web连接。我们在这里使用`case`语句。我们使用curl工具进行数据传输，它可以与服务器进行数据交换。
- en: Configuring basic network connectivity
  id: totrans-82
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 配置基本的网络连接
- en: In this section, we are going to configure basic network connectivity using
    `wpa_supplicant`.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一部分，我们将使用`wpa_supplicant`配置基本的网络连接。
- en: Getting ready
  id: totrans-84
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: 'Besides having a terminal open, we need to remember a few concepts:'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 除了打开一个终端，我们还需要记住几个概念：
- en: Check whether `wpa_supplicant` is installed or not.
  id: totrans-86
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检查`wpa_supplicant`是否已安装。
- en: You should know the SSID and password.
  id: totrans-87
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你应该知道SSID和密码。
- en: Remember that you have to run your program as a root user.
  id: totrans-88
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 记住，你必须以root用户身份运行你的程序。
- en: How to do it...
  id: totrans-89
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'Create a script called `wifi_conn.sh` and write the following code in it:'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 创建一个名为`wifi_conn.sh`的脚本，并在其中写入以下代码：
- en: '[PRE19]'
  id: totrans-91
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: How it works...
  id: totrans-92
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: 'Execute the script using `sudo`:'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 使用`sudo`执行脚本：
- en: '[PRE20]'
  id: totrans-94
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: Monitoring directories and files
  id: totrans-95
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 监控目录和文件
- en: '`inotify` is a tool in Linux which is used to report when a file system event
    occurs. Using `inotify`, you can monitor individual files or directories.'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: '`inotify`是Linux中的一个工具，用于报告文件系统事件的发生。使用`inotify`，你可以监控单独的文件或目录。'
- en: Getting ready
  id: totrans-97
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: Make sure you have the `inotify` tool installed on your system.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 确保你的系统已安装`inotify`工具。
- en: How to do it...
  id: totrans-99
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'Create a script called `inotify_example.sh`:'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 创建一个名为`inotify_example.sh`的脚本：
- en: '[PRE21]'
  id: totrans-101
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: How it works...
  id: totrans-102
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: The `inotifywait` command is mostly used in shell scripting. The main purpose
    of the inotify tool is to monitor the directories and new files. It also monitors
    the changes in the files.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: '`inotifywait`命令主要用于Shell脚本中。`inotify`工具的主要目的是监控目录和新文件。它还监控文件的变化。'
- en: Compressing and archiving files
  id: totrans-104
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 压缩和归档文件
- en: There is a difference between a compressed and an archive file. So, what is
    an archive file? It is a collection of files and directories that are stored in
    a single file. An archive file is not a compressed file.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 压缩文件和归档文件是不同的。那么，什么是归档文件呢？它是将多个文件和目录存储在一个文件中的集合。归档文件不是压缩文件。
- en: What is a compressed file? This is a collection of files and directories stored
    in one file. It uses less disk space for storage.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 什么是压缩文件？这是一个将文件和目录存储在一个文件中的集合。它使用更少的磁盘空间进行存储。
- en: 'In this section, we are going to discuss two compression tools:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一部分，我们将讨论两个压缩工具：
- en: '`bzip2`'
  id: totrans-108
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`bzip2`'
- en: '`zip`'
  id: totrans-109
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`zip`'
- en: Getting ready
  id: totrans-110
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: You should have files to archive and compress.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 你应该有文件可以进行归档和压缩。
- en: How to do it...
  id: totrans-112
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'First, let''s see how we can compress the files:'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，让我们看看如何压缩文件：
- en: 'We are going to look at compression with the help of `bzip2`. Decide which
    file to compress and run the following command:'
  id: totrans-114
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们将通过`bzip2`来进行压缩。选择要压缩的文件并运行以下命令：
- en: '[PRE22]'
  id: totrans-115
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'Using `bzip2`, we can compress multiple files and directories at the same time.
    Just separate them by putting a space between each of them. You can compress it
    as follows:'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 使用`bzip2`，我们可以同时压缩多个文件和目录。只需在每个文件之间加上空格即可。你可以这样压缩：
- en: '[PRE23]'
  id: totrans-117
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: 'We are going to use `zip` for compression. By using the zip compression tool,
    files are compressed individually:'
  id: totrans-118
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们将使用`zip`进行压缩。使用zip压缩工具时，文件是单独压缩的：
- en: '[PRE24]'
  id: totrans-119
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: After running the preceding command, the file to be compressed or the directory
    to be compressed, such as `files_zip` will be compressed and you will get a compressed
    file called `file_name.zip`. The `-r` option includes all the files in the `files_dir`
    directory recursively.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 执行上述命令后，将被压缩的文件或目录（如`files_zip`）将被压缩，得到一个名为`file_name.zip`的压缩文件。`-r`选项递归包括`files_dir`目录中的所有文件。
- en: 'Now, let''s discuss how to archive files:'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们讨论如何归档文件：
- en: An archive file contains more than one file or directory. **Tar** is used to
    archive files without compression.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 归档文件包含多个文件或目录。**Tar** 用于无压缩的文件归档。
- en: 'The following are the two archiving modes:'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是两种归档模式：
- en: '`-x`: extract an archive'
  id: totrans-124
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-x`：解压归档文件'
- en: '`-c`: create an archive'
  id: totrans-125
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-c`：创建归档文件'
- en: 'Options:'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 选项：
- en: '`-f`: FILE name of the archive—you must specify this unless using tape drive
    for archive'
  id: totrans-127
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-f`：归档文件的文件名——除非使用磁带驱动器进行归档，否则必须指定此项'
- en: '`-v`: Be verbose, list all files being archived/extracted'
  id: totrans-128
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-v`：详细显示，列出所有正在归档/解压的文件'
- en: '`-z`: Create/extract archive with gzip/gunzip'
  id: totrans-129
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-z`：使用gzip/gunzip创建/解压归档文件'
- en: '`-j`: Create/extract archive with bzip2/bunzip2'
  id: totrans-130
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-j`：使用bzip2/bunzip2创建/解压归档文件'
- en: '`-J`: Create/extract archive with XZ'
  id: totrans-131
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-J`：使用XZ创建/解压归档文件'
- en: 'To create a TAR file, use the following command:'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 要创建一个TAR文件，使用以下命令：
- en: '[PRE25]'
  id: totrans-133
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: 'In this example, we are representing a file, which is created when we use the `tar`
    command. Its name is `filename.tar`. We can specify the directory or file in which
    we are putting archive files. We must specify it after inserting `filename.tar`.
    Multiple files and directories can archive at the same time, just leave a space
    between the file and directory names:'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个示例中，我们表示一个文件，该文件是在使用`tar`命令时创建的。它的名字是`filename.tar`。我们可以指定一个目录或文件来存放归档文件。我们必须在输入`filename.tar`之后指定它。多个文件和目录可以同时归档，只需在文件和目录名称之间留一个空格：
- en: '[PRE26]'
  id: totrans-135
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: After executing the preceding command, all the contents from work and school
    directories will be stored in the new file `filename.tar`.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 执行上述命令后，所有来自工作和学校目录的内容将被存储在新文件`filename.tar`中。
- en: After running the preceding command, all the contents from work and school subdirectories
    will be stored in the new file `filename.tar`.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 执行上述命令后，所有来自工作和学校子目录的内容将被存储在新文件`filename.tar`中。
- en: 'The following command is used to list the contents of a TAR file:'
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 以下命令用于列出TAR文件的内容：
- en: '[PRE27]'
  id: totrans-139
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: 'To extract the contents of a TAR file, use the following command:'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 要提取TAR文件的内容，使用以下命令：
- en: '[PRE28]'
  id: totrans-141
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: This command is used for extraction and it will not remove the TAR file. However,
    in your current working directory, you will find the unarchived contents.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 这个命令用于解压，它不会删除TAR文件。然而，在当前工作目录中，你将找到解压后的内容。
- en: How it works...
  id: totrans-143
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 它是如何工作的……
- en: '**bzip2** is used to compress the files and folder at the same time. Just issue
    the command in the terminal and the files will be compressed. After the compression,
    the compressed file will get the extension `.bz2`.'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: '**bzip2** 用于同时压缩文件和文件夹。只需在终端中输入命令，文件将被压缩。压缩后，压缩文件将获得`.bz2`扩展名。'
- en: '**zip** compress the files individually and then collects them in a single
    file.'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: '**zip** 将文件单独压缩，然后将它们汇集到一个文件中。'
- en: A TAR file is a collection of different files and directories, which combines
    them into one file. TAR is used for creating backups and archives.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: TAR文件是一个包含不同文件和目录的集合，它将这些文件和目录合并成一个文件。TAR用于创建备份和归档。
- en: Rotating files from RAM to storage for log rotation
  id: totrans-147
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 将文件从RAM转移到存储设备进行日志轮换
- en: In this section, we are going to discuss the logrotate Linux tool. Using this
    tool, administration of systems becomes easy. The systems generate large number
    of log files. This allows for automatic rotation, removal, compression, and mailing
    of log files.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将讨论logrotate Linux工具。使用此工具，系统管理变得更加轻松。系统会生成大量的日志文件。它允许自动轮换、删除、压缩和发送日志文件。
- en: 'We can handle each and every log file. We can handle them daily, weekly, and
    monthly. Using this tool, we can keep logs longer with less disk space. The default
    configuration file is `/etc/logrotate.conf`. Run the following command to see
    the contents of this file:'
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以处理每一个日志文件。我们可以按天、周、月来处理它们。通过使用此工具，我们可以在节省磁盘空间的同时，保持日志文件更长时间。默认的配置文件是`/etc/logrotate.conf`。运行以下命令查看此文件的内容：
- en: '[PRE29]'
  id: totrans-150
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: 'You will see the following:'
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 你将看到以下内容：
- en: '[PRE30]'
  id: totrans-152
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: Getting ready
  id: totrans-153
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: To use logrotator, you must be aware of the `logrotate` command.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 要使用logrotator，必须了解`logrotate`命令。
- en: How to do it...
  id: totrans-155
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作……
- en: We are going to look at an example configuration.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将查看一个示例配置。
- en: 'We have two options for managing log files:'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 我们有两种管理日志文件的选项：
- en: Create a new configuration file and store it in `/etc/logrotate.d/`. This configuration
    file will be executed daily along with other standard jobs. This will be with
    root privileges.
  id: totrans-158
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个新的配置文件并将其存储在 `/etc/logrotate.d/` 中。这个配置文件会与其他标准任务一起每日执行，并且会使用根用户权限。
- en: Create a new configuration file and execute it independently. This will execute
    with non-root privileges. This way, you can execute it manually, at whatever times
    you want.
  id: totrans-159
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个新的配置文件并独立执行。这样会以非根用户权限执行。通过这种方式，你可以手动执行，随时按需求执行。
- en: Adding configuration to /etc/logrotate.d/
  id: totrans-160
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 将配置添加到 /etc/logrotate.d/
- en: Now, we will configure a web server. This puts information like `access.log`
    and `error.log` into the `/var/log/example-app`. It will act as a data user or
    group.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们将配置一个 Web 服务器。它将像 `access.log` 和 `error.log` 这样的信息放入 `/var/log/example-app`。它将充当数据用户或组。
- en: 'To add some configuration to `/etc/logrotate.d/`, first open up a new file
    there:'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 要向 `/etc/logrotate.d/` 添加配置，首先打开一个新文件：
- en: '[PRE31]'
  id: totrans-163
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: 'Write the following code in `example-app`:'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 在 `example-app` 中写入以下代码：
- en: '[PRE32]'
  id: totrans-165
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: 'Some of the new configuration directives in this file are as follows:'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 此文件中的一些新配置指令如下：
- en: '`create 0640 www-data www-data`: After rotation, this will create a new empty
    log file with specified permissions for the owner and group.'
  id: totrans-167
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`create 0640 www-data www-data`：旋转后，这将创建一个新的空日志文件，并为所有者和组设置指定的权限。'
- en: '`sharedscripts`: This means that configuration scripts are run only once per
    run instead of there being a rotation for each file.'
  id: totrans-168
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`sharedscripts`：这意味着配置脚本在每次运行时仅执行一次，而不是为每个文件进行轮换。'
- en: '`postrotate` to `endscript`: This particular block has a script that has code
    for running after the log file is rotated. Using this, our application can switch
    over to the newly created log file.'
  id: totrans-169
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`postrotate` 到 `endscript`：这个特定的块包含在日志文件旋转后执行的脚本。使用这个，我们的应用程序可以切换到新创建的日志文件。'
- en: How it works...
  id: totrans-170
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: 'We can customize the `.config` file according to our needs and then save that
    file in `/etc/logrotate.d`. For that, run the following command:'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以根据需要自定义 `.config` 文件，然后将其保存在 `/etc/logrotate.d` 中。为此，运行以下命令：
- en: '[PRE33]'
  id: totrans-172
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: After running this command, logrotate will point the standard configuration
    file, and then it will be on debug mode. It will give us the information about
    the files which logrotate is handling.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 运行此命令后，logrotate 将指向标准配置文件，然后进入调试模式。它会提供有关 logrotate 正在处理的文件的信息。
- en: Using Linux iptables for a firewall
  id: totrans-174
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 Linux iptables 作为防火墙
- en: In this section, we are going to set up a firewall using iptables. **iptables**
    is the standard firewall software present in most Linux distributions. We are
    going to use these set of rules to filter the network traffic. You can protect
    the server from unwanted traffic by filtering the data packets by specifying the
    source or destination IP address, port addresses, protocol types, network interfaces,
    and so on. We can configure this for accepting, rejecting, or forwarding network
    packets.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一部分中，我们将使用 iptables 设置防火墙。**iptables** 是大多数 Linux 发行版中存在的标准防火墙软件。我们将使用这些规则来过滤网络流量。通过指定源或目标
    IP 地址、端口地址、协议类型、网络接口等，可以通过过滤数据包来保护服务器免受不必要的流量。我们可以配置它来接受、拒绝或转发网络数据包。
- en: Rules are arranged in chains. By default, there are three chains (input, output,
    and forward). The input chain handles incoming traffic, while the output chain
    handles outgoing traffic. The forward chain handles routing traffic. Each chain
    has a default policy to adhere to if network packets do not match any policy inside
    the chain.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 规则按链排列。默认情况下，有三个链（input、output 和 forward）。输入链处理传入流量，而输出链处理传出流量。转发链处理路由流量。如果网络数据包与链中的任何策略不匹配，则每个链都有一个默认策略。
- en: Getting ready
  id: totrans-177
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: 'Please check that the following requirements are satisfied before proceeding
    to the next activity:'
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 请在继续下一项活动之前检查以下要求是否已满足：
- en: Root privileges
  id: totrans-179
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 根用户权限
- en: SSH access (command line access to the server)
  id: totrans-180
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: SSH 访问（命令行访问服务器）
- en: Make sure you have gt and looptools installed in your Linux environment
  id: totrans-181
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 确保你的 Linux 环境中已安装 gt 和 looptools
- en: Basic skills for working on a Linux environment
  id: totrans-182
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 Linux 环境中工作的基本技能
- en: How to do it...
  id: totrans-183
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'Now, we are going to see some of the `iptables` commands:'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们将查看一些 `iptables` 命令：
- en: 'Run the following command to list all the rules that are set on the server:'
  id: totrans-185
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 运行以下命令列出服务器上设置的所有规则：
- en: '[PRE34]'
  id: totrans-186
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: 'To allow incoming traffic from a specific port, use the following command:'
  id: totrans-187
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要允许来自特定端口的传入流量，请使用以下命令：
- en: '[PRE35]'
  id: totrans-188
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: This rule will allow incoming traffic from port `4321`. The firewall needs to
    be restarted to make this rule effective.
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 这条规则将允许来自端口`4321`的传入流量。需要重启防火墙才能使此规则生效。
- en: 'Using `iptables`, you can block the incoming traffic. For that, run the following
    command:'
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 `iptables`，你可以阻止传入的流量。为此，运行以下命令：
- en: '[PRE36]'
  id: totrans-191
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: 'If any new rules are added in the `iptables`, we should save them first. Otherwise,
    after a system reboot, they will disappear. Run the following command to saving
    the `iptables` after adding new rules:'
  id: totrans-192
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果在 `iptables` 中添加了新的规则，我们应该先保存它们。否则，在系统重启后，它们将消失。添加新规则后，运行以下命令以保存 `iptables`：
- en: '[PRE37]'
  id: totrans-193
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: The default file where rules are saved might differ depending on which Linux
    distribution you are working on.
  id: totrans-194
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 默认保存规则的文件可能会有所不同，这取决于你使用的 Linux 发行版。
- en: 'We can save rules in a specific file by using the following command:'
  id: totrans-195
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们可以使用以下命令将规则保存到特定文件中：
- en: '[PRE38]'
  id: totrans-196
  prefs: []
  type: TYPE_PRE
  zh: '[PRE38]'
- en: 'You can restore these rules that are saved in the file. Run the following command:'
  id: totrans-197
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你可以恢复保存在文件中的这些规则。运行以下命令：
- en: '[PRE39]'
  id: totrans-198
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: How it works...
  id: totrans-199
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: Using iptables, we can control the incoming traffic, drop the traffic on a specific
    port, and add new rules and save them.
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 iptables，我们可以控制传入的流量、丢弃特定端口的流量、添加新规则并保存它们。
- en: Accessing SQL databases remotely or locally
  id: totrans-201
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 远程或本地访问 SQL 数据库
- en: In this section, we are going to learn how to automate SQL queries by connecting
    to a server using a shell script. Bash scripting is used for automating things.
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将学习如何通过使用 shell 脚本连接到服务器来自动化 SQL 查询。Bash 脚本用于自动化操作。
- en: Getting ready
  id: totrans-203
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备就绪
- en: Make sure that `mysql`, `postgres`, and `sqlite` are installed. Ensure that
    the user is created in MySQL and that you have granted permission to that user.
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 确保已经安装了 `mysql`、`postgres` 和 `sqlite`。确保 MySQL 中已创建用户，并且你已经为该用户授予了权限。
- en: How to do it...
  id: totrans-205
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'MySQL queries in script: We are going to write a script called `mysql_version.sh`
    to get the latest version of MySQL:'
  id: totrans-206
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 脚本中的 MySQL 查询：我们将编写一个名为 `mysql_version.sh` 的脚本，以获取 MySQL 的最新版本：
- en: '[PRE40]'
  id: totrans-207
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: 'Now, we are going to create a script called `create_database.sh` to create
    the database:'
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们将创建一个名为 `create_database.sh` 的脚本来创建数据库：
- en: '[PRE41]'
  id: totrans-209
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: 'SQLite queries in script: Now, we are going to create a `sqlite` database.
    You can create the `sqlite` database by simply writing `sqlite3` and a name for
    the database. For example:'
  id: totrans-210
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 脚本中的 SQLite 查询：现在，我们将创建一个 `sqlite` 数据库。你只需写下 `sqlite3` 和数据库的名称即可创建 `sqlite`
    数据库。例如：
- en: '[PRE42]'
  id: totrans-211
  prefs: []
  type: TYPE_PRE
  zh: '[PRE42]'
- en: 'Now, we are going to create a table in the `sqlite` console. Enter `sqlite3
    testdb` and press *Enter—*you will see the sqlite3 console. Now, write the `create
    table` command to create a table:'
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们将在 `sqlite` 控制台中创建一个表。输入 `sqlite3 testdb` 并按 *Enter*——你将看到 sqlite3 控制台。现在，写入
    `create table` 命令以创建表：
- en: '[PRE43]'
  id: totrans-213
  prefs: []
  type: TYPE_PRE
  zh: '[PRE43]'
- en: 'Postgres queries in scripting: Now, we are going to check the postgresql database
    version. Here, `testdb` is our database name, which is what we created earlier.
    For that, run the following command:'
  id: totrans-214
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 脚本中的 Postgres 查询：现在，我们将检查 PostgreSQL 数据库的版本。这里，`testdb`是我们的数据库名称，也是我们之前创建的。为此，运行以下命令：
- en: '[PRE44]'
  id: totrans-215
  prefs: []
  type: TYPE_PRE
  zh: '[PRE44]'
- en: 'Now, we are going to create a table. For that, run the following command:'
  id: totrans-216
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，我们将创建一个表。为此，运行以下命令：
- en: '[PRE45]'
  id: totrans-217
  prefs: []
  type: TYPE_PRE
  zh: '[PRE45]'
- en: How it works...
  id: totrans-218
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: We are creating bash scripts to check the version of a database and to create
    a new database. In these scripts, we are using the root user and there is a password
    present right after `-p` for that user. You can use the `root` user or else you
    can create a new user, assign a password to it, and use that user in your scripts.
  id: totrans-219
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们正在编写 bash 脚本，以检查数据库的版本并创建新数据库。在这些脚本中，我们使用 root 用户，并且该用户的密码会紧随 `-p` 后。你可以使用
    `root` 用户，或者可以创建一个新用户，分配密码，并在脚本中使用该用户。
- en: SQLite software provides us with a simple command-line interface. Using this
    interface, we can manually enter and execute SQL commands. You can list the database
    using the dot (`.`) operator. `.databases` and `.tables` are used to list all
    the tables in the database.
  id: totrans-220
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: SQLite 软件为我们提供了一个简单的命令行界面。通过这个界面，我们可以手动输入和执行 SQL 命令。你可以使用点（`.`）操作符列出数据库。`.databases`
    和 `.tables` 用于列出数据库中的所有表。
- en: In PostgreSQL, first we are changing the user from student to postgres. Then,
    we enter `psql` to start the `postgres` command-line console. In that console,
    we must create the `testdb` database. To come out of the console, run the `\quit`
    command. Now, once again, start the `testdb` console by typing `psql testdb` and
    pressing *Enter.* Now, create a table in that database.
  id: totrans-221
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在PostgreSQL中，首先我们将用户从student更改为postgres。然后，输入 `psql` 启动 `postgres` 命令行控制台。在该控制台中，我们必须创建 `testdb`
    数据库。要退出控制台，请运行 `\quit` 命令。现在，再次启动 `testdb` 控制台，输入 `psql testdb` 并按 *Enter.* 现在，在该数据库中创建一个表。
- en: Creating SSH keys for password less remote access
  id: totrans-222
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 为密码无障碍远程访问创建SSH密钥
- en: In this section, we are going to learn how to log in without a password using
    SSH. **SSH** is an open source network protocol and is used to log in to the remote
    servers to perform some actions. We can use the SSH protocol to transfer files
    from one computer to another. SSH uses public key cryptography.
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将学习如何使用SSH无密码登录。**SSH** 是一个开源网络协议，用于登录远程服务器执行某些操作。我们可以使用SSH协议将文件从一台计算机传输到另一台计算机。SSH使用公钥加密。
- en: Getting ready
  id: totrans-224
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备就绪
- en: Make sure you have SSH access.
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 确保您具有SSH访问权限。
- en: How to do it...
  id: totrans-226
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'First, we are going to create a SSH key. The `ssh-keygen` command is used to
    create a SSH key. Run the command as follows:'
  id: totrans-227
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，我们将创建一个SSH密钥。使用 `ssh-keygen` 命令来创建SSH密钥。运行以下命令：
- en: '[PRE46]'
  id: totrans-228
  prefs: []
  type: TYPE_PRE
  zh: '[PRE46]'
- en: 'You will get the following output:'
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 您将获得以下输出：
- en: '[PRE47]'
  id: totrans-230
  prefs: []
  type: TYPE_PRE
  zh: '[PRE47]'
- en: 'Now, we will copy the SSH public key to the remote host. Run the following
    command:'
  id: totrans-231
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，我们将SSH公钥复制到远程主机。运行以下命令：
- en: '[PRE48]'
  id: totrans-232
  prefs: []
  type: TYPE_PRE
  zh: '[PRE48]'
- en: 'Now, you can log in to the remote host without a password. Run the `ssh` command
    as follows:'
  id: totrans-233
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，您可以无密码登录到远程主机。运行以下 `ssh` 命令：
- en: '[PRE49]'
  id: totrans-234
  prefs: []
  type: TYPE_PRE
  zh: '[PRE49]'
- en: Creating and configuring cron Jobs for task scheduling
  id: totrans-235
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建和配置cron作业以进行任务调度
- en: In this section, we are going to learn how to configure Cron Jobs. We are going
    to use crontab to set up a Cron Job.
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将学习如何配置Cron作业。我们将使用crontab设置Cron作业。
- en: How to do it...
  id: totrans-237
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'Open your terminal and go to the `/etc` folder and check the `/cron` folders.
    You will see the following cron folders:'
  id: totrans-238
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开您的终端并转到 `/etc` 文件夹并检查 `/cron` 文件夹。您将看到以下cron文件夹：
- en: '`/etc/cron.hourly`'
  id: totrans-239
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/etc/cron.hourly`'
- en: '`/etc/cron.daily`'
  id: totrans-240
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/etc/cron.daily`'
- en: '`/etc/cron.weekly`'
  id: totrans-241
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/etc/cron.weekly`'
- en: '`/etc/cron.monthly`'
  id: totrans-242
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/etc/cron.monthly`'
- en: Now, we will copy our shell script into one the preceding folders.
  id: totrans-243
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，我们将把我们的Shell脚本复制到其中一个上述文件夹中。
- en: If you need to run your shell script to run daily, place it in the `cron.daily`
    folder. If you need to run it hourly, place it in the `cron.hourly` folder, and
    so on.
  id: totrans-244
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果需要每天运行您的Shell脚本，请将其放在 `cron.daily` 文件夹中。如果需要每小时运行，请将其放在 `cron.hourly` 文件夹中，依此类推。
- en: 'Example: Write a script and place it in the `cron.daily` folder. Make the script
    executable by giving the necessary permissions.'
  id: totrans-245
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 示例：编写一个脚本并将其放在 `cron.daily` 文件夹中。通过授予必要的权限使脚本可执行。
- en: 'Now, run the `crontab` command:'
  id: totrans-246
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，运行 `crontab` 命令：
- en: '[PRE50]'
  id: totrans-247
  prefs: []
  type: TYPE_PRE
  zh: '[PRE50]'
- en: 'Press *Enter* and it will ask for the editor of your type. By default, it will
    open `vi` editor. In my case, I selected `nano`. Now, create a `cron` command.
    The syntax for creating the `cron` command is:'
  id: totrans-248
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按下*Enter*，它将询问您的编辑器类型。默认情况下，它将打开`vi`编辑器。在我的情况下，我选择了`nano`。现在，创建一个`cron`命令。创建`cron`命令的语法是：
- en: The number of minutes after the hour (0 to 59)
  id: totrans-249
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 小时后的分钟数（0到59）
- en: The hour in military time (24 hour) format (0 to 23)
  id: totrans-250
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 小时的军用时间格式（24小时制）（0到23）
- en: The day of the month (1 to 31)
  id: totrans-251
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 月份的日期（1到31）
- en: The month (1 to 12)
  id: totrans-252
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 月份（1到12）
- en: The day of the week (0 or 7 is Sunday, or use the appropriate name)
  id: totrans-253
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一周的日期（0或7是星期日，或使用适当的名称）
- en: The command to run
  id: totrans-254
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 要运行的命令
- en: If you enter `*` in all options before the script name, you script will execute,
    every minute of every hour, of every day of the month, of every month and every
    day in the week.
  id: totrans-255
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果在脚本名称之前的所有选项中输入`*`，则脚本将每分钟执行，每小时执行一次，每月的每一天执行一次，每年的每个月和每周的每一天执行一次。
- en: 'Now, add the following line in your script:'
  id: totrans-256
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，在您的脚本中添加以下行：
- en: '[PRE51]'
  id: totrans-257
  prefs: []
  type: TYPE_PRE
  zh: '[PRE51]'
- en: Save the file and exit.
  id: totrans-258
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 保存文件并退出。
- en: 'You can list the existing jobs by running the following command:'
  id: totrans-259
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您可以通过运行以下命令列出现有作业：
- en: '[PRE52]'
  id: totrans-260
  prefs: []
  type: TYPE_PRE
  zh: '[PRE52]'
- en: 'To remove the existing Cron Job, delete the line that contains your Cron Job
    and save it. Run the following command:'
  id: totrans-261
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要删除现有的Cron作业，请删除包含您的Cron作业的行并保存它。运行以下命令：
- en: '[PRE53]'
  id: totrans-262
  prefs: []
  type: TYPE_PRE
  zh: '[PRE53]'
- en: How it works...
  id: totrans-263
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 工作原理...
- en: We used the `crontab` command to add and delete the Cron Job. Use the appropriate
    settings to execute your script daily, hourly, monthly, and weekly.
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
  zh: 我们使用 `crontab` 命令添加和删除Cron作业。使用适当的设置每天、每小时、每月和每周执行您的脚本。
- en: Creating users and groups systematically
  id: totrans-265
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 有系统地创建用户和组
- en: In this section, we are going to learn how to create users and groups through
    a shell script.
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将学习如何通过 shell 脚本创建用户和组。
- en: How to do it...
  id: totrans-267
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何实现...
- en: Now, we will create a script to add a user. The `useradd` command is used to
    create a user. We are going to use the `while` loop, which will read our `.csv`
    file, and we will use the `for` loop to add each user that's present in that `.csv`
    file.
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们将创建一个脚本来添加用户。`useradd` 命令用于创建用户。我们将使用 `while` 循环，它将读取我们的 `.csv` 文件，并且我们将使用
    `for` 循环来添加 `.csv` 文件中存在的每个用户。
- en: 'Create a script using `add_user.sh`:'
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 `add_user.sh` 创建脚本：
- en: '[PRE54]'
  id: totrans-270
  prefs: []
  type: TYPE_PRE
  zh: '[PRE54]'
- en: How it works...
  id: totrans-271
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: In this recipe, we have used `while` and `for` loops. The `while` loop will
    read our `.csv` file. It will create arrays for each column. We used `-d` for
    the home directory, `-s` for the bash shell, and `-p` for the password.
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个例子中，我们使用了 `while` 和 `for` 循环。`while` 循环将读取我们的 `.csv` 文件，它将为每一列创建数组。我们使用了
    `-d` 来指定主目录，`-s` 来指定 bash shell，`-p` 来指定密码。
