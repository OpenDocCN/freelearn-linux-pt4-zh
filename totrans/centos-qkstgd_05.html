<html><head></head><body><div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Managing File Permissions</h1>
                </header>
            
            <article>
                
<p><span><span><span>Permissions are one of several good</span></span></span> <span><span><span>features that make</span></span></span> <span><span><span>L</span></span></span><span><span><span>inux more secure when applied properly. Since</span></span></span> <span><span><span>L</span></span></span><span><span><span>inux is a multi-user OS, different users will be working with multiple programs and files, and so on. Permissions help keep things secure and organized. In this chapter, you will learn how to manage access controls on files using basic read, write, and execute permissions and user or group ownership. You will also learn to apply special permissions and the <strong>access control list</strong> (</span></span></span><strong>ACL</strong>)<span><span><span>.</span></span></span></p>
<p>In this chapter, we will cover the following topics:</p>
<ul>
<li>Understanding Linux filesystem permissions</li>
<li>Managing file permissions </li>
<li>Managing file ownership</li>
<li>Special permissions</li>
<li>Managing default permissions</li>
<li>Managing ACL on files</li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Understanding Linux filesystem permissions</h1>
                </header>
            
            <article>
                
<p>On Linux/Unix-based operating systems, every file belongs to a user and to a group. By default, the user who creates the file is the owner of that file and <span>the file</span> belongs to that user's primary group. Access to the file via the Linux filesystem is controlled by permissions applied to that file. These permissions are classified for the owner (also known as the <strong>user</strong>) of the file, group (also known as the <strong>group owner</strong>) of that file, and for everybody <span>else </span>(also known as <strong>others</strong>) in the Linux system.</p>
<p>There are three types of standard permissions that are applied to files:</p>
<ul>
<li>Read, represented by the letter <kbd>r</kbd></li>
<li>Write, represented by the letter <kbd>w</kbd></li>
<li>Execute, represented by the letter <kbd>x</kbd></li>
</ul>
<p>These are generally grouped in triplets (<span>such as <kbd>rwx</kbd> or <kbd>r-w</kbd>)</span> to represent a class of permissions. Each file has three classes of permissions; that is, these permissions affect access to three categories in the system:</p>
<ul>
<li><strong>User/owner (u)</strong>:<span> Describes permissions applicable to the user who is the owner of that file. By default, it is the user who creates the file.</span></li>
<li><strong>Group (g)</strong>: <span>Describes permissions applicable to the group that owns the file.</span></li>
<li><strong>Others/everyone else (o)</strong>: Describes permissions for everybody else in the system.</li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Effect of permissions on files and directories</h1>
                </header>
            
            <article>
                
<p>The permissions control access to files and directories. The same permissions have different effects on files and directories.</p>
<p>Here is a table listing the permissions and the corresponding effect of permissions on the file and directories:</p>
<table style="border-collapse: collapse;width: 100%" border="1">
<tbody>
<tr>
<td style="width: 99.6px">
<p class="CDPAlignCenter CDPAlign"><strong>Permission</strong></p>
</td>
<td style="width: 173.4px">
<p class="CDPAlignCenter CDPAlign"><strong>Effect on files</strong></p>
</td>
<td style="width: 438px">
<p class="CDPAlignCenter CDPAlign"><strong>Effect on directories</strong></p>
</td>
</tr>
<tr>
<td style="width: 99.6px">
<p>Read (<kbd>r</kbd>)</p>
</td>
<td style="width: 173.4px">
<p>Contents of file can be read</p>
</td>
<td style="width: 438px">
<p>Contents of directory can be listed using the <kbd>ls</kbd> command</p>
</td>
</tr>
<tr>
<td style="width: 99.6px">
<p>Write (<kbd>w</kbd>)</p>
</td>
<td style="width: 173.4px">
<p>Contents of file can be modified</p>
</td>
<td style="width: 438px">
<p>We can create or delete files and modify permissions on the files or directory</p>
</td>
</tr>
<tr>
<td style="width: 99.6px">
<p>Execute (<kbd>x</kbd>)</p>
</td>
<td style="width: 173.4px">
<p>We can execute files as commands</p>
</td>
<td style="width: 438px">
<p>Contents of directory can be accessed (we can use the <kbd>cd</kbd> command on that directory)</p>
</td>
</tr>
</tbody>
</table>
<p> </p>
<p>If a user has read permission on a directory, it means they can list the names of files in it using the <kbd>ls</kbd> command only. If a user has only execute permission on a directory, then they cannot list the contents of the directory with the <kbd>ls</kbd> command; however, if a user knows the contents of the directory, they can access the contents explicitly by accessing the filename.</p>
<p>Any user can delete a file or sub-directory if they have write permission to the directory in which the file resides, irrespective of the ownership or permission on the file itself. Root has full control of permissions; it can access or delete any file in the filesystem. However, there are some advance permissions such as <kbd>chattr</kbd> and <strong>Security-Enhanced Linux</strong> (<strong>SELinux</strong>) controls, which can be used to <span>create</span> access controls for root. SELinux is a mandatory access control, which is discussed in <a href="6aff4224-a804-4b36-b692-4959e8937beb.xhtml">Chapter 9</a>, <em>Overview and Essential Advance Utilities</em>.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Viewing applied permissions and ownership</h1>
                </header>
            
            <article>
                
<p>The <kbd>ls</kbd> command with the <kbd>-l</kbd> option is used to get detailed information on the directory contents, which includes permissions and ownership. It will list the detailed information of all the files that reside in the directory. To prevent the descent into the directory and view the information of the directory itself, use the <kbd>-d</kbd> option with the <kbd>ls</kbd> command, as shown in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img src="Images/46c3e54c-48be-4608-8b17-6c0b2a35864f.png" style="width:25.92em;height:6.67em;" width="521" height="134"/></p>
<p>The first character in a long listing tells us the type of file. A hyphen (<kbd>-</kbd>) sign here represents a regular file that can contain data or text, or it can be a binary file. The following table lists various types of files and their identifiers used as the first character in a long-listing format.</p>
<p>Here is a table listing file types and their descriptions:</p>
<table style="border-collapse: collapse;width: 100%" border="1">
<tbody>
<tr>
<td style="width: 83.2px">
<p class="CDPAlignCenter CDPAlign"><strong>Type</strong></p>
</td>
<td style="width: 361.8px">
<p class="CDPAlignCenter CDPAlign"><strong>Description</strong></p>
</td>
</tr>
<tr>
<td style="width: 83.2px">
<p><kbd>-</kbd></p>
</td>
<td style="width: 361.8px">
<p>File</p>
</td>
</tr>
<tr>
<td style="width: 83.2px">
<p><kbd>d</kbd></p>
</td>
<td style="width: 361.8px">
<p>Directory</p>
</td>
</tr>
<tr>
<td style="width: 83.2px">
<p><kbd>l</kbd></p>
</td>
<td style="width: 361.8px">
<p>Link (symbolic link similar to shortcuts on Windows)</p>
</td>
</tr>
<tr>
<td style="width: 83.2px">
<p><kbd>c</kbd></p>
</td>
<td style="width: 361.8px">
<p>Character-type device files</p>
</td>
</tr>
<tr>
<td style="width: 83.2px">
<p><kbd>b</kbd></p>
</td>
<td style="width: 361.8px">
<p>Block-type device files</p>
</td>
</tr>
<tr>
<td style="width: 83.2px">
<p><kbd>s</kbd></p>
</td>
<td style="width: 361.8px">
<p>Socket-type files</p>
</td>
</tr>
<tr>
<td style="width: 83.2px">
<p><kbd>p</kbd></p>
</td>
<td style="width: 361.8px">
<p>Named pipes</p>
</td>
</tr>
</tbody>
</table>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Managing file permissions</h1>
                </header>
            
            <article>
                
<p>The <kbd>chmod</kbd> command is used to modify the permissions on a file. <strong>Change mode</strong> (<strong>chmod</strong>) <span>permissions are also known as </span><strong>modes</strong><span> of a file. </span>Using <kbd>chmod</kbd>, we can modify permissions separately for the owner, group, and the rest of the world (others) in the system. There are two ways in which we can modify permissions with <kbd>chmod</kbd>: one is by using numbers and the other is by using symbolic notations.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Modifying file permissions with chmod using symbols</h1>
                </header>
            
            <article>
                
<p>The <kbd>chmod</kbd> command is used to change the permission or mode of a file or directories. It takes the new set of permissions as the first argument, followed by the list of files and directories, to apply those new permissions. The symbolic method has the following syntax:</p>
<pre><strong>$ chmod     whowhatwhich    file   |   directory</strong></pre>
<p>Here is a table listing the keywords used with <kbd>chmod</kbd> and their descriptions:</p>
<table style="border-collapse: collapse;width: 100%" border="1">
<tbody>
<tr>
<td>
<p class="CDPAlignLeft CDPAlign"><strong>Keyword</strong></p>
</td>
<td>
<p class="CDPAlignCenter CDPAlign"><strong>Description</strong></p>
</td>
</tr>
<tr>
<td>
<p>Who</p>
</td>
<td>
<p>It represents whose permission you want to change:</p>
<p><kbd>u</kbd>: User permissions</p>
<p><kbd>g</kbd>: Group permissions</p>
<p><kbd>o</kbd>: Other permissions</p>
<p><kbd>a</kbd>: All user permissions</p>
<p>If nothing is specified in this field, it takes (<kbd>a</kbd>) as the default value.</p>
</td>
</tr>
<tr>
<td>
<p>What</p>
</td>
<td>
<p>It represents what you want to do with permissions:</p>
<p><kbd>+</kbd>: Add some permissions in the existing set of permissions</p>
<p><kbd>-</kbd>: Remove some permissions from the existing set of permissions</p>
<p><kbd>=</kbd>: Set exactly the specified permissions, irrespective of the existing set of permissions</p>
</td>
</tr>
<tr>
<td>
<p>Which</p>
</td>
<td>
<p>It represents which permissions you are using:</p>
<p><kbd>r</kbd>: Read</p>
<p><kbd>w</kbd>: Write</p>
<p><kbd>x</kbd>: Execute</p>
</td>
</tr>
</tbody>
</table>
<p> </p>
<p>The following are some examples to illustrate the usage of the <kbd>chmod</kbd> command, using symbols:</p>
<p>List the existing permissions of the file named <kbd>myfile</kbd>,as shown in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img src="Images/799b3948-63ea-4fd8-b955-710dafe58b79.png" style="width:24.42em;height:4.17em;" width="515" height="88"/></p>
<p>Add execute permission for the user to the file named <kbd>myfile</kbd>, as shown in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img src="Images/808aea79-61a4-4400-b22d-0219b3900ffc.png" style="width:24.83em;height:4.25em;" width="518" height="89"/></p>
<p>Remove the write permission from the group and add the execute permission for others to the file named <kbd>myfile</kbd>, as shown in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img src="Images/8b84f58e-8ef7-4a4f-b843-af6dea0e0c04.png" style="width:25.00em;height:4.25em;" width="518" height="89"/></p>
<p>Set the read permission exactly and remove any existing permissions for all to the file named <kbd>myfile</kbd>, as shown in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img src="Images/56a52c2b-f8e7-4695-a6d6-58cce34c2d9a.png" style="width:25.83em;height:4.42em;" width="517" height="88"/></p>
<p>Set the execute permission exactly and remove any existing permissions for all from the file named <kbd>myfile</kbd>, as shown in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img src="Images/a2f22842-1b8d-46ed-ad67-be8bcd23ec53.png" style="width:25.83em;height:4.42em;" width="516" height="89"/></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Managing file permissions with chmod using numbers</h1>
                </header>
            
            <article>
                
<p>The <kbd>chmod</kbd> command can also be used to modify file or directory permissions, using the numeric method. This method sets exactly the new permissions specified, using numbers with the <kbd>chmod</kbd> command, irrespective of the existing permissions of the file or directory. In the numeric method, permissions are represented by three-digit (or four-digit when setting special permissions) octal numbers. Each octal number represents a number between zero and seven, which is the sum of permissions for an access level—either a user, group, or others. The syntax to apply permissions using numbers is as follows:</p>
<pre><strong>$ chmod     ###     file   |    directory</strong></pre>
<p>Here, each <kbd>#</kbd> represents permissions for a user, group, and other access levels, starting from left to right. It is the sum of all the permissions (read, write, and execute) of that access level, where each permission has a certain numeric weightage, as follows:</p>
<p>Here is a table listing the numeric weightage of permissions:</p>
<table style="border-collapse: collapse;width: 100%" border="1">
<tbody>
<tr>
<td>
<p class="CDPAlignCenter CDPAlign"><strong>Permission</strong></p>
</td>
<td>
<p class="CDPAlignCenter CDPAlign"><strong>Numeric weightage</strong></p>
</td>
</tr>
<tr>
<td>
<p>Read (<kbd>r</kbd>)</p>
</td>
<td>
<p>4</p>
</td>
</tr>
<tr>
<td>
<p>Write (<kbd>w</kbd>)</p>
</td>
<td>
<p>2</p>
</td>
</tr>
<tr>
<td>
<p>Execute (<kbd>x</kbd>)</p>
</td>
<td>
<p>1</p>
</td>
</tr>
</tbody>
</table>
<p> </p>
<p>When setting permissions using the numeric method, we calculate the total sum of permissions we need for the user, group, or others; for example, if you want to use <kbd>set-rwx-r-xr--</kbd> as the new permission for <kbd>file1</kbd>, you do the following:</p>
<p class="CDPAlignCenter CDPAlign"><em>user → rwx → 4+2+1=7</em></p>
<p class="CDPAlignCenter CDPAlign"><em>group → r-x → 4+1=5</em></p>
<p class="CDPAlignCenter CDPAlign"><em>others → r- - → 4=4</em></p>
<p>The following example of the <kbd>chmod</kbd> command shows the usage of the <kbd>chmod</kbd> to set permissions using numbers and the usage of <kbd>chmod</kbd> to set the same permissions using symbols:</p>
<pre><strong>$ chmod 754 file1                </strong><br/><strong>$ chmod u=rwx,g=rx,o=r file1     </strong></pre>
<p>The following are some examples to illustrate the usage of the <kbd>chmod</kbd> command using numbers:</p>
<p>Set the read permission for the user, the write permission for the group, and no permission for others on the file named <kbd>file1</kbd>, as shown in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img src="Images/176a9912-d600-4d69-b946-a18ae52e9382.png" style="width:22.58em;height:7.92em;" width="507" height="177"/></p>
<p class="mce-root"/>
<div class="packt_tip"><span>Use <kbd>chmod</kbd> with the <kbd>-R</kbd> option to recursive set permissions on all files and sub-directories within a directory.</span> <span>With the <kbd>X</kbd> option, you can add or remove execute permissions for directories only and not files. Although not used much, it is a useful option</span> <span>sometimes;</span><span> you can use <kbd>chmod -R +rX /data</kbd> to set execute permissions for directories in the <kbd>/data</kbd> folder, but not for any file within it.</span></div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Managing file ownership</h1>
                </header>
            
            <article>
                
<p>Every file or directory created on a Linux system belongs to a user and a group, which are also known as the owner of the file or the group owner of the file. Ownership of the file or the directory can be modified by the root user, or the owner of the file. Group ownership again can only be modified by the root user or the owner of the file, for the groups only to which he is a member. This section covers how to manage the ownership of files and directories.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Understanding default ownership</h1>
                </header>
            
            <article>
                
<p>When we create a file or directory, it gets certain default ownership and group ownership. The user who creates the file becomes the user (owner) of that file, and the primary group of that user becomes the group of that file. To find out whether a user or a group has the permissions to access a file or a directory, a shell checks the ownership of that file in the following order:</p>
<ol>
<li>When accessing a file, a shell checks whether you are the owner of a file. If a user is the owner of a file, then the user gets access to the file with the permissions that are set for the owner of the file.</li>
<li>If the user is not the owner of the file, a shell checks for the group of the file. If the user is a member of a group assigned to the file, then he gets access to the file with the permissions that are set for the group of the file.</li>
<li>If the user is neither the owner of the file and doesn't belong to the group assigned to the file, then the user gets access to the file with other permissions.</li>
</ol>
<p class="mce-root"/>
<p>The long-listing <kbd>ls -l</kbd> command is used to view the current ownership of the file. The third and fourth fields of output of the long-listing command display the owner and group of the file, as shown in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img src="Images/1b795cdb-68c9-4f77-8c10-942f6c29ff01.png" style="width:27.92em;height:4.83em;" width="641" height="111"/></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Modifying user ownership with chown</h1>
                </header>
            
            <article>
                
<p>The <kbd>chown</kbd> command can be used to change the user ownership as well as the group ownership of a file or directory. Initially, we will see how the <kbd>chown</kbd> command can be used to change file ownership. The syntax of the <kbd>chown</kbd> command is as follows:</p>
<pre><strong>$ chown    &lt;user_name_to_set_as_owner&gt;    &lt;file_or_foldername&gt;</strong></pre>
<p>The following are some the examples to illustrate the usage of the <kbd>chown</kbd> command:</p>
<p>List current ownership of file named <kbd>myfile</kbd> using the <kbd>ls</kbd> command is shown as follows:</p>
<pre><strong>$ ls -l myfile</strong></pre>
<p>Grant user ownership of the file named <kbd>myfile</kbd> to <kbd>jack</kbd>, as shown in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img src="Images/7effa62b-d9c6-4482-b287-0f5000b5c471.png" style="width:24.17em;height:8.25em;" width="518" height="177"/></p>
<p>The <kbd>chown</kbd> command is very often used with the <kbd>-R</kbd> option to recursively modify the ownership of a complete directory tree. The following command is used to grant ownership of a directory named <kbd>mydir</kbd> and all files and sub-directories within it to the user <kbd>jack</kbd>, as shown in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img src="Images/d469002e-3a10-408b-b683-98c336ad5643.png" style="width:24.75em;height:11.58em;" width="520" height="244"/></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Modifying group ownership with chown</h1>
                </header>
            
            <article>
                
<p>The <kbd>chown</kbd> command can also be used to modify group ownership of a file or directory by prefixing a group name with a colon (<kbd>:</kbd>) sign or <span>period</span> (<kbd>.</kbd>) sign, as shown in the following command:</p>
<pre><strong>$ chown :group &lt;filename_or_directoryname&gt;</strong></pre>
<p>The following screenshot shows the usage of the <kbd>chown</kbd> command to change the group of <kbd>myfile</kbd> to <kbd>jack</kbd>:</p>
<p class="CDPAlignCenter CDPAlign"><img src="Images/3b1b111b-03de-40dd-8c8a-e0b78e955f16.png" style="width:22.33em;height:14.25em;" width="520" height="332"/></p>
<p class="mce-root"/>
<p class="mce-root"/>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Modifying both user and group ownership with chown</h1>
                </header>
            
            <article>
                
<p>The <kbd>chown</kbd> command can also be used to modify both the owner and group of the file simultaneously by using either of the following syntax:</p>
<pre><strong>$ chown    owner:group    &lt;filename_or_dirname&gt;</strong></pre>
<pre><strong>$ chown    owner.group    &lt;filename_or_dirname&gt;</strong></pre>
<p>The <kbd>chown</kbd> command can be used to change the owner of the file named <kbd>myfile</kbd> to root and the group of the file to wheel, as shown in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img src="Images/29b5569a-f705-4a81-8fa7-fb832d0a086d.png" style="width:27.50em;height:6.83em;" width="532" height="132"/></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Modifying group ownership with chgrp</h1>
                </header>
            
            <article>
                
<p>The <kbd>chgrp</kbd> command is also used to modify the group of a file or directory. This can only modify the group owner, unlike the previous command, <kbd>chown</kbd>,which could be used to modify user ownership and group ownership. The syntax of this command is as follows:</p>
<pre><strong>$ chgrp    &lt;new_groupname&gt;    &lt;filename_dirname&gt;</strong></pre>
<p>The <kbd>chgrp</kbd> command can be used to change the group of the <kbd>myfile</kbd> <span>file </span>to the group <kbd>jack</kbd>,as shown in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img src="Images/fd671763-30b9-47fc-9956-d0bface1a68a.png" style="width:25.92em;height:6.50em;" width="531" height="133"/></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Special permissions</h1>
                </header>
            
            <article>
                
<p>Besides the basic permissions set, which is applicable by default, Linux also has some special/advanced permission sets, which are used sometimes to enhance some functionalities. These permissions are applicable to files (mainly executable files) and directories. These are <kbd>setuid</kbd>, <kbd>setgid</kbd>, and <kbd>sticky bit</kbd>.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Modifying special permissions for files</h1>
                </header>
            
            <article>
                
<p><kbd>Setuid</kbd> and <kbd>setgid</kbd> are two special permissions that are applied to executable files.</p>
<p>If <kbd>setuid</kbd> is applied to an executable file, it means that if that file is executed as a program, then it will run as the user of the file and not as the user who ran the program.</p>
<p>Similarly, when <kbd>setgid</kbd> is applied to the file, it runs as the group of the file and not as the group that ran the program.</p>
<p>The <kbd>passwd</kbd> command has <kbd>setuid</kbd> applied by default in Linux systems, as shown in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img src="Images/290b174d-dca1-44e8-9d33-36e5b99a9cf5.png" style="width:28.00em;height:2.83em;" width="662" height="67"/></p>
<p>The <kbd>chmod</kbd> command can be used to add <kbd>setuid</kbd> to a script file named <kbd>myscript</kbd>,as shown in the following command line:</p>
<pre><strong>$ ls -l myscript</strong><br/><strong>$ chmod u+s myscript</strong><br/><br/><strong>or</strong><br/><br/><strong>$ chmod 4755 myscript</strong><br/><strong>$ ls -l myscript</strong></pre>
<p>The <kbd>chmod</kbd> command can be used to add <kbd>setgid</kbd> on a script file named <kbd>myscript</kbd> as shown in the following command line:</p>
<pre><strong>$ ls -l myscript</strong><br/><strong>$ chmod g+s myscript</strong><br/><br/><strong>or</strong><br/><br/><strong>$ chmod 2755 myscript</strong><br/><strong>$ ls -l myscript</strong></pre>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Modifying special permission, for directories</h1>
                </header>
            
            <article>
                
<p>The <kbd>sticky bit</kbd> and <kbd>setgid</kbd> are special permissions that are applied to special directories.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Using sticky bit</h1>
                </header>
            
            <article>
                
<p>The <kbd>sticky bit</kbd> special permission is used to put a restriction on the deletion of files. When sticky bit is set on a directory, then only the owner of the file and the root user can delete the files within that directory, for example:</p>
<p>The <kbd>/tmp</kbd> folder has got sticky bit applied by default in Linux systems, as shown in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img src="Images/f606b2b4-62dc-4371-94c3-ca49ac8235e2.png" style="width:23.92em;height:2.83em;" width="552" height="65"/></p>
<p>The following example illustrates the usage of the <kbd>chmod</kbd> command to add sticky bit to a directory:</p>
<pre><strong>$ ls -ld mydir</strong><br/><strong>$ chmod o+t mydir</strong><br/><br/><strong>or</strong><br/><br/><strong>$ chmod 1775 mydir</strong><br/><strong>$ ls -ld mydir</strong></pre>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Using setgid</h1>
                </header>
            
            <article>
                
<p>The <kbd>setgid</kbd> special permission is used to enable group inheritance from the parent directory. When <kbd>setgid</kbd> is set on a directory, then files created in that directory will inherit the group affiliation from the parent directory, instead of inheriting it from the user who creates the file. It is generally used on collaborative (shared) directories to automatically change a file from the default user private group to the shared group. </p>
<p>The following command line is used to view the existing permission of a directory:</p>
<pre><strong>$ ls -ld mydir</strong></pre>
<p>The following example illustrates the usage of the <kbd>chmod</kbd> command to add the <kbd>setgid</kbd> permission to a directory:</p>
<pre><strong>$ chmod g+s mydir</strong><br/><strong>or</strong><br/><strong>$ chmod 2770 mydir</strong><br/><strong>$ ls -ld mydir</strong></pre>
<p>Here is a table listing special permissions and their effect on files and directories:</p>
<table style="border-collapse: collapse;width: 100%" border="1">
<tbody>
<tr>
<td>
<p class="CDPAlignCenter CDPAlign"><strong>Special permission</strong></p>
</td>
<td>
<p class="CDPAlignCenter CDPAlign"><strong>Numerically fourth-digit weightage</strong></p>
</td>
<td>
<p class="CDPAlignCenter CDPAlign"><strong>Effects on files</strong></p>
</td>
<td>
<p class="CDPAlignCenter CDPAlign"><strong>Effects on directories</strong></p>
</td>
</tr>
<tr>
<td>
<p><kbd>setuid</kbd> <kbd>(u+s)</kbd></p>
</td>
<td>
<p>Setuid= 4</p>
</td>
<td>
<p>Files are executed as the user that owns the file, not the user running that file</p>
</td>
<td>
<p>No effect</p>
</td>
</tr>
<tr>
<td>
<p><kbd>setgid</kbd> <kbd>(g+s)</kbd></p>
</td>
<td>
<p>Setgid = 2</p>
</td>
<td>
<p>Files are executed as the group that owns the file</p>
</td>
<td>
<p>Enables group inheritance. Files created in the directory have their group owner set as the group owner of the directory</p>
</td>
</tr>
<tr>
<td>
<p><kbd>sticky bit (o+t)</kbd></p>
</td>
<td>
<p>Sticky bit = 1</p>
</td>
<td>
<p>No effect</p>
</td>
<td>
<p>Only the root or the owner of the files can delete the files from the directory with a sticky bit set</p>
</td>
</tr>
</tbody>
</table>
<p> </p>
<div class="packt_infobox">Extra care is to be taken when setting these special permissions, as incorrect setting (usage) of the <kbd>setuid</kbd> and <kbd>setgid</kbd> on binaries can lead to privilege escalation. Such scenarios can help an attacker gain access to the root account via a regular user account.</div>
<p class="mce-root"/>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Managing default permissions</h1>
                </header>
            
            <article>
                
<p>The files get their default permissions from the users or processes that create them. If a file is created using text editors, it will have read and write permissions and no executable permissions for everyone. Similarly, a binary executable created using compilers generally has executable permission sets, since they are meant for execution.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Understanding umask</h1>
                </header>
            
            <article>
                
<p>Default file and folder permissions are set by the <kbd>umask</kbd> program. The <kbd>umask</kbd> command without any argument will display the existing value of <kbd>umask</kbd>. The same command, when followed by a new octal value as an argument, will set the new value of <kbd>umask</kbd>. The following command line is used to view the existing <kbd>umask</kbd> of a user:</p>
<pre><strong>$ umask</strong></pre>
<p>Normal users have a different <kbd>umask</kbd>,and the root has a different <kbd>umask</kbd> value, to decide the default permissions for files and directories. The following examples illustrate the different <kbd>umask</kbd> values the exit in system for a regular user and a root user:</p>
<ul>
<li>Execute the <kbd>umask</kbd> command on Terminal as a root user to view the <kbd>umask</kbd> value for the root account, as shown in the following screenshot:</li>
</ul>
<p class="CDPAlignCenter CDPAlign"><img src="Images/f884b0e3-0bdd-4a75-95da-f597e146ab87.png" style="width:15.67em;height:3.50em;" width="303" height="67"/></p>
<ul>
<li>To view the <kbd>umask</kbd> value of <kbd>student</kbd> user, first switch to <kbd>student</kbd> user account and then execute the <kbd>umask</kbd> command as shown in the following screenshot:</li>
</ul>
<p class="CDPAlignCenter CDPAlign"><img src="Images/1a719805-f601-4baa-a9c3-5a46e3a5560b.png" style="width:24.33em;height:5.08em;" width="530" height="110"/></p>
<p>For files, the maximum default value is generally <kbd>666</kbd> (normal files do not require execute permissions to be set by default), and for directories the maximum default value is <kbd>777</kbd> (since directories require execute permissions to be set using the <kbd>cd</kbd> command). The <kbd>umask</kbd> values are taken off<span> from the maximum default octal values</span> to decide the default permissions for files and directories.</p>
<p class="mce-root"/>
<p>For example, let's understand the <kbd>umask</kbd> value <kbd>0022</kbd> that is the default value of the root account. It means remove write permissions for the group and others from the maximum permissions of files and directories. Hence, the default permission for the file will be <kbd>644</kbd>, and for the directory it will be <kbd>755</kbd>. Similarly, a <kbd>umask</kbd> value of <kbd>0002</kbd> that is the default value of the normal user account, means remove write permissions for others from the maximum permissions of files and directories. Hence, the default permission for the file will be <kbd>664</kbd>,and for the directory it will be <kbd>775</kbd>.</p>
<div class="packt_infobox">While setting a new <kbd>umask</kbd> value of user, if the argument of <kbd>umask</kbd> command contains fewer than three octal digits, then leading zeros are assumed in the argument part.</div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Managing ACL on files</h1>
                </header>
            
            <article>
                
<p>Standard Linux file permissions are applicable for file owners, groups of files, or everyone else in the system. Using standard permissions, we cannot give multiple users or multiple groups different permissions for a single file. This kind of delicate control is provided using ACLs in Linux. We can give permissions to more than one user or one group for the same file.</p>
<p>File owners or root can set ACLs on individual files or on directories if the filesystem is mounted with ACL support enabled. CentOS 7's default filesystem is <kbd>XFS</kbd>, which has built-in ACL support. Although not all applications (such as <kbd>tar</kbd>) support ACL, it is still a great functionality available in the Linux system.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Viewing ACL permissions</h1>
                </header>
            
            <article>
                
<p>Using the <kbd>ls -l</kbd> command, we can view standard permission and tell whether a file or a directory has ACL applied to it. If the tenth character in the permission is the <kbd>+</kbd> symbol, then it indicates that ACL is applied on that file or directory.</p>
<p>If the plus (<kbd>+</kbd>) symbol is present on a file, it means the user permission represents the user ACL setting, the group permission represents the ACL mask (and not the group owner setting), and other permissions are other ACL settings. An example to find out whether the ACL permissions are applied on file is shown in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img src="Images/1e4f8c65-e6dd-4fc1-bfa3-46a13b431bb9.png" style="width:23.50em;height:3.00em;" width="510" height="65"/></p>
<p class="mce-root"/>
<p class="mce-root"/>
<div class="packt_infobox">If ACL is applied on a file, then modifying its group permissions with <kbd>chmod</kbd> will change the ACL mask and not the group owner permissions.</div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Using getfacl</h1>
                </header>
            
            <article>
                
<p>To view the ACLs on a file or directory, the <kbd>getfacl</kbd> command is used. Its syntax is shown in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img src="Images/bbe96ea1-06d0-42eb-ade4-4f6c96291d38.png" style="width:40.42em;height:31.83em;" width="726" height="572"/></p>
<p class="CDPAlignLeft CDPAlign"><span>The <kbd>getfacl</kbd> command can also be used to export the ACL applied to a file or directory into a file, as shown in the following command line:</span></p>
<pre class="mce-root"><strong><span>$ getfacl -R /data &gt; file.acl</span></strong></pre>
<p><span>The exported ACL can be imported from the file and applied using the </span><kbd>setfacl</kbd> <span>command, as shown in the following command line: </span></p>
<pre><strong><span>$ setfacl --set-file=file.acl</span></strong></pre>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">ACL mask</h1>
                </header>
            
            <article>
                
<p>The ACL mask is used to set the maximum effective permissions for the group owner of a file, named users of a file, and named groups of a file. The maximum permissions of the owner or others are the ones that are set using <kbd>chmod</kbd> and not controlled by the ACL mask.</p>
<p>The ACL mask is set on a file using the <kbd>setfacl</kbd> command as follows:</p>
<pre><strong>$ setfacl   -m    m::r    filename</strong></pre>
<div>The ACL mask is viewed using the <kbd>getfacl</kbd> command as follows:</div>
<pre><strong>$ getfacl     filename</strong></pre>
<p>The <kbd>getfacl</kbd> command displays a string <kbd>#effective:</kbd> in front of the entries that are restricted by the mask. It gets updated automatically whenever group permissions are updated with <kbd>chmod</kbd>.</p>
<p>The following table lists the user types and corresponding ACL precedence in Linux systems:</p>
<table style="border-collapse: collapse;width: 100%" border="1">
<tbody>
<tr>
<td>
<p class="CDPAlignCenter CDPAlign"><strong>User type</strong></p>
</td>
<td>
<p class="CDPAlignCenter CDPAlign"><strong>ACL precedence</strong></p>
</td>
</tr>
<tr>
<td>
<p>Owner user</p>
</td>
<td>
<p>ACL permissions apply</p>
</td>
</tr>
<tr>
<td>
<p>Named user</p>
</td>
<td>
<p>ACL permissions apply <span>(should be equal to or less than ACL mask)</span></p>
</td>
</tr>
<tr>
<td>
<p>Group</p>
</td>
<td>
<p>ACL permissions apply <span>(should be equal to or less than ACL mask)</span></p>
</td>
</tr>
<tr>
<td>
<p>Named group</p>
</td>
<td>
<p>ACL permissions apply <span>(should be equal to or less than ACL mask)</span></p>
</td>
</tr>
<tr>
<td>
<p>Others</p>
</td>
<td>
<p>ACL permissions apply</p>
</td>
</tr>
</tbody>
</table>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Modifying ACL permissions</h1>
                </header>
            
            <article>
                
<p>ACLs use the same standard filesystem permission representation, which is used with <kbd>chmod</kbd>.</p>
<p class="mce-root"/>
<p class="mce-root"/>
<p>The following table list the symbols and their corresponding permission representation in ACL:</p>
<table style="border-collapse: collapse;width: 100%" border="1">
<tbody>
<tr>
<td>
<p class="CDPAlignLeft CDPAlign"><strong>Symbol</strong></p>
</td>
<td>
<p class="CDPAlignCenter CDPAlign"><strong>Permission</strong></p>
</td>
</tr>
<tr>
<td>
<p><kbd>r</kbd></p>
</td>
<td>
<p>Read</p>
</td>
</tr>
<tr>
<td>
<p><kbd>w</kbd></p>
</td>
<td>
<p>Write</p>
</td>
</tr>
<tr>
<td>
<p><kbd>x</kbd></p>
</td>
<td>
<p>Execute</p>
</td>
</tr>
<tr>
<td>
<p><kbd>-</kbd></p>
</td>
<td>
<p>That permission is absent</p>
</td>
</tr>
<tr>
<td>
<p><kbd>X</kbd></p>
</td>
<td>
<p>Indicates the execute permission should be set on directories and not on regular files</p>
</td>
</tr>
</tbody>
</table>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Using setfacl</h1>
                </header>
            
            <article>
                
<p>The <kbd>setfacl</kbd> command is used with the <kbd>-m</kbd> option to modify or add new ACLs to a file or directory. For example, file owner permissions can be set using <kbd>chmod</kbd> or using <kbd>setfacl</kbd>. If no named user is specified in the user part of <kbd>setfacl</kbd>, then that permission applies to the file owner, as shown in the following command:</p>
<pre><strong>$ ls -l file1</strong><br/><strong>$ setfacl -m u::rwx file1</strong></pre>
<p>Named user ACLs are set on a file using the username or UID, as shown in the following command:</p>
<pre><strong>$ setfacl -m u:jack:rwx file1</strong></pre>
<p>If no named group is specified in ACL, then that ACL applies to the group owner, as shown in the following command:</p>
<pre><strong>$ setfacl -m g::rw file1</strong></pre>
<p>We can modify or add a named group ACL to a file using the group name or GID, as shown <span>in the following command:</span></p>
<pre><strong>$ setfacl -m g:sam:rw  file1</strong></pre>
<p>We can set the ACL using output from <kbd>getfacl</kbd> command and giving it as input to <kbd>setfacl</kbd> command. In the following example, the <kbd>--set-file</kbd> option enables the <kbd>setfacl</kbd> command to read the input from a file or <kbd>stdin</kbd> (<kbd>-</kbd>), as shown <span>in the following command:</span></p>
<pre><strong>$ getfacl file1 | setfacl  --set-file=- file2</strong></pre>
<p>We can set the ACL recursively using the <kbd>-R</kbd> option on directories. The <kbd>X</kbd> option is also generally used with recursion, so that directories will get executable permissions set, and this prevents adding executable permissions to files accidentally when setting ACL permission recursively:</p>
<pre><strong>$ setfacl -R -m u:jack:rX dir1</strong></pre>
<p>We can set default ACLs on directories to enable ACL inheritance on all new files and sub-directories using the <kbd>-d</kbd> option or by prefixing the <kbd>setfacl</kbd> command with <kbd>d:</kbd>, as shown <span>in the following command line:</span></p>
<pre><strong>$ setfacl -m d:u:jack:rwX directory</strong></pre>
<p>To remove default ACLs, use the <kbd>-x</kbd> option with <kbd>d:</kbd>, as shown <span>in the following command line:</span></p>
<pre><strong>$ setfacl -x d:u:jack:rwX directory</strong></pre>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Removing an ACL</h1>
                </header>
            
            <article>
                
<p>The <kbd>setfacl</kbd> command is also used with the <kbd>-x</kbd> option to remove the applied ACL for any user or group. The only difference when removing ACL from setting ACL is that we don't specify the permission while removing. The following example illustrates the usage of the <kbd>setfacl</kbd> command to remove the ACL applied to a file named as <kbd>file1</kbd> for the user jack and the group sam:</p>
<pre><strong>$ setfacl -x  u:jack,g:sam  file1</strong></pre>
<p>To remove all ACLs from a file or directory, we can use the <kbd>-b</kbd> option, as shown <span>in the following command:</span></p>
<pre><strong>$ setfacl -b file1</strong></pre>
<p class="mce-root"/>
<p class="mce-root"/>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article>
                
<p>In this chapter, we began with learning about different types of permissions in Linux systems and how to manage them using numbers as well as using symbols. Then we learned about the managing of file ownership using the <kbd>chown</kbd> and <kbd>chgrp</kbd> commands. This was followed by understanding special permissions for executable and directories. Then we learned how to manage default permissions. Finally, we looked at how to view, set, and delete ACLs on files and directories in CentOS 7.</p>
<p>In the next chapter, we will learn about process management in CentOS 7. Process management is an essential skill that is required to manage your system resources. It will lay the solid foundation for optimizing system performance.</p>


            </article>

            
        </section>
    </div>



  </body></html>