<html><head></head><body><div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Scripts for Power Users</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">In this chapter, we will cover the following:</p>
<ul class="calibre13">
<li class="calibre14">Creating Syslog entries and generating an alarm</li>
<li class="calibre14">Backing up and erasing media, disks, and partitions with DD</li>
<li class="calibre14">Creating graphics and presentations on the CLI</li>
<li class="calibre14">Checking for file integrity and tampering</li>
<li class="calibre14">Mounting network file systems and retrieving files</li>
<li class="calibre14">Browsing the web from the CLI</li>
<li class="calibre14">Capturing network traffic headlessly</li>
<li class="calibre14">Finding binary dependencies</li>
<li class="calibre14">Fetching time from different locations</li>
<li class="calibre14">Encrypting/decrypting files from a script</li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Introduction</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">This chapter will help power users to get an idea on how to perform certain tasks with shell scripts. These tasks include creating syslog entries using the <kbd class="calibre17">logger</kbd> command, taking backups, creating graphics and presentations on the CLI, checking file integrity and tampering, mounting network file systems and retrieving files, browsing the web, capturing network traffic, finding binary dependencies, and encrypting and decrypting a files. In this chapter, users will learn how to use scripts to do these tasks.</p>
<p class="mce-root"/>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Creating Syslog entries and generating an alarm  </h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">In this section, we are going to discuss the syslog protocol. We'll also learn about the <kbd class="calibre17">logger</kbd> command, which is a shell command and acts as an interface for the syslog module. The <kbd class="calibre17">logger</kbd> command makes entries in the system log. In this section, we are also going to create an alarm using a script.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">Besides having a terminal open, we need to make sure you have a file to make an entry.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article class="calibre2">
                
<ol class="calibre20">
<li class="chapter">We are going to use the <kbd class="calibre17">logger</kbd> command to enter <kbd class="calibre17">file_name</kbd> into the <kbd class="calibre17">syslog</kbd> file. Run the following command:</li>
</ol>
<div class="title-page-name">
<pre class="calibre27"><strong class="calibre3">$ logger -f file_name</strong></pre></div>
<ol start="2" class="calibre20">
<li class="chapter">Now we are going to write a script to create an alarm. Create a <kbd class="calibre17">create_alarm.sh</kbd><span class="calibre11"> script and write the following code in it:</span></li>
</ol>
<div class="title-page-name">
<pre class="calibre27">#!/bin/bash<br class="calibre2"/>declare -i H<br class="calibre2"/>declare -i M<br class="calibre2"/>declare -i cur_H<br class="calibre2"/>declare -i cur_M<br class="calibre2"/>declare -i min_left<br class="calibre2"/>declare -i hour_left<br class="calibre2"/>echo -e "What time do you Wake Up?"<br class="calibre2"/>read H<br class="calibre2"/>echo -e "and Minutes?"<br class="calibre2"/>read  M<br class="calibre2"/>cur_H=`date +%H`<br class="calibre2"/>cur_M=`date +%M`<br class="calibre2"/>echo "You Selected "<br class="calibre2"/>echo "$H:$M"<br class="calibre2"/>echo -e "\nIt is Currently $cur_H:$cur_M"<br class="calibre2"/>if [  $cur_H -lt $H ]; then<br class="calibre2"/>    hour_left=`expr $H - $cur_H`<br class="calibre2"/>    echo "$H - $cur_H means You Have: $hour_left hours still"<br class="calibre2"/>fi<br class="calibre2"/>if [ $cur_H -gt $H ]; then<br class="calibre2"/>    hour_left=`expr $cur_H - $H`<br class="calibre2"/>    echo -e  "\n$cur_H - $H means you have $hour_left hours left \n"<br class="calibre2"/>fi<br class="calibre2"/>if [ $cur_H == $H ]; then<br class="calibre2"/>    hour_left=0<br class="calibre2"/>    echo -e "Taking a nap?\n"<br class="calibre2"/>fi<br class="calibre2"/>if [ $cur_M -lt $M ]; then<br class="calibre2"/>    min_left=`expr $M - $cur_M`<br class="calibre2"/>    echo -e "$M -$cur_M you have: $min_left minutes still"<br class="calibre2"/>fi<br class="calibre2"/>if [ $cur_M -gt $M ]; then<br class="calibre2"/>    min_left=`expr $cur_M - $M`<br class="calibre2"/>    echo -e "$cur_M - $M you have $min_left minutes left \n"<br class="calibre2"/>fi<br class="calibre2"/>if [ $cur_M == $M ]; then<br class="calibre2"/>    min_left=0<br class="calibre2"/>    echo -e "and no minutes\n"<br class="calibre2"/>fi<br class="calibre2"/><br class="calibre2"/>echo -e "Sleeping for $hour_left hours and $min_left minutes \n"<br class="calibre2"/>sleep $hour_left\h<br class="calibre2"/>sleep $min_left\m<br class="calibre2"/>mplayer ~/.alarm/alarm.mp3</pre></div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">Now we will see a description of the <kbd class="calibre17">logger</kbd> command and the <kbd class="calibre17">create_alarm</kbd> script we just wrote:</p>
<ol class="calibre20">
<li class="chapter">The <kbd class="calibre17">logger</kbd> command made an entry about your file in the <kbd class="calibre17">syslog</kbd> file, which was in the <kbd class="calibre17">/var/log</kbd> directory of your system. You can check that file. Navigate to the <kbd class="calibre17">/var/log</kbd> directory and run <kbd class="calibre17">nano syslog</kbd> and you will find the entry in that file.</li>
<li class="chapter">We created a script to create an alarm. We used the <kbd class="calibre17">date</kbd> command for the date and time. We also used the <kbd class="calibre17">sleep</kbd> command to block the alarm for that particular time.</li>
</ol>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Backing up and erasing media, disks, and partitions with DD</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">In this section, we are going to discuss the <kbd class="calibre17">dd</kbd> command. The <kbd class="calibre17">dd</kbd> command stands for <em class="calibre18">data duplicator</em>. It is mainly used for converting and copying files. In this section, we are going to learn about backing up and erasing a media file.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">Besides having a terminal open, we need to make sure you have the necessary files present in the current directory to take backups, to make copies, and similar tasks.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">The <kbd class="calibre17">dd</kbd> command is mainly used for converting and copying files. The <kbd class="calibre17">if</kbd> parameter stands for input-file and is a source. <kbd class="calibre17">of</kbd> stands for output-file and is a source where we want to paste data.</p>
<ol class="calibre20">
<li class="chapter">Run the following command to copy the contents of one file to another:</li>
</ol>
<div class="title-page-name">
<pre class="calibre27"><strong class="calibre3"># create a file 01.txt and add some content in that file.</strong><br class="calibre2"/><strong class="calibre3"># create another file 02.txt and add some content in that file.</strong><br class="calibre2"/><strong class="calibre3">$ dd if=/home/student/work/01.txt of=/home/student/work/02.txt bs=512 count=1</strong></pre></div>
<ol start="2" class="calibre20">
<li class="chapter">Run the following command to take a backup of the partition or the hard disk:</li>
</ol>
<div class="title-page-name">
<pre class="calibre27"><strong class="calibre3">$ sudo dd if=/dev/sda2 of=/home/student/hdbackup.img</strong></pre></div>
<ol start="3" class="calibre20">
<li class="chapter">The <kbd class="calibre17">dd</kbd> command is also used to erase all of the contents of the disk. Run the following command to delete the contents:</li>
</ol>
<div class="title-page-name">
<pre class="calibre27"><strong class="calibre3">$ sudo dd if=/home/student/work/1.sh</strong></pre></div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">Now we will see how the preceding commands work:</p>
<ol class="calibre20">
<li class="chapter">We used the <kbd class="calibre17">dd</kbd> command to copy the contents of the <kbd class="calibre17">01.txt</kbd> file into the <kbd class="calibre17">02.txt</kbd> file.</li>
<li class="chapter">To run this command, we must have super user privileges. Using the <kbd class="calibre17">dd</kbd> command, we took a backup and stored it in the <kbd class="calibre17">hdbackup.img</kbd> file.</li>
<li class="chapter">Using the <kbd class="calibre17">dd</kbd> command, we erased the contents of the <kbd class="calibre17">1.sh</kbd> file.</li>
</ol>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Creating graphics and presentations on the CLI</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">In this section, we are going to learn how to make presentations and how to create graphics on the CLI. For this, we are going to use a tool named <strong class="calibre6">dialog</strong><strong class="calibre6">.</strong> <kbd class="calibre17">dialog</kbd> is a Linux command-line tool used for taking input from users and to create message boxes.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">Besides having a terminal open, make sure you have the dialog utility installed on your system. Install it by using the <kbd class="calibre17">apt</kbd> command. APT stands for Advanced Package Tool. Using the <kbd class="calibre17">apt</kbd> command, you can manage software from the command line for debian-based Linux. The <kbd class="calibre17">apt</kbd> command easily interacts with the <kbd class="calibre17">dpkg</kbd> packaging system.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article class="calibre2">
                
<ol class="calibre20">
<li class="chapter">We are going to write a script for a <kbd class="calibre17">Yes</kbd>/<kbd class="calibre17">No</kbd> box. In that script, we are going to use the <kbd class="calibre17">if</kbd> condition. Create the <kbd class="calibre17">yes_no.sh</kbd> script and add the following content to it:</li>
</ol>
<div class="title-page-name">
<pre class="calibre27">dialog --yesno "Do you wish to continue?" 0 0<br class="calibre2"/>a=$?<br class="calibre2"/>if [ "${a}" == "0" ]; then<br class="calibre2"/>    echo Yes<br class="calibre2"/>else<br class="calibre2"/>    echo No<br class="calibre2"/>fi</pre></div>
<ol start="2" class="calibre20">
<li class="chapter">We'll use dialog's calendar. Create a <kbd class="calibre17">calendar_dialog.sh</kbd> script. In that, we'll select a specific date:</li>
</ol>
<div class="title-page-name">
<pre class="calibre27">dialog --calendar "Select a date... " 0 0 1 1 2018<br class="calibre2"/>val=$?</pre></div>
<ol start="3" class="calibre20">
<li class="chapter">We're going to use the checklist option of <kbd class="calibre17">dialog</kbd>. Create a <kbd class="calibre17">checklist_dialog.sh </kbd>script. In that, we'll select multiple options:</li>
</ol>
<div class="title-page-name">
<pre class="calibre27">dialog --stdout --checklist "Enable the account options you want:" 10 40 3 \<br class="calibre2"/>              1 "Home directory" on \<br class="calibre2"/>              2 "Signature file" off \<br class="calibre2"/>              3 "Simple password" off</pre></div>
<ol start="4" class="calibre20">
<li class="chapter">Now, we are going to write a script to raise the border of an image. Create a <kbd class="calibre17">raise_border.sh</kbd> script. We'll use the <kbd class="calibre17">convert</kbd> command with the <kbd class="calibre17">raise</kbd> option:</li>
</ol>
<div class="title-page-name">
<pre class="calibre27"><strong class="calibre3">convert -raise 5x5 mountain.png mountain-raised.png</strong></pre></div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">Now we will see a description of the options and commands written in the preceding scripts:</p>
<ol class="calibre20">
<li class="chapter">We wrote code for a <kbd class="calibre17">Yes</kbd>/<kbd class="calibre17">No</kbd> box using the dialog tool in Linux. We used the <kbd class="calibre17">if</kbd> condition to take an answer of either <kbd class="calibre17">Yes</kbd> or <kbd class="calibre17">No</kbd>.</li>
<li class="chapter">We used the <kbd class="calibre17">--calendar</kbd> option of the dialog tool. It asks for a date to be selected. We selected a date from the year 2018.</li>
<li class="chapter">We used the <kbd class="calibre17">checklist</kbd> option of the dialog tool. We made a checklist, which had three options: Home directory, Signature file, and Simple Password.</li>
<li class="chapter">We raised the border of an image using the <kbd class="calibre17">convert</kbd> command and the <kbd class="calibre17">–raise</kbd> option, and then the new image was saved as <kbd class="calibre17">mountain-raised.png</kbd>.</li>
</ol>
<p class="mce-root"/>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Checking for file integrity and tampering</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">In this section, we are going to learn how to check the integrity of a file and how to check for tampering by writing a simple shell script. Why do we need to check integrity? The answer is simple: administrators check integrity when there are passwords and libraries present on a server, as well as when files contain highly sensitive data.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">Besides having a terminal open, you need to make sure the necessary files and directories are present.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article class="calibre2">
                
<ol class="calibre20">
<li class="chapter">We are going to write a script to check whether a file in a directory has been tampered with. Create an <kbd class="calibre17">integrity_check.sh</kbd> script and add the following code to it:</li>
</ol>
<div class="title-page-name">
<pre class="calibre27">#!/bin/bash<br class="calibre2"/>E_DIR_NOMATCH=50<br class="calibre2"/>E_BAD_DBFILE=51<br class="calibre2"/>dbfile=Filerec.md5<br class="calibre2"/># storing records.<br class="calibre2"/>set_up_database ()<br class="calibre2"/>{<br class="calibre2"/>    echo ""$directory"" &gt; "$dbfile"<br class="calibre2"/>    # Write directory name to first line of file.<br class="calibre2"/>    md5sum "$directory"/* &gt;&gt; "$dbfile"<br class="calibre2"/>    # Append md5 checksums and filenames.<br class="calibre2"/>}<br class="calibre2"/>check_database ()<br class="calibre2"/>{<br class="calibre2"/>    local n=0<br class="calibre2"/>    local filename<br class="calibre2"/>    local checksum<br class="calibre2"/>    if [ ! -r "$dbfile" ]<br class="calibre2"/>    then<br class="calibre2"/>        echo "Unable to read checksum database file!"<br class="calibre2"/>        exit $E_BAD_DBFILE<br class="calibre2"/>    fi<br class="calibre2"/><br class="calibre2"/>    while read rec[n]<br class="calibre2"/>    do<br class="calibre2"/>        directory_checked="${rec[0]}"<br class="calibre2"/>        if [ "$directory_checked" != "$directory" ]<br class="calibre2"/>        then<br class="calibre2"/>            echo "Directories do not match up!"<br class="calibre2"/>            # Tried to use file for a different directory.<br class="calibre2"/>            exit $E_DIR_NOMATCH<br class="calibre2"/>        fi<br class="calibre2"/>        if [ "$n" -gt 0 ]<br class="calibre2"/>        then<br class="calibre2"/>            filename[n]=$( echo ${rec[$n]} | awk '{ print $2 }' )<br class="calibre2"/>            # md5sum writes recs backwards,<br class="calibre2"/>            #+ checksum first, then filename.<br class="calibre2"/>            checksum[n]=$( md5sum "${filename[n]}" )<br class="calibre2"/>            if [ "${rec[n]}" = "${checksum[n]}" ]<br class="calibre2"/>            then<br class="calibre2"/>                echo "${filename[n]} unchanged."<br class="calibre2"/>            else<br class="calibre2"/>                echo "${filename[n]} : CHECKSUM ERROR!"<br class="calibre2"/>            fi<br class="calibre2"/>        fi<br class="calibre2"/>        let "n+=1"<br class="calibre2"/>        done &lt;"$dbfile" # Read from checksum database file.<br class="calibre2"/>}<br class="calibre2"/>if [ -z "$1" ]<br class="calibre2"/>then<br class="calibre2"/>    directory="$PWD" # If not specified,<br class="calibre2"/> else<br class="calibre2"/>    directory="$1"<br class="calibre2"/>fi<br class="calibre2"/>clear<br class="calibre2"/>if [ ! -r "$dbfile" ]<br class="calibre2"/>then<br class="calibre2"/>    echo "Setting up database file, \""$directory"/"$dbfile"\".";<br class="calibre2"/>    echo<br class="calibre2"/>    set_up_database<br class="calibre2"/>fi<br class="calibre2"/>check_database<br class="calibre2"/>echo<br class="calibre2"/>exit 0</pre></div>
<p class="mce-root"/>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">When we run this script, it will create a database file named <kbd class="calibre17">filerec.md5</kbd>, which will have data about all the files present in that directory. We'll use those files for reference.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Mounting network file systems and retrieving files</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">In this section, we are going to learn about the <kbd class="calibre17">mount</kbd> command. To mount a file system onto the file system tree, use the <kbd class="calibre17">mount</kbd> command. This command will instruct the kernel to mount the file system found on a particular device. There is a mount point in the tree for each partition that is mounted.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">Besides having a terminal open, make sure you have necessary files and directories present to mount</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article class="calibre2">
                
<ol class="calibre20">
<li class="chapter">We are going to use the <kbd class="calibre17">mount</kbd> command to mount the file system. Then, we are going to use the <kbd class="calibre17">ro</kbd> and <kbd class="calibre17">noexec</kbd> options to mount:</li>
</ol>
<div class="title-page-name">
<pre class="calibre27"><strong class="calibre3">$ mount -t ext4 /directorytobemounted /directoryinwhichitismounted -o ro,noexec</strong></pre></div>
<ol start="2" class="calibre20">
<li class="chapter">We can mount the device with default options too. Run the following command to mount a device using the default options:</li>
</ol>
<div class="title-page-name">
<pre class="calibre27"><strong class="calibre3">$ mount -t ext4 /directorytobemounted /directoryinwhichitismounted -o defaults</strong></pre></div>
<ol start="3" class="calibre20">
<li class="chapter">The <kbd class="calibre17">scp</kbd> command is used to securely transfer files between two hosts. We can transfer files from our localhost to a remote host, and also between two remote hosts. Run the following command to transfer files from a remote host to our local host:</li>
</ol>
<div class="title-page-name">
<pre class="calibre27"><strong class="calibre3">$ scp <em class="calibre26">from_host_name</em>:filename </strong><em class="calibre26"><strong class="calibre3">/local_directory_name</strong><br class="calibre2"/></em></pre></div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article class="calibre2">
                
<ol class="calibre20">
<li class="chapter">We used the <kbd class="calibre17">ext4</kbd> file system. In the <kbd class="calibre17">mount</kbd> command, we first specified which directory we wanted to mount, followed by the directory in which we will mount it with the <kbd class="calibre17">ro</kbd> and <kbd class="calibre17">noexec</kbd> options.</li>
<li class="chapter">We mounted the directories using the default options.</li>
<li class="chapter">We used the <kbd class="calibre17">scp</kbd> command to copy files from a remote host to the local host.</li>
</ol>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Browsing the web from the CLI</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">In this section, we are going learn about browsing the web from the command-line interface. We are going to browse the web from the command line using the w3m and ELinks browsers.</p>
<p class="mce-root"><strong class="calibre6">w3m</strong> is a text-based web browser. Using w3m, we can browse web pages through our terminal window.</p>
<p class="mce-root"><strong class="calibre6">ELinks</strong> is also a text-based web browser. It supports menu-driven configuration, frames, tables, browsing, and background downloading. ELinks can handle remote URLS as well as local files.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">Besides having a terminal open, we need to remember a couple of things:</p>
<ul class="calibre13">
<li class="calibre14">Make sure you have w3m installed</li>
<li class="calibre14">Make sure you have ELinks installed</li>
</ul>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article class="calibre2">
                
<ol class="calibre20">
<li class="chapter">We are going to use see how to use <kbd class="calibre17">w3m</kbd> to browse the web from the command line. After successful installation, just go to the terminal window and type <kbd class="calibre17">w3m</kbd> followed by the website name:</li>
</ol>
<div class="title-page-name">
<pre class="calibre27"><strong class="calibre3">$ w3m google.com</strong></pre></div>
<ol start="2" class="calibre20">
<li class="chapter">We are going to see how to use <kbd class="calibre17">elinks</kbd> to browse the web from the command line. After successful installation, just go to the terminal window and type <kbd class="calibre17">elinks</kbd> followed by the website name:</li>
</ol>
<div class="title-page-name">
<pre class="calibre27"><strong class="calibre3">$ elinks google.com</strong></pre></div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article class="calibre2">
                
<ol class="calibre20">
<li class="chapter">To navigate through the website, use the following keyboard combinations:
<ol class="calibre20">
<li class="chapter"><em class="calibre26">Shift</em> + <em class="calibre26">U</em>: This combination will open a new web page</li>
<li class="chapter"><em class="calibre26">Shift</em> + <em class="calibre26">B</em>: This combination will navigate you to the previous web page</li>
<li class="chapter"><em class="calibre26">Shift</em> + <em class="calibre26">T</em>: This combination will open a new tab</li>
</ol>
</li>
<li class="chapter">The following are keyboard shortcuts to navigate through the website using ELinks:
<ol class="calibre20">
<li class="chapter">Go to URL - g</li>
<li class="chapter">Open a new tab - t</li>
<li class="chapter">Go forward - u</li>
<li class="chapter">Go back - Left</li>
<li class="chapter">Exit - q</li>
<li class="chapter">Previous tab - &lt;</li>
<li class="chapter">Next tab - &gt;</li>
<li class="chapter">Close tab - c</li>
</ol>
</li>
</ol>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Capturing network traffic headlessly</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">In this section, we are going to learn how to capture traffic. We are going to capture network traffic with a packet sniffer tool called <strong class="calibre6">tcpdump</strong>. This tool is used to filter or capture TCP/IP packets that are transferred or received over a network.</p>
<p class="mce-root"/>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">Besides having a terminal open, we need to remember a few concepts:</p>
<ul class="calibre13">
<li class="calibre14">Make sure the tcpdump tool is installed on your machine</li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">Now we are going to use some <kbd class="calibre17">tcpdump</kbd> commands to capture packets:</p>
<ol class="calibre20">
<li class="chapter">To capture packets from an interface, use the following code:</li>
</ol>
<div class="title-page-name">
<pre class="calibre27"><strong class="calibre3">$ sudo tcpdump -i eth0</strong></pre></div>
<ol start="2" class="calibre20">
<li class="chapter">To print the captured packets in ASCII values, use the following code:</li>
</ol>
<div class="title-page-name">
<pre class="calibre27"><strong class="calibre3">$ sudo tcpdump -A -i eth0</strong></pre></div>
<ol start="3" class="calibre20">
<li class="chapter">To capture a specific number of packets, use the following code:</li>
</ol>
<div class="title-page-name">
<pre class="calibre27"><strong class="calibre3">$ sudo tcpdump -c 10 -i eth0</strong></pre></div>
<ol start="4" class="calibre20">
<li class="chapter">To print the captured packets in HEX and ASCII, use the following code:</li>
</ol>
<div class="title-page-name">
<pre class="calibre27"><strong class="calibre3">$ sudo tcpdump -XX -i eth0</strong></pre></div>
<ol start="5" class="calibre20">
<li class="chapter">To capture and save the packets in a specific file, use the following code:</li>
</ol>
<div class="title-page-name">
<pre class="calibre27"><strong class="calibre3">$ sudo tcpdump -w 111.pcap -i eth0</strong></pre></div>
<ol start="6" class="calibre20">
<li class="chapter">To capture IP address packets, use the following code:</li>
</ol>
<div class="title-page-name">
<pre class="calibre27"><strong class="calibre3">$ sudo tcpdump -n -i eth0</strong></pre></div>
<ol start="7" class="calibre20">
<li class="chapter">To read the captured packets, use the following code:</li>
</ol>
<div class="title-page-name">
<pre class="calibre27"><strong class="calibre3">$ sudo tcpdump -r 111.pcap</strong></pre></div>
<div class="title-page-name">
<p class="calibre4">Now we are going to look at an explanation of <kbd class="calibre17">tcpdump</kbd> and the commands we are using.</p>
</div>
<p class="mce-root"/>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">We used the tcpdump Linux tool, which is used to capture or filter data packets. tcpdump is used to capture a packet on a specific interface. We used the <kbd class="calibre17">-i</kbd> option for this. We can save captured packets in a file. Just give the filename and specify the <kbd class="calibre17">-w</kbd> option in the <kbd class="calibre17">tcpdump</kbd> command. We can read the file by giving the <kbd class="calibre17">-r</kbd> option to read the file in the <kbd class="calibre17">tcpdump</kbd> command.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Finding binary dependencies</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">In this section, we are going to check the executable. We will find out which string is present in it by using the string command.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">Besides having a terminal open, make sure you have a binary present in your directory.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article class="calibre2">
                
<ol class="calibre20">
<li class="chapter">First, we will check the executable. Run the following command:</li>
</ol>
<div class="title-page-name">
<pre class="calibre27"><strong class="calibre3">$ file binary_name</strong></pre></div>
<ol start="2" class="calibre20">
<li class="chapter">Now we will write a command to find strings within the binary. Run the following command:</li>
</ol>
<pre class="calibre27"><strong class="calibre3">$ strings binary_name</strong></pre>
<ol start="3" class="calibre20">
<li class="chapter">We can hexdump a file by running the following command:</li>
</ol>
<pre class="calibre27"><strong class="calibre3"><span class="calibre11">$ od -tx1 </span>binary_name</strong></pre>
<ol start="4" class="calibre20">
<li class="chapter">We can list the symbols in the binary by running the following command:</li>
</ol>
<div class="title-page-name">
<pre class="calibre27"><strong class="calibre3">$ nm binary_name</strong></pre></div>
<ol start="5" class="calibre20">
<li class="chapter">You can check which shared library it has been linked with by running the following command:</li>
</ol>
<div class="title-page-name">
<pre class="calibre27"><strong class="calibre3">$ ldd binary_name</strong></pre></div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">Now we will look at an explanation of the previous commands:</p>
<ol class="calibre20">
<li class="chapter">We used the <kbd class="calibre17">file</kbd> command to get the information about the binary. We also got the architecture information by running the <kbd class="calibre17">file</kbd> command.</li>
<li class="chapter">The <kbd class="calibre17">string</kbd> command will return the string within that binary file.</li>
<li class="chapter">By running the <kbd class="calibre17">od</kbd> command, you will get the hexdump of the file.</li>
<li class="chapter">There are symbols present in the binary. You can list those symbols by running the <kbd class="calibre17">nm</kbd> command.</li>
<li class="chapter">By running the <kbd class="calibre17">ldd</kbd> command, you can check which shared library your binary is linked with.</li>
</ol>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Fetching time from different locations</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">In this section, we are going to learn how to use the <kbd class="calibre17">date</kbd> command to fetch time from different time zones.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">Besides having a terminal open, you need to have a basic knowledge of <kbd class="calibre17">date</kbd> command.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article class="calibre2">
                
<ol class="calibre20">
<li class="chapter">We are going to write a shell script to ascertain the time in different time zones. To do this, we are going to use the <kbd class="calibre17">date</kbd> command. Create a <kbd class="calibre17">timezones.sh</kbd> shell script and write the following code in it:</li>
</ol>
<div class="title-page-name">
<pre class="calibre27">TZ=":Antarctica/Casey" date<br class="calibre2"/>TZ=":Atlantic/Bermuda" date<br class="calibre2"/>TZ=":Asia/Calcutta" date<br class="calibre2"/>TZ=":Europe/Amsterdam" date</pre></div>
<p class="mce-root"/>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">In the preceding script, we used the <kbd class="calibre17">date</kbd> command to fetch the time. We fetched the time from four different continents—Antarctica, Atlantic, Asia, and Europe.</p>
<p class="mce-root">You can find all of the time zones in the <kbd class="calibre17">/usr/share/zoneinfo</kbd> folder on your system.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Encrypting/decrypting files from a script</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">In this section, we are going to learn about OpenSSL. In this section, we are going encrypt and decrypt messages and files using OpenSSL.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">Besides having a terminal open, you need to have a basic knowledge of encoding and decoding schemes.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article class="calibre2">
                
<ol class="calibre20">
<li class="chapter">We are going to encrypt and decrypt simple messages. We will use the -base64 encoding scheme. First, we will encrypt a message. Run the following command in the terminal:</li>
</ol>
<div class="title-page-name">
<pre class="calibre27"><strong class="calibre3">$ echo "Welcome to Bash Cookbook" | openssl enc -base64</strong></pre></div>
<ol start="2" class="calibre20">
<li class="chapter">To decrypt the message, run following command in the terminal:</li>
</ol>
<div class="title-page-name">
<pre class="calibre27"><strong class="calibre3">$ echo " V2VsY29tZSB0byBCYXNoIENvb2tib29rCg==" | openssl enc -base64 -d</strong></pre></div>
<ol start="3" class="calibre20">
<li class="chapter">Now we are going to encrypt and decrypt files. First, we will encrypt a file. Run the following command in the terminal:</li>
</ol>
<div class="title-page-name">
<pre class="calibre27"><strong class="calibre3">$ openssl enc -aes-256-cbc -in /etc/services -out enc_services.dat</strong></pre></div>
<ol start="4" class="calibre20">
<li class="chapter">Now we are going to decrypt a file. Run the following command in the terminal:</li>
</ol>
<div class="title-page-name">
<pre class="calibre27"><strong class="calibre3">$ openssl enc -aes-256-cbc -d -in enc_services.dat &gt; services.txt</strong></pre></div>
<p class="mce-root"/>
<p class="mce-root"/>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root"><strong class="calibre6">OpenSSL</strong> is a tool used for encrypting and decrypting messages, files, and directories. In the preceding example, we used the -base64 scheme. The <kbd class="calibre17">-d</kbd> option is used for decryption.</p>
<p class="mce-root">To encrypt a file, we used the <kbd class="calibre17">-in</kbd> option, followed by the file that we want to encrypt, and the <kbd class="calibre17">-out</kbd> option instructed OpenSSL to store the file. It then stores the encrypted file by the specified name.</p>


            </article>

            
        </section>
    </div>



  </body></html>