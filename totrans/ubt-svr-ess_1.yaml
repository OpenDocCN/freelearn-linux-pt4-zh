- en: Chapter 1. The Ubuntu Server Installation
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: This chapter will cover how to install Ubuntu Server by using different methods.
    We will have a look at how to install Ubuntu Server in the manual and automated
    mode by using a simple or an advanced installation.
  prefs: []
  type: TYPE_NORMAL
- en: 'To reach this goal, we will follow this plan:'
  prefs: []
  type: TYPE_NORMAL
- en: Preparation before the installation
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The manual installation
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The automated installation
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Preparation before the installation
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this section, we will take a quick look at the latest Ubuntu Server release
    news and then, we will make a list of all the system requirements.
  prefs: []
  type: TYPE_NORMAL
- en: The latest Ubuntu release
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Canonical, the company that produces Ubuntu, releases a new version every 6
    months. Each release has a code with a *YY.ZZ* pattern, where *YY* is the year
    and *ZZ* is the month.
  prefs: []
  type: TYPE_NORMAL
- en: I started writing this book just after Ubuntu 15.04 (Vivid Vervet) was released
    on April 23, 2015\. Currently, there are two major releases—the LTS one that was
    released last year (**LTS** stands for **long-term support**), which is version
    14.04, and the latest version 15.04\. It is not a big deal if you choose either
    of these two versions to perform the tasks in the coming chapters, since it will
    make no difference. So, we decided to use the latest version as a reference for
    our samples, especially because the next LTS release will be based on it. (Note
    that only the LTS releases are supported for 5 years by Canonical, and the non-LTS
    releases have a support of only 9 months. That's why we normally choose the LTS
    versions for Ubuntu Server deployments.) When there is a notable difference between
    these two versions, we will mention it.
  prefs: []
  type: TYPE_NORMAL
- en: 'Now, let''s take a look at some information related to the latest version:'
  prefs: []
  type: TYPE_NORMAL
- en: It uses Linux kernel 3.19, which brings a lot of improvements in terms of performance
    as well as network facilities for both servers and cloud.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 15.04 is the first Ubuntu version that features LXD.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: It uses the latest versions of OpenStack, **LXC** (**Linux Containers**), LXD,
    Juju, libvirt, QEMU, Open vSwitch, Ceph, cloud-init, Docker, and HA-related package
    updates.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: It replaced the service manager and the standard boot `upstart` with `systemd`.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The `upstart` boot still exists under Ubuntu. You can use it by opening the
    **GRUB** boot menu, choosing **Advanced options for Ubuntu**, and then clicking
    on **Ubuntu, with Linux** (upstart).
  prefs: []
  type: TYPE_NORMAL
- en: If you would like to switch permanently to the `upstart` boot, you can install
    the `upstart-sysv` package, which will remove `ubuntu-standard` and `systemd-sysv`.
  prefs: []
  type: TYPE_NORMAL
- en: System requirements
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: System requirements depend on the services that may need to be deployed in the
    future and installed on the server. For demonstration/test purposes, we need a
    minimal configuration of 300 MHz CPU, 192 MB of RAM, and a 1.5 GB hard disk. This
    light configuration allows us to deploy Ubuntu Server on an old computer or even
    a little virtual machine. This limited footprint is basically due to the absence
    of the X Windows System (graphic interface), which is not needed in a server environment.
  prefs: []
  type: TYPE_NORMAL
- en: In a production environment, you should be careful about your actual needs in
    terms of resources (the CPU, RAM, and hard disk) and the estimation growth of
    those needs. To do this, you need to make a good measure of dimensions based on
    the services that you are going to deploy.
  prefs: []
  type: TYPE_NORMAL
- en: In the case of the samples in this book, we will use the 64-bit version of Ubuntu
    Server 15.04, and we will install it on a virtual box machine that has 1 GB of
    RAM and 2 TB of hard disk.
  prefs: []
  type: TYPE_NORMAL
- en: Tip
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Note that if you are using a used computer/server, you should back up your data
    before installing or upgrading Ubuntu. Partitioning tools used in the installation
    process are reliable and can be used for many years without any problems in general,
    but sometimes, they can perform catastrophic actions.
  prefs: []
  type: TYPE_NORMAL
- en: Additional resources
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: This book comprises only the essentials. It contains exactly what you need to
    know to perform a specific task. If you need more information about and an in-depth
    understanding of Ubuntu, you can have a look at the official documentation by
    visiting [https://help.ubuntu.com](https://help.ubuntu.com).
  prefs: []
  type: TYPE_NORMAL
- en: You should download the CD image according to your system architecture. The
    whole list exists at [http://releases.ubuntu.com/15.04/](http://releases.ubuntu.com/15.04/).
  prefs: []
  type: TYPE_NORMAL
- en: The manual installation
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this section, we will have a look at how to install Ubuntu Server manually,
    either from the CD or the USB key. Here, we will only cover the installation from
    the CD; the same procedure applies for the installation from the USB key. In the
    latter case, you should configure your computer (using the BIOS interface) to
    boot from USB.
  prefs: []
  type: TYPE_NORMAL
- en: There is another way to manually install Ubuntu Server, which is via network,
    but since we will see this procedure in depth in the next **Automated installation**
    section, we will not cover it here.
  prefs: []
  type: TYPE_NORMAL
- en: A simple installation from a CD
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The procedure for installing Ubuntu from a CD is the same as that for most
    of the Linux distributions. So, if you are familiar with this, you can save time
    and move directly to the next section. If you are a newbie in this field, please
    follow this section closely, since the next sections (advanced installation and
    automated installation) will be based on this. Note that for Ubuntu Server edition,
    there is no graphical environment like the one in the desktop edition. So, you
    will need to use only the keyboard and not the mouse. The stepwise procedure to
    install Ubunto from CD is as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: First of all, download the installation CD image that matches your CPU architecture
    from the download page at [http://releases.ubuntu.com/15.04/](http://releases.ubuntu.com/15.04/)
    and burn it on to an empty CD.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Secondly, verify that your server BIOS is configured to boot on a CD-ROM drive;
    if this isn't the case, take care that you change it.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Insert your CD in to the CD-ROM drive and boot it.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Just after the boot process starts, you will be asked to select the installation
    language. Choose the one that you want. Don't worry if you choose some other language
    by mistake. You will soon learn how to change the settings.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Now, you will get the following interface:![A simple installation from a CD](img/B04800_01_01.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'You can see a lot of options that cater to your needs:'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: If you just press the *Enter* key when selecting the default **Install Ubuntu
    Server** option, you will start the installation process.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: The second option, **Multiple server install with MAAS**, will be covered later
    in the chapter when talking about virtualization and cloud.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Some people prefer starting with the third option, **Check disk for defects**,
    to verify that the burn process of the ISO file on the CD was done correctly.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: The fourth option, **Test memory**, is very helpful, especially when your server
    starts crashing and you suspect a RAM-related problem.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: You can use the fifth option, **Boot from first hard disk**, to bypass the boot
    from the CD in case you forgot it by mistake in the CD-ROM driver.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Finally, the last option, **Rescue a broken system**, turns a CD into a rescue
    disk that is useful for backup and recovery.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: In most of the cases, all that you need to do is launch the installation by
    pressing the **Enter** key when selecting the default **Install Ubuntu Server**
    option, but there are some cases where you need some special options, either because
    of some specific hardware-related need of your machine, or because you need to
    customize the kernel parameters of the server for future use. For this purpose,
    Ubuntu gives you a lot of possibilities via the bottom menu on the boot splash
    screen, which can be accessed via the function keys.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: If you press **F1**, you will see an interactive help screen with documentation
    for the rest of the options.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: If you accidentally chose the wrong language at the time of booting, press **F2**
    to change it. The boot screen will automatically choose a keyboard mapping based
    on your language.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: If you want a different mapping (for example, in my case, I am preparing screenshots
    for this book in English but I am using a French keyboard), press **F3** to choose
    from a list of keyboard mapping options. The boot screen also has a lot of great
    accessibility options.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: The **F4** key displays a list of installation modes from which you can choose
    to install Ubuntu Server by using an OEM installation, a minimal system, and a
    minimal virtualization guest. The OEM installation is available for manufacturers.
    The minimal virtualization guest gives you an easy way to install a virtualized
    version of Ubuntu.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: The **F5** key shows an accessibility menu that allows you to choose a high-contrast
    screen, a screen magnifier, a screen reader, a braille terminal, keyboard modifiers,
    and even an on-screen keyboard.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The real power and control over the boot process is available once you press
    the **F6** key. Here, you can see a menu of the common arguments that help the
    CD boot on difficult hardware. If you press the *Esc* key, you will move from
    this menu to the boot prompt. You can type extra kernel boot parameters that you
    might need for your hardware, as shown in the following screenshot:'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '![A simple installation from a CD](img/B04800_01_02.jpg)'
  prefs:
  - PREF_IND
  type: TYPE_IMG
- en: Just after launching the installation process, you will be asked to choose the
    language of the installation procedure, which will be the default language of
    the server that you wish to install. Select the one that you want by using the
    up/down arrow keys on your keyboard and then press the *Enter* key. You will also
    be asked for the location of the server (based on this, the system will fix the
    server time settings). Then, you have a choice of either letting the installer
    detect your keyboard layout, or you entering it manually.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: After performing these steps, the installer starts the installation process
    by detecting the hardware and loading some packages. Then, it moves on to configure
    the network settings by using **DHCP** (**Dynamic Host Configuration Protocol**)
    and asking for the hostname that you would like to give to your server. If you
    wouldn't like to use DHCP for network configuration, choose **go back** or simply
    press the *Esc* button to go to the first interface of network configuration,
    where you will find the **Configure the network manually** option, as shown in
    the following screenshot:![A simple installation from a CD](img/B04800_01_03.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: By making this choice, you will be asked via different interfaces to enter your
    IP address, Netmask, the default Gateway, and DNS.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
- en: Note that if you enter wrong information by mistake and you realize just after
    pressing the *Enter* key, don't worry. You can go back easily to the previous
    interface and re-enter the correct data. All that you need to do is choose **Go
    Back** or simply press the *Esc* button.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Also note that this data is not a tattoo, and you can change it later. We will
    have a look at how to do this in the next chapter.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: At this point, we have almost finished the network settings part. We will be
    asked for the hostname in the next screen, and then we will move on to the user
    settings. First of all, you will be asked about the full username. Then, you will
    get an interface that asks for the Ubuntu username, which will be used for authentication
    with a proposition derived from the full username that you entered before. You
    can accept the proposition or modify it. Finally, you will be asked to enter and
    re-enter a password for this user. Be careful in this step because the keys entered
    will be hidden, as shown in the following screenshot. Therefore, it is important
    to remember the keys that you have entered:![A simple installation from a CD](img/B04800_01_04.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Next, you will be asked whether you would like to encrypt your home directory.
    Don't do that unless you know what you are doing. At the end of this step, you
    will be asked to check your time zone. Change it in case it is incorrect.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Now, the most critical part of the installation arrives—partitioning! If you
    are using a new hard disk, you will see a screen, as shown in the following screenshot:![A
    simple installation from a CD](img/B04800_01_05.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: If you are using a used hard disk, you will receive an interface that is a little
    different. It contains in general the same four options with the options related
    to the reuse of the existing partitions. The first three options are the recommended
    ones for a newbie. In our case, we will choose the **Guided—use entire disk and
    set up LVM** option. The **Manual** option will be covered in the **Advanced installation**
    section.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'On pressing the *Enter* key, you will be taken to the next screen, where you
    will be asked to choose the disk that you would like to partition. You will then
    be taken to an interface, which will ask for your permission to write changes
    on the disk with the **No** option selected. We of course need to make changes
    to the disk. We should just verify that we created a backup of our data on the
    disk before moving on. The next step is to select the **Yes** option and press
    the *Enter* key. Before you finish this step, you will be asked to enter the size
    of each volume group that you will be using for this partitioning. You can answer
    with a number followed by a symbol such as MB, GB, and TB, or simply use a percentage.
    Finally, you will get a summary of the partitioning step, which needs to be confirmed
    before it is applied, as shown in the following screenshot. Select the **Yes**
    option and press the *Enter* key:'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '![A simple installation from a CD](img/B04800_01_06.jpg)'
  prefs:
  - PREF_IND
  type: TYPE_IMG
- en: At this point, the real installation process starts. During the installation,
    the installer needs only the CD, but if there is an Internet connection, it can
    be used to download software lists and install the latest updates. For that, it
    will ask you to either enter the proxy settings if you have one, or to keep this
    field empty.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'After this step, the installer will start downloading the software list (we
    will cover this later in the next chapter). This step can take some time, depending
    on your Internet speed:'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '![A simple installation from a CD](img/B04800_01_07.jpg)'
  prefs:
  - PREF_IND
  type: TYPE_IMG
- en: 'After a few minutes, the installation process starts:'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '![A simple installation from a CD](img/B04800_01_08.jpg)'
  prefs:
  - PREF_IND
  type: TYPE_IMG
- en: During this step, you will be asked about the update policy. Personally, I recommend
    that you deactivate the automatic installation of updates. It is better when the
    administrator manages the installation of updates manually depending on the servers
    that are running on Ubuntu Server.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: One of the useful facilities that are given by the Ubuntu installer is the ability
    to choose to install server packages such as the SSH and DNS server. You can choose
    one of them by pressing the *space bar*, and you can continue the installation
    process by pressing the *Enter* key. In our case, we will decide not to install
    a server at this step. We will have a look at how to do this in a later chapter:![A
    simple installation from a CD](img/B04800_01_09.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Finally, you will be asked to confirm the installation of the GRUB boot loader
    to the **Master Boot Recorder** (**MBR**). Then, you will get the following notification
    at the end of the installation process:![A simple installation from a CD](img/B04800_01_10.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Upgrading from an old release
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In case you have an existing Ubuntu Server and you would like to upgrade it
    to the newest release, you can use the `do-release-upgrade` command. This command
    is a part of the `update-manager-core` package; it does not have any graphical
    dependencies and is installed by default.
  prefs: []
  type: TYPE_NORMAL
- en: 'You can check the options list associated with this command by running the
    following:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'You will find the following options very useful:'
  prefs: []
  type: TYPE_NORMAL
- en: '`do-release-upgrade --check-dist-upgrade-only`: The `--check-dist-upgrade-only`
    option checks for a new version. If a new version is found, it is displayed as
    a result in the terminal. Once executed, this command performs only a verification
    job; no upgrade is made.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`do-release-upgrade --sandbox`: The `--sandbox` option is used to test an upgrade
    in a protected environment. This is particularly useful if you wish to test the
    deployment of an upgrade prior to its application in the production environment.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`do-release-upgrade`: The `do-release-upgrade` tool researches and makes an
    upgrade to the next LTS or stable version available, if it exists.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Tip
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The upgrade policy used by the `do-release-upgrade` tool is defined in the `/etc/update-manager/release-upgrades`
    file. The prompt variable at the end of the file indicates whether only the LTS
    versions will be considered or all the versions (the LTS ones as well as the regular
    ones) will be searched for when asking for an upgrade. The prompt variable can
    take as values `lts` for the LTS versions, `normal` for all versions, and `never`
    to never search for new versions.
  prefs: []
  type: TYPE_NORMAL
- en: You should only use the `Prompt=lts` mode when you are deploying a version of
    Ubuntu that is already an LTS. Otherwise, no new version will be detected by `do-release-upgrade`.
  prefs: []
  type: TYPE_NORMAL
- en: The advanced installation
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Much of the Ubuntu Server installation process fulfils a majority of user needs,
    and it is used in the same manner by most of the users (newbie or advanced), but
    the part that requires much more attention and which is customized by many advanced
    system administrators depending on their needs is the partitioning step. In this
    section, we will have a look at how to perform an advanced partitioning for a
    specific hard disk schema.
  prefs: []
  type: TYPE_NORMAL
- en: Using RAID
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The **RAID** technology (an acronym for **Redundant Array of Inexpensive Disks**)
    refers to the techniques used to distribute data across multiple hard drives (creating
    a storage unit from several hard disks). The unit thus created has an improved
    fault tolerance (high availability) or a greater performance (the capacity/write
    speed). The distribution of data on several hard drives allows you to increase
    the safety and reliability of the associated services.
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: For more information about this technology, you can take a tour at [http://www.tldp.org/HOWTO/Software-RAID-HOWTO.html](http://www.tldp.org/HOWTO/Software-RAID-HOWTO.html).
  prefs: []
  type: TYPE_NORMAL
- en: 'In this section, we will see how to install Ubuntu Server using two RAID1 partitions
    on two different hard disks, one for the **root** and the other for **Swap**:'
  prefs: []
  type: TYPE_NORMAL
- en: In the **Partition disk** step, select **manual**. Then, select one by one all
    the disks that you want and which should be a part of the RAID partitions (in
    our case, only two disks). For each disk, create a new empty partition table on
    it.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select the free space on the first drive. Then, choose **Create a new partition**.
    Set the size that you want for **Swap**; it should be twice the RAM size and up
    to 2 GB. Then, choose **Primary** and select **Beginning**. The **physical volume
    for RAID** option should be chosen in the **Use as:** line. Finally, select **Done
    setting up partition**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: With the remaining free space, perform the same steps for the root partition.
    The only exception is that after setting the size, choose **Continue** and then
    select **Primary**. Also, select the **Bootable flag:** line to change the value
    to **on**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Return to the **Partition Disks** step and select **Configure Software RAID**
    at the beginning of the page. Then, choose **yes** to write the modifications
    to disk.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In the **Create MD device** setup and for this example, choose **RAID1**, but
    if you are applying another architecture, choose the one that fits your needs.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Now, enter the number of hard drives that you have chosen for the array (in
    our case, we have two active devices). Then, select **Continue**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Next, enter the number of spare devices (choose the default setting for RAID1,
    which is 0) and then select **Continue**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: At this step, choose the partitions that you wish to use. For the **Swap** partition,
    choose **sda1** and **sdb1**. Select **Continue** to go to the next step.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Repeat steps 3 to 7 to prepare the root partition, and at the end, choose **sda2**
    and **sdb2**. Finally, select **Finish**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'We should now have a list of RAID devices and hard drives. The next remaining
    steps are required to format and set the mount point for the RAID devices. Deal
    with the RAID devices as a local hard disk; format and mount accordingly:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Getting back to the initial partitioning page again, we will see our newly
    created **RAID devices #0** and **#1** partitions.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Under the **RAID1 device #0** partition, select **#1** and press the *Enter*
    key.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In the **Use as:** file, select **swap area** and then apply this partition
    by using the **Done setting up partition** entry.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Under the **RAID1 device #1** partition, select **#1** and press the *Enter*
    key.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In the **Use as:** file, select **Ext4 journaling file system**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In the **Mount point** field, choose **/** (the root file system). You can change
    the other options as you wish. Then, apply that partition by using the **Done
    setting up partition** entry.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Finally, select **Finish partitioning and write changes to disk**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The installation process will then continue normally.
  prefs: []
  type: TYPE_NORMAL
- en: Using LVM
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '**LVM** (**Logical Volume Manager**) allows the creation and the management
    of logical volume on Linux. The use of logical volumes somehow replaces the disks''
    partitioning. This is a much more flexible system as it allows you, for instance,
    to reduce the size of a file system to expand another one regardless of their
    location on disks.'
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: For more information about this technology, you can take a tour at [http://tldp.org/HOWTO/LVM-HOWTO/](http://tldp.org/HOWTO/LVM-HOWTO/).
  prefs: []
  type: TYPE_NORMAL
- en: 'In this section, we will have a look at the partitioning step of Ubuntu Server
    installation process with the **/srv** partition mounted on a LVM volume. This
    section will be divided into two parts—the first part is during the Ubuntu installation
    within only one **PV** (**physical volume**), which will be a part of the **VG**
    (**volume group**), and the second part will be after the Ubuntu installation.
    While performing this process, we will demonstrate how to add a second PV to the
    VG:'
  prefs: []
  type: TYPE_NORMAL
- en: In the **Partition disks** screen, choose **Manual**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select the hard disk. Then, choose **Yes** to confirm the **Create a new empty
    partition table on this device** order.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Next, create standard swap and / partitions with the file system that you want.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: For our `/srv` LVM partition, create a new logical partition and change the
    **Use as** field to **physical volume for LVM**. Then, select **Done setting up
    the partition**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Now, choose **Configure the Logical Volume Manager** and select **Yes**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: On the next screen and for **LVM configuration action**, select **Create volume
    group**. Name the VG (for example, vg01). Then, select the partition prepared
    for LVM and choose **Continue**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Return to the **LVM configuration action** page and select **Create logical
    volume**. Choose the newly created VG and name the new LV. Then, choose a size
    and at the end, select **Finish**. You will be taken to the main **Partition Disks**
    page again.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Now, let's add a file system to our new LVM. To do this, select the partition
    under the LVM that you created and set up the file system that you want and choose
    **/srv** as the mount point. Next, select **Done setting up the partition**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Finally, apply the **Finish partitioning and write changes to disk** order.
    Then, confirm the changes and continue your installation.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Now, we will continue with the second part that started after the Ubuntu Server
    installation and which covers adding a second hard disk, creating a PV, adding
    it to the existing VG, extending LV with the srv command, and finally extending
    the file system. In this part, we will use a second hard disk named `/dev/sdb`,
    and we will use it entirely as a PV. You can configure and use as much of PV as
    you want:'
  prefs: []
  type: TYPE_NORMAL
- en: 'First of all, create the PV using the following command:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Next, extend the VG (called `vg01` in our example), as follows:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Use the `vgdisplay` command to find out the size that you can allocate (for
    free physical extents, see the **Free PE / size** line). We will assume in our
    example a free size of 511 PE (which is equivalent to 2 GB with a size of 4 MB
    PE), and we will use the entire available free space.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'We can now use the PE to extend the LV via the following command (there are
    other methods, but they are beyond the scope of this book):'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: We used the `-l` option here to extend the LV using PE. If you want to extend
    using MB, GB, and TB, you can use the `-l` option.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Before expanding an `ext3` or `ext4` file system, it is recommended that you
    unmount it before hand (as best practice). In case you want to reduce an LV, it
    will be mandatory to unmount it. The following commands unmount the partition
    and then check it:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Finally, you can resize the file system by using the following command:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Now, you can mount the partition and check its new size using the following
    command:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: The automated installation
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Sometimes, we have a large number of servers to install. In this case, the manual
    installation will take a lot of time to perform a repetitive task. To solve this
    problem, there is the automation installation, or what we call the network boot.
  prefs: []
  type: TYPE_NORMAL
- en: For this, we need a machine equipped with a DHCP server and a TFTP server that
    will provide us the services and configuration files that we need for the system
    to be installed.
  prefs: []
  type: TYPE_NORMAL
- en: The PXE process
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The client computer (our future server) will boot its network interface in the
    **PXE** (**Preboot Execution Environment**) mode. Then, the DHCP present on the
    network will send it the `pxelinux.0` file; this will be explained later. Thus,
    the client computer accesses the `pxelinux.cfg` configuration file via TFTP, which
    contains the necessary information required to launch the installation process.
  prefs: []
  type: TYPE_NORMAL
- en: The PXE installation procedure
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'Let''s start with the server installation:'
  prefs: []
  type: TYPE_NORMAL
- en: First of all, install the DHCP server by using the `sudo apt-get install isc-dhcp-server
    -y` command, and then configure it by using the `/etc/default/isc-dhcp-server`
    file to use the network that you want for listening (such as `eth0`).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'In the `/etc/dhcp/dhcpd.conf` file, you should configure some parameters such
    as the subnet and the address range. Then, restart it by using the following command:'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'After this, install the following packages that are necessary if you wish to
    set up the PXE environment:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Now, it is time to configure the TFTP service. To do this, add the following
    two lines to the `/etc/default/tftpd-hpa` file:'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Also, add the following line at the end of the `/etc/inetd.conf file`:'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Then, reboot the service using the `sudo /etc/init.d/tftpd-hpa restart` command.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'Now, we need to copy the installation files to the PXE server. In our example,
    I used the ISO image that I have in my home directory. First of all, mount it
    by using the following command:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE11]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Then, copy the required files to the server by using the following commands:'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE12]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'After doing this, modify the `/var/lib/tftpboot/pxelinux.cfg/default` PXE config
    file by adding the following lines at the end:'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE13]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Be careful when adding the IP address.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'The last step required to set up the PXE server is to add the following lines
    at the end of the `/etc/dhcp/dhcpd.conf` file:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE14]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Then, reboot the DHCP server by using the following command:'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE15]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Let''s move on to the client configuration. In our case, I used a `virtualbox`
    instance to test this kind of installation:'
  prefs: []
  type: TYPE_NORMAL
- en: Create the virtual machine with the characteristics that you want via the `virtualbox`
    manager.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Then, go to the **Settings** of the machine and select the **System** tab. In
    the **Boot Order** part, deselect all options and select **Network**, as shown
    in the following screenshot:![The PXE installation procedure](img/B04800_01_11.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select the **Network** tab and configure the network adaptor to act as a bridge.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Finally, start your VM. You will see the following interface:![The PXE installation
    procedure](img/B04800_01_12.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Enjoy watching the server installation if you were doing it locally from a CD.
  prefs: []
  type: TYPE_NORMAL
- en: Tip
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The PXE installation can be used to install a lot of machines in parallel as
    well as to install Ubuntu Server on machines without a CD-ROM driver.
  prefs: []
  type: TYPE_NORMAL
- en: The installation process will be entirely automated if you combine the PXE method
    with a `kickstart` and/or `preseed` file. A good starting point for working with
    `kickstart` is [https://help.ubuntu.com/community/KickstartCompatibility](https://help.ubuntu.com/community/KickstartCompatibility).
  prefs: []
  type: TYPE_NORMAL
- en: Additional resources
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Since this book consists of the essentials for the Ubuntu Server, we can''t
    cover topics in depth. Therefore, here are some useful links that will help you
    go as far as you want in this subject:'
  prefs: []
  type: TYPE_NORMAL
- en: For details regarding the installation of the Ubuntu desktop from a PXE server,
    visit [https://help.ubuntu.com/community/Installation/LocalNet](https://help.ubuntu.com/community/Installation/LocalNet).
    You can use the same procedure to install Ubuntu Server.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: To learn how to prepare a PXE server that allows you to boot multiple distributions
    (Ubuntu, Debian, Fedora, CentOS, and openSUSE), visit [https://help.ubuntu.com/community/PXEInstallMultiDistro](https://help.ubuntu.com/community/PXEInstallMultiDistro).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: For those of you searching for how to set up a MAAS server that will deploy
    a Ubuntu system through `netboot`, a very good guide is available at [http://maas.ubuntu.com/docs/install.html](http://maas.ubuntu.com/docs/install.html).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, we had a look at how to install Ubuntu Server in different
    modes—manually and automated—with the help of a simple or an advanced installation.
  prefs: []
  type: TYPE_NORMAL
- en: Now, we can start managing our server, which is the subject that we will cover
    in the next chapter.
  prefs: []
  type: TYPE_NORMAL
