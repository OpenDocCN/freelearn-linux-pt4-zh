<html><head></head><body><div class="chapter" title="Chapter&#xA0;1.&#xA0;Setting Up Your Raspberry Pi"><div class="titlepage"><div><div><h1 class="title"><a id="ch01"/>Chapter 1. Setting Up Your Raspberry Pi</h1></div></div></div><p>Before we can get into the realms of building our home security system, there's a bit of preparation work needed to get our Raspberry Pi up and running. So, we're going to go through the initial steps needed to get our Pi ready to be worked on.</p><p>In this chapter, we will cover the following topics:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Exploring the different versions of the Raspberry Pi that are available</li><li class="listitem" style="list-style-type: disc">Choosing the right Raspberry Pi version for your system</li><li class="listitem" style="list-style-type: disc">Preparing the SD Card with the Raspbian Operating System</li><li class="listitem" style="list-style-type: disc">Learning how to remotely access the Raspberry Pi over your home network</li><li class="listitem" style="list-style-type: disc">Updating our operating system with the latest packages</li><li class="listitem" style="list-style-type: disc">Exploring the time-keeping options on the Raspberry Pi</li><li class="listitem" style="list-style-type: disc">Setting the user and root passwords to secure our Raspberry Pi</li></ul></div><div class="section" title="Which flavor of Pi?"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec08"/>Which flavor of Pi?</h1></div></div></div><p>Since the Raspberry Pi was released in 2012, there have been several versions of the mini-PC board released. I'll go though each of the versions released with their respective features so that you can choose which one is suitable for your particular project.</p><p>The good news is<a id="id0" class="indexterm"/> that it doesn't really matter which version you use in terms of power, as our home security system doesn't necessarily need loads of processing power, depending on what you want your system to do, of course). You might have an older board kicking about that will work for you.</p><p>The other piece of good news is that the GPIO interface pin layouts are the same across all the versions. The later versions have more pins, but the original 26 pins still remain in the same place.</p><div class="mediaobject"><img src="graphics/B04579_01_10.jpg" alt="Which flavor of Pi?"/><div class="caption"><p>The latest Raspberry Pi Version 2</p></div></div><div class="section" title="Raspberry Pi Model A"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec07"/>Raspberry Pi Model A</h2></div></div></div><p>The baby of the<a id="id1" class="indexterm"/> family is the Model A; it was released as a lower-cost version of the<a id="id2" class="indexterm"/> Model B, shown in the following section. Its main differences from the Model B are that it features just 256Mb of memory and has no Ethernet port; so if you want to connect this board to a network, you are limited to using a USB Wi-Fi dongle.</p><div class="mediaobject"><img src="graphics/5278_Ch01_01.jpg" alt="Raspberry Pi Model A"/><div class="caption"><p>The Raspberry Pi Model A Board Layout</p></div></div></div><div class="section" title="Raspberry Pi Model B"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec08"/>Raspberry Pi Model B</h2></div></div></div><p>This was the first version of Raspberry Pi to be released; an updated revision, which improved the power<a id="id3" class="indexterm"/> system and USB port protection, came later. It features 512Mb of memory and has an Ethernet port for connecting to your network. This is probably the <a id="id4" class="indexterm"/>most common version used, and having the Ethernet port is incredibly useful, especially to get up and run quickly in order to set up and configure your Pi without the need for a keyboard and monitor.</p><div class="mediaobject"><img src="graphics/5278_Ch01_02.jpg" alt="Raspberry Pi Model B"/><div class="caption"><p>The Raspberry Pi Model B Layout</p></div></div></div><div class="section" title="Raspberry Pi Model B+ and Model 2"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec09"/>Raspberry Pi Model B+ and Model 2</h2></div></div></div><p>In 2014, the Raspberry Pi Foundation released a new version of the board that had some fundamental <a id="id5" class="indexterm"/>changes as compared to the previous version. The most fundamental changes were the board layout, form factor, and mounting points—much to the dismay<a id="id6" class="indexterm"/> of the many enclosure and accessory manufacturers out there.</p><p>In fact, we were<a id="id7" class="indexterm"/> in the middle of prototyping an enclosure for a commercial product that we were developing based on the Raspberry Pi—fortunately we caught wind of the board change in the nick of time and were able to change our enclosure to support the upcoming model B+.</p><p>The main electronic changes<a id="id8" class="indexterm"/> to this board are the addition of 2 more USB ports that can deliver more power to peripherals, an expanded GPIO interface, and the removal of the composite video port that is now consolidated into the audio jack. It also now uses a micro SD card with a better card slot.</p><p>In February 2015, a more powerful Raspberry Pi was released: the Raspberry Pi Model 2. It's similar to the Model B+ in terms of form-factor and interfaces, but is now reportedly 6-times faster than the Model B/B+ with its upgraded ARM processor and 1Gb of memory.</p><p>At the same low cost of less than £30, it's a fantastic little board and a great power-house for embedded systems.</p><div class="mediaobject"><img src="graphics/5278_Ch01_03.jpg" alt="Raspberry Pi Model B+ and Model 2"/><div class="caption"><p>The Raspberry Pi Model B+ and Model 2 Layout</p></div></div></div><div class="section" title="Model comparison table"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec10"/>Model comparison table</h2></div></div></div><div class="informaltable"><table border="1"><colgroup><col style="text-align: left"/><col style="text-align: left"/><col style="text-align: left"/><col style="text-align: left"/><col style="text-align: left"/></colgroup><thead><tr><th style="text-align: left" valign="bottom"> </th><th style="text-align: left" valign="bottom">
<p>Model A</p>
</th><th style="text-align: left" valign="bottom">
<p>Model B</p>
</th><th style="text-align: left" valign="bottom">
<p>Model B+</p>
</th><th style="text-align: left" valign="bottom">
<p>Version 2</p>
</th></tr></thead><tbody><tr><td style="text-align: left" valign="top">
<div class="informalexample"><pre class="programlisting">Processor</pre></div>
</td><td colspan="3" style="text-align: center" valign="top">
<p>
</p><div class="informalexample"><pre class="programlisting">ARM1176JZF-S 700 MHz processor, VideoCore IV GPU</pre></div></td><td style="text-align: left" valign="top">
<div class="informalexample"><pre class="programlisting">Quad-core ARM Cortex-A7 CPU and a VideoCore IV dual-core GPU</pre></div></td></tr><tr><td style="text-align: left" valign="top">
<div class="informalexample"><pre class="programlisting">Memory</pre></div></td><td style="text-align: left" valign="top">
<div class="informalexample"><pre class="programlisting">256Kb</pre></div></td><td style="text-align: left" valign="top">
<div class="informalexample"><pre class="programlisting">512Kb</pre></div></td><td style="text-align: left" valign="top">
<div class="informalexample"><pre class="programlisting">512Kb</pre></div></td><td style="text-align: left" valign="top">
<div class="informalexample"><pre class="programlisting">1Gb</pre></div></td></tr><tr><td style="text-align: left" valign="top">
<div class="informalexample"><pre class="programlisting">USB Ports</pre></div></td><td style="text-align: left" valign="top">
<div class="informalexample"><pre class="programlisting">2</pre></div></td><td style="text-align: left" valign="top">
<div class="informalexample"><pre class="programlisting">2</pre></div></td><td style="text-align: left" valign="top">
<div class="informalexample"><pre class="programlisting">4</pre></div></td><td style="text-align: left" valign="top">
<div class="informalexample"><pre class="programlisting">4</pre></div></td></tr><tr><td style="text-align: left" valign="top">
<div class="informalexample"><pre class="programlisting">Ethernet</pre></div></td><td style="text-align: left" valign="top">
<div class="informalexample"><pre class="programlisting">No</pre></div></td><td style="text-align: left" valign="top">
<div class="informalexample"><pre class="programlisting">Yes</pre></div></td><td style="text-align: left" valign="top">
<div class="informalexample"><pre class="programlisting">Yes</pre></div></td><td style="text-align: left" valign="top">
<div class="informalexample"><pre class="programlisting">Yes</pre></div></td></tr><tr><td style="text-align: left" valign="top">
<div class="informalexample"><pre class="programlisting">No.GPIO Pins</pre></div></td><td style="text-align: left" valign="top">
<div class="informalexample"><pre class="programlisting">26</pre></div></td><td style="text-align: left" valign="top">
<div class="informalexample"><pre class="programlisting">26</pre></div></td><td style="text-align: left" valign="top">
<div class="informalexample"><pre class="programlisting">40</pre></div></td><td style="text-align: left" valign="top">
<div class="informalexample"><pre class="programlisting">40</pre></div></td></tr><tr><td style="text-align: left" valign="top">
<div class="informalexample"><pre class="programlisting">Storage</pre></div></td><td style="text-align: left" valign="top">
<div class="informalexample"><pre class="programlisting">SD Card</pre></div></td><td style="text-align: left" valign="top">
<div class="informalexample"><pre class="programlisting">SD<a id="id9" class="indexterm"/> Card</pre></div></td><td style="text-align: left" valign="top">
<div class="informalexample"><pre class="programlisting">Micro SD Card</pre></div></td><td style="text-align: left" valign="top">
<div class="informalexample"><pre class="programlisting">Micro SD Card</pre></div></td></tr></tbody></table></div></div><div class="section" title="So which one?"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec11"/>So which one?</h2></div></div></div><p>Essentially, any<a id="id10" class="indexterm"/> version of the Raspberry Pi will work with the modules presented in this book, but if you want to exploit features such as the camera, which may require more processing power and memory, or want to have an Ethernet connection, you'll need to use the Model B.</p><p>If you want to start plugging additional stuff into the USB port, such as a GSM modem, then I recommend that you use the Model B+ as it delivers more power to those kinds of devices without the need for additional USB hubs.</p><p>If you want to do<a id="id11" class="indexterm"/> more processing with video and images from an attached camera, or want to connect lots of things, then go for the latest <span class="strong"><strong>Model 2</strong></span> board. I'm<a id="id12" class="indexterm"/> going to assume that's the one you have chosen for this project, and that's the one I'll be using throughout this book; just be aware of any limitations if you choose to use an earlier model.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note02"/>Note</h3><p>The Raspberry<a id="id13" class="indexterm"/> Pi Foundation site has more detailed information about each model. You can visit it at <a class="ulink" href="https://www.raspberrypi.org/products">https://www.raspberrypi.org/products</a>.</p></div></div></div></div></div>
<div class="section" title="Preparing the SD card"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec09"/>Preparing the SD card</h1></div></div></div><p>The Raspberry Pi <a id="id14" class="indexterm"/>only boots from an SD card (or micro SD card for the B+ and v2 models), and cannot boot from an external drive or USB stick (well that's not strictly true, but is beyond the scope of this book).</p><p>It's recommended that you use a Class 10 SD card for performance, but a Class 4 or 6 card will be fine for this project. You'll need to have a minimum card size of 4Gb.</p><p>Now that we have our Raspberry Pi board and SD card to hand, we need to prepare the SD Card specifically for our home security system. We're going to use the standard Raspbian operating system as there really is no reason to use any other distribution; it's the de facto choice for the Raspberry Pi.</p><div class="section" title="Downloading the Raspbian image"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec12"/>Downloading the Raspbian image</h2></div></div></div><p>You'll need to grab<a id="id15" class="indexterm"/> the latest <span class="strong"><strong>Raspbian OS</strong></span> image from<a id="id16" class="indexterm"/> the Raspberry Pi site at <a class="ulink" href="https://www.raspberrypi.org/downloads">https://www.raspberrypi.org/downloads</a>.</p><p>Download the<a id="id17" class="indexterm"/> Raspbian OS ZIP file containing the image to your PC.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note03"/>Note</h3><p>At the time of writing, the latest version was Raspbian Jessie version 4.1 (<code class="literal">2015-09-24-raspbian-jessie.zip)</code>.</p></div></div><p>Once downloaded, unzip the file and you'll have the file, <code class="literal">2015-09-24-raspbian-jessie.img</code>.</p><p>The next thing to do is burn this image to your SD card…</p></div><div class="section" title="Using Microsoft Windows"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec13"/>Using Microsoft Windows</h2></div></div></div><p>On a Windows PC, the best<a id="id18" class="indexterm"/> way to burn the image to your SD card is to <a id="id19" class="indexterm"/>use the <span class="strong"><strong>Win32 Disk Imager</strong></span> utility. This can be downloaded from <a class="ulink" href="http://sourceforge.net/projects/win32diskimager">http://sourceforge.net/projects/win32diskimager</a>.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note04"/>Note</h3><p>The current version, at the time of writing, is 0.9.5.</p></div></div><p>It doesn't have <a id="id20" class="indexterm"/>an installer, and launches directly from the EXE file.</p><p>Now, it's time to create your SD card image:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Insert your SD card into the PC and launch the Win32 Disk Imager.</li><li class="listitem">Select the SD card device drive letter (make sure it's right!).</li><li class="listitem">Choose the Raspbian image file you've just downloaded.</li><li class="listitem">Click on the <span class="strong"><strong>Write</strong></span> button to create the SD card image.<div class="mediaobject"><img src="graphics/5278_Ch01_05.jpg" alt="Using Microsoft Windows"/></div></li></ol></div></div><div class="section" title="Using Linux"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec14"/>Using Linux</h2></div></div></div><p>On a Linux PC, you'll need to<a id="id21" class="indexterm"/> use the <span class="strong"><strong>gparted</strong></span> and <span class="strong"><strong>dd</strong></span> utilities to burn the<a id="id22" class="indexterm"/> image on your SD card.</p><p>Carry out the following steps to create your SD card image:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Extract <code class="literal">2015-09-24-raspbian-jessie.img</code> to your <code class="literal">Home</code> folder.</li><li class="listitem">Insert your SD card into the PC.</li><li class="listitem">If you're not already in a shell terminal window, open one (you can use <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>Alt</em></span> + <span class="emphasis"><em>T</em></span> on most graphical-based desktop systems).</li><li class="listitem">Type the following command in the shell terminal:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ sudo fdisk -l </strong></span>
</pre></div><p>In the list check, your SD card appears as a drive device (for example, <code class="literal">/dev/sdb</code>). It's crucial that you ensure you use the right device in the next step. We'll assume that your device is <code class="literal">/sdb</code>.</p></li><li class="listitem">To burn the image to the SD card, type the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ sudo dd if=2015-09-24-raspbian-jessie.img of=/dev/sdb</strong></span>
</pre></div></li><li class="listitem">Hit <span class="emphasis"><em>Enter</em></span> and<a id="id23" class="indexterm"/> go make a cup of tea or coffee as this will take a while. You'll know that it's finished<a id="id24" class="indexterm"/> when the command (<code class="literal">$</code>) prompt re-appears.</li><li class="listitem">When the command prompt does re-appear, type the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ sudo sync</strong></span>
</pre></div></li><li class="listitem">Once that command has finished, you can remove the SD card from the PC.</li></ol></div></div><div class="section" title="Booting your Pi"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec15"/>Booting your Pi</h2></div></div></div><p>You're now ready to <a id="id25" class="indexterm"/>boot up your Raspberry Pi. Pop your shiny new SD card into it and plug in the power.</p><p>Assuming that you have a monitor attached to your Pi, you should see your system booting up nicely. Although you could wait for it to boot up and connect to it via a terminal session (we'll look at that later), I recommend that you connect a monitor to it, at least in the first instance, just to make sure everything is working correctly.</p><p>In the new<a id="id26" class="indexterm"/> <span class="strong"><strong>Jessie</strong></span> version of Raspbian, you'll boot straight into a desktop GUI, which is a major change from previous versions, where you'd be taken to the <span class="strong"><strong>raspi-config</strong></span> utility, the<a id="id27" class="indexterm"/> first time the system is run, where you'd set up your Pi, and importantly, expand the file system to use the entire space available on your SD card.</p><div class="mediaobject"><img src="graphics/B04579_01_11.jpg" alt="Booting your Pi"/><div class="caption"><p>Debian Jessie boots into the GUI by default</p></div></div></div><div class="section" title="Expanding the file system"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec16"/>Expanding the file system</h2></div></div></div><p>When you first <a id="id28" class="indexterm"/>create your Raspbian SD card, you'll only be left with about 200Mb of space in the file system, regardless of the size of your SD card. This is not<a id="id29" class="indexterm"/> much use, so we want to expand the file system so that it uses all of the available space on the card.</p><p>Fortunately, this is very easy on the Raspberry Pi now, as this function is available in the Raspberry Pi Configuration Tool on the desktop.</p><p>To access the new configuration tool, go to <span class="strong"><strong>Menu</strong></span> and select <span class="strong"><strong>Preferences</strong></span> | <span class="strong"><strong>Raspberry Pi Configuration</strong></span>.</p><div class="mediaobject"><img src="graphics/B04579_01_12.jpg" alt="Expanding the file system"/><div class="caption"><p>The new Raspberry Pi Configuration Tool</p></div></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip02"/>Tip</h3><p>
<span class="strong"><strong>Goodbye GUI</strong></span>
</p><p>Most of our work is going to be done in the command-line interface (CLI). Therefore, before we reboot the system in a minute, let's change the <span class="strong"><strong>Boot</strong></span> option by selecting <span class="strong"><strong>To CLI</strong></span>, as shown<a id="id30" class="indexterm"/> in the previous screenshot, so boot into the command line going forward.</p></div></div><p>Anyway, now we<a id="id31" class="indexterm"/> click on the <span class="strong"><strong>Expand Filesystem</strong></span> button, and in a couple of seconds, you'll see a confirmation message. The filesystem will be expanded when the system next reboots.</p><div class="section" title="Using the raspi-config utility"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl3sec01"/>Using the raspi-config utility</h3></div></div></div><p>If you have an<a id="id32" class="indexterm"/> older version of Raspbian, or you're not using the desktop GUI, then you'll need to use the raspi-config utility (which is still better than the old days when we had to do this manually in the shell). The first time you boot up, you'll be taken straight to the raspi-config utility.</p><div class="mediaobject"><img src="graphics/5278_Ch01_06.jpg" alt="Using the raspi-config utility"/></div><p>The first option is the <code class="literal">Expand Filesystem</code> option; select this and you'll see various commands scrolling up<a id="id33" class="indexterm"/> the screen. Once it's finished, you'll see the following message:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>Root partition has been resized.</strong></span>
<span class="strong"><strong>The filesystem will be enlarged upon the next reboot</strong></span>
</pre></div><p>Click on <code class="literal">OK</code>.</p><p>Select <code class="literal">Finish</code> on the config screen and reboot your Pi when prompted.</p><p>After your Pi reboots with its fuller file system, you'll be taken straight to the shell prompt where you can log in with the default user and password.</p><p>
<span class="strong"><strong>Login</strong></span>: <code class="literal">pi</code>
</p><p>
<span class="strong"><strong>Password</strong></span>: <code class="literal">raspberry</code>
</p></div></div></div>
<div class="section" title="Setting up your Pi"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec10"/>Setting up your Pi</h1></div></div></div><p>When you<a id="id34" class="indexterm"/> boot into the shell and have the Ethernet connected, hopefully the Pi will have connected to your home network and acquired an IP address from your router. If this is the case, you <a id="id35" class="indexterm"/>should see the <span class="strong"><strong>IP address</strong></span> that has been issued just before the login prompt, as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/5278_Ch01_07.jpg" alt="Setting up your Pi"/></div><p>As you can see from my screenshot, it's given me the IP address, <code class="literal">192.168.0.118</code>. This is good because I can now access the Pi remotely, using a secure shell (SSH) client to connect to it from the comfort of my laptop. This is particularly useful when my Pi is in the office and I <a id="id36" class="indexterm"/>want to sit on my sofa in front of the telly but still work on it, which I often do when I'm feeling lazy.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip03"/>Tip</h3><p>
<span class="strong"><strong>Downloading the example code</strong></span>
</p><p>You can download the example code files from your account at <a class="ulink" href="http://www.packtpub.com">http://www.packtpub.com</a> for all the Packt Publishing books you have purchased. If you purchased this book elsewhere, you can visit <a class="ulink" href="http://www.packtpub.com/support">http://www.packtpub.com/support</a> and register to have the files e-mailed directly to you.</p></div></div><p>To do this, download<a id="id37" class="indexterm"/> <span class="strong"><strong>PuTTY</strong></span>: a utility that allows you to connect to shell terminals remotely over the network. You can download it from <a class="ulink" href="http://www.putty.org">http://www.putty.org</a>.</p><p>Install and launch <span class="strong"><strong>PuTTY</strong></span> and you're ready to connect to your Pi remotely from the comfort of your sofa.</p><div class="mediaobject"><img src="graphics/5278_Ch01_08.jpg" alt="Setting up your Pi"/></div><p>Type the IP <a id="id38" class="indexterm"/>address of the Raspberry Pi into the Host Name box and click on <span class="strong"><strong>Open</strong></span>. You'll be connected to your Pi in a remote terminal window. Once you've logged in, you can do pretty much everything on your Pi, as if you were sitting in front of it.</p><div class="mediaobject"><img src="graphics/B04579_01_09.jpg" alt="Setting up your Pi"/></div><p>We'll assume from now on that most of the work we do will be through a remote shell session, unless highlighted otherwise.</p><p>If you want to <a id="id39" class="indexterm"/>use the command line to launch the Raspberry Pi remote shell—for example, from another Linux system—use the following command from your terminal window:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># ssh pi@192.168.0.125</strong></span>
</pre></div><p>You'll then be prompted for the Pi's password and taken into a shell session.</p><div class="mediaobject"><img src="graphics/B04579_01_13.jpg" alt="Setting up your Pi"/><div class="caption"><p>The Pi shell session launched from a Debian desktop terminal window</p></div></div><div class="section" title="Getting up to date"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec17"/>Getting up to date</h2></div></div></div><p>Something that<a id="id40" class="indexterm"/> you should get into the habit of doing is updating the operating system regularly; even though you may have the latest image installed, it's very likely that there are updated packages available. To update your OS, enter the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ sudo apt-get update</strong></span>
</pre></div><p>After this, enter the following one:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ sudo apt-get dist-upgrade</strong></span>
</pre></div><p>This may take a while, depending on the number of updates required.</p></div><div class="section" title="Getting the right time"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec18"/>Getting the right time</h2></div></div></div><p>The<a id="id41" class="indexterm"/> Raspberry Pi doesn't have on-board real-time<a id="id42" class="indexterm"/> clock hardware. This is one of the deliberate omissions to keep the cost of the board down. Instead, the Pi gets its time when it boots up<a id="id43" class="indexterm"/> from time servers on the Internet using the <span class="strong"><strong>Network Time Protocol</strong></span> (<span class="strong"><strong>NTP</strong></span>). However, if there is no Internet connection at the time of booting up, then the time will be wrong.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note05"/>Note</h3><p>In our security system, it's important that the time is kept accurate so that timestamps on log files and images are correct.</p></div></div><div class="section" title="fake-hwclock"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl3sec02"/>fake-hwclock</h3></div></div></div><p>The <code class="literal">fake-hwclock</code> package is<a id="id44" class="indexterm"/> included in the <a id="id45" class="indexterm"/>latest Raspbian distributions, but in other past versions it <a id="id46" class="indexterm"/>wasn't. If you need to install it, use the command that follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ sudo apt-get install fake-hwclock</strong></span>
</pre></div><p>
<code class="literal">fake-hwclock</code> is used by the Raspberry Pi to try and keep time when there is no network connection. It will regularly save the current time and restore it at boot-up. The obvious problem with this is that if the Pi has been switched off a few days, then the time will be set to the last time that it was on, using <code class="literal">fake-hwclock</code>.</p><p>If you want to see what time it last logged, type the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ cat /etc/fake-hwclock.data</strong></span>
</pre></div></div><div class="section" title="ntp"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl3sec03"/>ntp</h3></div></div></div><p>The <span class="strong"><strong>Network Time Protocol</strong></span> (<span class="strong"><strong>NTP</strong></span>) is used when there is an Internet connection available and it can<a id="id47" class="indexterm"/> request the latest most <a id="id48" class="indexterm"/>accurate time from one or more time servers on the Internet.</p><p>By default, the <span class="strong"><strong>ntp service</strong></span> is enabled on the latest Raspbian distribution, but it will initially get its time at boot-up from <code class="literal">fake-hwclock</code> if there is no Internet connection. There may be times when it's necessary to force the ntp service to update from the Internet—for example, if the Internet connection is restored sometime after boot-up.</p><p>To force the ntp service to update from the Internet, use the following commands:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ service ntp stop</strong></span>
<span class="strong"><strong>$ ntpd –gq</strong></span>
<span class="strong"><strong>$ service ntp start</strong></span>
</pre></div></div></div><div class="section" title="Talking of security…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec19"/>Talking of security…</h2></div></div></div><p>There's no point in <a id="id49" class="indexterm"/>having a security system if the system itself is not secure. So, now we'll change the default password for the <span class="strong"><strong>pi</strong></span> user.</p><p>From the prompt, type the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ sudo passwd pi</strong></span>
<span class="strong"><strong>pi@raspberrypi ~ $ sudo passwd pi</strong></span>
<span class="strong"><strong>Enter new UNIX password:</strong></span>
<span class="strong"><strong>Retype new UNIX password:</strong></span>
<span class="strong"><strong>passwd: password updated successfully</strong></span>
</pre></div><div class="section" title="What is this sudo thing anyway?"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl3sec04"/>What is this sudo thing anyway?</h3></div></div></div><p>You'd have<a id="id50" class="indexterm"/> noticed that we've been putting <code class="literal">sudo</code> at the start of each command that we run in the terminal window. This is so that commands are run as the <span class="strong"><strong>root user</strong></span>—the highest <a id="id51" class="indexterm"/>security level. This elevated security is required to perform many operations. <code class="literal">sudo</code> actually means <span class="emphasis"><em>super do</em></span>.</p><p>If you can't be bothered to type <code class="literal">sudo</code> every time, then you can switch to the super user by typing the following:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ sudo su</strong></span>
</pre></div><p>You'll see that the prompt changed from a <code class="literal">$</code> to a <code class="literal">#</code>, which indicates that you are now running as the root user.</p><p>So, this might be a good time to change the root user password too! To do this, type the following:</p><div class="informalexample"><pre class="programlisting"># passwd
root@raspberrypi:/home/pi# passwd
Enter new UNIX password:
Retype new UNIX password:
passwd: password updated successfully
root@raspberrypi:/home/pi#</pre></div></div></div><div class="section" title="Connecting via Wi-Fi"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec20"/>Connecting via Wi-Fi</h2></div></div></div><p>You can also<a id="id52" class="indexterm"/> connect your Raspberry Pi to your network using Wi-Fi by plugging a USB dongle into it. There are additional configuration steps required to make this work, which are beyond the scope of this chapter, but there are many resources available covering this subject.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note06"/>Note</h3><p>You can find<a id="id53" class="indexterm"/> recipes for connecting your Raspberry Pi using Wi-Fi in the <span class="strong"><strong>Raspberry Pi Networking Cookbook</strong></span> by Rick Golden, published by Packt Publishing (<a class="ulink" href="https://www.packtpub.com/hardware-and-creative/raspberry-pi-networking-cookbook">https://www.packtpub.com/hardware-and-creative/raspberry-pi-networking-cookbook</a>).</p></div></div></div></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec11"/>Summary</h1></div></div></div><p>In this chapter, we took our Raspberry Pi out of its box and prepared it to be the centerpiece of our home security system. Along the way, we installed and set up the operating system, connected our Pi to the network, and accessed it remotely. We also secured our Pi and made sure it could keep the right time.</p><p>In the next chapter, we're going to explore the GPIO port and the various interfaces it features. We'll look at the various things we can connect to the Raspberry Pi using the GPIO port, including switches and sensors, as we start to build our home security system.</p></div></body></html>