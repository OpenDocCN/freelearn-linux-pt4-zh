- en: Managing Networking in CentOS
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在 CentOS 中管理网络
- en: A standalone system is often not of much use. Networking enables us to exchange
    information and share resources with other network devices and connected computers.
    In this chapter, you will learn essential skills required for managing network
    connections from the command line. Then you will learn how to access the remote
    system using **SSH** (short for **Secure Shell**) and the secure transfer of files
    with **SCP** (short for **Secure Copy**) and `rsync` utilities.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 独立系统通常没什么用处。网络使我们能够与其他网络设备和连接的计算机交换信息和共享资源。在本章中，您将学习从命令行管理网络连接所需的基本技能。然后，您将学习如何使用
    **SSH**（即 **安全外壳**）访问远程系统，以及如何使用 **SCP**（即 **安全复制**）和 `rsync` 工具进行安全文件传输。
- en: 'In this chapter, we will cover the following:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将涵盖以下内容：
- en: Linux networking concepts
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Linux 网络概念
- en: Using Linux networking commands
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 Linux 网络命令
- en: Managing networks with nmcli
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 nmcli 管理网络
- en: Editing network configuration files
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 编辑网络配置文件
- en: Configuring hostname and **DNS** (short for **Domain Name System**) resolution
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 配置主机名和 **DNS**（即 **域名系统**）解析
- en: Accessing remote logins with SSH
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 SSH 访问远程登录
- en: Transferring files in Linux
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 Linux 中传输文件
- en: Linux networking concepts
  id: totrans-10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Linux 网络概念
- en: 'A network is a group of two or more computers or computing devices connected
    using any communication media, such as cables or wireless media. These devices
    may be located in the same geographical location or spread across the world. A
    network environment provides these three services:'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 网络是由两台或更多计算机或计算设备组成的群体，通过任何通信媒介（如电缆或无线媒介）连接。这些设备可能位于相同的地理位置，也可能分布在全球各地。网络环境提供以下三项服务：
- en: Enables connected devices to communicate with each other
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使连接的设备能够相互通信
- en: Enables multiple users to share devices such as printers, copiers, scanners,
    and so on over the network
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使多个用户能够共享设备，如打印机、复印机、扫描仪等
- en: Enables the sharing of files and managing of information across computers
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使文件共享和信息管理在计算机之间进行
- en: 'Most organizations use two types of network: one for communication with internal
    staff and another for the outside world. **Intranet** is the term used to define
    communication within the internal network of an organization and **internet**
    is used for external communication. The internet is also the largest network in
    the world and is popularly known as a network of networks.'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数组织使用两种类型的网络：一种用于与内部员工的通信，另一种用于与外部世界的通信。**内部网**是用于定义组织内部网络通信的术语，**互联网**用于外部通信。互联网也是世界上最大的网络，通常被称为“网络的网络”。
- en: Common terms used in Linux networking
  id: totrans-16
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Linux 网络中常用的术语
- en: This section describes the various terms that are used to define computing devices
    and networking terminologies used in Linux.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 本节描述了用于定义计算设备和 Linux 中使用的网络术语的各种术语。
- en: IP address
  id: totrans-18
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: IP 地址
- en: Each device connected to a network must have at least one unique address that
    is used to identify that device on the network. This address is known as the IP
    address and it is essential for routing the packet from the source to the destination
    through the network. Information or data over the network is transferred in the
    form of packets. Each packet has a header attached to it containing the information
    required to route the packet from the source to the destination. There are two
    different types of IP address schemes available, called IPv4 and IPv6.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 每个连接到网络的设备必须具有至少一个唯一地址，用于标识该设备在网络中的位置。这个地址称为 IP 地址，并且它对于将数据包从源头路由到目标非常重要。网络上的信息或数据以数据包的形式传输。每个数据包附带一个头部，包含将数据包从源头路由到目标所需的信息。IP
    地址方案有两种类型，分别为 IPv4 和 IPv6。
- en: IPv4
  id: totrans-20
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: IPv4
- en: 'IPv4 is a 32-bit logical address used by computing devices to communicate with
    each other using the TCP/IP protocol stack. It is generally expressed in the decimal
    notation of four octets, with each octet containing 8 bits separated by a dot.
    The value of each octet can vary from 0 to 255\. This address can further be broken
    down into two parts; for example, a network part and host part:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: IPv4 是一种 32 位逻辑地址，用于计算设备通过 TCP/IP 协议栈相互通信。它通常以四个字节的十进制表示，每个字节包含 8 位，并用点分隔。每个字节的值可以从
    0 到 255 之间变化。这个地址可以进一步分为两部分；例如，网络部分和主机部分：
- en: '**Host part**: The host part is used to identify a host on a subnet. No two
    hosts on the same subnet can have the same host part.'
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**主机部分**：主机部分用于标识子网中的主机。同一子网中的两个主机不能具有相同的主机部分。'
- en: '**Network part**: The network part is used to identify a subnet. Hosts on the
    same subnet can communicate to each other without needing a router.'
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**网络部分**：网络部分用于标识子网。位于同一子网的主机可以互相通信，而无需路由器。'
- en: By using 32 bits for addresses, we can have a maximum of 4.3 billion unique
    addresses, many of which are reserved and cannot be used. Hence, to meet future
    requirements, IPv6 with an 128-bit address was created.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 使用32位地址时，我们最多可以拥有43亿个唯一地址，其中许多地址被保留且不可使用。因此，为了满足未来的需求，IPv6使用128位地址被创建。
- en: IPv6
  id: totrans-25
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: IPv6
- en: IPv6 uses 128 bits for addressing. It is expressed in eight octets, containing
    16 bits each, separated by colon. The use of 128 bits provides the 3.4 × 10^(38)
    unique addresses. The shifting of networked equipment and addresses from IPv4
    to IPv6 requires a lot of understanding and effort. IPv6 does not have a broadcast
    address.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: IPv6使用128位进行地址分配。它以八个八位字节表示，每个字节包含16位，且由冒号分隔。使用128位提供了3.4 × 10^(38)个唯一地址。从IPv4向IPv6的网络设备和地址迁移需要大量的理解和努力。IPv6没有广播地址。
- en: We will be restricting our discussion in this chapter to IPv4, as it is still
    more widely used and you will encounter it the most while performing networking.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将专注于IPv4，因为它仍然被广泛使用，并且在进行网络操作时，你会最常遇到它。
- en: Different classes of IP addressing
  id: totrans-28
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 不同类别的IP地址
- en: IPv4 addresses are divided into **five public** classes named A, B, C, D, and
    E, and **three private** IP address classes.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: IPv4地址分为**五个公共**类别：A、B、C、D和E，以及**三个私有**IP地址类别。
- en: Public classes
  id: totrans-30
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 公共类别
- en: 'There are five different public IP address classes from A to E. Here, classes
    A, B, and C are divided into two parts: **network address** (short for **Net ID**)
    and **host address** (short for **Host ID**). Net ID identifies the network and
    Host ID identifies the host on the network as shown in table here:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 公共IP地址类别从A到E共有五种。这里，A、B、C类被划分为两个部分：**网络地址**（简写为**Net ID**）和**主机地址**（简写为**Host
    ID**）。Net ID用于标识网络，Host ID用于标识网络上的主机，如下表所示：
- en: '| **Public class** | **Octet 1** | **Octet 2** | **Octet 3** | **Octet 4**
    | **Range** |'
  id: totrans-32
  prefs: []
  type: TYPE_TB
  zh: '| **公共类别** | **第1字节** | **第2字节** | **第3字节** | **第4字节** | **范围** |'
- en: '| Class A | Net ID | Host ID | Host ID | Host ID | `1.0.0.0` to `127.255.255.255`
    |'
  id: totrans-33
  prefs: []
  type: TYPE_TB
  zh: '| 类别 A | 网络标识符 | 主机标识符 | 主机标识符 | 主机标识符 | `1.0.0.0` 至 `127.255.255.255` |'
- en: '| Class B | Net ID | Net ID | Host ID | Host ID | `128.0.0.0` to `191.255.255.255`
    |'
  id: totrans-34
  prefs: []
  type: TYPE_TB
  zh: '| 类别 B | 网络标识符 | 网络标识符 | 主机标识符 | 主机标识符 | `128.0.0.0` 至 `191.255.255.255` |'
- en: '| Class C | Net ID | Net ID | Net ID | Host ID | `192.0.0.0` to `223.255.255.255`
    |'
  id: totrans-35
  prefs: []
  type: TYPE_TB
  zh: '| 类别 C | 网络标识符 | 网络标识符 | 网络标识符 | 主机标识符 | `192.0.0.0` 至 `223.255.255.255` |'
- en: '| Class D | Multicast address | `224.0.0.0` to `239.255.255.255` |'
  id: totrans-36
  prefs: []
  type: TYPE_TB
  zh: '| 类别 D | 多播地址 | `224.0.0.0` 至 `239.255.255.255` |'
- en: '| Class E | Reserved for the future | `240.0.0.0` to `255.255.255.254` |'
  id: totrans-37
  prefs: []
  type: TYPE_TB
  zh: '| 类别 E | 保留供未来使用 | `240.0.0.0` 至 `255.255.255.254` |'
- en: Private classes
  id: totrans-38
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 私有类别
- en: 'The following three IP address ranges are reserved for private use within the
    internal network of an organization. These IPv4 addresses can be used within a
    network, campus, and so on, and are not routable on the internet. Hence, if any
    packet contains any of these private IP addresses, it is dropped by the routers.
    Generally, the NAT mechanism is used for communicating with the public IPv4 address
    space when machines are working on private IPv4\. The following table lists the
    private IPv4 address classes along with their address ranges and some special
    IPv4 addresses, such as link-local address and loopback address:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 以下三个IP地址范围保留供组织内部网络的私有使用。这些IPv4地址可以在网络、校园等内部使用，且无法在互联网中路由。因此，如果任何数据包包含这些私有IP地址，路由器将丢弃它。通常，当设备在私有IPv4地址空间内工作时，使用NAT机制与公共IPv4地址空间进行通信。下表列出了私有IPv4地址类别及其地址范围，以及一些特殊IPv4地址，如链路本地地址和回环地址：
- en: '| **Private class** | **Address range** | **Subnet mask** | **Address block**
    |'
  id: totrans-40
  prefs: []
  type: TYPE_TB
  zh: '| **私有类别** | **地址范围** | **子网掩码** | **地址块** |'
- en: '| Class A | `10.0.0.0` to `10.255.255.255` | `255.0.0.0` | `10.0.0.0 /8` |'
  id: totrans-41
  prefs: []
  type: TYPE_TB
  zh: '| 类别 A | `10.0.0.0` 至 `10.255.255.255` | `255.0.0.0` | `10.0.0.0 /8` |'
- en: '| Class B | `172.16.0.0` to `172.31.255.255` | `255.240.0.0` | `172.16.0.0
    /12` |'
  id: totrans-42
  prefs: []
  type: TYPE_TB
  zh: '| 类别 B | `172.16.0.0` 至 `172.31.255.255` | `255.240.0.0` | `172.16.0.0 /12`
    |'
- en: '| Class C | `192.168.0.0` to `192.168.0.255` | `255.255.0.0` | `192.168.0.0
    /16` |'
  id: totrans-43
  prefs: []
  type: TYPE_TB
  zh: '| 类别 C | `192.168.0.0` 至 `192.168.0.255` | `255.255.0.0` | `192.168.0.0 /16`
    |'
- en: '| Loopback address | `127.0.0.0` to `127.255.255.255` | `255.0.0.0` | `127.0.0.0
    /8` |'
  id: totrans-44
  prefs: []
  type: TYPE_TB
  zh: '| 回环地址 | `127.0.0.0` 至 `127.255.255.255` | `255.0.0.0` | `127.0.0.0 /8` |'
- en: '| Link-local address (APIPA) | `169.254.0.0` to `169.254.255.255` | `255.255.0.0`
    | `169.254.0.0 /16` |'
  id: totrans-45
  prefs: []
  type: TYPE_TB
  zh: '| 链路本地地址（APIPA） | `169.254.0.0` 至 `169.254.255.255` | `255.255.0.0` | `169.254.0.0
    /16` |'
- en: Loopback address
  id: totrans-46
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 回环地址
- en: '`127.0.0.1` is a special address that always points to local system (localhost)
    and is used for the testing of various services. The network `127.0.0.0/8` is
    a loopback network of the local system. It enables server-client communication
    on a single system.'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: '`127.0.0.1`是一个特殊的地址，总是指向本地系统（localhost），并用于测试各种服务。网络`127.0.0.0/8`是本地系统的回环网络，它允许在单一系统上进行服务器与客户端的通信。'
- en: Link-local address or APIPA
  id: totrans-48
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 链路本地地址或APIPA
- en: The link-local address or **Automatic Private IP Addressing** (**APIPA**) is
    used if a machine connected in a DHCP environment is unable to acquire an IP address
    from the DHCP sever. This also helps in establishing communication between machines
    on the same network by allocating them IP addresses in the range of `169.254.0.0/16`,
    if the DHCP server is not connected or down.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 如果机器连接到DHCP环境中，但无法从DHCP服务器获取IP地址，则使用链路本地地址或**自动私有IP地址分配**（**APIPA**）。这也有助于在DHCP服务器未连接或宕机的情况下，通过在`169.254.0.0/16`范围内分配IP地址，使同一网络中的机器之间能够建立通信。
- en: Netmask
  id: totrans-50
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 子网掩码
- en: 'Netmask is used to identify a subnet. Binary AND operations of the 32-bit Host
    IP address with 32-bit netmask yields the network part of the address. The lowest
    possible address on a subnet is all zeros in the host part; it represents the
    network address**.** The highest possible address on a subnet is all ones in the
    host part; it represents the broadcast address for all hosts on a subnet. It is
    expressed in two forms. The conventional syntax uses a decimal representation
    of the network part while the new syntax uses CIDR notation to represent the network
    prefix (number of ones in the network address). For example, we can represent
    a 24-bit netmask in both these forms as shown below:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 子网掩码用于标识一个子网。将32位主机IP地址与32位子网掩码进行按位与运算，得到地址的网络部分。子网中最低的地址是主机部分全为零，它表示网络地址**。**
    子网中最高的地址是主机部分全为一，它表示广播地址，适用于子网内的所有主机。子网掩码可以用两种形式表示。传统语法使用十进制表示网络部分，而新的语法使用CIDR表示法表示网络前缀（网络地址中1的数量）。例如，我们可以用以下两种形式表示一个24位子网掩码：
- en: '**Conventional form**: `255.255.255.0`'
  id: totrans-52
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**传统形式**：`255.255.255.0`'
- en: '**CIDR notation**: `/24`'
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**CIDR表示法**：`/24`'
- en: 'Let us assume that we are having following IP address and netmask information
    with us:'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 假设我们拥有以下IP地址和子网掩码信息：
- en: '`10.1.1.212 / 8`'
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`10.1.1.212 / 8`'
- en: '`192.168.1.100 / 24`'
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`192.168.1.100 / 24`'
- en: 'Now, using the above limited information we can find other related network
    information such as network address and broadcast address as given in the next
    table:'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，利用上述有限信息，我们可以找到其他相关的网络信息，如网络地址和广播地址，具体如下表所示：
- en: Network information for system having these details : `10.1.1.212 / 8 `
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 拥有以下详细信息的系统的网络信息：`10.1.1.212 / 8`
- en: '| **Information description** | **Values** |'
  id: totrans-59
  prefs: []
  type: TYPE_TB
  zh: '| **信息描述** | **值** |'
- en: '| IP address (host address) | `10.1.1.212` |'
  id: totrans-60
  prefs: []
  type: TYPE_TB
  zh: '| IP地址（主机地址） | `10.1.1.212` |'
- en: '| Netmask (network prefix) | `255.0.0.0/8 ` |'
  id: totrans-61
  prefs: []
  type: TYPE_TB
  zh: '| 子网掩码（网络前缀） | `255.0.0.0/8` |'
- en: '| Network address | `10.0.0.0` |'
  id: totrans-62
  prefs: []
  type: TYPE_TB
  zh: '| 网络地址 | `10.0.0.0` |'
- en: '| Broadcast address | `10.0.0.255` |'
  id: totrans-63
  prefs: []
  type: TYPE_TB
  zh: '| 广播地址 | `10.0.0.255` |'
- en: Network Information for system having these details : `192.168.1.100 / 24 `
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 拥有以下详细信息的系统的网络信息：`192.168.1.100 / 24`
- en: '| **Information description** | **Values** |'
  id: totrans-65
  prefs: []
  type: TYPE_TB
  zh: '| **信息描述** | **值** |'
- en: '| IP address (host address) | `192.168.1.100` |'
  id: totrans-66
  prefs: []
  type: TYPE_TB
  zh: '| IP地址（主机地址） | `192.168.1.100` |'
- en: '| Netmask (network prefix) | `255.255.255.0/24 ` |'
  id: totrans-67
  prefs: []
  type: TYPE_TB
  zh: '| 子网掩码（网络前缀） | `255.255.255.0/24` |'
- en: '| Network address | `192.168.1.0` |'
  id: totrans-68
  prefs: []
  type: TYPE_TB
  zh: '| 网络地址 | `192.168.1.0` |'
- en: '| Broadcast address | `192.168.1.255` |'
  id: totrans-69
  prefs: []
  type: TYPE_TB
  zh: '| 广播地址 | `192.168.1.255` |'
- en: Gateway
  id: totrans-70
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 网关
- en: A gateway is generally a router device or computer that is used to connect two
    or more dissimilar networks. In the case of Linux, it is the entry in the kernel
    routing table that is used when none of the route entries are matched.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 网关通常是用于连接两个或多个不同网络的路由器设备或计算机。在Linux中，它是内核路由表中的一项条目，当没有匹配的路由条目时，将使用该条目。
- en: Hostname
  id: totrans-72
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 主机名
- en: 'Hostname is a human-readable name associated with a machine IP address. A DNS
    server is used to map the hostname to the IP address and vice versa. We can view
    the hostname of any machine by typing `hostname` command without any argument
    as shown below:'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 主机名是与机器IP地址关联的人类可读名称。DNS服务器用于将主机名映射到IP地址，反之亦然。我们可以通过输入`hostname`命令（不带任何参数）查看任何机器的主机名，如下所示：
- en: '[PRE0]'
  id: totrans-74
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Every machine has got a special hostname that is, localhost associated with
    the loopback IP address `127.0.0.1.` This address is used for testing various
    services on the system.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 每台机器都有一个特殊的主机名，即与回环IP地址`127.0.0.1`关联的localhost。此地址用于测试系统上的各种服务。
- en: Nameserver
  id: totrans-76
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 域名服务器
- en: 'Nameserver is also known as the **DNS server**. The purpose of the DNS server
    is to convert the hostname to an IP address and vice versa. There is a default
    fixed order of files, which are looked up when doing DNS lookup in CentOS 7\.
    This order is managed by the rules written in the `nsswitch.conf` file and can
    be altered by an administrator. The following two files are looked up when resolving
    a DNS query in system:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: Nameserver也称为**DNS服务器**。DNS服务器的目的是将主机名转换为IP地址，反之亦然。在CentOS 7中，进行DNS查找时有一个默认的固定文件顺序。这一顺序由`nsswitch.conf`文件中写入的规则管理，管理员可以进行修改。系统在解析DNS查询时会查找以下两个文件：
- en: '**`/etc/hosts`**: The entries made in this file are first looked up before
    forwarding the query to the DNS server. It is a kind of local database of hostnames
    and IP address mappings. It is also quite useful for small isolated networks.'
  id: totrans-78
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**`/etc/hosts`**：在将查询转发到DNS服务器之前，首先会查找该文件中的条目。它是一个主机名和IP地址映射的本地数据库。对于小型独立网络来说，它也非常有用。'
- en: '**`/etc/resolv.conf`**: If the answer of DNS query is not found in the `/etc/hosts`
    file, then the query is passed to the DNS server mentioned in `/etc/resolv.conf`.
    This file can be updated using dhclient or manually.'
  id: totrans-79
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**`/etc/resolv.conf`**：如果在`/etc/hosts`文件中找不到DNS查询的答案，则该查询将传递给`/etc/resolv.conf`中指定的DNS服务器。此文件可以通过dhclient更新或手动更新。'
- en: 'Following command is used to display the current settings of nameserver:'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 以下命令用于显示当前的nameserver设置：
- en: '[PRE1]'
  id: totrans-81
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'After configuring the nameserver, verify the DNS connectivity using host command
    as shown here:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 配置好nameserver后，可以使用host命令验证DNS连接，方法如下：
- en: '[PRE2]'
  id: totrans-83
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: NetworkManager
  id: totrans-84
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: NetworkManager
- en: The NetworkManager is a GUI application used for the management of network settings.
    It comes with a daemon and Gnome applet to provide the network status and quick
    access for modification. The changes made using NetworkManager are stored in the `/etc/sysconfig/network-scripts`
    directory and thus it overrides any manual changes made there. If you want to
    configure the network connections manually by modifying the network scripts file,
    then NetworkManager should be disabled. NetworkManager provides a user-friendly
    method for manager network connections and is ideal for beginners.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: NetworkManager是一个用于管理网络设置的GUI应用程序。它配有守护进程和Gnome小程序，提供网络状态并能快速修改设置。通过NetworkManager所做的更改会存储在`/etc/sysconfig/network-scripts`目录中，因此它会覆盖该处的任何手动更改。如果你想通过修改网络脚本文件来手动配置网络连接，那么应该禁用NetworkManager。NetworkManager提供了一种用户友好的方式来管理网络连接，非常适合初学者。
- en: Network interface naming conventions
  id: totrans-86
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 网络接口命名规则
- en: Conventionally, network interfaces in Linux are enumerated sequentially as `eth0`,
    `eth1`, `eth2`, and so on.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 传统上，Linux中的网络接口按顺序编号为`eth0`，`eth1`，`eth2`等。
- en: 'The following table list the traditional names of interfaces with their descriptions:'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 以下表格列出了接口的传统名称及其描述：
- en: '| **Interface name** | **Description** |'
  id: totrans-89
  prefs: []
  type: TYPE_TB
  zh: '| **接口名称** | **描述** |'
- en: '| `eth0`, `eth1`, and so on | Ethernet interfaces |'
  id: totrans-90
  prefs: []
  type: TYPE_TB
  zh: '| `eth0`，`eth1`，以此类推 | 以太网接口 |'
- en: '| `wlan0`, `wlan1`, and so on | Wireless interfaces |'
  id: totrans-91
  prefs: []
  type: TYPE_TB
  zh: '| `wlan0`，`wlan1`，以此类推 | 无线接口 |'
- en: '| `eth0:1`, `eth0:2`, and so on | Alias interfaces |'
  id: totrans-92
  prefs: []
  type: TYPE_TB
  zh: '| `eth0:1`，`eth0:2`，以此类推 | 别名接口 |'
- en: '| `ppp0`, `ppp1`, and so on | Dial-up interface |'
  id: totrans-93
  prefs: []
  type: TYPE_TB
  zh: '| `ppp0`，`ppp1`，以此类推 | 拨号接口 |'
- en: '| `bond0` | First-bonded network device |'
  id: totrans-94
  prefs: []
  type: TYPE_TB
  zh: '| `bond0` | 第一个绑定的网络设备 |'
- en: '| `virbr0` | Internal bridge for virtual hosts |'
  id: totrans-95
  prefs: []
  type: TYPE_TB
  zh: '| `virbr0` | 虚拟主机的内部桥接 |'
- en: '| `lo` | Loopback interface |'
  id: totrans-96
  prefs: []
  type: TYPE_TB
  zh: '| `lo` | 回环接口 |'
- en: Now, CentOS 7 has new default naming conventions. The interface name is based
    on hardware, topology, and device type.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，CentOS 7有了新的默认命名规则。接口名称基于硬件、拓扑结构和设备类型。
- en: 'The following table illustrates the network interface naming convention in
    CentOS 7:'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 以下表格展示了CentOS 7中的网络接口命名规则：
- en: '| **Character in naming convention** | **Description** |'
  id: totrans-99
  prefs: []
  type: TYPE_TB
  zh: '| **命名规则中的字符** | **描述** |'
- en: '| First two characters represent type of interface |'
  id: totrans-100
  prefs: []
  type: TYPE_TB
  zh: '| 前两个字符表示接口类型 |'
- en: '`en`: Ethernet interface'
  id: totrans-101
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`en`: 以太网接口'
- en: '`wl`: Wlan interface'
  id: totrans-102
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`wl`: Wlan接口'
- en: '`ww`: WWAN interface'
  id: totrans-103
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ww`: WWAN接口'
- en: '|'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: '|'
- en: '| Next characters represent type of adapter |'
  id: totrans-105
  prefs: []
  type: TYPE_TB
  zh: '| 后续字符表示适配器类型 |'
- en: '`o`: Onboard adapter'
  id: totrans-106
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`o`: 集成适配器'
- en: '`s`: Hotplug slot'
  id: totrans-107
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`s`: 热插拔插槽'
- en: '`p`: PCI card'
  id: totrans-108
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`p`: PCI卡'
- en: '`x`: MAC address'
  id: totrans-109
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`x`: MAC地址'
- en: '|'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: '|'
- en: '| Last character is a number `N`, to represent an index, ID, or port |'
  id: totrans-111
  prefs: []
  type: TYPE_TB
  zh: '| 最后一个字符是数字`N`，表示索引、ID或端口 |'
- en: '`N`: 0, 1, 2, and so on'
  id: totrans-112
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`N`: 0, 1, 2等'
- en: '|'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: '|'
- en: 'If a fixed name could not be determined using new interface naming scheme then
    the old conventional naming scheme such as `eth0` or `eth1` is used. The example
    of new interface naming scheme is given here:'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 如果无法使用新的接口命名方案确定固定名称，则将使用旧的传统命名方案，例如`eth0`或`eth1`。这里给出了新的接口命名方案的示例：
- en: '`eno1`: First embedded network interface'
  id: totrans-115
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`eno1`：第一个嵌入式网络接口'
- en: '`enp1s0`: The first PCI card network interface with hotplug slot index 0'
  id: totrans-116
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`enp1s0`：带有热插拔插槽索引0的第一个PCI卡网络接口'
- en: If the biosdevname feature is enabled in the server, then this naming scheme
    is overridden with a different naming scheme.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 如果服务器启用了biosdevname功能，则此命名方案将被另一种命名方案覆盖。
- en: Using Linux networking commands
  id: totrans-118
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用Linux网络命令
- en: This section discuss the various networking commands and basic utilities that
    are used to display or modify the existing network configurations.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 本节讨论了用于显示或修改现有网络配置的各种网络命令和基本工具。
- en: Viewing IP address details
  id: totrans-120
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 查看IP地址详情
- en: 'In CentOS 7, we have three major utilities to display the device and address
    information:'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 在CentOS 7中，我们有三个主要工具用于显示设备和地址信息：
- en: Newer IP command (`/sbin/ip`)
  id: totrans-122
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 较新的IP命令（`/sbin/ip`）
- en: Almost obsolete `ifconfig` command from net-tools package (`/sbin/ifconfig`)
  id: totrans-123
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 几乎已过时的`ifconfig`命令，属于net-tools包（`/sbin/ifconfig`）
- en: Versatile `netstat` command (`/usr/bin/netstat`)
  id: totrans-124
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 多功能`netstat`命令（`/usr/bin/netstat`）
- en: Using the IP command
  id: totrans-125
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用IP命令
- en: The `ip` is a very powerful utility that is used to perform many tasks. Multiple
    older utilities such as `ifconfig` and `route` command were earlier used to perform
    these functions. The absolute path of the `ip` command is `/sbin/ip`.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: '`ip`是一个非常强大的工具，用于执行许多任务。早期，`ifconfig`和`route`等多个旧工具用于执行这些功能。`ip`命令的绝对路径是`/sbin/ip`。'
- en: '**Following are the examples to illustrate the usage of ip command:**'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: '**以下是说明如何使用ip命令的示例：**'
- en: 'The following `ip` command is used to display the IP address:'
  id: totrans-128
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 以下`ip`命令用于显示IP地址：
- en: '[PRE3]'
  id: totrans-129
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'The `ip` command can also be used to display statistics of the network performance
    (received and transmitted packets, errors, dropped counters, and so on) as shown
    in command line here:'
  id: totrans-130
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ip`命令还可以用于显示网络性能的统计信息（接收和发送的包、错误、丢包计数等），如以下命令行所示：'
- en: '[PRE4]'
  id: totrans-131
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'The `ip` command can also be used to display the routing information as shown
    in command line here:'
  id: totrans-132
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ip`命令还可以用于显示路由信息，如以下命令行所示：'
- en: '[PRE5]'
  id: totrans-133
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'The `/sbin/ip` command can also be used to assign multiple IP addresses to
    a single device using aliases. Binding multiple IP addresses to a single NIC with
    a different label is useful in many cases (for example, in virtual hosting). Aliases
    are treated as separate interfaces and are generally configured when NetworkManager
    is turned off. The command to create an alias is as follows:'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: '`/sbin/ip`命令还可以用于为单个设备分配多个IP地址，并使用别名。将多个IP地址绑定到单个网卡，并为其分配不同的标签在许多情况下非常有用（例如，在虚拟主机中）。别名被视为独立的接口，通常在关闭NetworkManager时进行配置。创建别名的命令如下：'
- en: '`$ ip addr add 10.1.1.250/24 dev enp0s8 label enp0s8:0`.'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: '`$ ip addr add 10.1.1.250/24 dev enp0s8 label enp0s8:0`。'
- en: Using ifconfig command
  id: totrans-136
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用ifconfig命令
- en: This is an older command used to display or modify the current configuration
    of network interfaces. The usage of `ifconfig` command is now obsolete and it
    is replaced with the newer `ip` utility. Now, the `ip addr` and `ip link` commands
    are preferred to display network interface information in place of `ifconfig`.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 这是一个旧的命令，用于显示或修改当前的网络接口配置。`ifconfig`命令现在已经过时，已被较新的`ip`工具取代。现在，`ip addr`和`ip
    link`命令被优先用来替代`ifconfig`，以显示网络接口信息。
- en: 'The following table lists the popular options of `ifconfig` with their descriptions:'
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 以下表格列出了`ifconfig`的常用选项及其描述：
- en: '| **Command** | **Description** |'
  id: totrans-139
  prefs: []
  type: TYPE_TB
  zh: '| **命令** | **描述** |'
- en: '| `$ ifconfig` | Display the current configuration of active interfaces only
    |'
  id: totrans-140
  prefs: []
  type: TYPE_TB
  zh: '| `$ ifconfig` | 仅显示当前活动接口的配置 |'
- en: '| `$ ifconfig -a` | Display all interfaces information which are available
    in system, whether they are active or inactive |'
  id: totrans-141
  prefs: []
  type: TYPE_TB
  zh: '| `$ ifconfig -a` | 显示系统中所有接口的信息，无论它们是活动的还是非活动的 |'
- en: '| `$ ifconfig eth0` | Display the configuration of the specified interface
    `eth0` |'
  id: totrans-142
  prefs: []
  type: TYPE_TB
  zh: '| `$ ifconfig eth0` | 显示指定接口`eth0`的配置 |'
- en: '| `$ ifconfig eth0 up` | Activate the network adapter `eth0`, if it is down.
    |'
  id: totrans-143
  prefs: []
  type: TYPE_TB
  zh: '| `$ ifconfig eth0 up` | 如果网络适配器`eth0`处于关闭状态，则激活它。 |'
- en: '| `$ ifconfig eth0 down` | Deactivate the network adapter `eth0`, if it is
    up. |'
  id: totrans-144
  prefs: []
  type: TYPE_TB
  zh: '| `$ ifconfig eth0 down` | 如果网络适配器`eth0`处于开启状态，则将其关闭。 |'
- en: 'The `ifconfig` command can be used to assign an IP address and netmask to a
    network adapter. These are runtime changes and are lost after reboot. Following
    command line shows how to use ifconfig for making runtime assignment of IP address
    and netmask to an interface:'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: '`ifconfig` 命令可以用来为网络适配器分配 IP 地址和子网掩码。这些更改是运行时生效的，并且在重启后会丢失。以下命令行展示了如何使用 ifconfig
    为接口分配 IP 地址和子网掩码：'
- en: '[PRE6]'
  id: totrans-146
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Some naive users still find, the older `ifconfig` command easier to use, in
    comparison to the new and more versatile `ip` command.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 一些较为初学的用户仍然发现，较旧的 `ifconfig` 命令相比新版本更为易用，而 `ip` 命令则功能更强大且灵活。
- en: The `ifconfig` utility is a part of the net-tools package. If this package is
    not installed on the system, then you may not get access to this utility on CentOS
    7.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: '`ifconfig` 工具是 net-tools 包的一部分。如果该包未安装在系统上，那么在 CentOS 7 中你可能无法访问该工具。'
- en: Netstat
  id: totrans-149
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Netstat
- en: 'The `netstat` command can also be used to print interface details. To display
    kernel interface information for all the interfaces, the `-i` option is used with
    the `-e` option to display the extended information for the interfaces as shown
    in command line here:'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: '`netstat` 命令也可以用来打印接口详情。要显示所有接口的内核接口信息，可以使用 `-i` 选项与 `-e` 选项，来显示接口的扩展信息，如下所示：'
- en: '[PRE7]'
  id: totrans-151
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: Viewing the routing information
  id: totrans-152
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 查看路由信息
- en: Irrespective of the underlying IP addressing scheme, while communicating, the
    information needs to travel from a host on one network to a host on another network.
    Each host can have multiple routing tables, which decide how to route the traffic
    to a particular network from the host. The routing table makes sure the correct network
    interface is used for sending the packets to a destination network. We can also
    define the IP address of any intermediate router that is required to reach the
    destination network in routing table.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 无论底层 IP 地址方案如何，在通信过程中，信息需要从一个网络上的主机传输到另一个网络上的主机。每个主机可以有多个路由表，决定如何将流量从主机路由到特定网络。路由表确保使用正确的网络接口将数据包发送到目标网络。我们还可以在路由表中定义任何中间路由器的
    IP 地址，以便到达目标网络。
- en: Using the ip route command
  id: totrans-154
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 `ip route` 命令
- en: The `ip route` command is one of the many features of the newer `ip` utility.
    This command can be used to display or modify the existing IP routing table. We
    can add, delete, or modify specific static routes to specific hosts or networks
    using `ip route` command.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: '`ip route` 命令是新版本 `ip` 工具的众多功能之一。此命令可以用来显示或修改现有的 IP 路由表。我们可以使用 `ip route` 命令添加、删除或修改指向特定主机或网络的静态路由。'
- en: '**Following are the examples to illustrate the usage of ip route command:**'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: '**以下是展示 `ip route` 命令用法的示例：**'
- en: 'We can use `ip route` command to display the current routing table as follows:'
  id: totrans-157
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们可以使用 `ip route` 命令显示当前的路由表，如下所示：
- en: '[PRE8]'
  id: totrans-158
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'The `ip route` command can be used to add static routes in routing table. In
    the following example we **add** **network routing** information for `25.25.25.0/24`
    network, to route it through `eth0` interface, as shown here:'
  id: totrans-159
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ip route` 命令可以用来向路由表中添加静态路由。在以下示例中，我们**添加** **网络路由**信息，将 `25.25.25.0/24` 网络路由通过
    `eth0` 接口，如下所示：'
- en: '[PRE9]'
  id: totrans-160
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'The `ip route` command can also be used to **add host** **routing** information.
    In the following example we add information to route IPv4 address `15.15.15.15`
    through `eth1` interface:'
  id: totrans-161
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ip route` 命令也可以用来**添加主机** **路由**信息。在以下示例中，我们将信息添加到 IPv4 地址 `15.15.15.15`，并通过
    `eth1` 接口路由：'
- en: '[PRE10]'
  id: totrans-162
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'The `ip route` command can also be used to delete the static route from the
    routing table. In the following example we **delete** **network routing** information
    for `25.25.25.0/24` network as shown here:'
  id: totrans-163
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ip route` 命令也可以用于从路由表中删除静态路由。在以下示例中，我们**删除** **网络路由**信息，目标是 `25.25.25.0/24`
    网络，如下所示：'
- en: '[PRE11]'
  id: totrans-164
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'The `ip route` command can also be used to **delete**** host** **routing** information.
    In the following example we delete information to route IPv4 address `15.15.15.15`
    through `eth1` interface:'
  id: totrans-165
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ip route` 命令也可以用来**删除** **主机** **路由**信息。在以下示例中，我们删除通过 `eth1` 接口路由 IPv4 地址
    `15.15.15.15` 的信息：'
- en: '[PRE12]'
  id: totrans-166
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: Using route command
  id: totrans-167
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 route 命令
- en: The `route` command is also used to modify the routing table.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: '`route` 命令也可以用于修改路由表。'
- en: '**Following are the examples to illustrate the usage of route command:**'
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: '**以下是展示 `route` 命令用法的示例：**'
- en: 'Use the `route` command as shown here to display the current routing table:'
  id: totrans-170
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 `route` 命令，如下所示，来显示当前的路由表：
- en: '[PRE13]'
  id: totrans-171
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'The `route` command can also be used to add a static route in the routing table.
    The following route command syntax is used to add a network routing information
    in the routing table:'
  id: totrans-172
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`route` 命令也可以用来在路由表中添加静态路由。以下路由命令语法用于在路由表中添加网络路由信息：'
- en: '[PRE14]'
  id: totrans-173
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'The following route command syntax is used to add a host routing information
    in the routing table:'
  id: totrans-174
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 以下路由命令语法用于在路由表中添加主机路由信息：
- en: '[PRE15]'
  id: totrans-175
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'The `route` command can also be used to delete a static route in the routing
    table. The following `route` command syntax is used to delete a network routing
    information in the routing table:'
  id: totrans-176
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`route` 命令也可以用来删除路由表中的静态路由。以下 `route` 命令语法用于删除路由表中的网络路由信息：'
- en: '[PRE16]'
  id: totrans-177
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'The following `route` command syntax is used to delete a host routing information
    in the routing table:'
  id: totrans-178
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 以下 `route` 命令语法用于删除路由表中的主机路由信息：
- en: '[PRE17]'
  id: totrans-179
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: Using netstat command
  id: totrans-180
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 netstat 命令
- en: The `netstat` command, which is known as network statistics, is a versatile
    command with lots of features. This command is used to print network connections
    details, kernel routing table information, interface statistics, open ports, and
    so on. In this section, we restrict ourselves to the usage of the `netstat` command
    to fetch the routing table information only.
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: '`netstat` 命令，也称为网络统计命令，是一个功能强大的命令，具有很多功能。此命令用于打印网络连接详细信息、内核路由表信息、接口统计信息、开放端口等。在本节中，我们仅关注如何使用
    `netstat` 命令来获取路由表信息。'
- en: '**Following are the examples to illustrate the usage of netstat command.**'
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: '**以下是说明如何使用 `netstat` 命令的示例。**'
- en: 'Use the `netstat` command to display the kernel routing table information with
    the `-r` option as shown here:'
  id: totrans-183
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 `netstat` 命令显示带有 `-r` 选项的内核路由表信息，如下所示：
- en: '[PRE18]'
  id: totrans-184
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'Use the `netstat` command to display the kernel routing table information without
    resolving the hostname or port names as shown here:'
  id: totrans-185
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 `netstat` 命令显示内核路由表信息，而不解析主机名或端口名，如下所示：
- en: '[PRE19]'
  id: totrans-186
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: '`netstat` is one of the few commands that is available by default on Unix-like
    operating systems and Windows operating systems as well.'
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: '`netstat` 是在类 Unix 操作系统和 Windows 操作系统中默认可用的少数命令之一。'
- en: Gateway
  id: totrans-188
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 网关
- en: We can add or delete the default gateway at run-time using the `route` command.
    The default gateway tells us where to send the packet if none of the network or
    host entry in routing table matches with the destination IP address of packet.
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以使用 `route` 命令在运行时添加或删除默认网关。默认网关告诉我们，如果路由表中没有与数据包目标 IP 地址匹配的网络或主机条目，应该将数据包发送到哪里。
- en: 'The following command line is used to delete the default gateway from the routing
    table:'
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 以下命令行用于从路由表中删除默认网关：
- en: '[PRE20]'
  id: totrans-191
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'The following command line is used to add the default gateway in the routing
    table:'
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 以下命令行用于在路由表中添加默认网关：
- en: '[PRE21]'
  id: totrans-193
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'To add same permanent gateway for all the interfaces, we can modify the `/etc/sysconfig/network`
    file and add the following entry:'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 要为所有接口添加相同的永久网关，我们可以修改 `/etc/sysconfig/network` 文件，并添加以下条目：
- en: '[PRE22]'
  id: totrans-195
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'To assign different gateway entries for each interface, we modify the `/etc/sysconfig/network-scripts/ifcfg-<interfacename>` configuration
    file as follows:'
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 要为每个接口分配不同的网关条目，我们可以修改 `/etc/sysconfig/network-scripts/ifcfg-<interfacename>`
    配置文件，如下所示：
- en: '[PRE23]'
  id: totrans-197
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: Viewing nameserver details
  id: totrans-198
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 查看域名服务器详细信息
- en: The nameserver or DNS server information is stored in the `/etc/resolv.conf`
    file. This file can be updated using dhclient or NetworkManager or by an administrator,
    manually. In this file, we can specify a maximum of three nameserver directives
    in their order of precedence from top to bottom.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 域名服务器或 DNS 服务器信息存储在 `/etc/resolv.conf` 文件中。此文件可以通过 dhclient 或 NetworkManager
    更新，或者由管理员手动更新。在此文件中，我们可以指定最多三个域名服务器指令，并按优先级顺序从上到下排列。
- en: 'The contents of nameserver configuration file can be viewed as shown here:'
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 域名服务器配置文件的内容可以通过以下方式查看：
- en: '![](img/dc5a9b9e-67f0-4b6b-b362-16285f82cfca.png)'
  id: totrans-201
  prefs: []
  type: TYPE_IMG
  zh: '![](img/dc5a9b9e-67f0-4b6b-b362-16285f82cfca.png)'
- en: Network troubleshooting utilities
  id: totrans-202
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 网络故障排除工具
- en: In this section, we will learn about some networking tools/troubleshooting utilities.
    Networking tools are quite useful for monitoring and debugging network issues
    such as network connectivity and network traffic.
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将了解一些网络工具/故障排除工具。网络工具对于监控和调试网络问题（如网络连接和网络流量）非常有用。
- en: Using ethtool command
  id: totrans-204
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 ethtool 命令
- en: The `ethtool` is a utility for displaying and configuring Ethernet card driver
    and hardware settings. Changes made using `ethtool` are runtime changes and not
    persistence changes.
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: '`ethtool`是一个用于显示和配置以太网卡驱动程序和硬件设置的工具。使用`ethtool`所做的更改是运行时更改，而非持久性更改。'
- en: '**Following are the examples to illustrate the usage of ethtool command:**'
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: '**以下是一些示例，说明`ethtool`命令的用法：**'
- en: 'Display the Ethernet interface''s current settings using `ethtool` command
    as shown here:'
  id: totrans-207
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用`ethtool`命令显示以太网接口当前设置，如下所示：
- en: '[PRE24]'
  id: totrans-208
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: 'Display the Ethernet interface driver settings using `ethtool` command as shown
    here:'
  id: totrans-209
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用`ethtool`命令显示以太网接口驱动程序设置，如下所示：
- en: '[PRE25]'
  id: totrans-210
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: 'Modifying the Ethernet interface settings using `ethtool` command as shown
    h:'
  id: totrans-211
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用`ethtool`命令修改以太网接口设置，如下所示：
- en: '[PRE26]'
  id: totrans-212
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: 'Blink the Ethernet interface port light for 10 seconds for identification using
    `ethtool` command as shown here:'
  id: totrans-213
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用`ethtool`命令，如下所示，闪烁以太网接口端口指示灯10秒以进行标识：
- en: '[PRE27]'
  id: totrans-214
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: Using ping command
  id: totrans-215
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用ping命令
- en: The `ping` command is used to verify the network connectivity of a remote host.
    It can tell you whether the machine connected to the network is online and responding.
    It also provides stats for network packet loss and latency measurement.
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: '`ping`命令用于验证远程主机的网络连接性。它可以告诉你机器是否连接到网络且在线并响应。它还提供网络丢包和延迟测量的统计信息。'
- en: '**Following are the examples to illustrate the usage of ping command:**'
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: '**以下是一些示例，说明`ping`命令的用法：**'
- en: 'The ping command can be used to identify the status of a remote host (if it''s
    alive or not) as shown here:'
  id: totrans-218
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ping`命令可以用于识别远程主机的状态（是否存活），如下所示：'
- en: '[PRE28]'
  id: totrans-219
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: 'The ping command can be used send the `ping` request through a specific interface
    as shown here:'
  id: totrans-220
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ping`命令可以用于通过指定的接口发送`ping`请求，如下所示：'
- en: '[PRE29]'
  id: totrans-221
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: 'The `ping` command can be used to troubleshoot DNS issues by sending ping request
    to a specified URL. If we are able to `ping` a URL using its IP address, but we
    are not getting reply of ping by specifying name of same URL, it means our DNS
    server is not set up properly or not working properly. An example of `ping` command
    with URL is shown here:'
  id: totrans-222
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ping`命令还可以通过向指定的URL发送ping请求来排查DNS问题。如果我们能够使用IP地址`ping`某个URL，但指定该URL的名称时却收不到回复，说明我们的DNS服务器设置不正确或无法正常工作。以下是使用URL的`ping`命令示例：'
- en: '[PRE30]'
  id: totrans-223
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: 'The `ping` command can also be used to send the fixed number of packets using
    the `-c` option as shown here:'
  id: totrans-224
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ping`命令也可以通过`-c`选项发送固定数量的数据包，如下所示：'
- en: '[PRE31]'
  id: totrans-225
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: In the case of Windows, by default, the `ping` command sends only four packets,
    whereas in the case of Linux, the `ping` command will continue to send the packets
    by default unless its execution is aborted by pressing *Ctrl *+ *C*. ICMP ping
    cannot be considered a durable diagnostic tool, just one of many. The network
    diagnostic depends on many factors in a network. At the same time, ICMP ping is
    the most basic and default utility, which every system user should know how to
    use.
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 在Windows系统中，默认情况下，`ping`命令仅发送四个数据包，而在Linux系统中，`ping`命令会继续发送数据包，直到按下*Ctrl* +
    *C*中止其执行。ICMP ping不能作为持久的诊断工具，只是众多工具之一。网络诊断依赖于网络中的许多因素。同时，ICMP ping是最基础和默认的工具，每个系统用户都应了解如何使用它。
- en: Using tracepath command
  id: totrans-227
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用tracepath命令
- en: The `tracepath` command is used to trace the path from the origin to the destination.
    Each line in the `tracepath` output represents a router (hop) that the packet
    passes through.
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: '`tracepath`命令用于跟踪从源到目的地的路径。`tracepath`输出中的每一行表示数据包经过的一个路由器（跳跃）。'
- en: 'The example of `tracepath` command is shown in image here:'
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: '`tracepath`命令的示例如下图所示：'
- en: '![](img/905491d9-a532-4079-a6e9-4c39e01ef9f6.png)'
  id: totrans-230
  prefs: []
  type: TYPE_IMG
  zh: '![](img/905491d9-a532-4079-a6e9-4c39e01ef9f6.png)'
- en: Using traceroute command
  id: totrans-231
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用traceroute命令
- en: This command is used to display or inspect the network path taken to reach the
    destination by a packet. It is quite useful in troubleshooting network delays
    and errors.
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 此命令用于显示或检查数据包到达目的地所经过的网络路径。它在排查网络延迟和错误时非常有用。
- en: By default, the `traceroute` and `tracepath` commands use UDP packets for probing
    the path to a destination. The `traceroute` command has options to inspect the
    path using ICMP (`-I`) or TCP (`-T`) packets, if IDS or IPS blocks the UDP traffic.
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，`traceroute`和`tracepath`命令使用UDP包来探测到目的地的路径。如果IDS或IPS阻止了UDP流量，`traceroute`命令可以选择使用ICMP（`-I`）或TCP（`-T`）包来检查路径。
- en: '**Following is an example to illustrate the usage of traceroute command**:'
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: '**以下是一个示例，说明traceroute命令的用法**：'
- en: 'The `traceroute` command can be used to display the route taken by the packet
    to reach the network host as shown in image here:'
  id: totrans-235
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`traceroute` 命令可用于显示数据包到达网络主机所经过的路由，如下图所示：'
- en: '![](img/6d7edf18-f667-4d56-8b26-b05a88bd2655.png)'
  id: totrans-236
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6d7edf18-f667-4d56-8b26-b05a88bd2655.png)'
- en: Using mtr command
  id: totrans-237
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 mtr 命令
- en: 'This command combines the functionalities of `ping` and `traceroute`. It constantly
    polls a remote server and fetches the latency and performance changes over time.
    The example for usage of mtr command is shown here:'
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 该命令结合了 `ping` 和 `traceroute` 的功能。它不断地轮询远程服务器，并获取延迟和性能变化。mtr 命令的使用示例如下所示：
- en: '[PRE32]'
  id: totrans-239
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: 'Output on execution of preceding command is shown here:'
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: 执行前述命令后的输出如下所示：
- en: '![](img/f03e5a02-f2c4-4748-b0f8-0f0f4522e4d8.png)'
  id: totrans-241
  prefs: []
  type: TYPE_IMG
  zh: '![](img/f03e5a02-f2c4-4748-b0f8-0f0f4522e4d8.png)'
- en: Verifying DNS connectivity
  id: totrans-242
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 验证 DNS 连接性
- en: There are multiple tools that are available in CentOS 7 to verify DNS connectivity.
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: CentOS 7 提供了多种工具来验证 DNS 连接性。
- en: Using nslookup command
  id: totrans-244
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 nslookup 命令
- en: This is a network administration tool for querying the DNS to obtain the domain
    name or IP address mapping or any other specific DNS record. It can be used in
    non-interactive mode as well as in interactive mode in CLI by a user.
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: 这是一个网络管理工具，用于查询 DNS 以获取域名或 IP 地址映射，或其他特定的 DNS 记录。它既可以在非交互模式下使用，也可以在命令行界面（CLI）中的交互模式下由用户使用。
- en: '**Following are the examples to illustrate the usage of nslookup command:**'
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: '**以下是一些示例，说明了 nslookup 命令的使用：**'
- en: 'The usage of `nslookup` command to find the IP address of domain name is shown
    here:'
  id: totrans-247
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 `nslookup` 命令查找域名的 IP 地址，如下所示：
- en: '[PRE33]'
  id: totrans-248
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: 'The usage of `nslookup` command to find the authoritative nameserver of a domain
    is shown here: [](http://www.centos.org/)'
  id: totrans-249
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 `nslookup` 命令查找域名的授权名称服务器，如下所示：[http://www.centos.org/](http://www.centos.org/)
- en: '[PRE34]'
  id: totrans-250
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: 'The `nslookup` command can be used to make a non-authoritative query of an
    MX record from a DNS server specified in `/etc/resolv.conf` file is shown here:'
  id: totrans-251
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`nslookup` 命令可用于对 `/etc/resolv.conf` 文件中指定的 DNS 服务器执行非授权的 MX 记录查询，如下所示：'
- en: '[PRE35]'
  id: totrans-252
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: 'The `nslookup` command can be used to make an authoritative query of an MX
    record from the DNS server. We can specify the authoritative nameserver for the
    zone as an argument as shown here:'
  id: totrans-253
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`nslookup` 命令可用于向 DNS 服务器发起授权查询以获取 MX 记录。我们可以指定区域的授权名称服务器作为参数，如下所示：'
- en: '[PRE36]'
  id: totrans-254
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: Using host command
  id: totrans-255
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 host 命令
- en: Host is one of the simplest DNS lookup utilities. If the `host` command is used
    without any option, it prints the short summary for its argument DNS lookup.
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: Host 是最简单的 DNS 查询工具之一。如果不带任何选项使用 `host` 命令，它会打印出其参数的简要摘要。
- en: 'The example of `host` command are shown in command line here:'
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
  zh: '`host` 命令的示例显示在命令行中：'
- en: '[PRE37]'
  id: totrans-258
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: Using dig command
  id: totrans-259
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 dig 命令
- en: '**DIG** (short for **Domain Information Groper**) is the most flexible and
    versatile DNS lookup utility for DNS troubleshooting.'
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
  zh: '**DIG**（即 **Domain Information Groper** 的缩写）是最灵活、最强大的 DNS 查询工具，用于 DNS 故障排除。'
- en: '**Following are the examples to illustrate the usage of** dig **command:**'
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: '**以下是一些示例，说明了** dig **命令的使用：**'
- en: 'The usage of `dig` command to find the IP address of a domain name is shown
    in command line here:'
  id: totrans-262
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 `dig` 命令查找域名的 IP 地址，如下命令行所示：
- en: '[PRE38]'
  id: totrans-263
  prefs: []
  type: TYPE_PRE
  zh: '[PRE38]'
- en: 'The `dig` command can be use to return only an IP address by making a short
    DNS lookup as shown in command line here:'
  id: totrans-264
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`dig` 命令可以通过简短的 DNS 查询，仅返回 IP 地址，如下命令行所示：'
- en: '[PRE39]'
  id: totrans-265
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: 'The `dig` command can be used with an option to turn off extra information
    and display only the required answer as shown in command line here:'
  id: totrans-266
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`dig` 命令可以使用选项关闭额外的信息，仅显示所需的答案，如下命令行所示：'
- en: '[PRE40]'
  id: totrans-267
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: 'The `dig` command can be used to perform the reverse lookup (find out the hostname
    of the specified IP address) by using the `-x` option as shown in command line
    here:'
  id: totrans-268
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`dig` 命令可以通过使用 `-x` 选项执行反向查询（查找指定 IP 地址的主机名），如下命令行所示：'
- en: '[PRE41]'
  id: totrans-269
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: DIG is a flexible and versatile tool. It is recommended to refer the manual
    of the `dig` utility (`$ man dig`).
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: DIG 是一个灵活且多功能的工具。建议参考 `dig` 工具的手册（`$ man dig`）。
- en: Finding local ports and services information
  id: totrans-271
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 查找本地端口和服务信息
- en: There are multiple services running on standard logical ports in the Linux system.
    Well-known ports and their related service entries are available in the `/etc/services`
    file. It's vital to identify the status of running services in the system. There
    are multiple commands such as `netstat`, `ss`, and so on that are used to find
    out the status of running services in localhost.
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
  zh: Linux 系统中有多个服务运行在标准的逻辑端口上。著名的端口及其相关服务条目可以在 `/etc/services` 文件中找到。识别系统中运行的服务状态是至关重要的。有多个命令，如
    `netstat`、`ss` 等，用于查找本地主机上运行服务的状态。
- en: Using the ss command
  id: totrans-273
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 ss 命令
- en: The `ss` command is another utility used to view socket statistics, similar
    to the `netstat` command. The advantage of using `ss` is that it can display more
    TCP and connection state information than other tools that exist by default.
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
  zh: '`ss` 命令是另一个用于查看套接字统计信息的工具，类似于 `netstat` 命令。使用 `ss` 的优点是它能显示比默认存在的其他工具更多的 TCP
    和连接状态信息。'
- en: 'An example of `ss` command usage is shown here:'
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
  zh: 这里展示了一个 `ss` 命令的使用示例：
- en: '![](img/1363275e-00a9-4e81-ab2d-c39d5d1e85f5.png)'
  id: totrans-276
  prefs: []
  type: TYPE_IMG
  zh: '![](img/1363275e-00a9-4e81-ab2d-c39d5d1e85f5.png)'
- en: Using the netstat command
  id: totrans-277
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 netstat 命令
- en: As discussed earlier, the `netstat` command is used to display all the active
    connections and routing tables information. This command is useful for monitoring
    performance and troubleshooting.
  id: totrans-278
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，`netstat` 命令用于显示所有活动连接和路由表信息。这个命令对于性能监控和故障排除非常有用。
- en: 'An example of `netstat` command usage is shown here:'
  id: totrans-279
  prefs: []
  type: TYPE_NORMAL
  zh: 这里展示了一个 `netstat` 命令的使用示例：
- en: '![](img/5ea05706-ca1d-4ba8-99a1-d08aa51610fb.png)'
  id: totrans-280
  prefs: []
  type: TYPE_IMG
  zh: '![](img/5ea05706-ca1d-4ba8-99a1-d08aa51610fb.png)'
- en: 'Here is a table listing the popular options used with the `ss` and `netstat`
    commands:'
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
  zh: 下面是列出常用选项的表格，这些选项与 `ss` 和 `netstat` 命令一起使用：
- en: '| **Option** | **Description** |'
  id: totrans-282
  prefs: []
  type: TYPE_TB
  zh: '| **选项** | **描述** |'
- en: '| `-a` | Display all listening and non-listening sockets |'
  id: totrans-283
  prefs: []
  type: TYPE_TB
  zh: '| `-a` | 显示所有监听和非监听的套接字 |'
- en: '| `-n` | Display numbers instead of services name |'
  id: totrans-284
  prefs: []
  type: TYPE_TB
  zh: '| `-n` | 显示数字而非服务名称 |'
- en: '| `-t` | Display TCP sockets |'
  id: totrans-285
  prefs: []
  type: TYPE_TB
  zh: '| `-t` | 显示 TCP 套接字 |'
- en: '| `-u` | Display UDP sockets |'
  id: totrans-286
  prefs: []
  type: TYPE_TB
  zh: '| `-u` | 显示 UDP 套接字 |'
- en: '| `-l` | Display only listening sockets |'
  id: totrans-287
  prefs: []
  type: TYPE_TB
  zh: '| `-l` | 仅显示监听中的套接字 |'
- en: '| `-p` | Display the process ID information of sockets |'
  id: totrans-288
  prefs: []
  type: TYPE_TB
  zh: '| `-p` | 显示套接字的进程 ID 信息 |'
- en: Web utilities
  id: totrans-289
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 网络工具
- en: This section discusses the various command-line-based web utilities such as
    command-line downloaders, command-line web browsers, and so on.
  id: totrans-290
  prefs: []
  type: TYPE_NORMAL
  zh: 本节讨论了各种基于命令行的网页工具，如命令行下载器、命令行网页浏览器等。
- en: Graphical and non-graphical web browsers
  id: totrans-291
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 图形化和非图形化网页浏览器
- en: Web browsers are application software used to retrieve, transmit, or process
    information using the **World Wide Web** (**WWW**) protocol. In simple words,
    they send requests to web servers and display the response received from the web
    server.
  id: totrans-292
  prefs: []
  type: TYPE_NORMAL
  zh: 网页浏览器是用于通过 **万维网** (**WWW**) 协议检索、传输或处理信息的应用软件。简单来说，它们向网页服务器发送请求，并显示从网页服务器收到的响应。
- en: Most of the time, we use graphical web browsers such as Firefox, Google Chrome,
    Opera, and so on, however, sometimes we do not have graphical environment and
    we still need to access websites. In those situations, we can use non-graphical
    browsers such as Lynx, elinks, W3M, and so on.
  id: totrans-293
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数时候，我们使用图形化网页浏览器，如 Firefox、Google Chrome、Opera 等，然而，有时我们没有图形环境，但仍然需要访问网站。在这些情况下，我们可以使用非图形浏览器，如
    Lynx、elinks、W3M 等。
- en: Command-line file downloader (wget)
  id: totrans-294
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 命令行文件下载器 (wget)
- en: The `wget` command is one of the most popular non-interactive command-line file
    downloaders in Linux. It can download multiple files/directories and can work
    in the background as well. The downloaded web page can be opened with any graphical
    or non-graphical browser.
  id: totrans-295
  prefs: []
  type: TYPE_NORMAL
  zh: '`wget` 命令是 Linux 中最流行的非交互式命令行文件下载工具之一。它可以下载多个文件/目录，并且可以在后台运行。下载的网页可以使用任何图形或非图形浏览器打开。'
- en: 'Some of its popular features are as follows:'
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: 它的一些常用功能如下：
- en: Support of HTTP, HTTPS, and FTP protocols, as well as retrieval through HTTP
    proxies
  id: totrans-297
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 支持 HTTP、HTTPS 和 FTP 协议，以及通过 HTTP 代理的检索
- en: Resume partial downloads
  id: totrans-298
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 恢复部分下载
- en: Large file downloads
  id: totrans-299
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 大文件下载
- en: Recursive downloads for mirroring a website
  id: totrans-300
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 用于镜像网站的递归下载
- en: Password-required downloads
  id: totrans-301
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 需要密码的下载
- en: 'The syntax of `wget` command is shown here:'
  id: totrans-302
  prefs: []
  type: TYPE_NORMAL
  zh: '`wget` 命令的语法如下所示：'
- en: '[PRE42]'
  id: totrans-303
  prefs: []
  type: TYPE_PRE
  zh: '[PRE42]'
- en: 'An example of `wget` command usage is shown here:'
  id: totrans-304
  prefs: []
  type: TYPE_NORMAL
  zh: 这里展示了一个 `wget` 命令的使用示例：
- en: '![](img/a4a864a8-e34a-4e2a-8d42-4513cd5ecef5.png)'
  id: totrans-305
  prefs: []
  type: TYPE_IMG
  zh: '![](img/a4a864a8-e34a-4e2a-8d42-4513cd5ecef5.png)'
- en: Command-line download and upload using curl
  id: totrans-306
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 curl 进行命令行下载和上传
- en: '**Curl** (short for **Client URL Library**) is a non-interactive command-line
    tool to automate HTTP jobs done using web browsers and many more functions. Using
    curl, one can download multiple files or upload files to a URL using URL-based
    syntax.'
  id: totrans-307
  prefs: []
  type: TYPE_NORMAL
  zh: '**Curl**（**客户端URL库**的缩写）是一个非交互式的命令行工具，用于自动化通过网页浏览器完成的HTTP任务及其他许多功能。使用curl，用户可以通过基于URL的语法下载多个文件或将文件上传到一个URL。'
- en: 'An example of `curl` command usage is shown here:'
  id: totrans-308
  prefs: []
  type: TYPE_NORMAL
  zh: 一个`curl`命令使用示例如下：
- en: '![](img/f0300423-0edf-4639-8f75-ddd52a9d8efd.png)'
  id: totrans-309
  prefs: []
  type: TYPE_IMG
  zh: '![](img/f0300423-0edf-4639-8f75-ddd52a9d8efd.png)'
- en: Managing a network with nmcli
  id: totrans-310
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用`nmcli`管理网络
- en: There are several tools available in Linux for the management of a network,
    however in CentOS 7, the additional `nmcli` utility has simplified and speeded
    up the setup of networking. `nmcli` is an acronym for the NetworkManager command
    line and is used to control the network-manager utility from the command line.
    The `nmtui` utility used to be a favorite of system administrators, however `nmcli`
    saves a lot of time and its capability to be used in script has make it one of
    the best networking tools in Linux.
  id: totrans-311
  prefs: []
  type: TYPE_NORMAL
  zh: Linux中有多种网络管理工具，但在CentOS 7中，附加的`nmcli`工具简化并加速了网络设置。`nmcli`是NetworkManager命令行工具的缩写，用于从命令行控制网络管理器工具。`nmtui`工具曾是系统管理员的最爱，但`nmcli`节省了大量时间，并且其可用于脚本的功能使其成为Linux中最好的网络工具之一。
- en: Defining basic terms
  id: totrans-312
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 定义基本术语
- en: Following are the few basic terms which are used with `nmcli` and hence an overview
    of these will help us in understanding it better.
  id: totrans-313
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是与`nmcli`一起使用的几个基本术语，了解这些术语将有助于我们更好地理解它。
- en: Device or interface
  id: totrans-314
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 设备或接口
- en: A device is a network interface such as `eno1`, `eno2`, `enp0s1`, `eth0`, and
    so on.
  id: totrans-315
  prefs: []
  type: TYPE_NORMAL
  zh: 设备是网络接口，如`eno1`、`eno2`、`enp0s1`、`eth0`等。
- en: Connection
  id: totrans-316
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 连接
- en: A connection in the context of `nmcli` is a collection of settings or configurations
    used to store a state of device. A single device can have multiple connections,
    however only one connection may be active at one time.
  id: totrans-317
  prefs: []
  type: TYPE_NORMAL
  zh: 在`nmcli`的上下文中，连接是用于存储设备状态的设置或配置的集合。一个设备可以有多个连接，但一次只能有一个连接处于活动状态。
- en: For example, a DHCP configuration of the network interface can be stored in
    one connection and a static configuration of the network interface can be stored
    in another state. This helps in switching connections rapidly, without changing
    the configuration manually every time. Connection is also popularly known as **connection
    profile.**
  id: totrans-318
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，网络接口的DHCP配置可以存储在一个连接中，静态配置可以存储在另一个状态中。这有助于快速切换连接，而无需每次手动更改配置。连接也通常被称为**连接配置文件**。
- en: Displaying network information using nmcli
  id: totrans-319
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用nmcli显示网络信息
- en: We can display the list of active connections or all saved connections using
    the `nmcli` command.
  id: totrans-320
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以使用`nmcli`命令显示活动连接列表或所有已保存的连接。
- en: '**Following are the examples to illustrate the usage of** nmcli **command for
    displaying network information:**'
  id: totrans-321
  prefs: []
  type: TYPE_NORMAL
  zh: '**以下是说明如何使用** nmcli **命令显示网络信息的示例：**'
- en: 'Display the list of all connections using `nmcli` command as follows:'
  id: totrans-322
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用`nmcli`命令显示所有连接的列表，如下所示：
- en: '[PRE43]'
  id: totrans-323
  prefs: []
  type: TYPE_PRE
  zh: '[PRE43]'
- en: 'Display only the active connections using `nmcli` command as follows:'
  id: totrans-324
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用`nmcli`命令仅显示活动连接，如下所示：
- en: '[PRE44]'
  id: totrans-325
  prefs: []
  type: TYPE_PRE
  zh: '[PRE44]'
- en: 'Display the details of a connection by specifying the connection ID (`NAME`)
    using `nmcli` command as follows:'
  id: totrans-326
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用`nmcli`命令通过指定连接ID（`NAME`）显示连接详情，如下所示：
- en: '[PRE45]'
  id: totrans-327
  prefs: []
  type: TYPE_PRE
  zh: '[PRE45]'
- en: 'An example of `nmcli` command usage to display connection state is shown here:'
  id: totrans-328
  prefs: []
  type: TYPE_NORMAL
  zh: 显示连接状态的`nmcli`命令使用示例如下：
- en: '![](img/3841a153-c139-4ce8-bdea-0b0c93cf7893.png)'
  id: totrans-329
  prefs: []
  type: TYPE_IMG
  zh: '![](img/3841a153-c139-4ce8-bdea-0b0c93cf7893.png)'
- en: 'Display the device (interface) status as connected or disconnected using `nmcli`
    command as follows:'
  id: totrans-330
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用`nmcli`命令显示设备（接口）状态为已连接或未连接，如下所示：
- en: '[PRE46]'
  id: totrans-331
  prefs: []
  type: TYPE_PRE
  zh: '[PRE46]'
- en: 'Display the device details using `nmcli` command as follows:'
  id: totrans-332
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用`nmcli`命令显示设备详情，如下所示：
- en: '[PRE47]'
  id: totrans-333
  prefs: []
  type: TYPE_PRE
  zh: '[PRE47]'
- en: 'An example of `nmcli` command to display the device details is shown here:'
  id: totrans-334
  prefs: []
  type: TYPE_NORMAL
  zh: 显示设备详情的`nmcli`命令示例如下：
- en: '![](img/fd80c2b6-e80d-441b-92b1-13ab31be010e.png)'
  id: totrans-335
  prefs: []
  type: TYPE_IMG
  zh: '![](img/fd80c2b6-e80d-441b-92b1-13ab31be010e.png)'
- en: Creating network connections using nmcli
  id: totrans-336
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用nmcli创建网络连接
- en: We can create new connections or a connection profile using the `nmcli` command.
    While creating a connection profile, the order of arguments plays an important
    role. We can specify IP address, gateway, and so on. The connection argument must
    include the connection type, interface name, and connection name argument to create
    a connection profile. The additional details such as DNS server are set after
    the creation of a connection profile by modifying it (connection profile) later
    on.
  id: totrans-337
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以使用`nmcli`命令创建新连接或连接配置文件。在创建连接配置文件时，参数的顺序非常重要。我们可以指定IP地址、网关等。连接参数必须包括连接类型、接口名称和连接名称等，以便创建连接配置文件。诸如DNS服务器等附加信息，则是在创建连接配置文件后通过修改该配置文件来设置的。
- en: '**Following are the examples to illustrate the usage of** **nmcli** **command
    for creating a new connection profile:**'
  id: totrans-338
  prefs: []
  type: TYPE_NORMAL
  zh: '**以下是说明如何使用** **nmcli** **命令创建新连接配置文件的示例：**'
- en: 'Create a new connection profile named `dhcp` which will autoconnect as an Ethernet
    connection on the `enp0s8` device using DHCP connectivity as shown here:'
  id: totrans-339
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建一个名为`dhcp`的新连接配置文件，该文件将通过DHCP连接方式在`enp0s8`设备上自动连接，如下所示：
- en: '![](img/f7def3bf-f5b2-46a0-a136-98c97a551796.png)'
  id: totrans-340
  prefs: []
  type: TYPE_IMG
  zh: '![](img/f7def3bf-f5b2-46a0-a136-98c97a551796.png)'
- en: 'Create another new connection profile named `static` and specify an IP address
    and gateway `nmcli` command. Also set the auto connect off on booting as shown
    here:'
  id: totrans-341
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建另一个名为`static`的新连接配置文件，并通过`nmcli`命令指定IP地址和网关。还需在启动时将自动连接关闭，如下所示：
- en: '![](img/30a3ca67-7b07-408d-8e15-f06f34b4a6da.png)'
  id: totrans-342
  prefs: []
  type: TYPE_IMG
  zh: '![](img/30a3ca67-7b07-408d-8e15-f06f34b4a6da.png)'
- en: 'Display the connection profiles that exist in the system using `nmcli` command
    as shown here:'
  id: totrans-343
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用`nmcli`命令显示系统中存在的连接配置文件，如下所示：
- en: '![](img/0ee48fc3-e835-4b09-a3da-b990e31fae5e.png)'
  id: totrans-344
  prefs: []
  type: TYPE_IMG
  zh: '![](img/0ee48fc3-e835-4b09-a3da-b990e31fae5e.png)'
- en: 'Change the connection profile of the existing device `enp0s8` to static using
    `nmcli` command, as shown here:'
  id: totrans-345
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用`nmcli`命令将现有设备`enp0s8`的连接配置文件更改为静态，如下所示：
- en: '![](img/932029c3-9a87-4f7d-a99b-a70a81b42a5e.png)'
  id: totrans-346
  prefs: []
  type: TYPE_IMG
  zh: '![](img/932029c3-9a87-4f7d-a99b-a70a81b42a5e.png)'
- en: 'Switch the connection profile of the device `enp0s8` again to `dhcp` using
    `nmcli` command as shown here:'
  id: totrans-347
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用`nmcli`命令再次将设备`enp0s8`的连接配置文件切换为`dhcp`，如下所示：
- en: '![](img/ef5ddcfd-428e-45ff-9111-fd0f5a212034.png)'
  id: totrans-348
  prefs: []
  type: TYPE_IMG
  zh: '![](img/ef5ddcfd-428e-45ff-9111-fd0f5a212034.png)'
- en: The option we have to give as an argument while creating the nmcli connection
    profile depends on the type used. To view all the options available, we can type
    `nmcli con add help` in the command line.
  id: totrans-349
  prefs: []
  type: TYPE_NORMAL
  zh: 创建nmcli连接配置文件时，我们需要提供的选项取决于所使用的类型。要查看所有可用选项，可以在命令行中输入`nmcli con add help`。
- en: Modifying network interfaces using nmcli
  id: totrans-350
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用nmcli修改网络接口
- en: An existing connection profile can be modified using the `nmcli con mod` command.
    Additional settings such as DNS servers can be specified here. Some properties,
    such as IP addresses and gateways, have different names to the name which was
    used while creating the connection profile.
  id: totrans-351
  prefs: []
  type: TYPE_NORMAL
  zh: 可以使用`nmcli con mod`命令修改现有的连接配置文件。可以在此指定其他设置，例如DNS服务器。某些属性（如IP地址和网关）在创建连接配置文件时使用的名称与修改后使用的名称不同。
- en: The command `nmcli con mod` is followed by arguments which are a set of key/value
    pairs. The `nmcli con show <connection_profile_name>` command is used to list
    the current key values for a connection.
  id: totrans-352
  prefs: []
  type: TYPE_NORMAL
  zh: '`nmcli con mod`命令后跟的是一组键/值对参数。`nmcli con show <connection_profile_name>`命令用于列出当前连接的键值。'
- en: 'When modifying a DHCP connection profile to static, the profile `ipv4.method`
    property key should be set as `manual`:'
  id: totrans-353
  prefs: []
  type: TYPE_NORMAL
  zh: 当将DHCP连接配置文件修改为静态时，`ipv4.method`属性键应设置为`manual`：
- en: '| **Property name while creating** | **Property name while modifying** |'
  id: totrans-354
  prefs: []
  type: TYPE_TB
  zh: '| **创建时的属性名称** | **修改时的属性名称** |'
- en: '| `ip4` | `ipv4` |'
  id: totrans-355
  prefs: []
  type: TYPE_TB
  zh: '| `ip4` | `ipv4` |'
- en: '| `gw4` | `gwv4` |'
  id: totrans-356
  prefs: []
  type: TYPE_TB
  zh: '| `gw4` | `gwv4` |'
- en: '**Following are the examples to illustrate the usage of nmcli con mod command
    to modify network interface settings:**'
  id: totrans-357
  prefs: []
  type: TYPE_NORMAL
  zh: '**以下是说明如何使用nmcli con mod命令修改网络接口设置的示例：**'
- en: 'Turn off auto connect for a connection profile as shown in command line here:'
  id: totrans-358
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在命令行中关闭连接配置文件的自动连接，如下所示：
- en: '[PRE48]'
  id: totrans-359
  prefs: []
  type: TYPE_PRE
  zh: '[PRE48]'
- en: 'Specify a DNS server using `nmcli con mod` command as shown here:'
  id: totrans-360
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用`nmcli con mod`命令指定DNS服务器，如下所示：
- en: '[PRE49]'
  id: totrans-361
  prefs: []
  type: TYPE_PRE
  zh: '[PRE49]'
- en: 'We can further add more values to a key by using the `+` or `-` symbol in front
    of the argument. We can also add another DNS server using `nmcli con mod` command
    as shown here:'
  id: totrans-362
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们可以通过在参数前添加`+`或`-`符号，进一步向某个键添加更多值。我们还可以使用`nmcli con mod`命令添加另一个DNS服务器，如下所示：
- en: '[PRE50]'
  id: totrans-363
  prefs: []
  type: TYPE_PRE
  zh: '[PRE50]'
- en: 'We can change the static IP address and gateway for a connection profile as
    shown here:'
  id: totrans-364
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们可以如下面所示修改连接配置文件的静态IP地址和网关：
- en: '[PRE51]'
  id: totrans-365
  prefs: []
  type: TYPE_PRE
  zh: '[PRE51]'
- en: 'We can assign a secondary IP address to the same interface without a gateway
    in an existing profile as shown here:'
  id: totrans-366
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们可以在现有配置文件中为同一接口分配一个不带网关的二级IP地址，如下所示：
- en: '[PRE52]'
  id: totrans-367
  prefs: []
  type: TYPE_PRE
  zh: '[PRE52]'
- en: 'To activate the changes, the connection profile needs to be activated using
    up with `nmcli con` command as shown here:'
  id: totrans-368
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 要激活更改，需要使用`nmcli con`命令激活连接配置文件，如下所示：
- en: '[PRE53]'
  id: totrans-369
  prefs: []
  type: TYPE_PRE
  zh: '[PRE53]'
- en: 'Delete a connection profile using `nmcli del` command as shown here:'
  id: totrans-370
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用`nmcli del`命令删除连接配置文件，如下所示：
- en: '[PRE54]'
  id: totrans-371
  prefs: []
  type: TYPE_PRE
  zh: '[PRE54]'
- en: 'Disable all managed interfaces using `nmcli` command as shown here:'
  id: totrans-372
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用`nmcli`命令禁用所有受管理接口，如下所示：
- en: '[PRE55]'
  id: totrans-373
  prefs: []
  type: TYPE_PRE
  zh: '[PRE55]'
- en: 'Bring down an interface by temporarily disconnecting the device as shown here:'
  id: totrans-374
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过暂时断开设备来关闭接口，如下所示：
- en: '[PRE56]'
  id: totrans-375
  prefs: []
  type: TYPE_PRE
  zh: '[PRE56]'
- en: 'Bring up an interface by connecting the device as shown here:'
  id: totrans-376
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过连接设备来启动接口，如下所示：
- en: '[PRE57]'
  id: totrans-377
  prefs: []
  type: TYPE_PRE
  zh: '[PRE57]'
- en: Editing network configuration files
  id: totrans-378
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 编辑网络配置文件
- en: In the previous section, we looked at how `nmcli` is used to configure static
    and dynamic IP addressing. Apart from the NetworkManager command-line interface
    and GUI interface, we can configure networking manually using network interface
    configuration files. At any one time, we can either configure networking using
    network interface files manually or using NetworkManager, but not both simultaneously.
    The location of the network interface files (scripts) varies from one Linux distribution
    to another. In the case of CentOS 7, the network interface configuration files
    are stored in the `/etc/sysconfig/network-scripts/` folder and their naming conventions
    begin with `ifcfg-<device_name>`.
  id: totrans-379
  prefs: []
  type: TYPE_NORMAL
  zh: 在前一部分中，我们了解了如何使用`nmcli`配置静态和动态IP地址。除了NetworkManager的命令行接口和GUI接口，我们还可以通过修改网络接口配置文件手动配置网络。在任何时候，我们可以通过手动配置网络接口文件或使用NetworkManager来配置网络，但不能同时使用两者。网络接口文件（脚本）的存储位置在不同的Linux发行版中有所不同。在CentOS
    7中，网络接口配置文件存储在`/etc/sysconfig/network-scripts/`文件夹中，并且其命名规则以`ifcfg-<device_name>`开头。
- en: Configuring networking options in static and dynamic modes
  id: totrans-380
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 配置静态和动态模式下的网络选项
- en: We can configure networking manually in static IP addressing or DHCP IP addressing
    modes by modifying network interface config files.
  id: totrans-381
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以通过修改网络接口配置文件以手动配置静态IP地址或DHCP IP地址模式。
- en: '**Following are the examples to illustrate how networking is configured manually
    in CentOS 7:**'
  id: totrans-382
  prefs: []
  type: TYPE_NORMAL
  zh: '**以下是手动配置CentOS 7网络的示例：**'
- en: 'Dynamic (`dhcp`) configuration of the `ifcfg` file is shown here:'
  id: totrans-383
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 动态（`dhcp`）配置的`ifcfg`文件如下所示：
- en: '![](img/4e6df568-99a1-4ee2-9375-ddd6d108caf6.png)'
  id: totrans-384
  prefs: []
  type: TYPE_IMG
  zh: '![](img/4e6df568-99a1-4ee2-9375-ddd6d108caf6.png)'
- en: 'Static configuration of the `ifcfg` file is explained as follows:'
  id: totrans-385
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ifcfg`文件的静态配置如下所示：'
- en: 'If more than one value of an IP address, prefix, or gateway is to be assigned
    in static configuration, then it is suffixed with a number at the end. If multiple
    DNS server are to be assigned, then they are numbered in their order of lookup,
    as shown here:'
  id: totrans-386
  prefs: []
  type: TYPE_NORMAL
  zh: 如果要在静态配置中分配多个IP地址、前缀或网关，则在其后加上一个数字。如果要分配多个DNS服务器，它们将按照查找顺序编号，如下所示：
- en: '![](img/6903575c-d8a8-4576-9803-f76243f700cf.png)'
  id: totrans-387
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6903575c-d8a8-4576-9803-f76243f700cf.png)'
- en: 'After making the desired changes to the configuration files, the networking
    service is to be restarted, or you can run the `nmcli con reload` command. This
    will make NetworkManager re-read the configuration files and apply changes. When
    reloading the `nmcli` configuration, the interface needs to be brought up and
    down once, for changes to come into effect as shown here:'
  id: totrans-388
  prefs: []
  type: TYPE_NORMAL
  zh: 在对配置文件进行所需更改后，需要重新启动网络服务，或者可以运行`nmcli con reload`命令。这样会使NetworkManager重新读取配置文件并应用更改。在重新加载`nmcli`配置时，接口需要先上升再下降一次，才能使更改生效，如下所示：
- en: '[PRE58]'
  id: totrans-389
  prefs: []
  type: TYPE_PRE
  zh: '[PRE58]'
- en: Configuring hostnames and name resolutions
  id: totrans-390
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 配置主机名和名称解析
- en: Hostname and DNS servers play an important role in networking as a machine is
    reachable in a network either by the IP address or hostname. The DNS server is
    responsible for the IP address to domain name and domain name to IP address conversion.
    This process of conversion is also known as **name resolution** or **DNS resolution**.
  id: totrans-391
  prefs: []
  type: TYPE_NORMAL
  zh: 主机名和DNS服务器在网络中扮演着重要角色，因为计算机可以通过IP地址或主机名在网络中访问。DNS服务器负责将IP地址转换为域名，也负责将域名转换为IP地址。这个转换过程也被称为**名称解析**或**DNS解析**。
- en: Since CentOS 7, the static host name has been stored in a new file, `/etc/hostname`.
    In earlier versions, it was stored in the `/etc/sysconfig/network` file. Now,
    a new command has been introduced with the name `hostnamectl`, to view and modify
    the hostname of machine.
  id: totrans-392
  prefs: []
  type: TYPE_NORMAL
  zh: 自 CentOS 7 起，静态主机名被存储在一个新的文件中，`/etc/hostname`。在早期版本中，它存储在`/etc/sysconfig/network`文件中。现在，新增了一个名为`hostnamectl`的命令，用于查看和修改机器的主机名。
- en: Displaying and modifying the hostname
  id: totrans-393
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 显示和修改主机名
- en: The `hostname` command is used to view the hostname or to temporarily modify
    the hostname at runtime. And the `hostnamectl` command is used to permanently
    modify the hostname from command line.
  id: totrans-394
  prefs: []
  type: TYPE_NORMAL
  zh: '`hostname`命令用于查看主机名或在运行时临时修改主机名。而`hostnamectl`命令用于通过命令行永久修改主机名。'
- en: '**Following are the examples to illustrate the usage of hostname command:**'
  id: totrans-395
  prefs: []
  type: TYPE_NORMAL
  zh: '**以下是说明`hostname`命令用法的示例：**'
- en: 'View the fully qualified host name of CentOS 7 using the `hostname` command
    as shown here:'
  id: totrans-396
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用`hostname`命令查看 CentOS 7 的完全限定主机名，如下所示：
- en: '![](img/19da4ce4-39b8-4877-84b8-c32a418a112a.png)'
  id: totrans-397
  prefs: []
  type: TYPE_IMG
  zh: '![](img/19da4ce4-39b8-4877-84b8-c32a418a112a.png)'
- en: 'Modify the fully qualified hostname temporarily at runtime, using the `hostname`
    command as shown here:'
  id: totrans-398
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用`hostname`命令临时修改完全限定的主机名，如下所示：
- en: '![](img/072c3998-9838-4cfc-9935-660c350e4f18.png)'
  id: totrans-399
  prefs: []
  type: TYPE_IMG
  zh: '![](img/072c3998-9838-4cfc-9935-660c350e4f18.png)'
- en: '**Following are the examples to illustrate the usage of hostnamectl command:**'
  id: totrans-400
  prefs: []
  type: TYPE_NORMAL
  zh: '**以下是说明`hostnamectl`命令用法的示例：**'
- en: 'View the hostname changes made using the `hostnamectl` command as shown in
    the following screenshot:'
  id: totrans-401
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用`hostnamectl`命令查看已修改的主机名变化，如下截图所示：
- en: '![](img/e4bc03c0-924f-4503-b75e-e3e428b0d287.png)'
  id: totrans-402
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e4bc03c0-924f-4503-b75e-e3e428b0d287.png)'
- en: 'Use the `hostnamectl` command to make permanent changes to the hostname as
    shown in following screenshot:'
  id: totrans-403
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用`hostnamectl`命令可以永久修改主机名，如下截图所示：
- en: '![](img/0d183878-a7b4-4b06-b8d5-d9369665e364.png)'
  id: totrans-404
  prefs: []
  type: TYPE_IMG
  zh: '![](img/0d183878-a7b4-4b06-b8d5-d9369665e364.png)'
- en: Modifying nameservers (DNS sever)
  id: totrans-405
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 修改名称服务器（DNS 服务器）
- en: The order of IP address to domain name and vice-versa lookup is already discussed
    earlier in this chapter. The information for the DNS server (nameserver) is stored
    in the `/etc/resolv.conf` file. The nameserver directive is followed by the IP
    address of a nameserver to query the IP lookup. A maximum of three nameserver
    directives can be specified in this file to provide backup if one is down.
  id: totrans-406
  prefs: []
  type: TYPE_NORMAL
  zh: 域名与 IP 地址之间的查询顺序在本章前面已讨论。DNS 服务器（名称服务器）的信息存储在`/etc/resolv.conf`文件中。`nameserver`指令后跟名称服务器的
    IP 地址，用于查询 IP 查找。如果一个名称服务器宕机，最多可以在此文件中指定三个`nameserver`指令以提供备份。
- en: DNS server entries in `/etc/resolv.conf` are managed by NetworkManager. We should
    add or modify the DNS server using `nmcli` or GUI NetworkManager if NetworkManager
    is running.
  id: totrans-407
  prefs: []
  type: TYPE_NORMAL
  zh: '`/etc/resolv.conf`中的 DNS 服务器条目由 NetworkManager 管理。如果 NetworkManager 正在运行，我们应该使用`nmcli`或图形界面
    NetworkManager 来添加或修改 DNS 服务器。'
- en: '**Following examples are used to explain, how we can view or modify the nameserver
    of a system:**'
  id: totrans-408
  prefs: []
  type: TYPE_NORMAL
  zh: '**以下示例用于解释如何查看或修改系统的名称服务器：**'
- en: 'Display the nameserver details as shown here:'
  id: totrans-409
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 显示名称服务器详细信息，如下所示：
- en: '![](img/595658a9-30f8-46aa-a72a-fc942b99c5c6.png)'
  id: totrans-410
  prefs: []
  type: TYPE_IMG
  zh: '![](img/595658a9-30f8-46aa-a72a-fc942b99c5c6.png)'
- en: 'We can modify the nameserver entry by adding the DNS server for a specific
    connection profile using `nmcli` as shown here:'
  id: totrans-411
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们可以通过为特定连接配置文件添加 DNS 服务器来使用`nmcli`修改名称服务器条目，如下所示：
- en: '[PRE59]'
  id: totrans-412
  prefs: []
  type: TYPE_PRE
  zh: '[PRE59]'
- en: 'If NetworkManager is running, then manual modifications made in the `/etc/resolv.conf`
    file are overwritten by NetworkManager. Hence, for manually modifying and preserving
    the entries of `/etc/resolv.conf` file, we should first turn off NetworkManager
    and then modify them as shown here:'
  id: totrans-413
  prefs: []
  type: TYPE_NORMAL
  zh: 如果 NetworkManager 正在运行，那么对`/etc/resolv.conf`文件的手动修改将被 NetworkManager 覆盖。因此，要手动修改并保留`/etc/resolv.conf`文件中的条目，我们应该先关闭
    NetworkManager，然后再进行修改，如下所示：
- en: '[PRE60]'
  id: totrans-414
  prefs: []
  type: TYPE_PRE
  zh: '[PRE60]'
- en: Accessing remote logins with SSH
  id: totrans-415
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 SSH 访问远程登录
- en: SSH is an OpenSSH client program used for securely logging in to a remote machine
    for remote administration. It provides an authenticated encrypted communication
    channel between two hosts over an untrusted network.
  id: totrans-416
  prefs: []
  type: TYPE_NORMAL
  zh: SSH 是一个 OpenSSH 客户端程序，用于安全地登录到远程计算机进行远程管理。它为两台主机之间提供经过身份验证的加密通信通道，适用于不可信的网络。
- en: Understanding OpenSSH
  id: totrans-417
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 理解 OpenSSH
- en: The SSH component can be categorized into two parts. The first is OpenSSH server
    (sshd service) which is installed and run on a remote server to accept connections
    from OpenSSH Client. By default, it runs on port `22` using TCP protocol, which
    should be allowed by firewalls to accept OpenSSH client connections.
  id: totrans-418
  prefs: []
  type: TYPE_NORMAL
  zh: SSH 组件可以分为两个部分。第一个是 OpenSSH 服务器（sshd 服务），它安装并运行在远程服务器上，接受来自 OpenSSH 客户端的连接。默认情况下，它使用
    TCP 协议在 `22` 端口上运行，防火墙应该允许 OpenSSH 客户端连接。
- en: The second component is SSH Client, which should be installed on any client
    system (Linux, Windows, or macOS) from which you want to connect to the system
    running OpenSSH server for remote administration.
  id: totrans-419
  prefs: []
  type: TYPE_NORMAL
  zh: 第二个组件是SSH客户端，应该安装在任何客户端系统上（Linux、Windows 或 macOS），从这些系统中你可以连接到运行 OpenSSH 服务器的系统进行远程管理。
- en: Thus, the SSH protocol facilitates secure communications between two systems
    using client-server architecture. SSH encrypts the user login session completely
    and thereby makes it difficult for intruders to sniff any unencrypted password
    and eliminates **man-in-the-middle-attack** (**MITM**) probability over the network.
    SSH authenticates using the private-public key scheme, which further eliminates
    the impersonation attack on the network.
  id: totrans-420
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，SSH 协议通过客户端-服务器架构促进了两个系统之间的安全通信。SSH 完全加密用户登录会话，从而使入侵者难以嗅探任何未加密的密码，并消除了**中间人攻击**（**MITM**）的网络风险。SSH
    使用私钥-公钥方案进行认证，进一步消除了网络上的冒充攻击。
- en: Executing commands over SSH remotely
  id: totrans-421
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 远程通过 SSH 执行命令
- en: 'Following are the examples to illustrate the basic usage of `ssh` command:'
  id: totrans-422
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是一些示例，说明了 `ssh` 命令的基本用法：
- en: 'The `ssh` command can be used to log in to a remote system using the current
    logged-in username of client requesting connection to ssh sever, as shown in command
    line and next screenshot:'
  id: totrans-423
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ssh` 命令可以使用当前登录的客户端用户名登录远程系统，连接到 SSH 服务器，如命令行和下图所示：'
- en: '[PRE61]'
  id: totrans-424
  prefs: []
  type: TYPE_PRE
  zh: '[PRE61]'
- en: '![](img/78d4b782-0d51-4cb3-9614-652d07ae847b.png)'
  id: totrans-425
  prefs: []
  type: TYPE_IMG
  zh: '![](img/78d4b782-0d51-4cb3-9614-652d07ae847b.png)'
- en: 'The `ssh` command can be executed as another user by specifying the username
    and hostname/IP address as shown here:'
  id: totrans-426
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ssh` 命令可以通过指定用户名和主机名/IP 地址以另一个用户身份执行，如下所示：'
- en: '[PRE62]'
  id: totrans-427
  prefs: []
  type: TYPE_PRE
  zh: '[PRE62]'
- en: 'An example of execution of ssh command as different user is shown in the following
    screenshot:'
  id: totrans-428
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是以不同用户身份执行 ssh 命令的示例：
- en: '![](img/f12a48e0-e13f-4122-b5a9-fb253773ee33.png)'
  id: totrans-429
  prefs: []
  type: TYPE_IMG
  zh: '![](img/f12a48e0-e13f-4122-b5a9-fb253773ee33.png)'
- en: 'You can execute a command on the remote system via `ssh` as shown here:'
  id: totrans-430
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你可以通过 `ssh` 在远程系统上执行命令，如下所示：
- en: '[PRE63]'
  id: totrans-431
  prefs: []
  type: TYPE_PRE
  zh: '[PRE63]'
- en: 'An example of executing a command on remote system via `ssh` is shown in the
    following screenshot:'
  id: totrans-432
  prefs: []
  type: TYPE_NORMAL
  zh: 通过 `ssh` 在远程系统上执行命令的示例，如下图所示：
- en: '![](img/a53b1d2c-cbf4-48e1-99a4-18a07e9221d8.png)'
  id: totrans-433
  prefs: []
  type: TYPE_IMG
  zh: '![](img/a53b1d2c-cbf4-48e1-99a4-18a07e9221d8.png)'
- en: Key-based SSH authentication
  id: totrans-434
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 基于密钥的 SSH 认证
- en: 'SSH communication is secured using public key cryptography. When a user connects
    to the SSH-server using SSH-client for the first time, the SSH program stores
    the SSH-server public key in the user''s home directory inside a file, `known_hosts`,
    in a hidden folder named `~/.ssh/`, as shown in the following screenshot:'
  id: totrans-435
  prefs: []
  type: TYPE_NORMAL
  zh: SSH 通信通过公钥加密技术保障安全。当用户第一次使用 SSH-client 连接到 SSH-server 时，SSH 程序会将 SSH-server
    公钥存储在用户的主目录下的一个名为`~/.ssh/`的隐藏文件夹中的 `known_hosts` 文件里，如下图所示：
- en: '![](img/f8c51c92-30d9-46c6-8771-813f1e46073c.png)'
  id: totrans-436
  prefs: []
  type: TYPE_IMG
  zh: '![](img/f8c51c92-30d9-46c6-8771-813f1e46073c.png)'
- en: 'The following screenshot shows an example of a public key fingerprint of the
    remote host being stored in the client''s known host file:'
  id: totrans-437
  prefs: []
  type: TYPE_NORMAL
  zh: 下图显示了远程主机的公钥指纹示例，保存在客户端的已知主机文件中：
- en: '![](img/675ce68b-b7cd-42b7-b81e-2cf95062df54.png)'
  id: totrans-438
  prefs: []
  type: TYPE_IMG
  zh: '![](img/675ce68b-b7cd-42b7-b81e-2cf95062df54.png)'
- en: 'Now, subsequently whenever ssh-client connects to the server, it compares the
    public key sent by the server to the public key of the server stored in the `~/.ssh/known_hosts` file.
    If the public key does not match, the client assumes that the network traffic
    is being hijacked or the server to which the connection is being made is not the
    same, and hence SSH-client breaks the connection, as shown here:'
  id: totrans-439
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，每当 ssh-client 连接到服务器时，它会将服务器发送的公钥与存储在`~/.ssh/known_hosts`文件中的服务器公钥进行比较。如果公钥不匹配，客户端会认为网络流量可能被劫持，或者连接的服务器不一样，因此
    SSH-client 会断开连接，如下所示：
- en: '![](img/f61e3004-6c77-46c9-91ee-38a2f9908204.png)'
  id: totrans-440
  prefs: []
  type: TYPE_IMG
  zh: '![](img/f61e3004-6c77-46c9-91ee-38a2f9908204.png)'
- en: It is also a possibility that the server was reformatted or the server key replaced
    for any legitimate reason. In such circumstances, the user needs to update their
    `~/.ssh/known_hosts` files by deleting the old keys to enable logging in to the
    server.
  id: totrans-441
  prefs: []
  type: TYPE_NORMAL
  zh: 服务器可能会因为某些合法原因被重新格式化，或服务器密钥被替换。在这种情况下，用户需要通过删除旧的密钥来更新他们的`~/.ssh/known_hosts`文件，以便重新登录服务器。
- en: Configuring ssh-keygen for password-less authentication
  id: totrans-442
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 配置 ssh-keygen 实现无密码认证
- en: SSH server has multiple ways of authenticating a client connecting to it. The
    most popular method is password-based authentication as it is the easiest one,
    however it is not so secure. Passwords are exchanged with secure mechanisms, however,
    due to ease of use they are generally not complex or long. This enable the attacker
    to break the password using brute-force or dictionary attacks. In such scenarios,
    the SSH keys can provide a secure and reliable means of authentication for clients.
  id: totrans-443
  prefs: []
  type: TYPE_NORMAL
  zh: SSH 服务器有多种方式来验证连接到它的客户端。最常见的方式是基于密码的身份验证，因为它是最简单的方法，但它的安全性较差。密码通过安全机制进行交换，然而由于易于使用，密码通常不够复杂或长。因此，攻击者可以通过暴力破解或字典攻击来破解密码。在这种情况下，SSH
    密钥可以为客户端提供一种安全可靠的认证方式。
- en: SSH server uses a public key cryptography scheme to authenticate users. In this
    scheme, a pair of keys are generated, a public key and private key, for authentication.
    As the name suggests, a private key is kept secret by the client as its compromise
    can lead to someone logging in to the server without any additional authentication.
  id: totrans-444
  prefs: []
  type: TYPE_NORMAL
  zh: SSH 服务器使用公钥密码学方案进行用户认证。在这种方案中，会生成一对密钥，即公钥和私钥，用于身份验证。顾名思义，私钥由客户端保密，因为私钥泄露可能导致未经额外身份验证就能登录到服务器。
- en: The corresponding public key for the secret private key of the client is not
    kept as secret and is copied to systems the user logs in to. The private key is
    used to decrypt the message encrypted using the associated public key of the client.
    Using the key pair, we can also enable the password-less authentication.
  id: totrans-445
  prefs: []
  type: TYPE_NORMAL
  zh: 客户端的秘密私钥对应的公钥不会被保密，而是被复制到用户登录的系统中。私钥用于解密使用客户端关联的公钥加密的消息。通过使用密钥对，我们还可以实现无密码认证。
- en: 'The trusted public key of the client is stored in a special file named `authorized_keys`
    in the `home` directory of user account, used to log in as shown in the following
    diagram:'
  id: totrans-446
  prefs: []
  type: TYPE_NORMAL
  zh: 客户端的受信任公钥存储在一个名为`authorized_keys`的特殊文件中，该文件位于用户帐户的`home`目录中，用于登录，如下图所示：
- en: '![](img/478b8c64-d28b-4c10-8a3a-581a359d73fc.png)'
  id: totrans-447
  prefs: []
  type: TYPE_IMG
  zh: '![](img/478b8c64-d28b-4c10-8a3a-581a359d73fc.png)'
- en: When a client attempts to authenticate the SSH server using keys, a challenge
    is issued using the public key of the client stored in the server. On successfully
    decrypting the challenge using the client's private key, the user gets access
    to the shell of the server.
  id: totrans-448
  prefs: []
  type: TYPE_NORMAL
  zh: 当客户端尝试使用密钥进行 SSH 服务器身份验证时，服务器会使用存储在服务器上的客户端公钥发起挑战。成功使用客户端私钥解密挑战后，用户即可访问服务器的
    shell。
- en: In addition to password-based and key-based authentication, SSH also supports
    Kerberos and gssapi and so on for authentication.
  id: totrans-449
  prefs: []
  type: TYPE_NORMAL
  zh: 除了基于密码和基于密钥的认证方式外，SSH 还支持 Kerberos 和 gssapi 等认证方式。
- en: Creating a SSH key pair
  id: totrans-450
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建 SSH 密钥对
- en: 'In this step, the client uses a special utility, `ssh-keygen`, to generate
    an SSH key pair for authentication with the server. This utility is bundled with
    OpenSSH and by default it creates a 2048-bit RSA key pair. It supports RSA and
    DSA, both with different lengths of keys. A key length of 4096 bits is recommended
    for establishing a secure connection between two machines. The following diagram
    shows how to create a RSA key pair of 2048-bit:'
  id: totrans-451
  prefs: []
  type: TYPE_NORMAL
  zh: 在此步骤中，客户端使用一个特殊的工具`ssh-keygen`来生成用于与服务器进行身份验证的 SSH 密钥对。该工具与 OpenSSH 一起捆绑，默认情况下它创建一个
    2048 位的 RSA 密钥对。它支持 RSA 和 DSA 两种加密算法，每种算法支持不同长度的密钥。建议使用 4096 位的密钥长度，以便在两台机器之间建立安全连接。下图展示了如何创建一个
    2048 位的 RSA 密钥对：
- en: '![](img/a39b0197-206a-4e0a-a74d-16884c739e88.png)'
  id: totrans-452
  prefs: []
  type: TYPE_IMG
  zh: '![](img/a39b0197-206a-4e0a-a74d-16884c739e88.png)'
- en: It will prompt you to select a location for the keys that will be generated.
    By default, the keys are stored in the user's home directory, the `~/.ssh` directory,
    with the private key named as `id_rsa` and the public key as `id_rsa.pub`. The
    permission on the private key is 600 and it is 644 on public key.
  id: totrans-453
  prefs: []
  type: TYPE_NORMAL
  zh: 系统会提示你选择生成密钥的存储位置。默认情况下，密钥存储在用户的主目录下的`~/.ssh`目录中，私钥命名为`id_rsa`，公钥命名为`id_rsa.pub`。私钥的权限为
    600，公钥的权限为 644。
- en: 'Then, it prompts you to enter an optional passphrase for the key, which is
    used to decrypt the key on the local machine (client side). Hence, brute-force
    or dictionary attacks are not possible for this passphrase. The passphrase also
    provides additional security in case of the system being compromised. For example,
    it can prevent the attacker from logging in to other servers when SSH keys have
    already been exchanged in the compromised system. Following image shows the RSA
    key pair public key used for authentication:'
  id: totrans-454
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，它会提示你为密钥输入一个可选的密码短语，该密码短语用于解密本地计算机（客户端）上的密钥。因此，暴力破解或字典攻击无法对这个密码短语进行攻击。密码短语还提供了额外的安全性，以防系统被攻破。例如，当SSH密钥已在被攻破的系统中交换时，它可以防止攻击者登录到其他服务器。下图显示了用于身份验证的RSA密钥对公钥：
- en: '![](img/5ba4c789-aa5e-4435-8399-6cc185eb134e.png)'
  id: totrans-455
  prefs: []
  type: TYPE_IMG
  zh: '![](img/5ba4c789-aa5e-4435-8399-6cc185eb134e.png)'
- en: Now, to enable key-based authentication, the public key of client is to be copied
    to the destination system running SSH server.
  id: totrans-456
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，为了启用基于密钥的身份验证，需要将客户端的公钥复制到运行SSH服务器的目标系统。
- en: '**Following example illustrate the copying of public key to remote machine
    using ssh-copy-id command:**'
  id: totrans-457
  prefs: []
  type: TYPE_NORMAL
  zh: '**以下示例演示了如何使用`ssh-copy-id`命令将公钥复制到远程计算机：**'
- en: 'There is one utility, `ssh-copy-id`, which is also bundled with OpenSSH and
    can be used to copy the key to the remote system. It automatically copies the
    `~/.ssh/id_rsa.pub` file by default into the remote system as shown here:'
  id: totrans-458
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 有一个工具，`ssh-copy-id`，它也包含在OpenSSH中，可以用来将密钥复制到远程系统。默认情况下，它会将`~/.ssh/id_rsa.pub`文件复制到远程系统，如下所示：
- en: '![](img/7deccecc-5690-461e-8c1f-83a6c2519c80.png)'
  id: totrans-459
  prefs: []
  type: TYPE_IMG
  zh: '![](img/7deccecc-5690-461e-8c1f-83a6c2519c80.png)'
- en: 'The general syntax of `ssh-copy-id` command is as follows:'
  id: totrans-460
  prefs: []
  type: TYPE_NORMAL
  zh: '`ssh-copy-id`命令的一般语法如下：'
- en: '[PRE64]'
  id: totrans-461
  prefs: []
  type: TYPE_PRE
  zh: '[PRE64]'
- en: 'The following diagram shows how to do ssh on remote host without giving password:'
  id: totrans-462
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 以下图示展示了如何在远程主机上进行SSH登录而不需要输入密码：
- en: '![](img/3526c378-0869-4fb2-9ddd-2a77b290fd80.png)'
  id: totrans-463
  prefs: []
  type: TYPE_IMG
  zh: '![](img/3526c378-0869-4fb2-9ddd-2a77b290fd80.png)'
- en: 'Another method of copying the public key into the remote host''s `authorized_keys`
    files using `ssh` command is shown here:'
  id: totrans-464
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 另一种将公钥复制到远程主机`authorized_keys`文件中的方法，如下所示：
- en: '[PRE65]'
  id: totrans-465
  prefs: []
  type: TYPE_PRE
  zh: '[PRE65]'
- en: Now SSH into the remote host by entering the passphrase when prompted (required
    only if you give the passphrase while creating the keys).
  id: totrans-466
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，通过在提示时输入密码短语来SSH登录远程主机（仅在创建密钥时给定密码短语时需要）。
- en: Configuring and securing SSH logins
  id: totrans-467
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 配置和保护SSH登录
- en: 'Additional security measures can be enabled by modifying the OpenSSH server
    configuration file `/etc/ssh/sshd_config`, on the remote host. Following are the
    some steps that can be taken to secure the SSH logins:'
  id: totrans-468
  prefs: []
  type: TYPE_NORMAL
  zh: 可以通过修改远程主机上的OpenSSH服务器配置文件`/etc/ssh/sshd_config`，启用额外的安全措施。以下是一些可以采取的措施来保护SSH登录：
- en: 'Now, since we have configured the SSH key-based authentication in the previous
    section, we can disable the password authentication to secure SSH logins in the
    SSH server configuration file. Edit the SSH daemon config file on the remote host
    running the SSH server and set the `PasswordAuthentication` directive value to
    `no` as shown here:'
  id: totrans-469
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，由于我们在前一节中已配置了基于SSH密钥的身份验证，因此可以禁用密码身份验证来保护SSH登录。编辑远程主机上运行SSH服务器的SSH守护进程配置文件，并将`PasswordAuthentication`指令的值设置为`no`，如下所示：
- en: '[PRE66]'
  id: totrans-470
  prefs: []
  type: TYPE_PRE
  zh: '[PRE66]'
- en: 'Prohibit direct login as the root user through SSH, as the root user has unrestricted
    privileges and exists by default on every Linux system. To secure the root user
    account through SSH, we can do following changes in configuration file:'
  id: totrans-471
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 禁止通过SSH直接以root用户身份登录，因为root用户具有无限制的权限，并且默认情况下每个Linux系统上都有root用户。为了通过SSH保护root用户账户，我们可以在配置文件中做如下更改：
- en: 'Comment the line with the directive `PermitRootLogin` as shown here:'
  id: totrans-472
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 注释掉带有指令`PermitRootLogin`的行，如下所示：
- en: '[PRE67]'
  id: totrans-473
  prefs: []
  type: TYPE_PRE
  zh: '[PRE67]'
- en: 'Set the directive `PermitRootLogin` value as `no` as shown here:'
  id: totrans-474
  prefs:
  - PREF_OL
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将指令`PermitRootLogin`的值设置为`no`，如下所示：
- en: '[PRE68]'
  id: totrans-475
  prefs: []
  type: TYPE_PRE
  zh: '[PRE68]'
- en: 'Allow only key-based ssh login in the root account by setting the directive
    `PermitRootLogin` value as `without-password` as shown here:'
  id: totrans-476
  prefs:
  - PREF_OL
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过将指令`PermitRootLogin`的值设置为`without-password`，仅允许使用密钥进行root账户的SSH登录，如下所示：
- en: '[PRE69]'
  id: totrans-477
  prefs: []
  type: TYPE_PRE
  zh: '[PRE69]'
- en: 'After making changes in the SSH server configuration file `/etc/ssh/sshd_config`,
    restart the `sshd` service to bring the applied changes into effect, as shown
    here:'
  id: totrans-478
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在修改完SSH服务器配置文件`/etc/ssh/sshd_config`后，重新启动`sshd`服务，以使所做的更改生效，如下所示：
- en: '[PRE70]'
  id: totrans-479
  prefs: []
  type: TYPE_PRE
  zh: '[PRE70]'
- en: Transferring files in Linux
  id: totrans-480
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在Linux中传输文件
- en: We have seen how to secure our communication between the client and remote host
    server using SSH. In this section, we will securely transfer files between two
    connected machines. CentOS 7 has two popular utilities, `scp` and `rsync`, to
    secure data transfer between connected machines.
  id: totrans-481
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经看过如何使用SSH保护客户端与远程主机服务器之间的通信。在本节中，我们将安全地传输两个连接机器之间的文件。CentOS 7 提供了两个常用的工具，`scp`和`rsync`，用于在连接的机器之间进行安全的数据传输。
- en: Secure file transfer using SCP
  id: totrans-482
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用SCP进行安全文件传输
- en: The `scp` command is used to securely transfer files from a local system to
    a remote host or from a remote host to a local system. It uses SSH server for
    secure (encrypted) data transfer and for authentication.
  id: totrans-483
  prefs: []
  type: TYPE_NORMAL
  zh: '`scp`命令用于安全地从本地系统传输文件到远程主机，或者从远程主机传输文件到本地系统。它使用SSH服务器进行安全（加密）数据传输和身份验证。'
- en: The `ssh`, `scp`, and `sftp` are bundled into `ssh` package and gets installed
    automatically on installation of `ssh`.
  id: totrans-484
  prefs: []
  type: TYPE_NORMAL
  zh: '`ssh`、`scp`和`sftp`被打包成`ssh`软件包，并在安装`ssh`时自动安装。'
- en: Local to remote filesystem file transfer
  id: totrans-485
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 从本地到远程文件系统的文件传输
- en: 'The syntax of transferring a file from local system to remote filesystem is
    as follows:'
  id: totrans-486
  prefs: []
  type: TYPE_NORMAL
  zh: 从本地系统传输文件到远程文件系统的语法如下：
- en: '[PRE71]'
  id: totrans-487
  prefs: []
  type: TYPE_PRE
  zh: '[PRE71]'
- en: 'On execution of the preceding command, you will be prompted for the remote
    user password. After entering the correct password, file transfer will begin as
    shown in the following diagram:'
  id: totrans-488
  prefs: []
  type: TYPE_NORMAL
  zh: 执行前面的命令时，系统会提示输入远程用户密码。输入正确的密码后，文件传输将开始，如下图所示：
- en: '![](img/5ed9a0c8-19a1-48ae-ab4d-500d2718cab2.png)'
  id: totrans-489
  prefs: []
  type: TYPE_IMG
  zh: '![](img/5ed9a0c8-19a1-48ae-ab4d-500d2718cab2.png)'
- en: Remote to local filesystem file transfer
  id: totrans-490
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 从远程到本地文件系统的文件传输
- en: 'The syntax of transferring a file from remote system to local filesystem transfer
    is as follows:'
  id: totrans-491
  prefs: []
  type: TYPE_NORMAL
  zh: 从远程系统传输文件到本地文件系统的语法如下：
- en: '[PRE72]'
  id: totrans-492
  prefs: []
  type: TYPE_PRE
  zh: '[PRE72]'
- en: 'On execution of preceding command you will be prompted for remote user password.
    After entering the correct password, file transfer will begin as shown here:'
  id: totrans-493
  prefs: []
  type: TYPE_NORMAL
  zh: 执行前面的命令时，系统会提示输入远程用户密码。输入正确的密码后，文件传输将开始，如下所示：
- en: '![](img/eb8d6f1f-21ef-4cd8-b977-19bb99892dd3.png)'
  id: totrans-494
  prefs: []
  type: TYPE_IMG
  zh: '![](img/eb8d6f1f-21ef-4cd8-b977-19bb99892dd3.png)'
- en: Synchronizing files using rsync
  id: totrans-495
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用rsync同步文件
- en: Rsync is another utility that is used to copy files securely and quickly from
    one system to another. It uses an SSH connection for transfer of data and differs
    from SCP as it copies only the differences in existing files. Rsync is faster
    than SCP as it copies only differences when copying files from one directory on
    a local system to a directory on a remote system, whereas SCP would copy everything.
  id: totrans-496
  prefs: []
  type: TYPE_NORMAL
  zh: Rsync是另一个用于快速、安全地从一个系统复制文件到另一个系统的工具。它使用SSH连接进行数据传输，并与SCP不同，因为它仅复制现有文件中的差异。Rsync比SCP更快，因为它仅复制文件之间的差异，而SCP则会复制所有内容。
- en: 'The following table lists the important options along with their description,
    that are used with `rsync` command for synchronizing files and folders:'
  id: totrans-497
  prefs: []
  type: TYPE_NORMAL
  zh: 下表列出了与`rsync`命令一起使用的重要选项及其说明，用于同步文件和文件夹：
- en: '| **Option** | **Description** |'
  id: totrans-498
  prefs: []
  type: TYPE_TB
  zh: '| **选项** | **说明** |'
- en: '| `-a` | Archive mode (it includes recursion, synchronizing symlinks, preserving
    permissions, preserving group ownership, times stamps, ownership of files, and
    synchronizing of device files).It is equivalent of the following options: `-rlptgoD`
    |'
  id: totrans-499
  prefs: []
  type: TYPE_TB
  zh: '| `-a` | 存档模式（包括递归、同步符号链接、保留权限、保留组所有权、时间戳、文件所有权，以及同步设备文件）。它相当于以下选项：`-rlptgoD`
    |'
- en: '| `-v` | It adds verbosity in the output when synchronization takes place.
    |'
  id: totrans-500
  prefs: []
  type: TYPE_TB
  zh: '| `-v` | 同步时在输出中增加详细信息。 |'
- en: '| `-r` | Synchronize whole directory tree recursively. |'
  id: totrans-501
  prefs: []
  type: TYPE_TB
  zh: '| `-r` | 递归同步整个目录树。 |'
- en: '| `-n` | Perform dry-run without making changes. |'
  id: totrans-502
  prefs: []
  type: TYPE_TB
  zh: '| `-n` | 执行干跑操作，不做任何更改。 |'
- en: '| `--remove-source-files` | Synchronized files are removed from the sender
    system. |'
  id: totrans-503
  prefs: []
  type: TYPE_TB
  zh: '| `--remove-source-files` | 同步后的文件将从发送系统中删除。 |'
- en: '| `-z` | Compress file data during transmission from source to destination.
    |'
  id: totrans-504
  prefs: []
  type: TYPE_TB
  zh: '| `-z` | 在从源到目标的传输过程中压缩文件数据。 |'
- en: '| `-X` | Synchronize SELinux contexts from source to destination. |'
  id: totrans-505
  prefs: []
  type: TYPE_TB
  zh: '| `-X` | 从源到目标同步SELinux上下文。 |'
- en: '| `-A` | Synchronize ACLs on file. |'
  id: totrans-506
  prefs: []
  type: TYPE_TB
  zh: '| `-A` | 同步文件的ACL。 |'
- en: Synchronizing data locally from one folder to another for backup
  id: totrans-507
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在本地从一个文件夹到另一个文件夹同步数据进行备份
- en: 'The syntax for local synchronization for backup from one folder to another
    is as follows:'
  id: totrans-508
  prefs: []
  type: TYPE_NORMAL
  zh: 用于从一个文件夹备份到另一个文件夹的本地同步语法如下：
- en: '[PRE73]'
  id: totrans-509
  prefs: []
  type: TYPE_PRE
  zh: '[PRE73]'
- en: 'An example of `rsync` command usage to synchronize local files is shown here:'
  id: totrans-510
  prefs: []
  type: TYPE_NORMAL
  zh: 下面是一个`rsync`命令使用示例，用于同步本地文件：
- en: '![](img/81654edb-dcde-4b3b-ad56-7b372e1fe957.png)'
  id: totrans-511
  prefs: []
  type: TYPE_IMG
  zh: '![](img/81654edb-dcde-4b3b-ad56-7b372e1fe957.png)'
- en: Synchronizing data from a local to remote host filesystem
  id: totrans-512
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 从本地到远程主机文件系统同步数据
- en: 'The syntax for local to remote host filesystem synchronization is as follows:'
  id: totrans-513
  prefs: []
  type: TYPE_NORMAL
  zh: 本地到远程主机文件系统同步的语法如下：
- en: '[PRE74]'
  id: totrans-514
  prefs: []
  type: TYPE_PRE
  zh: '[PRE74]'
- en: 'On execution of the preceding command, you will be prompted for a remote user
    password. After entering the correct password, file synchronization will begin
    as shown here:'
  id: totrans-515
  prefs: []
  type: TYPE_NORMAL
  zh: 执行上述命令时，系统会提示输入远程用户密码。输入正确密码后，文件同步将开始，如下所示：
- en: '![](img/50b696ff-c47d-43fe-8301-517132bc6fac.png)'
  id: totrans-516
  prefs: []
  type: TYPE_IMG
  zh: '![](img/50b696ff-c47d-43fe-8301-517132bc6fac.png)'
- en: Synchronizing data from remote host to local filesystem
  id: totrans-517
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 从远程主机同步数据到本地文件系统
- en: 'The syntax for remote host to local filesystem synchronization is as follows:'
  id: totrans-518
  prefs: []
  type: TYPE_NORMAL
  zh: 远程主机到本地文件系统同步的语法如下：
- en: '[PRE75]'
  id: totrans-519
  prefs: []
  type: TYPE_PRE
  zh: '[PRE75]'
- en: 'On execution of preceding command you will be prompted for remote user password.
    After entering the correct password, file synchronization will begin as shown
    here:'
  id: totrans-520
  prefs: []
  type: TYPE_NORMAL
  zh: 执行上述命令时，系统会提示输入远程用户密码。输入正确密码后，文件同步将开始，如下所示：
- en: '![](img/e56eb1b0-2aae-4e39-99ed-3734499a09e2.png)'
  id: totrans-521
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e56eb1b0-2aae-4e39-99ed-3734499a09e2.png)'
- en: Summary
  id: totrans-522
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we began with learning basic networking concepts such as IP
    address, DNS, gateway, and so on. This was followed by essential networking commands
    used in CentOS 7\. Then we looked at the management of network interfaces using
    nmcli (NetworkManager command-line interface), the editing of network configuration
    files for manual configuration, and modifying hostname, DNS server parameters,
    and so on. Thereafter, we learnt how to securely connect to remote hosts using
    the SSH Client and password as well as with public keys for authentication. Finally,
    we looked up how to securely transfer and synchronize files for backup from one
    host to another using the command line.
  id: totrans-523
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们首先学习了基本的网络概念，如IP地址、DNS、网关等。接着，我们介绍了CentOS 7中常用的基本网络命令。然后，我们了解了如何使用nmcli（NetworkManager命令行界面）管理网络接口，手动编辑网络配置文件进行配置，以及如何修改主机名、DNS服务器参数等。随后，我们学习了如何使用SSH客户端和密码以及公钥认证来安全地连接远程主机。最后，我们学习了如何使用命令行安全地传输和同步文件，以便从一台主机备份到另一台主机。
- en: In the next chapter, we will learn about how to keep CentOS 7 and its installed
    applications up to date. We will also learn how to install or remove undesired
    applications using the command line.
  id: totrans-524
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将学习如何保持CentOS 7及其安装的应用程序始终保持最新。我们还将学习如何通过命令行安装或删除不需要的应用程序。
