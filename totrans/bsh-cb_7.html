<html><head></head><body><div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Writing Bash to Win and Profit</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">In this chapter, we will introduce the following topics:</p>
<ul class="calibre13">
<li class="calibre14">Creating a lame utility HTTP server</li>
<li class="calibre14">Parsing RSS feeds and output HTML</li>
<li class="calibre14">Scraping the web and collecting files</li>
<li class="calibre14">Making a simple IRC chat bot logger</li>
<li class="calibre14">Blocking IP addresses from failed SSH attempts</li>
<li class="calibre14">Playing and managing audio from Bash</li>
<li class="calibre14">Creating a simple NAT and DMZ firewall</li>
<li class="calibre14">Parsing a GitHub project and generate a report</li>
<li class="calibre14">Creating a poor man's incremental remote backup</li>
<li class="calibre14">Using Bash scripts to monitor udev input</li>
<li class="calibre14">Using Bash to monitor battery life and optimize it</li>
<li class="calibre14">Using chroot and Restricted Bash shells to secure scripts</li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Introduction</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">This chapter will help you learn how to use commands and scripts for many tasks. You will get an idea about writing Bash scripts for monitoring certain tasks. You will learn about hosting files, parsing RSS feeds, and outputing HTML. You will also learn to copy contents from a website, make a simple IRC chat bot logger, block IP addresses, play and manage audio from command line, create a simple NAT firewall with DMZ using iptables, parse GitHub projects, create backups using rsync, monitor device events, the system’s battery life and power events, and use chroot for security.</p>
<p class="mce-root"/>
<p class="mce-root"/>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Creating a lame utility HTTP server</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">In this recipe, we will discuss the <span class="calibre16">cURL</span> tool in Linux. The cURL tool is used for transferring the data from or to a server. It supports many protocols, and <kbd class="calibre17">http</kbd> is one of them. cURL is used to transfer the data from URL. It has so many tricks to offer, such as http post, ftp post, user authentication, proxy support, file transfer, SSL connections, cookies, and similar.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">Besides having a Terminal open, you need to ensure that you have <kbd class="calibre17">curl</kbd> installed on your system.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How to do it…</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">We will learn about HTTP <kbd class="calibre17">GET</kbd> and <kbd class="calibre17">POST</kbd> methods using <kbd class="calibre17">curl</kbd> in Linux. Now, we will see examples of <kbd class="calibre17">GET</kbd> and <kbd class="calibre17">POST</kbd>:</p>
<ol class="calibre20">
<li class="chapter"><kbd class="calibre17">GET</kbd>: The HTTP GET method is used to request a data from a specified resource. The command is the example of HTTP GET and is accepting JSON formatted data:</li>
</ol>
<pre class="calibre27"><strong class="calibre3">$ curl -H "Content-Type:application/json" -H "Accept:application/json" -X GET http://host/resource/name</strong></pre>
<p class="calibre38">Another example of HTTP GET, which is accepting XML formatted data is as follows:</p>
<pre class="calibre27"><strong class="calibre3">$ curl -H "Content-Type:application/xml" -H "Accept:application/xml" -X GET http://host/resource/name</strong></pre>
<ol start="2" class="calibre20">
<li class="chapter"><kbd class="calibre17">POST</kbd>: The HTTP POST method is used to send the data to server. It is used to create as well as update a resource.</li>
</ol>
<p class="calibre38">A simple POST example is as shown:</p>
<pre class="calibre27"><strong class="calibre3">$ curl --data "name1=value1&amp;name2=value2" http://host/resource/name</strong></pre>
<p class="mce-root1">Run the following <kbd class="calibre17">curl</kbd> command to upload a file:</p>
<pre class="calibre27"><strong class="calibre3">$ curl -T "{File,names,separated,by,comma}" http://host/resource/name</strong></pre>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How it works…</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">Now we will learn about the options used in the <kbd class="calibre17">curl</kbd> command:</p>
<ol class="calibre20">
<li class="chapter">First, we learned about the <kbd class="calibre17">GET</kbd> method in the <kbd class="calibre17">curl</kbd> command. We accepted two types of data: JSON and XML. We used the <kbd class="calibre17">-X</kbd> option and specified the request. <kbd class="calibre17">-H</kbd> specifies the header.</li>
<li class="chapter">Second, we learned about the <kbd class="calibre17">POST</kbd> method in the <kbd class="calibre17">curl</kbd> command. The <kbd class="calibre17">--data</kbd> flag is used for the <kbd class="calibre17">POST</kbd> request. In the simple example, we are just posting the simple data and in the next, we are uploading files using the <kbd class="calibre17">-T</kbd> option.</li>
</ol>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Parsing RSS feeds and output HTML</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">In this recipe, we will use the <kbd class="calibre17">curl</kbd> and <kbd class="calibre17">xml2</kbd> tools of Linux to parse the RSS feed.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article class="calibre2">
                
<ul class="calibre13">
<li class="calibre14">You need to ensure that you have <kbd class="calibre17">curl</kbd> installed on your system</li>
<li class="calibre14">You need to ensure that you have <kbd class="calibre17">xml2</kbd> installed on your system</li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How to do it…</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">We will provide a URL in <kbd class="calibre17">curl</kbd>, and using the <kbd class="calibre17">xml2</kbd> tool, we will parse the RSS feed. Run the following command in your Terminal:</p>
<pre class="calibre22"><strong class="calibre3">$ curl -sL https://imdb.com | xml2 | head</strong></pre>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How it works…</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">We used xml2 and curl Linux tools to parse the XML RSS feed; xml2 converts XML document into text. In the output, each line is a key that is an XML path, and its value is separated by <kbd class="calibre17">=</kbd>.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Scraping the web and collecting files</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">In this recipe, we will learn how to collect data by web scraping. We will write a script for that.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">Besides having a Terminal open, you need to have basic knowledge of the <kbd class="calibre17">grep</kbd> and <kbd class="calibre17">wget</kbd> commands.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How to do it…</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">Now, we will write a script to scrape the contents from <kbd class="calibre17">imdb.com</kbd>. We will use the <kbd class="calibre17">grep</kbd> and <kbd class="calibre17">wget</kbd> commands in the script to get the contents. Create a <kbd class="calibre17">scrap_contents.sh</kbd> <span class="calibre16">script </span>and write the following code in it:</p>
<pre class="calibre22">$ mkdir -p data<br class="calibre2"/>$ cd data<br class="calibre2"/>$ wget -q -r -l5 -x 5  https://imdb.com<br class="calibre2"/>$ cd ..<br class="calibre2"/>$ grep -r -Po -h '(?&lt;=href=")[^"]*' data/ &gt; links.csv<br class="calibre2"/>$ grep "^http" links.csv &gt; links_filtered.csv<br class="calibre2"/>$ sort -u links_filtered.csv &gt; links_final.csv<br class="calibre2"/>$ rm -rf data links.csv links_filtered.csv</pre>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How it works…</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">In the preceding script, we have written code to get contents from a website. The <strong class="calibre6">wget</strong> utility is used for retrieving files from the web using the <kbd class="calibre17">http</kbd>, <kbd class="calibre17">https</kbd>, and <kbd class="calibre17">ftp</kbd> protocols. In this example, we are getting data from <kbd class="calibre17">imdb.com</kbd> and therefore we specified the website name in <kbd class="calibre17">wget</kbd>. <kbd class="calibre17">grep</kbd> is a command-line utility used for searching data that will match a regular expression. Here, we are searching for the specific links, and those links will be saved in <kbd class="calibre17">link_final.csv</kbd> after the web scraping.</p>
<p class="mce-root"/>
<p class="mce-root"/>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Making a simple IRC chat bot logger</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">In this recipe, we will make a simple bot logger. This script will log a few channels as well as handle the pings.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">Besides having a Terminal open, you need to have basic knowledge of IRC.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How to do it…</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">Now, we will write a script for an IRC logging bot. Create the <kbd class="calibre17">logging_bot.sh</kbd> <span class="calibre16">script </span>and write the following code in it:</p>
<pre class="calibre22">#!/bin/bash<br class="calibre2"/>nick="blb$$"<br class="calibre2"/>channel=testchannel<br class="calibre2"/>server=irc.freenode.net<br class="calibre2"/>config=/tmp/irclog<br class="calibre2"/>[ -n "$1" ] &amp;&amp; channel=$1<br class="calibre2"/>[ -n "$2" ] &amp;&amp; server=$2<br class="calibre2"/>config="${config}_${channel}"<br class="calibre2"/>echo "NICK $nick" &gt; $config<br class="calibre2"/>echo "USER $nick +i * :$0" &gt;&gt; $config<br class="calibre2"/>echo "JOIN #$channel" &gt;&gt; $config<br class="calibre2"/>trap "rm -f $config;exit 0" INT TERM EXIT<br class="calibre2"/>tail -f $config | nc $server 6667 | while read MESSAGE<br class="calibre2"/>do<br class="calibre2"/>    case "$MESSAGE" in<br class="calibre2"/>        PING*) echo "PONG${MESSAGE#PING}" &gt;&gt; $config;;                                  *QUIT*) ;;<br class="calibre2"/>        *PART*) ;;<br class="calibre2"/>        *JOIN*) ;;<br class="calibre2"/>        *NICK*) ;;<br class="calibre2"/>        *PRIVMSG*) echo "${MESSAGE}" | sed -nr "s/^:([^!]+).*PRIVMSG[^:]+:(.*)/[$(date '+%R')] \1&gt; \2/p";;<br class="calibre2"/>        *) echo "${MESSAGE}";;<br class="calibre2"/>    esac<br class="calibre2"/>done</pre>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How it works…</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">In this script, we handled the pings; also, we are logging some channels.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Blocking IP addresses from failed SSH attempts</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">In this recipe, we will learn about finding the failed SSH attempts and blocking those IP addresses. To find failed attempts, we will use <span class="calibre16"><kbd class="calibre17">grep</kbd> as well as <kbd class="calibre17">cat</kbd></span> commands. The login attempts to the SSH Server are tracked and recorded into the <kbd class="calibre17">rsyslog</kbd> daemon.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">Besides having a Terminal open, we need to remember a few concepts:</p>
<ul class="calibre13">
<li class="calibre14">Basic knowledge of the <kbd class="calibre17">grep</kbd> and <kbd class="calibre17">cat</kbd> commands</li>
<li class="calibre14">Ensure that <kbd class="calibre17">grep</kbd> is installed</li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How to do it…</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">We will find the failed SSH login attempts using the <kbd class="calibre17">grep</kbd> and <kbd class="calibre17">cat</kbd> commands. First, be a root user. Type the <kbd class="calibre17">sudo su</kbd> command. Next, run the following command to fetch the failed attempts using the <kbd class="calibre17">grep</kbd> command:</p>
<pre class="calibre22"><strong class="calibre3"># grep "Failed password" /var/log/auth.log</strong></pre>
<p class="mce-root">You can do this using the <kbd class="calibre17">cat</kbd> command also. Run the following command:</p>
<pre class="calibre22"><strong class="calibre3"># cat /var/log/auth.log | grep "Failed password"</strong></pre>
<p class="mce-root">You can block the particular IP address that has failed SSH login attempt using tcp-wrapper. Navigate to the <kbd class="calibre17">/etc</kbd> directory. Look for the <kbd class="calibre17">hosts.deny</kbd> file, add the following line in the file, and save the file:</p>
<pre class="calibre22">sshd: 192.168.0.1/255.255.255.0</pre>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How it works…</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">In this, we used the <kbd class="calibre17">cat</kbd> and <kbd class="calibre17">grep</kbd> commands. The most common use of the <kbd class="calibre17">cat</kbd> command is to display the contents of a file, and <kbd class="calibre17">grep</kbd> is a Linux utility used for searching a file for a particular pattern; then, it will display the lines that will have the particular pattern.</p>
<p class="mce-root">In the previous examples, we were searching for a failed login attempt. We are matching such key words using the <kbd class="calibre17">grep</kbd> command and then we are displaying it using the <kbd class="calibre17">cat</kbd> command.</p>
<p class="mce-root">To block an IP address, we just added a single line into the <kbd class="calibre17">hosts.deny</kbd> file, which will block that particular IP address.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Playing and managing audio from Bash</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">In this recipe, we will learn about how we can play the music from the command-line interface using a command-line player named <strong class="calibre6">SoX</strong>. SoX supports most of the audio formats, such as mp3, wav, mpg, and more.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">Besides having a Terminal open, we need to remember a few concepts:</p>
<ul class="calibre13">
<li class="calibre14">Ensure that you have SoX installed on your system</li>
<li class="calibre14">Ensure that you have sox libsox-fmt-all installed</li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How to do it…</h1>
                </header>
            
            <article class="calibre2">
                
<ol class="calibre20">
<li class="chapter">We will run the audio from the command line. For that, we will use SoX command-line player. After successful installation of <kbd class="calibre17">sox</kbd> and <kbd class="calibre17">libsox-fmt-all</kbd>, navigate to the directory where you have your audio files and run the following command to play all the <kbd class="calibre17">.mp3</kbd> files:</li>
</ol>
<pre class="calibre27"><strong class="calibre3">$ play *mp3</strong></pre>
<ol start="2" class="calibre20">
<li class="chapter">To play a specific song, run the following command:</li>
</ol>
<pre class="calibre27"><strong class="calibre3">$ play file_name.mp3</strong></pre>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How it works…</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">SoX is used for reading and writing audio files. The <kbd class="calibre17">libsox</kbd> library is the heart of the SoX tool. The <kbd class="calibre17">play</kbd> command is used to play the audio files. To play all mp3 files, we used <kbd class="calibre17">*mp3</kbd>. To play a specific file, just write filename with the extension after the <kbd class="calibre17">play</kbd> command.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Creating a simple NAT and DMZ firewall</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">In this recipe, we will create a simple NAT firewall with DMZ using iptables.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">Besides having a Terminal open, you need to ensure that <kbd class="calibre17">iptables</kbd> is installed in your machine.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How to do it…</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">We will write a script to set up a DMZ using <kbd class="calibre17">iptables</kbd>. Create a <kbd class="calibre17">dmz_iptables.sh</kbd> <span class="calibre16">script </span>and write the following code in it:</p>
<pre class="calibre22"># set the default policy to DROP<br class="calibre2"/>iptables -P INPUT DROP<br class="calibre2"/>iptables -P OUTPUT DROP<br class="calibre2"/>iptables -P FORWARD DROP<br class="calibre2"/># to configure the system as a router, enable ip forwarding by<br class="calibre2"/>sysctl -w net.ipv4.ip_forward=1<br class="calibre2"/># allow traffic from internal (eth0) to DMZ (eth2)<br class="calibre2"/>iptables -t filter -A FORWARD -i eth0 -o eth2 -m state --state NEW,ESTABLISHED,RELATED -j ACCEPT<br class="calibre2"/>iptables -t filter -A FORWARD -i eth2 -o eth0 -m state --state ESTABLISHED,RELATED -j ACCEPT<br class="calibre2"/># allow traffic from internet (ens33) to DMZ (eth2)<br class="calibre2"/>iptables -t filter -A FORWARD -i ens33 -o eth2 -m state --state NEW,ESTABLISHED,RELATED -j ACCEPT<br class="calibre2"/>iptables -t filter -A FORWARD -i eth2 -o ens33 -m state --state ESTABLISHED,RELATED -j ACCEPT<br class="calibre2"/>#redirect incoming web requests at ens33 (200.0.0.1) of FIREWALL to web server at 192.168.20.2<br class="calibre2"/>iptables -t nat -A PREROUTING -p tcp -i ens33 -d 200.0.0.1 --dport 80 -j DNAT --to-dest 192.168.20.2 <br class="calibre2"/>iptables -t nat -A PREROUTING -p tcp -i ens33 -d 200.0.0.1 --dport 443 -j DNAT --to-dest 192.168.20.2<br class="calibre2"/>#redirect incoming mail (SMTP) requests at ens33 (200.0.0.1) of FIREWALL to Mail server at 192.168.20.3<br class="calibre2"/>iptables -t nat -A PREROUTING -p tcp -i ens33 -d 200.0.0.1 --dport 25 -j DNAT --to-dest 192.168.20.3<br class="calibre2"/>#redirect incoming DNS requests at ens33 (200.0.0.1) of FIREWALL to DNS server at 192.168.20.4<br class="calibre2"/>iptables -t nat -A PREROUTING -p udp -i ens33 -d 200.0.0.1 --dport 53 -j DNAT --to-dest 192.168.20.4<br class="calibre2"/>iptables -t nat -A PREROUTING -p tcp -i ens33 -d 200.0.0.1 --dport 53 -j DNAT --to-dest 192.168.20.4</pre>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How it works…</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">In the preceding code, we have used <kbd class="calibre17">iptables</kbd> to set up a DMZ. In this script, we are allowing the internal traffic from the internet to the DMZ.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Parsing a GitHub project and generate a report</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">In this recipe, we will parse a GitHub project using the git command.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">Besides having a Terminal open, you need to ensure that you have <kbd class="calibre17">git</kbd> installed in your system.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How to do it…</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">We will use the git tool for parsing the project. Run this command to parse a project:</p>
<pre class="calibre22"><strong class="calibre3">$ git https://github.com/torvalds/linux.git</strong></pre>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How it works…</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">The tool git is used for handling the large projects. This command is used for cloning the git repository from the server.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Creating a poor man's incremental remote backup</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">In this recipe, we will learn about creating backups and incremental backups. We will write a script to get incremental backups.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">Besides having a Terminal open, we need to remember a few concepts:</p>
<ul class="calibre13">
<li class="calibre14">Basic knowledge of the <kbd class="calibre17">tar</kbd>, <kbd class="calibre17">gunzip</kbd>, and <kbd class="calibre17">gzip</kbd> commands.</li>
<li class="calibre14">Ensure that you have the necessary directories present in your system.</li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How to do it…</h1>
                </header>
            
            <article class="calibre2">
                
<ol class="calibre20">
<li class="chapter">First, select a directory whose backup you want to take. We will use the <kbd class="calibre17">tar</kbd> command. Let's assume that you want to take backup of your <kbd class="calibre17">/work</kbd> directory:</li>
</ol>
<pre class="calibre27"><strong class="calibre3">$ tar cvfz work.tar.gz /work</strong></pre>
<ol start="2" class="calibre20">
<li class="chapter">Now, we will write a script to take an incremental backup. Create a <kbd class="calibre17">incr_backup.sh</kbd> <span class="calibre11">script </span>and write the following code in it:</li>
</ol>
<pre class="calibre27">#!/bin/bash<br class="calibre2"/>gunzip /work/tar.gz<br class="calibre2"/>tar uvf /work.tar /work/<br class="calibre2"/>gzip /wo<span class="calibre11">rk.tar</span></pre>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How it works…</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">Now, we will learn about the options used in the preceding command as well as the script:</p>
<ol class="calibre20">
<li class="chapter">In the command, the options we have used are these:
<ol class="calibre20">
<li class="chapter"><kbd class="calibre17">c</kbd>: This option will create an archive</li>
<li class="chapter"><kbd class="calibre17">v</kbd>: This option is for verbose mode. We can see what files we are archiving.</li>
<li class="chapter"><kbd class="calibre17">f</kbd>: This option will take you back to the file.</li>
<li class="chapter"><kbd class="calibre17">z</kbd>: This option is used to compress it with gzip.</li>
</ol>
</li>
<li class="chapter">In this script, the options we have used are as listed:
<ol class="calibre20">
<li class="chapter"><kbd class="calibre17">u</kbd>: This option is used for updating the archive.</li>
<li class="chapter"><kbd class="calibre17">v</kbd>: For verbose.</li>
<li class="chapter"><kbd class="calibre17">f</kbd>: This option is to take back to a file.</li>
</ol>
</li>
</ol>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Using Bash scripts to monitor udev input</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">In this recipe, we will learn about the <strong class="calibre6">evtest</strong> Linux tool. This tool is used to monitor the input device events.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">Besides having a Terminal open, you need to ensure that <kbd class="calibre17">evtest</kbd> is installed in your system.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How to do it…</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root"><kbd class="calibre17">evtest</kbd> is a command-line tool. It will display the information on the input device. It will display all the events supported by the device. Then, it will monitor the device. We just need to run the <kbd class="calibre17">evtest</kbd> command with super user privilege. Run the command as follows:</p>
<pre class="calibre22"><strong class="calibre3">$ sudo evtest /dev/input/event3</strong></pre>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How it works…</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">The <kbd class="calibre17">evtest</kbd> command will produce output as follows:</p>
<pre class="calibre22"><strong class="calibre3">Input driver version is 1.0.1</strong><br class="calibre2"/><strong class="calibre3">Input device ID: bus 0x11 vendor 0x2 product 0x13 version 0x6</strong><br class="calibre2"/><strong class="calibre3">Input device name: "VirtualPS/2 VMware VMMouse"</strong><br class="calibre2"/><strong class="calibre3">Supported events:</strong><br class="calibre2"/><strong class="calibre3">  Event type 0 (EV_SYN)</strong><br class="calibre2"/><strong class="calibre3">  Event type 1 (EV_KEY)</strong><br class="calibre2"/><strong class="calibre3">    Event code 272 (BTN_LEFT)</strong><br class="calibre2"/><strong class="calibre3">    Event code 273 (BTN_RIGHT)</strong><br class="calibre2"/><strong class="calibre3">  Event type 2 (EV_REL)</strong><br class="calibre2"/><strong class="calibre3">    Event code 0 (REL_X)</strong><br class="calibre2"/><strong class="calibre3">    Event code 1 (REL_Y)</strong><br class="calibre2"/><strong class="calibre3">    Event code 8 (REL_WHEEL)</strong><br class="calibre2"/><strong class="calibre3">Properties:</strong><br class="calibre2"/><strong class="calibre3">  Property type 0 (INPUT_PROP_POINTER)</strong><br class="calibre2"/><strong class="calibre3">Testing ... (interrupt to exit)</strong></pre>
<p class="mce-root">The output shows the information presented by the kernel.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Using Bash to monitor battery life and optimize it</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">In this recipe, we will learn about the TLP Linux tool. <strong class="calibre6">TLP</strong> is a command-line tool; it is used for power management and will optimize the battery life.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">Besides having a Terminal open, you need to ensure that you have TLP installed on your system.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How to do it…</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">TLP’s configuration file is in the <kbd class="calibre17">/etc/default/</kbd> directory and the filename is <kbd class="calibre17">tlp</kbd>. After installation, it starts as a service automatically. We can check whether it’s running under system by running the <kbd class="calibre17">systemctl</kbd> command, as follows:</p>
<pre class="calibre22"><strong class="calibre3">$ sudo systemctl status tlp</strong></pre>
<p class="mce-root">Run the following command to get the operation mode:</p>
<pre class="calibre22"><strong class="calibre3">$ sudo tlp start</strong></pre>
<p class="mce-root">To get the system information as well as TLP status, run the following command:</p>
<pre class="calibre22"><strong class="calibre3">$ sudo tlp-stat -s</strong></pre>
<p class="mce-root">To view TLP configuration, run this command:</p>
<pre class="calibre22"><strong class="calibre3">$ sudo tlp-stat -c</strong></pre>
<p class="mce-root">To get all the power configurations, run the given command:</p>
<pre class="calibre22"><strong class="calibre3">$ sudo tlp-stat</strong></pre>
<p class="mce-root">To get the battery information, use this command:</p>
<pre class="calibre22"><strong class="calibre3">$ sudo tlp-stat -b</strong></pre>
<p class="mce-root">To get the fan speed and temperature of the system, run the next command:</p>
<pre class="calibre22"><strong class="calibre3">$ sudo tlp-stat -t</strong></pre>
<p class="mce-root">To get the processor data, run the following command:</p>
<pre class="calibre22"><strong class="calibre3">$ sudo tlp-stat -p</strong></pre>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How it works…</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">TLP is a command-line tool that comes with automated background tasks. TLP helps in optimizing the battery life in laptops powered by Linux.</p>
<p class="mce-root">We get information about the battery life, processor data, temperature, and fan speed by running <kbd class="calibre17">sudo tlp-stat</kbd> with various options. <kbd class="calibre17">tlp-stat</kbd> shows the power management setting. The options we used with <kbd class="calibre17">tlp-stat</kbd> are as follows:</p>
<ul class="calibre13">
<li class="calibre14"><kbd class="calibre17">-b</kbd>: Battery</li>
<li class="calibre14"><kbd class="calibre17">-t</kbd>: Temperature</li>
<li class="calibre14"><kbd class="calibre17">-p</kbd>: Processor data</li>
<li class="calibre14"> <kbd class="calibre17">-c</kbd>: Configuration</li>
<li class="calibre14"> <kbd class="calibre17">-s</kbd>: System information</li>
</ul>
<p class="mce-root"/>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Using chroot and restricted Bash shells to secure scripts</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">In this recipe, we will learn about chroot and restricted bash(rbash). The <kbd class="calibre17">chroot</kbd> command is used to change the root directory. Using rbash, we can restrict some features of the bash shell for some security purposes.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">Besides having a Terminal open, you need to ensure that <kbd class="calibre17">rbash</kbd> is installed in the system.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How to do it…</h1>
                </header>
            
            <article class="calibre2">
                
<ol class="calibre20">
<li class="chapter">Now, we will look at the command to start <kbd class="calibre17">rbash</kbd>. Run the following command:</li>
</ol>
<pre class="calibre27"><strong class="calibre3">$ bash -r</strong><br class="calibre2"/><strong class="calibre3">or</strong><br class="calibre2"/><strong class="calibre3">$ rbash</strong></pre>
<ol start="2" class="calibre20">
<li class="chapter">Now we will test some restrictions. First, we will try to change the directory. Run the following command:</li>
</ol>
<pre class="calibre27"><strong class="calibre3">$ cd work/</strong></pre>
<p class="mce-root">Next, we will try to write some contents to the file. Run the given command to write some contents into the file:</p>
<pre class="calibre22"><strong class="calibre3">ls &gt; log.txt</strong></pre>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How it works…</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">After using <kbd class="calibre17">rbash</kbd>, access to the system will be limited. In the preceding examples, we started the restricted shell by typing <kbd class="calibre17">bash -r</kbd> or <kbd class="calibre17">rbash</kbd>.</p>
<p class="mce-root">Next, we tried to change the directory, but we got the <kbd class="calibre17">rbash: cd: restricted</kbd> message, so we cannot change the directory in <kbd class="calibre17">rbash.</kbd> Also, we cannot write contents into the file.</p>


            </article>

            
        </section>
    </div>



  </body></html>