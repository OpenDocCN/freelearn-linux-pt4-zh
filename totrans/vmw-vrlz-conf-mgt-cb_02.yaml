- en: Chapter 2. Configuring VCM to Manage Your Infrastructure
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第2章。配置VCM以管理您的基础设施
- en: 'In this chapter, we will cover the following recipes:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将涵盖以下几篇指南：
- en: Adding a vCenter Server instance
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 添加vCenter服务器实例
- en: Adding a vCloud Director and vShield instance
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 添加vCloud Director和vShield实例
- en: Collecting data from managed machines
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从管理的机器收集数据
- en: Adding a discovery rule
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 添加发现规则
- en: Adding a network authority account to manage machines in multiple domains
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 添加网络权限账户以管理多个域中的机器
- en: Configuring a managing agent machine for virtual environment management
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 配置用于虚拟环境管理的管理代理机器
- en: Installing an agent on Windows servers
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在Windows服务器上安装代理
- en: Installing an agent on Linux servers
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在Linux服务器上安装代理
- en: Creating machine groups
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建机器组
- en: Introduction
  id: totrans-11
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 介绍
- en: Once VCM has been installed, we need to configure it to make it work for our
    environment; the default configurations need to be changed for environment-specific
    changes. To manage our infrastructure, we need to install agents on the Windows
    and Linux servers. This can be achieved in many ways, such as installing via scripts
    or, if we are using automation to deploy the machines, we could use that itself
    or push it to the servers identified by VCM.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦安装了VCM，我们需要对其进行配置，使其适应我们的环境；默认配置需要根据环境特定的变化进行修改。为了管理我们的基础设施，我们需要在Windows和Linux服务器上安装代理。这可以通过多种方式实现，例如通过脚本安装，或者如果我们使用自动化来部署机器，也可以使用自动化工具本身，或将其推送到VCM识别的服务器。
- en: We need to add vCenter, vCloud, and vShield server instances to VCM so that
    we can start utilizing the details available in those systems, such as machines
    and vApps deployed, which can be used to create various reports. Also, the captured
    details include the virtual machines deployed in the infrastructure, which can
    be used by VCM to deploy agents and bring them under management.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 我们需要将vCenter、vCloud和vShield服务器实例添加到VCM，以便开始利用这些系统中可用的详细信息，如已部署的机器和vApp，这些可以用来创建各种报告。同时，捕获的详细信息还包括基础设施中部署的虚拟机，这些虚拟机可以被VCM用来部署代理并纳入管理。
- en: We need to create various machine groups; a machine group is basically a collection
    of machines that can be grouped into a single entity for various purposes, such
    as patching, reporting, and checking compliance.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 我们需要创建各种机器组；机器组基本上是可以根据不同目的（例如修补、报告和合规性检查）将机器集合成一个实体的集合。
- en: In this chapter, we will start configuring VCM so that it is ready for day-to-day
    operations.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将开始配置VCM，以便它为日常操作做好准备。
- en: Let's begin.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 我们开始吧。
- en: Adding a vCenter Server instance
  id: totrans-17
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 添加vCenter服务器实例
- en: Before we start managing our virtual infrastructure, we need to add the components
    to VCM. We will start adding them in the following recipes, starting with vCenter.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们开始管理虚拟基础设施之前，我们需要将这些组件添加到VCM。我们将从以下几篇指南开始添加它们，从vCenter开始。
- en: Getting ready
  id: totrans-19
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: We will need a user with administrative access to the vCenter instance that
    we want to add to VCM as well as its **fully qualified domain name** (**FQDN**)
    or IP address.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将需要一个具有管理权限的用户来访问我们要添加到VCM的vCenter实例，以及其**完全限定域名**（**FQDN**）或IP地址。
- en: How to do it...
  id: totrans-21
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'To add the vCenter instance to VCM, log in to the VCM server UI and follow
    these steps:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 要将vCenter实例添加到VCM，请登录到VCM服务器UI并按照以下步骤操作：
- en: Log in to VCM with an administrative account.
  id: totrans-23
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用管理员帐户登录到VCM。
- en: Go to **Administration** | **Machines Manager** | **Licensed Machines** | **Licensed
    Virtual Environments**.![How to do it...](img/5400_02_pg-2.jpg)
  id: totrans-24
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 转到**管理** | **机器管理器** | **许可机器** | **许可虚拟环境**。![操作方式...](img/5400_02_pg-2.jpg)
- en: Click on **Add Machines**.
  id: totrans-25
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**添加机器**。
- en: Select **Basic** on the first page of the wizard.
  id: totrans-26
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在向导的第一页上选择**基础**。
- en: Enter the hostname (not FQDN here) for the machine name, select **Domain** from
    the dropdown which the machine belongs to, select **DNS** for **Type**, and **vCenter
    Windows** for **Machine Type**.
  id: totrans-27
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入机器名称的主机名（此处不使用FQDN），从下拉菜单中选择机器所属的**域**，选择**DNS**作为**类型**，选择**vCenter Windows**作为**机器类型**。
- en: Click on **Add**, and then click on **Next**.
  id: totrans-28
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**添加**，然后点击**下一步**。
- en: Click on **Finish** to close the wizard.
  id: totrans-29
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**完成**以关闭向导。
- en: Note
  id: totrans-30
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: With these steps, we added the vCenter instance to VCM, but we still need to
    configure it so that we can collect the details.
  id: totrans-31
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 通过这些步骤，我们将vCenter实例添加到VCM，但我们仍然需要进行配置，以便能够收集详细信息。
- en: Now, select the vCenter instance we just added and click on **Configure Settings**.
  id: totrans-32
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，选择刚才添加的vCenter实例，然后点击**配置设置**。
- en: In this wizard, select the vCenter instance.
  id: totrans-33
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在此向导中，选择vCenter实例。
- en: 'Provide the following information:'
  id: totrans-34
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Managing Agent**: Your Collector server'
  id: totrans-35
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Port**: `443`'
  id: totrans-36
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**User ID**: A user with administrative access to vCenter'
  id: totrans-37
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Password**: The password for the user; enter it twice to confirm'
  id: totrans-38
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Ignore untrusted SSL Certificate**: **Yes**'
  id: totrans-39
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Click on **Next** once all the details have been filled in.![How to do it...](img/image_02_002.jpg)
  id: totrans-40
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Note
  id: totrans-41
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
- en: '**Note**: The user must have a vCenter Server administrative role or a read-only
    role. However, you cannot run actions with a read-only role.'
  id: totrans-42
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Click on **Finish** to close the wizard.
  id: totrans-43
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: There should be a green circle in front of the vCenter instance's name on the
    VCM console.
  id: totrans-44
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: How it works...
  id: totrans-45
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: We are adding vCenter to VCM so that we can collect information about all the
    ESXi hosts in the instance, all the virtual machines, and so on, and based on
    this information, we can create compliance checks for our virtual infrastructure,
    discover the virtual machines as managed machines in VCM so that we can install
    agents, and collect information about them as well.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
- en: 'VCM collects the following information from vCenter:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
- en: vCenter Summary
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: vCenter Custom Information
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: vCenter Guests
  id: totrans-50
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: vCenter Hosts
  id: totrans-51
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: vCenter Host Profiles
  id: totrans-52
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: vCenter Inventory
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: vCenter Networking
  id: totrans-54
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: vCenter Settings
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: vCenter Resource Pools
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: vCenter Roles
  id: totrans-57
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Adding a vCloud Director and vShield instance
  id: totrans-58
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'There are three virtual elements that can be managed by VCM: vCenter, vShield,
    and vCloud. In the previous recipe, we added vCenter. In this one, we will continue
    with **vShield** and **vCloud Director** (**vCD**).'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
- en: VMware vShield is a suite of virtual security appliances built for VMware vCenter
    Server integration. A vShield security group is a logical trust zone that you
    create and assign resources to for vShield protection.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
- en: By adding vCloud to VCM, you can use the vCloud Director properties to create
    machine groups and so on.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  id: totrans-62
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: We will need the IP address of the vShield Manager and vCloud Director instances
    and a user account with administrative privileges.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
- en: Before adding vShield, you must collect data for your vCenter instance, as described
    in the next recipe.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  id: totrans-65
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: We will split this recipe into two sections, as follows.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
- en: '*Adding a vShield instance*'
  id: totrans-67
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Adding a vCloud Director instance*'
  id: totrans-68
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Adding a vShield instance
  id: totrans-69
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'This is a bit different than adding vCenter. After adding a vCenter instance
    and collecting data from it, VCM identifies the vShield VM and it makes it available
    on the VCM console for configuration, so we don''t need to perform any additional
    steps as we did for vCenter; we just need to configure it, which we will do as
    follows:'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
- en: Go to **Administration** | **Machines Manager** | **Licensed Machines** | **Licensed
    Virtual Environments**.
  id: totrans-71
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select the vShield device identified by VCM, and click on **Configure Settings**.![Adding
    a vShield instance](img/image_02_003.jpg)
  id: totrans-72
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Make sure the vShield instance is selected in the wizard launched.
  id: totrans-73
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Provide information as follows:'
  id: totrans-74
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Managing Agent**: Your Collector server'
  id: totrans-75
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Port**: `443`'
  id: totrans-76
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**User ID**: A user with administrative access to vShield'
  id: totrans-77
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Password**: The password for the user; enter it twice to confirm it'
  id: totrans-78
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Ignore untrusted SSL Certificate**: **Yes**'
  id: totrans-79
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Provide the name of the vCenter Server instance this vShield instance is responsible
    for
  id: totrans-80
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '![Adding a vShield instance](img/image_02_004.jpg)'
  id: totrans-81
  prefs:
  - PREF_IND
  type: TYPE_IMG
- en: Note
  id: totrans-82
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
- en: '**Note**: The user must have a vShield Manager administrative role or an unrestricted
    read-only role.'
  id: totrans-83
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Click on **Finish** to close the wizard.
  id: totrans-84
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Once again, you should see a green circle in front of the vShield instance you
    just configured.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
- en: If there isn't one, make sure you have provided the correct username and password.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
- en: Adding a vCloud Director instance
  id: totrans-87
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'Log in to VCM server and follow these steps:'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
- en: Go to **Administration** | **Machines Manager** | **Licensed Machines** | **Licensed
    Virtual Environments**.
  id: totrans-89
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on **Add Machines**.
  id: totrans-90
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select **Basic** from the first page of the wizard.
  id: totrans-91
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Enter your hostname in **Machine Name**, select **Domain** from the dropdown
    that the machine belongs to, select **DNS** as **Type** and **vCloud Director**
    as **Machine Type**.
  id: totrans-92
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on **Add**, and then click on **Next**.
  id: totrans-93
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on **Finish** to end the wizard.
  id: totrans-94
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Note
  id: totrans-95
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
- en: With these steps, we added the vCloud instance to VCM, but we still need to
    configure it so that we can collect the details.
  id: totrans-96
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Now, select the vCloud Director instance we just added and click on **Configure
    Settings**.
  id: totrans-97
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In this wizard, select the vCloud Director machine.
  id: totrans-98
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Provide information as follows:'
  id: totrans-99
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Managing Agent**: Your Collector server'
  id: totrans-100
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Port**: `443`'
  id: totrans-101
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**User ID**: A user with administrative access to vCloud Director'
  id: totrans-102
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Local user in the format `user@System`
  id: totrans-103
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Password**: The password for the user; enter it again to confirm it'
  id: totrans-104
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Ignore untrusted SSL Certificate**: **Yes**'
  id: totrans-105
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '![Adding a vCloud Director instance](img/image_02_005.jpg)'
  id: totrans-106
  prefs:
  - PREF_IND
  type: TYPE_IMG
- en: Click on **Finish** to close the wizard.
  id: totrans-107
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: There should be a green circle in front of the vCloud Director instance's name
    on the VCM console.
  id: totrans-108
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: How it works...
  id: totrans-109
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: We make information available in the vShield instance, that is, security groups
    and its members exposed to VCM. The details are stored in the VCM database as
    well and can be used when required.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
- en: 'After adding and performing a collection, we have the following information
    from the vCloud Director database in the VCM console:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
- en: vCloud Director Organizations
  id: totrans-112
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: vCloud Director virtual machines and vApps
  id: totrans-113
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: vCloud Director organization catalogs
  id: totrans-114
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: vCloud Director Virtual datacenters (vDCs) and networks
  id: totrans-115
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: vCloud Director Organizations Users
  id: totrans-116
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: vCloud Director Organizations Groups
  id: totrans-117
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: vCloud Director Organizations Settings
  id: totrans-118
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: This information can be used to create machine groups based on vCloud organizations
    in order to manage them accordingly.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
- en: Collecting data from managed machines
  id: totrans-120
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Once we are done adding and configuring virtual environments, we can start collecting
    data, which can be further used to check compliance, create necessary machine
    groups, export reports, and so on.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
- en: We need to collect data from virtual environments as well as from all the machines
    that we plan to manage, that is, Windows or Linux servers.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 我们需要收集虚拟环境中的数据以及我们计划管理的所有机器的数据，即 Windows 或 Linux 服务器。
- en: Getting ready
  id: totrans-123
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备就绪
- en: All the servers we want to manage should be added to the VCM console, either
    by following earlier recipes for virtual infrastructures or by installing agents
    by following the recipes in this chapter.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 我们要管理的所有服务器应已添加到 VCM 控制台中，可以通过遵循虚拟基础设施的先前步骤或通过本章中的代理安装步骤来完成。
- en: How to do it...
  id: totrans-125
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作…
- en: 'We will split this recipe into two sections:'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将把这个步骤分为两个部分：
- en: '*Collecting data from virtual infrastructures*'
  id: totrans-127
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*从虚拟基础设施收集数据*'
- en: '*Collecting data from managed machines*'
  id: totrans-128
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*从受管机器收集数据*'
- en: Collecting data from virtual infrastructures
  id: totrans-129
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 从虚拟基础设施收集数据
- en: 'To collect all data off a vCenter, vShield Manager, or vCD instance, follow
    these steps:'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 要从 vCenter、vShield 管理器或 vCD 实例收集所有数据，请按照以下步骤操作：
- en: Log in to VCM and follow the steps to collect virtual infrastructure data.
  id: totrans-131
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 登录到 VCM，并按照步骤收集虚拟基础设施数据。
- en: You can be anywhere in the VCM console; make sure the machine group is **All
    Machines** (to understand more about machine groups, have a look at the *Creating
    machine groups* recipe), and click on **Collect** in the top-left corner.
  id: totrans-132
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你可以在 VCM 控制台的任何地方，确保机器组是**所有机器**（要了解更多关于机器组的信息，请查看*创建机器组*的步骤），然后点击左上角的**收集**。
- en: This will launch a wizard; select **Machine Data** under **Collection Type**.
  id: totrans-133
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 这将启动一个向导；在**收集类型**下选择**机器数据**。
- en: Select the machines you want to collect data from, in this case, any or all
    of vCenter, vShield, and vCloud servers. Select them and make sure they are on
    the right-hand side, and then click on **Next**.
  id: totrans-134
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择你要收集数据的机器，在本例中，可以选择任何或所有 vCenter、vShield 和 vCloud 服务器。选择它们并确保它们在右侧，然后点击**下一步**。
- en: Select **Select Data Types** to collect from these machines.![Collecting data
    from virtual infrastructures](img/image_02_006.jpg)
  id: totrans-135
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择**选择数据类型**来收集这些机器的数据。![从虚拟基础设施收集数据](img/image_02_006.jpg)
- en: Under **Data Types**, tick each checkbox underneath **Virtualization**:![Collecting
    data from virtual infrastructures](img/image_02_007.jpg)
  id: totrans-136
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**数据类型**下，勾选**虚拟化**下的每个复选框：![从虚拟基础设施收集数据](img/image_02_007.jpg)
- en: Make sure there are no conflicts, and click on **Finish**.
  id: totrans-137
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确保没有冲突，然后点击**完成**。
- en: Click on **Jobs** in the left-hand corner of the VCM console.
  id: totrans-138
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击 VCM 控制台左上角的**作业**。
- en: Make sure the job to collect the data has completed successfully.
  id: totrans-139
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确保收集数据的任务已成功完成。
- en: Collecting data from managed machines
  id: totrans-140
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 从受管机器收集数据
- en: 'In this subsection, we will collect data from managed machines, such as Windows
    and Linux servers. Follow these steps:'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 在本小节中，我们将收集来自受管机器的数据，如 Windows 和 Linux 服务器。请按照以下步骤操作：
- en: Log in to VCM and follow the steps to collect virtual infrastructure data.
  id: totrans-142
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 登录到 VCM，并按照步骤收集虚拟基础设施数据。
- en: You can be anywhere in the VCM console; make sure the machine group is **All
    Machines** (to understand more about machine groups, have a look at the *Creating
    machine groups* recipe) and click on **Collect** in the top-left corner.
  id: totrans-143
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你可以在 VCM 控制台的任何地方，确保机器组是**所有机器**（要了解更多关于机器组的信息，请查看*创建机器组*的步骤），然后点击左上角的**收集**。
- en: This will launch a wizard; select **Machine Data** under **Collection Type**.
  id: totrans-144
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 这将启动一个向导；在**收集类型**下选择**机器数据**。
- en: On the next page, select the machine/machines whose data you want to collect.
    The machines must be on the right-hand side.
  id: totrans-145
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在下一页，选择你想要收集数据的机器/机器组。选中的机器必须位于右侧。
- en: 'You have two options for deciding how data will be collected: based on the
    data type or based on the collection filter set.'
  id: totrans-146
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你有两种选择来决定如何收集数据：根据数据类型或根据收集筛选器集。
- en: Note
  id: totrans-147
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '**Note**: If you select data type then you are presented with options to select
    from various entities of the OS such as accounts, account policies, disk space,
    device drives, and so on that are relevant to the OS of the machine we selected.
    If you select filter sets, VCM has precreated sets of filters, which can be used
    to collect data from the managed machine. The filter sets can be created manually,
    while installing VCM, or when you import any compliance template.'
  id: totrans-148
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '**注意**：如果你选择数据类型，那么你将看到可以从操作系统的各种实体中选择的选项，如账户、账户策略、磁盘空间、设备驱动器等，这些选项与我们所选的机器的操作系统相关。如果选择筛选器集，VCM
    会预先创建一组筛选器，可以用于从受管机器收集数据。这些筛选器集可以在安装 VCM 时或在导入任何合规模板时手动创建。'
- en: '![Collecting data from managed machines](img/image_02_008.jpg)'
  id: totrans-149
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![从受管机器收集数据](img/image_02_008.jpg)'
- en: Depending upon what you select, the next page will differ.
  id: totrans-150
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 根据你选择的内容，下一页面将有所不同。
- en: For the **Data Types** window, select individual data types or select all of
    them.![Collecting data from managed machines](img/image_02_009.jpg)
  id: totrans-151
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对于**数据类型**窗口，选择单独的数据类型或选择全部数据类型。![从受管机器收集数据](img/image_02_009.jpg)
- en: For the **Filter Sets** window, select the appropriate filter set to collect
    the data.![Collecting data from managed machines](img/image_02_010.jpg)
  id: totrans-152
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对于**过滤器集**窗口，选择适当的过滤器集以收集数据。![从受管机器收集数据](img/image_02_010.jpg)
- en: Make sure there are no conflicts, and close the wizard. It will start a collection
    job, and VCM will go to the specified machines and collect details either according
    to data types or selected filter sets.
  id: totrans-153
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确保没有冲突，并关闭向导。它将启动一个采集任务，VCM将访问指定的机器并根据数据类型或选定的过滤器集收集详细信息。
- en: How it works...
  id: totrans-154
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何工作...
- en: In the previous recipes, we added vCenter, vCD, and vShield Manager; now, we
    need the data to import into all those elements. By performing a collection, we
    are adding the details available on those systems to VCM so that we can have a
    single interface where we can see all the details.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 在之前的步骤中，我们添加了vCenter、vCD和vShield Manager；现在，我们需要导入这些元素的数据。通过执行采集操作，我们将这些系统中的详细信息添加到VCM中，以便我们可以通过一个单一的界面查看所有细节。
- en: The details fetched from those systems have been mentioned in the earlier recipes.
    When VCM performs a collection operation, it goes into each application's database,
    pulls all the relevant information, and then places it in its own database. For
    example, when we perform a vCenter collection, it collects details about all the
    VMs, ESXi hosts, their versions, snapshot details for VMs, VM configuration, and
    so on. All the data is presented in the VCM console under **Console** | **Virtual
    Environments**.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 从这些系统获取的详细信息已经在之前的步骤中提到。当VCM执行采集操作时，它会进入每个应用的数据库，提取所有相关信息，然后将其存入自己的数据库。例如，当我们执行vCenter采集时，它会收集所有虚拟机、ESXi主机、其版本、虚拟机的快照详情、虚拟机配置等信息。所有数据都将在VCM控制台下的**控制台**
    | **虚拟环境**中展示。
- en: In case of vCD, VCM fetches information about the vApps, VMs, catalogs, local
    users, groups, and so on.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 对于vCD，VCM会获取有关vApp、虚拟机、目录、本地用户、组等的信息。
- en: This information can then be exported via reports, used for compliance checks.
    This can also be used in creating dynamic filters for creating machine groups.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 这些信息可以通过报告导出，用于合规性检查。这些信息也可以用于创建动态过滤器，进而创建机器组。
- en: Details captured from managed machines such as Windows and Linux servers will
    be used in analyzing their current compliance and patch status.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 从受管机器（如Windows和Linux服务器）捕获的详细信息将用于分析它们当前的合规性和补丁状态。
- en: There's more...
  id: totrans-160
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'Have a look at the following article by VMware if you want details about filter
    sets:'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你想了解过滤器集的详细信息，请查看VMware的以下文章：
- en: '[https://www.vmware.com/support/vcm/doc/help/vcm581/Content/Core_CS/AdminSettingsCollFltr.htm](https://www.vmware.com/support/vcm/doc/help/vcm581/Content/Core_CS/AdminSettingsCollFltr.htm)'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://www.vmware.com/support/vcm/doc/help/vcm581/Content/Core_CS/AdminSettingsCollFltr.htm](https://www.vmware.com/support/vcm/doc/help/vcm581/Content/Core_CS/AdminSettingsCollFltr.htm)'
- en: Adding a discovery rule
  id: totrans-163
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 添加发现规则
- en: VCM must discover machines in your environment before you can collect data from
    them. You can create a **discovery rule** to discover all machines, or you can
    apply a filter to limit the machines that VCM discovers. Discovery rules are used
    to discover managed machines automatically.
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: VCM必须先发现你环境中的机器，然后才能从中收集数据。你可以创建一个**发现规则**来自动发现所有机器，或者可以应用过滤器来限制VCM发现的机器。发现规则用于自动发现受管机器。
- en: Getting ready
  id: totrans-165
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: You must have configured and collected data from vCenter and vCloud to add a
    database discovery rule.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 你必须配置并收集来自vCenter和vCloud的数据，才能添加数据库发现规则。
- en: You must license the virtual environments and Windows, Unix, and Linux machines
    to use for data collection. When you license these virtual or physical machines,
    they appear in the **Licensed Machines** list.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 你必须为虚拟环境以及Windows、Unix和Linux机器配置许可，以便用于数据收集。当你为这些虚拟或物理机器配置许可时，它们会出现在**已许可机器**列表中。
- en: VCM can discover machines from Active Directory, browse lists, domain controllers,
    databases, or by IP address.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: VCM可以从Active Directory、浏览器列表、域控制器、数据库或通过IP地址发现机器。
- en: We will perform database discovery in this recipe; you can check remaining options
    in your lab.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将在本步骤中执行数据库发现操作；你可以在实验室中查看其他选项。
- en: How to do it...
  id: totrans-170
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'We will configure VCM to discover vCenter VMs by following these steps:'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将通过以下步骤配置VCM以发现vCenter虚拟机：
- en: Log in to VCM as an administrative user.
  id: totrans-172
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 以管理员身份登录VCM。
- en: Go to **Administrator** | **Machines Manager** | **Discovery Rule**; click on
    the green plus button to add a new discovery rule.
  id: totrans-173
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 转到**管理员** | **机器管理器** | **发现规则**；点击绿色加号按钮以添加新发现规则。
- en: This will launch a wizard; provide a name and description.
  id: totrans-174
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 这将启动一个向导；提供一个名称和描述。
- en: Select the **By DB Discovery:** checkbox.![How to do it...](img/image_02_011.jpg)
  id: totrans-175
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择**通过数据库发现：**复选框。![如何操作...](img/image_02_011.jpg)
- en: Select **vCenter Guest Systems** under **Discovery Query**.
  id: totrans-176
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**发现查询**下选择**vCenter来宾系统**。
- en: The other two options are using vCloud Director or directly from the host.![How
    to do it...](img/image_02_012.jpg)
  id: totrans-177
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 另外两个选项是使用vCloud Director或直接从主机。![如何操作...](img/image_02_012.jpg)
- en: 'On the next page, select/fill in options according to this table:'
  id: totrans-178
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在下一页，根据此表格选择/填写选项：
- en: '| **Option** | **Description** |'
  id: totrans-179
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| **选项** | **描述** |'
- en: '| **Machine Name Format** | The format for VCM to display guest machines. You
    can select the **NetBIOS**, **DNS**, or **VM/vCenter** name format. |'
  id: totrans-180
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| **机器名称格式** | VCM显示来宾机器的格式。您可以选择**NetBIOS**、**DNS**或**VM/vCenter**名称格式。 |'
- en: '| **Domain Name** | The domain under which to add the new machine. This domain
    is the same as the **Domain Name** property when you add machines using manual
    discovery. |'
  id: totrans-181
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| **域名** | 添加新机器时的域。该域与手动发现添加机器时的**域名**属性相同。 |'
- en: '| **Domain Type** | Select one out of **Active Directory**, **DNS**, or **NetBIOS**
    domain types. |'
  id: totrans-182
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| **域类型** | 从**Active Directory**、**DNS**或**NetBIOS**域类型中选择一个。 |'
- en: '| **Protocol** | Select **DCOM** or **HTTP**. |'
  id: totrans-183
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| **协议** | 选择**DCOM**或**HTTP**。 |'
- en: '| **HTTP Port (default used if blank)** | This uses the HTTP listener on the
    target machine. The listener is configured to listen on the designated port. Port
    `26542` is the default setting. Accepted port values range from `1` to `65535`.
    Other applications must not use this port. |'
  id: totrans-184
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| **HTTP端口（默认为空时使用）** | 这将使用目标机器上的HTTP监听器。监听器配置为在指定端口上监听。端口`26542`是默认设置。接受的端口值范围为`1`到`65535`。其他应用程序不得使用此端口。
    |'
- en: '| **Use a proxy server** | **No** |'
  id: totrans-185
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| **使用代理服务器** | **否** |'
- en: '| **Connection String** | This is the address of the virtual machine to contact.
    This address can differ from the address that resolves by machine name from DNS
    or other name-resolution systems. Use this address when VCM must contact a vApp
    virtual machine through a Network Address Translation (**NAT**) address. |'
  id: totrans-186
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| **连接字符串** | 这是要联系的虚拟机的地址。此地址可能与DNS或其他名称解析系统通过机器名称解析得到的地址不同。当VCM必须通过网络地址转换（**NAT**）地址联系vApp虚拟机时，请使用此地址。
    |'
- en: '| **ESX Host Name Filter** | This filters the query to ESX host machine names
    in the virtual environment based on the information you type. |'
  id: totrans-187
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| **ESX主机名称过滤器** | 根据您输入的信息，此过滤器将查询虚拟环境中的ESX主机名称。 |'
- en: '| **VM Guest Name Filter** | This filters the query to guest VM names on the
    ESX host machine in the virtual environment based on the information you type.
    |'
  id: totrans-188
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| **虚拟机来宾名称过滤器** | 根据您输入的信息，此过滤器将查询虚拟环境中ESX主机上的来宾虚拟机名称。 |'
- en: '| **Guest DNS Name Filter** | This filters the query to domain name servers
    based on the information you type. |'
  id: totrans-189
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| **来宾DNS名称过滤器** | 根据您输入的信息，此过滤器将查询域名服务器。 |'
- en: '| **Guest OS Name Filter** | This filters the query to the guest operating
    systems in the virtual environment based on the information you type. |'
  id: totrans-190
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| **来宾操作系统名称过滤器** | 根据您输入的信息，此过滤器将查询虚拟环境中的来宾操作系统。 |'
- en: '| **Power State** | This filters the query to the state of the guest virtual
    machine in the virtual environment based on the information you type. |'
  id: totrans-191
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| **电源状态** | 根据您输入的信息，此过滤器将查询虚拟环境中来宾虚拟机的状态。 |'
- en: 'After you make appropriate selections as described in the table, your screen
    should look like this:'
  id: totrans-192
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在按照表格中所述做出适当选择后，您的屏幕应该如下所示：
- en: '![How to do it...](img/image_02_013.jpg)'
  id: totrans-193
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![如何操作...](img/image_02_013.jpg)'
- en: Select **Yes** to start the discovery once the rule creation is over, and if
    you want, you can select **License** and install **Agent** on **Discovered Machines**.
  id: totrans-194
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择**是**以在规则创建结束后启动发现，如果需要，您还可以选择**许可**并在**发现的机器**上安装**代理**。
- en: Click **Finish** to close the wizard.
  id: totrans-195
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 单击**完成**以关闭向导。
- en: How it works...
  id: totrans-196
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: As this is a query run against the VCM database, we must perform a collection
    against at least one vCenter Server before we run this discovery rule.
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 由于这是对VCM数据库执行的查询，我们必须在运行此发现规则之前至少对一个vCenter服务器进行数据采集。
- en: VCM adds the machines either to the available machines in the machine manager
    if you choose not to license the machine; and if you choose to license it as part
    of the discovery rule, then they go to either licensed Windows or Unix machines.
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你选择不为机器授权，VCM会将机器添加到机器管理器中的可用机器列表；如果选择将其作为发现规则的一部分进行授权，则它们将归类为授权的Windows或Unix机器。
- en: There's more...
  id: totrans-199
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 更多内容...
- en: 'This is the table describing all the available methods taken from the VCM help
    document on [http://www.vmware.com/](http://www.vmware.com/):'
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 这是从VCM帮助文档中提取的所有可用方法的表格，地址：[http://www.vmware.com/](http://www.vmware.com/)：
- en: '| **Sr. No.** | **Method** | **Description** |'
  id: totrans-201
  prefs: []
  type: TYPE_TB
  zh: '| **序号** | **方法** | **描述** |'
- en: '| **1** | **By Active Directory** | This discovers all the machines that have
    an account on the selected AD domain. The discovery process identifies machines
    based on the current domain controller data. |'
  id: totrans-202
  prefs: []
  type: TYPE_TB
  zh: '| **1** | **通过活动目录** | 通过此方式可以发现所有在所选AD域中有账户的机器。发现过程根据当前的域控制器数据识别机器。 |'
- en: '| **2** | **By Browse List** | This discovers all the machines that have the
    **Computer Browser** service turned on. When the rule discovers machines through
    the browse list, VCM returns the NetBIOS domain name for each machine. |'
  id: totrans-203
  prefs: []
  type: TYPE_TB
  zh: '| **2** | **通过浏览列表** | 此方式通过启用**计算机浏览器**服务的机器来发现机器。当规则通过浏览列表发现机器时，VCM会返回每台机器的NetBIOS域名。
    |'
- en: '| **3** | **By Domain Controller** | This discovers all the machines that have
    an account on the selected domain. When the domain controller performs a periodic
    update, existing machines might not appear, while deleted machines might. |'
  id: totrans-204
  prefs: []
  type: TYPE_TB
  zh: '| **3** | **通过域控制器** | 通过此方式可以发现所有在所选域中有账户的机器。当域控制器执行定期更新时，现有机器可能不会显示，而已删除的机器可能会出现。
    |'
- en: '| **4** | **By IP Address** | This discovers all the machines in your network
    that exist in specific IP address ranges. Discovered machines appear in the list
    of available machines. |'
  id: totrans-205
  prefs: []
  type: TYPE_TB
  zh: '| **4** | **通过IP地址** | 此方式通过特定的IP地址范围来发现网络中所有机器。发现的机器会出现在可用机器列表中。 |'
- en: '| **5** | **By DB Discovery** | This discovers machines based on the SQL query
    used for the discovery rule. This discovery type uses data that VCM has already
    collected from other sources as the basis for finding new systems to manage. You
    can discover vCD-managed virtual machines, virtual machine guests, and virtual
    machine hosts. |'
  id: totrans-206
  prefs: []
  type: TYPE_TB
  zh: '| **5** | **通过数据库发现** | 此方式通过用于发现规则的SQL查询来发现机器。该发现类型使用VCM已经从其他来源收集的数据作为发现新系统的基础。你可以发现由vCD管理的虚拟机、虚拟机客体和虚拟机主机。
    |'
- en: 'Refer here for more:'
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 更多内容请参见这里：
- en: '[https://www.vmware.com/support/vcm/doc/help/vcm581/Content/Core_CS/AdminMachMngrDiscAECWiz.htm](https://www.vmware.com/support/vcm/doc/help/vcm581/Content/Core_CS/AdminMachMngrDiscAECWiz.htm)'
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://www.vmware.com/support/vcm/doc/help/vcm581/Content/Core_CS/AdminMachMngrDiscAECWiz.htm](https://www.vmware.com/support/vcm/doc/help/vcm581/Content/Core_CS/AdminMachMngrDiscAECWiz.htm)'
- en: Adding a network authority account to manage machines in multiple domains
  id: totrans-209
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 添加网络授权账户以管理多个域中的机器
- en: For medium to large infrastructures, there are always multiple Active Directory
    domains available. We can use VCM to manage servers in multiple domains. This
    recipe explains what you need to do for that.
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 对于中型到大型基础设施，通常会有多个活动目录域可用。我们可以使用VCM管理多个域中的服务器。本节解释了你需要做的工作。
- en: Getting ready
  id: totrans-211
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: There should be a proper name resolution. If there is a firewall in between,
    then the ports stated in the first chapter must be open.
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 必须有适当的名称解析。如果中间有防火墙，则第一个章节中提到的端口必须开放。
- en: We need a **network authority account** per domain in order to manage the machines
    in that domain and VCM functions such as collecting data, patching, and so on.
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 我们需要为每个域提供一个**网络授权账户**，以便管理该域中的机器，以及执行VCM功能，如数据收集、打补丁等。
- en: How to do it...
  id: totrans-214
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: We need to add the domains and network authority account and finally associate
    them with one another.
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 我们需要添加域和网络授权账户，并最终将它们关联在一起。
- en: Go to **Administration** | **Settings** | **Network Authority**
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 转到**管理** | **设置** | **网络授权**
- en: 'We have three options:'
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 我们有三种选择：
- en: '**Available Domains** (identified while performing the installation); we can
    add new ones if required'
  id: totrans-218
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**可用域**（在执行安装时识别的域）；如果需要，我们可以添加新的域'
- en: '**Available Accounts** (we assigned one NAA while performing VCM deployment)'
  id: totrans-219
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**可用账户**（在执行VCM部署时，我们分配了一个NAA）'
- en: '**Assigned Accounts**'
  id: totrans-220
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**分配账户**'
- en: Available Domains
  id: totrans-221
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 可用域
- en: Domains are identified in one of the steps when we perform the VCM server installation;
    now, we can add extra domains. Click on **Add** under **Available Domains**, and
    provide the domain **Name** and **Type**.
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 在执行VCM服务器安装时，域会在某个步骤中进行标识；现在，我们可以添加额外的域。在**可用域**下点击**添加**，并提供域**名称**和**类型**。
- en: '![Available Domains](img/image_02_014.jpg)'
  id: totrans-223
  prefs: []
  type: TYPE_IMG
  zh: '![可用域](img/image_02_014.jpg)'
- en: Available Accounts
  id: totrans-224
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 可用账户
- en: Under **Available Accounts**, we can see which network authority accounts are
    available and then add any extra accounts or remove unwanted ones.
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 在**可用账户**下，我们可以看到哪些网络权限账户是可用的，然后可以添加任何额外的账户或删除不需要的账户。
- en: '![Available Accounts](img/image_02_015.jpg)'
  id: totrans-226
  prefs: []
  type: TYPE_IMG
  zh: '![可用账户](img/image_02_015.jpg)'
- en: Assigned Accounts
  id: totrans-227
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 分配的账户
- en: This is the place where we associate available accounts with available domains.
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 这是我们将可用账户与可用域关联的地方。
- en: Go to **Assigned Accounts** | **By Domain** | **Active Directory**, and then
    click on **Edit Assigned Accounts** and associate the available accounts with
    this domain.
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 转到**分配的账户** | **按域** | **Active Directory**，然后点击**编辑分配的账户**，并将可用账户与此域关联。
- en: '![Assigned Accounts](img/image_02_016.jpg)'
  id: totrans-230
  prefs: []
  type: TYPE_IMG
  zh: '![分配的账户](img/image_02_016.jpg)'
- en: How it works...
  id: totrans-231
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: Basically, by following this process, we assigned an account that has local
    admin privileges or the rights explained in the first chapter to all the machines
    in the respective domain that will be managed by VCM.
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 基本上，通过遵循这个过程，我们为将由VCM管理的各个域中的所有机器分配了具有本地管理员权限或第一章中解释的权限的账户。
- en: We can assign as many accounts as required. When a VCM function is started,
    assigned accounts will be tried in the specified order. When something starts
    a subsequent time, the last successfully used account will be used first. Accounts
    are listed in the order in which they are assigned, from top to bottom.
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以根据需要分配任意数量的账户。当启动VCM功能时，将按指定顺序尝试分配的账户。当某个账户被再次启动时，将优先使用最后成功使用的账户。账户按分配顺序从上到下列出。
- en: 'If a machine is in multiple lists (such as a domain and a machine group), the
    authority account that will be used to contact it will be in the following order:'
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 如果一台机器出现在多个列表中（如域和机器组），则用于与其联系的权限账户的顺序如下：
- en: The last account that worked
  id: totrans-235
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 最后一个成功使用的账户
- en: The accounts assigned to the domain
  id: totrans-236
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 分配给域的账户
- en: The accounts assigned any machine group (including the default **All Machines**
    group) to which the machine belongs
  id: totrans-237
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 被分配给任何机器组（包括默认的**所有机器**组）的账户
- en: We need to do this for Windows only, as in the case of Linux, we need to accept
    the certificate in the VCM console. Unless we accept the certificate, we will
    not be able to patch the Linux machine from VCM. To accept the certificate, on
    the VCM console, go to **Administration** | **Certificates**, select the machine,
    and click on **Change Trust Status**. Follow the wizard, and you will see a handshake
    symbol in front of the machine. This will allow you to patch the Linux machine
    from the VCM console. The steps to perform this action are a part of the next
    recipe.
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 我们只需要对Windows进行此操作，因为在Linux的情况下，我们需要在VCM控制台中接受证书。除非我们接受该证书，否则无法通过VCM修补Linux机器。要接受证书，在VCM控制台中，转到**管理**
    | **证书**，选择机器，然后点击**更改信任状态**。按照向导操作，您将看到机器前面有一个握手符号。这样，您就可以通过VCM控制台修补Linux机器。执行此操作的步骤将在下一篇食谱中介绍。
- en: Configuring a managing agent machine for virtual environment management
  id: totrans-239
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 为虚拟环境管理配置管理代理机器
- en: Managing agents are systems that manage the communication between the collector
    and the virtual environment we manage via VCM, that is, vCenter Server, vCD, and
    vShield Manager. In this recipe, we will assign a system the role of a management
    agent.
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: 管理代理是管理收集器与我们通过VCM管理的虚拟环境之间通信的系统，即vCenter Server、vCD和vShield Manager。在本食谱中，我们将指定一个系统作为管理代理。
- en: Getting ready
  id: totrans-241
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: We need to have the version 5.5 or later agent installed on the machine and
    data collected from it, which will be designated as the managing agent. Refer
    to the next recipe.
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: 我们需要在机器上安装版本5.5或更高版本的代理，并收集其数据，这将被指定为管理代理。请参考下一篇食谱。
- en: The managing agent machines must have the version 5.5 or later agent installed.
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: 管理代理机器必须安装版本5.5或更高版本的代理。
- en: We can designate any server that can communicate with VCM as well as vCD, vShield,
    and vCenter Server as a managing agent.
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以指定任何能够与VCM、vCD、vShield和vCenter Server通信的服务器作为管理代理。
- en: How to do it...
  id: totrans-245
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'Log in to VCM and follow these steps to designate a managing agent and then
    change it to a managed virtual environment:'
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
- en: Navigate to **Administration** | **Certificates**.![How to do it...](img/image_02_017.jpg)
  id: totrans-247
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select the machine that you want to designate as a managing agent.
  id: totrans-248
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select **Change Trust Status**.
  id: totrans-249
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Check to trust or uncheck to untrust the selected machines box, click on **Next**,
    and click on **Finish** on the next page to complete the wizard.
  id: totrans-250
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select the machine again and click on **Managing Agent** in the top menu.
  id: totrans-251
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select **Enable**, click on **Next**, and then click on **Finish** on the next
    page to complete the wizard.
  id: totrans-252
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Note
  id: totrans-253
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
- en: '**Note**: The choice of managing agent solely depends on the size of the infrastructure
    you manage; you can use your collector as a managing agent, or you can use another
    Windows machine. If your individual vCenter instance manages between 1 to 30 hosts
    and a maximum of 1,000 guests, then you can use the collector as your managing
    agent. Otherwise, designate a dedicated managing agent.'
  id: totrans-254
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '![How to do it...](img/image_02_018.jpg)'
  id: totrans-255
  prefs:
  - PREF_IND
  type: TYPE_IMG
- en: The selected server will become the managing agent now.
  id: totrans-256
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Once the managing agent has been designated, we can change it for the managed
    virtual environment.
  id: totrans-257
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Go to **Administration** | **Machines Manager** | **Licensed Machines** | **Licensed
    Virtual Environments**. Select the machine whose managing agent you want to change,
    and click on **Configure Settings**.
  id: totrans-258
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select the machine added if required.
  id: totrans-259
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: On the top, there is a dropdown to select either of the available managing agents.
    Change to a new one and click on **Next** (not visible in the screenshot), and
    click on **Finish** on next page to close the wizard.![How to do it...](img/image_02_019.jpg)
  id: totrans-260
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Repeat steps 8 through 10 for the remaining virtual environments in the infrastructure.
  id: totrans-261
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: How it works...
  id: totrans-262
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The managing agents are systems that manage the communication between the collector
    and the virtual environment using the VMware APIs of the various products. They
    must be configured to manage secure communication between virtual environment
    instances and the collector.
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
- en: It is recommended that VCM collector act as the managing agent if any of the
    vCenter instances it is managing has 1 to 30 hosts and upto 1,000 guests. The
    default managing agent is the Collector server, but as the workload increases,
    we can start adding them. In this recipe, we looked at designating a managed machine
    to a managed agent.
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
- en: We are designating another server to communicate with the virtual environment
    so that some of the work can be offloaded from VCM Collector. The server must
    have connectivity to the virtual environment servers and VCM Collector.
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
- en: Installing an agent on Windows servers
  id: totrans-266
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Before we start managing any machine, we need to install an agent on it. This
    can be done in multiple ways, such as pushing it from the VCM console, installing
    it manually, or installing it with a script.
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
- en: In this recipe, we will have a look at installing the agent manually and with
    a script on a Windows server.
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  id: totrans-269
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Prepare a server to install the agent; the installer is available on the VCM
    Collector server, at `X:\Program Files (x86)\Vmware\VCM\AgentFiles` and the certificate
    is available at `X:\Program Files (x86)\Vmware\VCM\CollectorData`, where `X` is
    the drive where VCM is installed.
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
- en: Copy the installer and certificate on a shared location from where it can be
    copied to the server where we want to install it.
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
- en: We need administrative access on the server where we will be installing the
    agent.
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
- en: The local firewall should be disabled (not recommended) or port `26542` must
    be open between the managed machine and VCM Collector.
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
- en: For an agent push, we need the machines to be registered as licensed machines
    on the VCM console and the network authority account to be a part of the local
    administrators group, and port `26542` should be open on the machine where we
    are pushing the agent.
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  id: totrans-275
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: We will split this recipe into three sections, as follows
  id: totrans-276
  prefs: []
  type: TYPE_NORMAL
- en: '*Manual agent installation*'
  id: totrans-277
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Agent push from the console*'
  id: totrans-278
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Licensing Windows machines*'
  id: totrans-279
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Manual agent installation
  id: totrans-280
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'Log in to the server with an administrative account, copy the installer with
    a certificate locally, and follow this process:'
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
- en: Start `VCMAgentInstall.exe`.
  id: totrans-282
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on **Next**, again on **Next**, and on the destination location screen,
    continue with the default `C:\Windows\CMAgent` value.
  id: totrans-283
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select **Allow HTTP**, and go with the default port, `26542`.
  id: totrans-284
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: On this page, browse to the location where the certificate is copied.
  id: totrans-285
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on **Next** three more times, and it will start installing the agent.
  id: totrans-286
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Once the agent has been installed, log in to VCM console.
  id: totrans-287
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Go to **Administration** | **Machines Manager** | **Licensed Machines** | **Licensed
    Windows Machines**, and click on **Add Machine**.
  id: totrans-288
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select **Basic** and select automatically license machines.
  id: totrans-289
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Provide details about the machine where you installed the agent, as follows:'
  id: totrans-290
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Provide the hostname for the **Machine Name** parameter
  id: totrans-291
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Select the domain from the dropdown which the machine belongs to
  id: totrans-292
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Select **DNS** as **Type**
  id: totrans-293
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Select **Windows Server** as **Machine Type**
  id: totrans-294
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Click on **Next** and then on **Finish** to close the wizard.
  id: totrans-295
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Once the machine has been added to VCM, we need to hit the R**efresh** button
    on the console and click on **Collect** to start data collection.
  id: totrans-296
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Monitor the data collection job, and finally, we are done with adding a machine
    to VCM.
  id: totrans-297
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Agent push from the console
  id: totrans-298
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The machine should be in the VCM console either by running a discovery rule
    or adding it manually. Now, we can perform a push of the agent from the console.
  id: totrans-299
  prefs: []
  type: TYPE_NORMAL
- en: 'Log in to the VCM console and follow these steps to install the agent on the
    machine:'
  id: totrans-300
  prefs: []
  type: TYPE_NORMAL
- en: Go to **Administration** | **Machines Manager** | **Licensed Machines** | **Licensed
    Windows Machines**, and select the machine which you want to add the agent to.
  id: totrans-301
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on **Install** in the menu.![Agent push from the console](img/image_02_020.jpg)
  id: totrans-302
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The wizard will open. Make sure the machine appears in the **Selected** box.
  id: totrans-303
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'On the next page, set the following values:'
  id: totrans-304
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Install At:** Keep this default.'
  id: totrans-305
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Install From:** Keep this default.'
  id: totrans-306
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Options:** Select **HTTP** and set the port to `26542`. Keep the rest default.'
  id: totrans-307
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '![Agent push from the console](img/image_02_021.jpg)'
  id: totrans-308
  prefs:
  - PREF_IND
  type: TYPE_IMG
- en: On the schedule screen, select **Run Now**.
  id: totrans-309
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Confirm the selection and click on **Finish**.
  id: totrans-310
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on **Jobs** to see whether the job is successful, and after that, go back
    to the console, scroll to the right, and check whether the machine has its agent
    state changed from **Unknown** to **Current Agent** and shows its agent version
    as **5.8.2**.
  id: totrans-311
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Once the machine has its agent installed, perform an initial collection.
  id: totrans-312
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Licensing Windows machines
  id: totrans-313
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: We will perform the following steps to license a managed machine. The steps
    are the same for Windows and Linux/Unix machines.
  id: totrans-314
  prefs: []
  type: TYPE_NORMAL
- en: Log in to the VCM console with an admin account.
  id: totrans-315
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on **Administration**.
  id: totrans-316
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Go to **Machines Manager** | **Available Machines**.
  id: totrans-317
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select the Windows machines to license.
  id: totrans-318
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on **License**.
  id: totrans-319
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Follow the wizard to finish licensing the machine, and if the available number
    is below zero and in red, contact VMware to purchase more licenses.
  id: totrans-320
  prefs: []
  type: TYPE_NORMAL
- en: How it works...
  id: totrans-321
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: With this recipe, we are making sure that the machine we want to manage has
    an agent installed, is licensed in VCM, and that we have performed the data collection.
  id: totrans-322
  prefs: []
  type: TYPE_NORMAL
- en: VCM has enough information about managed machines to start deploying software;
    put the machine in the correct machine group. We can perform further specific
    collections to find out the compliance status or patching status, and based on
    that, we can fix the machine or install missing patches.
  id: totrans-323
  prefs: []
  type: TYPE_NORMAL
- en: There's more...
  id: totrans-324
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: We can install the agent with a script.
  id: totrans-325
  prefs: []
  type: TYPE_NORMAL
- en: 'Here is the code for the script:'
  id: totrans-326
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  id: totrans-327
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Here is what the options stand for:'
  id: totrans-328
  prefs: []
  type: TYPE_NORMAL
- en: '| **Sr. No.** | **Option** | **Description** |'
  id: totrans-329
  prefs: []
  type: TYPE_TB
- en: '| **1** | `C:\VCM_Agent` | The location where the BAT file, installer, and
    certificate are copied |'
  id: totrans-330
  prefs: []
  type: TYPE_TB
- en: '| **2** | `CMAgentInstall.exe` | The VCM agent installer |'
  id: totrans-331
  prefs: []
  type: TYPE_TB
- en: '| **3** | `/s` | Option for a silent installation |'
  id: totrans-332
  prefs: []
  type: TYPE_TB
- en: '| **4** | `INSTALLPATH` | The location to install the VCM agent on the server
    |'
  id: totrans-333
  prefs: []
  type: TYPE_TB
- en: '| **5** | `PORT` | The port for the VCM agent to communicate |'
  id: totrans-334
  prefs: []
  type: TYPE_TB
- en: '| **6** | `CERT` | The VCM Enterprise certificate path |'
  id: totrans-335
  prefs: []
  type: TYPE_TB
- en: Just run the batch file and then follow steps 6 to 11 to complete the agent
    installation.
  id: totrans-336
  prefs: []
  type: TYPE_NORMAL
- en: You can also use the `PowerCLI` commands `Copy.VMGuestFile` and `Invoke-VMSCript`
    to automate the deployment.
  id: totrans-337
  prefs: []
  type: TYPE_NORMAL
- en: Installing an agent on Linux servers
  id: totrans-338
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: We need an agent to manage Linux/Unix machines; in this recipe, we will install
    it manually on a Linux machine.
  id: totrans-339
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  id: totrans-340
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In case of a Linux installer, make sure that it is copied from the same VCM
    server where the managed machine will get managed, as VCM certificates are embedded
    in the installer. If we use an installer from another VCM server and then try
    to manage it from a different server, it will fail.
  id: totrans-341
  prefs: []
  type: TYPE_NORMAL
- en: Copy the correct installer from the VCM server to the Linux server.
  id: totrans-342
  prefs: []
  type: TYPE_NORMAL
- en: Install the prerequisites and verify that the `glibc.i686`, `net-tools`, and
    `redhat-lsb-core` packages have been installed on the target machine.
  id: totrans-343
  prefs: []
  type: TYPE_NORMAL
- en: Open port `26542` if a firewall is enabled.
  id: totrans-344
  prefs: []
  type: TYPE_NORMAL
- en: We need the root password of the machine where the agent will be installed.
  id: totrans-345
  prefs: []
  type: TYPE_NORMAL
- en: 'The agent is available at `X: \Program Files (x86)\VMware\VCM\Installer\Packages\CMAgent.5.8.2.linux`
    on the VCM Collector server. We don''t need to copy the certificate the way we
    did in Windows as the certificate is built into the installer.'
  id: totrans-346
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  id: totrans-347
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Follow the steps to install the agent on a Linux machine:'
  id: totrans-348
  prefs: []
  type: TYPE_NORMAL
- en: Copy the installer with `scp` or `winscp` on the server.
  id: totrans-349
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Log in to the Linux server as root.
  id: totrans-350
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Run `chmod u+x CMAgent.5.8.2.linux`.
  id: totrans-351
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Run  `./CMAgent.5.8.2.linux` .
  id: totrans-352
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Copy the modified and `savedcsi.config` file to the extracted location.
  id: totrans-353
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Note
  id: totrans-354
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
- en: '**Note:** `csi.config` is a configuration file used by the VCM agent to install
    the agent.'
  id: totrans-355
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: More details about the configuration options can be found at [https://www.vmware.com/support/vcm/doc/help/vcm581/Content/NIX/CM_Ref_UNIX_csi_config_options.htm](https://www.vmware.com/support/vcm/doc/help/vcm581/Content/NIX/CM_Ref_UNIX_csi_config_options.htm).There
    are lots of options available to configure the `csi.config` file.
  id: totrans-356
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: We need to set `CSI_AGENT_RUN_OPTION = daemon` to start this as a daemon; for
    the rest, you can consult with your Linux admin and decide.
  id: totrans-357
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: An example:  `# cp /<Shared_location> csi.config /<extractedlocation>/CSIInstall/csi.config`
    .
  id: totrans-358
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Once this is done, run the installer script using `./CSIInstall/InstallCMAgent
    -s`.
  id: totrans-359
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Once the agent has been installed, follow the previous recipe from step 6 onward;
    just change the location from **Licensed Windows Machines** to **Licensed UNIX
    Machines**, and when entering details, set **Machine Type** as **Red Hat Server**
    or any other, depending upon the OS and as per the following screenshot:'
  id: totrans-360
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '![How to do it...](img/image_02_022.jpg)'
  id: totrans-361
  prefs:
  - PREF_IND
  type: TYPE_IMG
- en: How it works...
  id: totrans-362
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: We added the agent to the Linux/Unix machines as well so that we can collect
    the details of the managed machines; then, those details will be used to check
    compliance and patch status.
  id: totrans-363
  prefs: []
  type: TYPE_NORMAL
- en: There's more...
  id: totrans-364
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: We can create a preconfigured `csi-config` file and copy it to `/opt/CMAgent`
    along with the installer.
  id: totrans-365
  prefs: []
  type: TYPE_NORMAL
- en: Copy the content of the following script into a `.sh` file.
  id: totrans-366
  prefs: []
  type: TYPE_NORMAL
- en: 'Give it execute permission: `chmod CMAgentInstall.sh 755`.'
  id: totrans-367
  prefs: []
  type: TYPE_NORMAL
- en: Then, run the `./CMAgentInstall.sh` command.
  id: totrans-368
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  id: totrans-369
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: The script identifies the OS of the machine and, based on that, opens port `26542`
    on the local firewall. Then, it copies the preconfigured `csi.config` file and,
    finally, installs the agent from the `/opt/CSIInstall` folder.
  id: totrans-370
  prefs: []
  type: TYPE_NORMAL
- en: Creating machine groups
  id: totrans-371
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Machine/virtual object groups are used to organize managed machines and virtual
    objects into small logical groups. There are default groups available from VCM
    when it is deployed (more details are in the *There's More...* section).
  id: totrans-372
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  id: totrans-373
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: As an administrator, you must have some idea of which machine you should put
    together. You can use this concept and create machine groups as per your requirement.
  id: totrans-374
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  id: totrans-375
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Once you have a basic understanding of what you want to achieve with the group,
    log in to the VCM console and follow the steps detailed shortly.
  id: totrans-376
  prefs: []
  type: TYPE_NORMAL
- en: We will create a machine group that will include all the machines that are a
    part of the `Study.local` Active Directory group, and it will keep on adding machines
    as soon as a new machine is added to VCM from the same domain.
  id: totrans-377
  prefs: []
  type: TYPE_NORMAL
- en: Go to **Administration** | **Machines Manager** | **Machine/Virtual Object Group**
    | **All Machines** and click on **Add Group**.![How to do it...](img/image_02_023.jpg)
  id: totrans-378
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Provide a name and proper description, and click on **Next**.
  id: totrans-379
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Set **Membership Type** as **Dynamic** or **Static**.
  id: totrans-380
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In our case, we are going ahead with **Dynamic**, so click on **Finish** on
    the next page to complete the wizard.
  id: totrans-381
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Follow step 1 again, but this time, go to the machine group we just created.
    Click on the group and then click on **Filters**. This is where we will define
    the criteria to add machines to this group.
  id: totrans-382
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Under **Filters**, click on **Add Filter**.
  id: totrans-383
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Provide a meaningful name and description, and click on **Next**.
  id: totrans-384
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Now, all the details we collected from vCenter, vCloud, and all the managed
    machines are available here to filter.
  id: totrans-385
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Your imagination is the limit for creating filters, and you can use all the
    information you can gather from VCM. In our case, we have selected Machines as
    the data type; this is where your experience and expectations will meet together
    to make the exact machine group you want.![How to do it...](img/image_02_024.jpg)
  id: totrans-386
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select **Basic** under **Rule Type**.
  id: totrans-387
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Now, add your condition, such as **Domain Name****=**`'STUDY'`.![How to do it...](img/image_02_025.jpg)
  id: totrans-388
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on **Next**, and then click on **Finish** to close the wizard.
  id: totrans-389
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Now, go to the machine group, and a refresh will give you all the machines that
    are a part of the `STUDY` domain.![How to do it...](img/image_02_026.jpg)
  id: totrans-390
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: How it works...
  id: totrans-391
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: When you work with managed machines, you can create static groups, where members
    are selected manually, or dynamic groups, where filters dynamically determine
    membership. Machines can belong to multiple groups.
  id: totrans-392
  prefs: []
  type: TYPE_NORMAL
- en: You set the active machine group on the main toolbar, and you can define a machine
    filter with the options to the right of the textbox, as shown in this screenshot.
    A machine group filter further limits the selected machine group.
  id: totrans-393
  prefs: []
  type: TYPE_NORMAL
- en: '![How it works...](img/image_02_027.jpg)'
  id: totrans-394
  prefs: []
  type: TYPE_IMG
- en: In all nodes except those in the **Administration** slider, an active machine
    group limits the displayed data to the managed machines defined in the selected
    machine group.
  id: totrans-395
  prefs: []
  type: TYPE_NORMAL
- en: There's more...
  id: totrans-396
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'This is the list of default groups created with an installation of VCM:'
  id: totrans-397
  prefs: []
  type: TYPE_NORMAL
- en: '| **Name** | **Description** |'
  id: totrans-398
  prefs: []
  type: TYPE_TB
- en: '| All machines | All the licensed machines in VCM |'
  id: totrans-399
  prefs: []
  type: TYPE_TB
- en: '| AD auto-created | Active Directory auto-created machine groups |'
  id: totrans-400
  prefs: []
  type: TYPE_TB
- en: '| All Unix machines | All Unix machines |'
  id: totrans-401
  prefs: []
  type: TYPE_TB
- en: '| All VM guest machines | All managed VM guests from managed vCenter, vCloud,
    and vShield environments |'
  id: totrans-402
  prefs: []
  type: TYPE_TB
- en: '| All VM guest Unix machines | All VM guest Unix machines |'
  id: totrans-403
  prefs: []
  type: TYPE_TB
- en: '| All VM guest Windows machines | All VM guest Windows machines |'
  id: totrans-404
  prefs: []
  type: TYPE_TB
- en: '| All VM host machines | All VM host machines |'
  id: totrans-405
  prefs: []
  type: TYPE_TB
- en: '| All Windows machines | All Windows machines |'
  id: totrans-406
  prefs: []
  type: TYPE_TB
- en: Dynamic groups
  id: totrans-407
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: In dynamic groups, we define single or multiple filters, and based on the filters,
    the group is populated. If we are defining multiple filters, then a logical `AND`
    operation is performed on them.
  id: totrans-408
  prefs: []
  type: TYPE_NORMAL
- en: Your imagination is the limit, considering the amount of data you have in VCM
    and all that of it is available to play with while creating filters for groups.
  id: totrans-409
  prefs: []
  type: TYPE_NORMAL
- en: Static groups
  id: totrans-410
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: In static groups, we define the members when we create the group, and then,
    we need to update them as and when required. There are no filters associated with
    them.
  id: totrans-411
  prefs: []
  type: TYPE_NORMAL
- en: The best use case is creating a static group for all the vCenter Server instances,
    as we won't be adding members on a daily basis, and if we add anyone, we can add
    them manually.
  id: totrans-412
  prefs: []
  type: TYPE_NORMAL
