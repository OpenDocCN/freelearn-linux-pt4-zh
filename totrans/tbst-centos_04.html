<html><head></head><body><div class="chapter" title="Chapter&#xA0;4.&#xA0;Troubleshooting Package Management and System Upgrades"><div class="titlepage"><div><div><h1 class="title"><a id="ch04"/>Chapter 4. Troubleshooting Package Management and System Upgrades</h1></div></div></div><p>The <a id="id175" class="indexterm"/>Yellowdog Updater, Modified (Yum) has been with us for a while. It is easy to use and it serves to reduce the complexity of dependency management when installing or upgrading CentOS packages. More commonly referred to as Yum, this chapter will be assuming that you are already proficient in its fundamental usage (including installing packages, updating packages, removing packages, and searching for packages) as our intention is to continue the overall premise of this book by approaching the subject of package management and system upgrades.</p><p>In this chapter, we will:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Learn how to gather software information with RPM and YUM</li><li class="listitem" style="list-style-type: disc">Learn how to use Yum plugins to make the process of troubleshooting an easier task</li><li class="listitem" style="list-style-type: disc">Troubleshoot issues relating to package installation and updates</li><li class="listitem" style="list-style-type: disc">Discover how to extend the system and install additional Yum repositories</li><li class="listitem" style="list-style-type: disc">Learn how to download an RPM package with Yum</li><li class="listitem" style="list-style-type: disc">Learn how to restore an RPM database</li><li class="listitem" style="list-style-type: disc">Discuss the complexities of managing minor system upgrades</li></ul></div><div class="section" title="Gathering software information"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec38"/>Gathering software information</h1></div></div></div><p>Before<a id="id176" class="indexterm"/> starting to tackle YUM, we will deviate a little by turning our attention towards the process of gathering the necessary software information in order to discover more about the system in general.</p><p>To do this, we will begin by running the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># cat /etc/redhat-release; lscpu | grep -i arch; yum repolist all; ls -alsh /etc/yum.repos.d;</strong></span>
</pre></div><p>At this stage, I will <a id="id177" class="indexterm"/>not explain every command shown in the above example, but you will notice that the output is verbose, and it does a good job of detailing the CentOS release information. The information displayed includes details regarding the overall architecture of the server; the domain, time, and date information, and finally, the extent, status, and permissions of the repository list used by Yum.</p><p>So far so good, but what if I need to know about the RPM-based packages that are installed on the server? Rather than wading through an entire series of configuration files (or even making an educated guess), why not simply use the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># rpm -qa | sort | less</strong></span>
</pre></div><p>As you can see, depending on what is installed on your server, the above command will output an extensive (or on the other hand, a relatively small) list of RPM-based packages. If this is too detailed, and you merely want a quick idea as to what the installation history could be, you can simply display the total number of RPM-based packages by typing the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># rpm -qa | wc -l</strong></span>
</pre></div><p>As we have used the <code class="literal">wc</code> command, the output will be restricted to a numeric value representing the information requested. It may be too simplistic or vague for your exact needs, but it will give you a firm grounding with regard to the current usage of the server in question (especially if this task is repeated over specific time periods).</p><p>So, why stop there? If you feel rather more inquisitive, then you can also request information regarding which Yum packages are installed by typing the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># yum list installed | sort | less</strong></span>
</pre></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note08"/>Note</h3><p>At this stage, you may be asking, what is the difference between <code class="literal">yum list installed</code> and the previously mentioned <code class="literal">rpm –qa</code> command? In simple terms, the former Yum-based command will also list the package dependencies, so you should expect to see far more detail in the output.</p></div></div><p>Again, this listing can either be extensive or not depending on the purpose of the server in question, but for those of you who enjoy the benefits of good housekeeping, this function can be improved by printing the output to a file of your choice like this:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># yum list installed | sort &gt; /path/to/filename.txt</strong></span>
</pre></div><p>Again, nothing <a id="id178" class="indexterm"/>too complicated at this stage, but before we round off these initial steps, it is important to realize that we have just exposed some of the secrets of a previously unknown CentOS server. Our familiarity with the system is now growing, and as a consequence of our activity, you will now feel far more comfortable and at ease with your new surroundings. After all, when a server goes down and everyone else is panicking, the confidence gained here will count towards your eventual success.</p></div></div>
<div class="section" title="Using Yum plugins"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec39"/>Using Yum plugins</h1></div></div></div><p>Yum is <a id="id179" class="indexterm"/>one of the most widely used package management tools, but many administrators are unaware that it comes complete with a plugin system that can be used to extend its capabilities. It would be true to say that many of these plugins are installed by default, but as it is assumed you know nothing about the current system (which may often be the case for any troubleshooter), we will begin by installing the <code class="literal">yum-skip-broken</code> set of packages.</p><p>So, let' s start by typing the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># yum install yum-skip-broken</strong></span>
</pre></div><p>Having <a id="id180" class="indexterm"/>done this (and confirmed that this set of packages is now available to the system), we can now use the <code class="literal">--skip-broken</code> plugin to approach any situation in which you want to update or upgrade a certain package, which is refused due to a report of broken dependencies.</p><p>To do this, a combination of the following commands can be used:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># yum update --skip-broken &amp;&amp; yum upgrade --skip-broken</strong></span>
</pre></div><p>Of course, you can simplify the above command to suit your own purpose (by breaking it over two separate lines), but it should be noted that the reason an error occurs in these circumstances is often related to the mistake of mixing (incompatible) third-party repositories. In this respect, and in order to achieve a long-term solution, you will need to reduce the number of third-party repositories used. However, before attempting this, you should review the past transactions of Yum in order to ascertain how this will affect the system.</p><p>This can be achieved by typing the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># yum history</strong></span>
</pre></div><p>The above<a id="id181" class="indexterm"/> command will now generate a list of all the past operations undertaken by Yum, thereby affording a level of detail that can prove to be quite useful when attempting to debug a broken service, correct a package dependency, or assist in the process of reducing the number (or reliance) on third-party repositories. Moreover, from the list this command generates, you will also notice that each transaction carries a unique identifier.</p><p>The unique identifier can be used to obtain even more information about a particular event by typing:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># yum history info &lt;unique_identifier&gt;</strong></span>
</pre></div><p>Alternatively, in situations where this level of detail is not required, you can always obtain a summary of all recent events by typing the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># yum history summary</strong></span>
</pre></div><p>That being said, and while we are on the subject of Yum plugins, you should also be aware that <code class="literal">changelog</code> information is not directly available from the Yum package manager. Again, this type of information can be useful, but in order to follow this line of enquiry, you will need to install the <code class="literal">changelog</code> plugin by typing the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># yum install yum-plugin-changelog</strong></span>
</pre></div><p>Having done this, you will then be able to query the Yum <code class="literal">changelog</code> like this:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># yum changelog all &lt;package_name&gt;</strong></span>
</pre></div><p>As this output can be quite overwhelming, it is helpful to know that you do have the ability to restrict the information displayed by simply replacing the term <code class="literal">all</code> with a numeric value that indicates the number of records to show. So, in the case of wanting to read the <code class="literal">5</code> most recent updates to Postfix, you would type:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># yum changelog 5 postfix</strong></span>
</pre></div><p>Moreover, with this plugin installed, you can review the relevant <code class="literal">changelog</code> information prior to any package installation by typing the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># yum update --changelog</strong></span>
</pre></div><p>This is a small but interesting feature that can be extended to show all recent <code class="literal">changelog</code> information by typing:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># yum changelog all recent</strong></span>
</pre></div><p>Or, you can view all obsolete packages by typing:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># yum changelog all obsoletes</strong></span>
</pre></div><p>Finally, and <a id="id182" class="indexterm"/>before we close our discussion on using Yum plugins, there may be a situation that calls on the need to utilize <code class="literal">yum-utils</code>, and if it is not currently available to the system in question, you can install it by typing:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># yum install yum-utils</strong></span>
</pre></div><p>This addition makes package management a breeze when you consider the whole host of issues that can include the removal of orphaned or duplicate packages and the resolution of package cleanup operations.</p><p>For example, to remove orphaned packages, you can type:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># package-cleanup --orphans</strong></span>
</pre></div><p>To remove duplicates, you can use:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># package-cleanup --dupes</strong></span>
</pre></div><p>To facilitate the removal of old kernels, you can type:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># package-cleanup --oldkernels</strong></span>
</pre></div><p>With reference to the above example, if your system maintains a number of old kernels you can query them by running the command, <code class="literal">rpm -q kernel</code>. As you will see, this simple operation can provide the information you need in order to decide to whether the option to free disk space is available or not. If old kernels can be seen, you can remove them in the usual way. However, rather than suggesting that you need to do this, in uncovering this feature, my intention was to prove that <code class="literal">yum-utils</code> has many interesting features that should be explored, as it is an underrated aspect of Yum that can play an essential role when troubleshooting package management.</p></div>
<div class="section" title="Fixing Yum operations"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec40"/>Fixing Yum operations</h1></div></div></div><p>Now, it <a id="id183" class="indexterm"/>is important to realize that in many instances, the general cause of an error with Yum can begin with the network environment, an issue related to disk space, mixed repositories, or even the DNS settings on the system. However, there are occasions when a few common procedural errors will need rectifying by flushing Yum itself with one or more of the following range of commands.</p><p>To purge old package information, you should use:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># yum clean headers</strong></span>
</pre></div><p>To clean all cached packages, use the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># yum clean packages</strong></span>
</pre></div><p>To clean all <a id="id184" class="indexterm"/>cached XML-based data, use this:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># yum clean metadata</strong></span>
</pre></div><p>However, if you would like to flush the Yum cache in its entirety (including all headers, metadata, download packages, and more), you can always use the following command to complete the process:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># yum clean all</strong></span>
</pre></div></div>
<div class="section" title="Installing additional Yum repositories"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec41"/>Installing additional Yum repositories</h1></div></div></div><p>Installing<a id="id185" class="indexterm"/> additional repositories is not necessarily considered to be a troubleshooter's task, but it does serve to alleviate many issues regarding package dependencies and attempts to keep your system relevant within a Dev/Ops environment.</p><p>In the following text, I have included instructions for some of the most popular repositories. However, you should realize that the locations of these repositories will be different for alternative versions of CentOS, and that these links will be updated over time. Additional information can be found at the end of this chapter for future reference.</p><div class="section" title="EPEL"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec10"/>EPEL</h2></div></div></div><p>The <span class="strong"><strong>Extra Packages for Enterprise Linux</strong></span> (<span class="strong"><strong>EPEL</strong></span>) repository <a id="id186" class="indexterm"/>provides useful software packages <a id="id187" class="indexterm"/>that are not included in the official CentOS Linux repositories, some of which will be covered in the following chapters of this book. It is also a requirement for many other third-party repositories.</p><p>For CentOS 7, you should follow this procedure to install the EPEL repository:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># cd /root</strong></span>
<span class="strong"><strong># wget https://dl.fedoraproject.org/pub/epel/7/x86_64/e/epel-release-7-5.noarch.rpm</strong></span>
<span class="strong"><strong># yum install epel-release-7-5.noarch.rpm</strong></span>
</pre></div><p>Having completed the relevant steps, simply confirm that you would like to continue with the installation and then type the following command to ensure it is enabled:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># yum repolist all</strong></span>
</pre></div><p>EPEL is generally considered to be a base repository that is often required by many other repositories, and given the desire to keep our system current, I have included the procedures to <a id="id188" class="indexterm"/>install both the<a id="id189" class="indexterm"/> Remi and IUS repositories. However, with a heavy note of caution, I would suggest using only one of them to avoid any possible conflicts that may arise from employing them both on the same system.</p></div><div class="section" title="Remi"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec11"/>Remi</h2></div></div></div><p>The <a id="id190" class="indexterm"/>Remi repository<a id="id191" class="indexterm"/> depends on the EPEL repository and provides newer versions of the software to the core CentOS Linux repositories; so having installed this repository, you may expect to see several updates to the CentOS system the next time you run <code class="literal">yum update</code>.</p><p>For CentOS 7, you should follow this procedure to install the Remi repository:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># cd /root</strong></span>
<span class="strong"><strong># wget http://rpms.famillecollet.com/enterprise/remi-release-7.rpm</strong></span>
<span class="strong"><strong># rpm -Uvh remi-release-7*.rpm</strong></span>
</pre></div><p>By default, the Remi repository is disabled; to enable it, we will need to update the configuration file and mark it as active.</p><p>To do this, open the following file in your favorite text editor like this:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># nano /etc/yum.repos.d/remi.repo</strong></span>
</pre></div><p>Now, change:</p><div class="informalexample"><pre class="programlisting">enabled = 0</pre></div><p>To read:</p><div class="informalexample"><pre class="programlisting">enabled = 1</pre></div><p>Moreover, if you want to use the PHP 5.5 libraries, simply uncomment the <code class="literal">[remi-php55]</code> reference in the same file <code class="literal">remi.repo</code>. When done, save and close the file before typing the following command to ensure it is enabled:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># yum repolist all</strong></span>
</pre></div></div><div class="section" title="The IUS repository"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec12"/>The IUS repository</h2></div></div></div><p>As an <a id="id192" class="indexterm"/>alternative to Remi, the IUS repository also provides newer <a id="id193" class="indexterm"/>versions of software to the core CentOS Linux repositories, but the developers stress that IUS tends to use different package names in order to avoid conflicts that can arise from software version updates. This simple approach<a id="id194" class="indexterm"/> to package names has gained a lot of traction within the CentOS community as a whole as this level of control can be very useful <a id="id195" class="indexterm"/>within a mission critical environment. The IUS repository depends on the EPEL repository, but again, I would advise against mixing this repository with other sources.</p><p>For CentOS 7, you should follow this procedure to install the IUS repository:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># cd /root</strong></span>
<span class="strong"><strong># wget http://dl.iuscommunity.org/pub/ius/stable/CentOS/7/x86_64/ius-release-1.0-13.ius.centos7.noarch.rpm</strong></span>
<span class="strong"><strong># rpm -Uvh ius-release*.rpm</strong></span>
</pre></div><p>Moreover, given that the IUS repository works in a unique way, you should be aware that there is a package called <code class="literal">yum-plugin-replace</code> that is used to assist in the process of upgrading from stock packages to IUS <code class="literal">packageXY</code> style packages.</p><p>Again, I have provided a link to additional materials at the end of this chapter on how this tool can be used (and it is expected that these instructions may change over time), but at this present time, you can begin by typing:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># yum install yum-plugin-replace</strong></span>
</pre></div><p>Overall, regardless of whether you use Remi or IUS, remember, the golden rule is not to mix them, but regardless of which of these repository you choose, it is expected that either of them will serve you well.</p></div></div>
<div class="section" title="Downloading an RPM package with Yum"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec42"/>Downloading an RPM package with Yum</h1></div></div></div><p>If there is <a id="id196" class="indexterm"/>ever an occasion where you need to download a package but not install it, then this can be achieved with Yum. However, to begin this process, you need to ensure that your system maintains the following utility:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># yum install yum-plugin-downloadonly</strong></span>
</pre></div><p>In most cases, it may already be installed (as it forms part of the <code class="literal">yum-utils</code> package mentioned previously), but having completed this task (or confirmed that it is already present), you can simply download the required package to a directory of your choice by customizing the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># yum install &lt;package_name&gt; --downloadonly --downloaddir=/path/to/folder</strong></span>
</pre></div><p>For example, and to make sense of the the preceding command, you can download Samba and all of its dependencies to a user-based directory by typing:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># yum install samba --downloadonly --downloaddir=/home/username</strong></span>
</pre></div><p>Alternatively, you <a id="id197" class="indexterm"/>can also invoke the following variation, although this version of the command will assume that the download will be stored in your current location:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># yumdownloader &lt;package_name&gt;</strong></span>
</pre></div><p>Having done this, the next step will be to extract the contents of the package downloaded using <code class="literal">yumdownloader</code> in order to access the relevant RPM using the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># rpm2cpio &lt;package_name&gt; | cpio -idmv</strong></span>
</pre></div><p>The <code class="literal">cpio</code> command<a id="id198" class="indexterm"/> is typically used for backups, and its function is to facilitate the transport of files in and out of a <code class="literal">cpio</code> archive. It works in a way similar to <code class="literal">tar</code>, but unlike <code class="literal">tar</code>, <code class="literal">cpio</code> can work in conjunction with the <code class="literal">find</code> command.</p><p>For example, to make a back up, you can begin by accessing the relevant directory like this:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># cd /path/to/directory</strong></span>
</pre></div><p>List the directory contents to ensure that everything is present:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># ls -altr</strong></span>
</pre></div><p>Now, run the command for backing up the directory in the following way:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># find . -print | cpio -ocv &gt; /path/to/backup-name.cpio</strong></span>
</pre></div><p>So, in a few short steps, we have discovered how to download a package through Yum and to extract the relevant package data using the <code class="literal">cpio</code> command, a process that may prove to be most useful when troubleshooting a particular service or application that requires a dependency. This may or may not be the first time you have seen the <code class="literal">cpio</code> command, and yes, you won't be surprised to know that we have only scratched the surface of how it can be used. So, with that in mind, I would encourage you to learn more about it, as you will find that it will prove to be very useful at some point in the future.</p><p>Additional information about the <code class="literal">cpio</code> command can be found at the end of this chapter, but for reference, you can begin your journey by typing:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ man cpio</strong></span>
</pre></div></div>
<div class="section" title="Diagnosing a corrupt RPM database"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec43"/>Diagnosing a corrupt RPM database</h1></div></div></div><p>RPM <a id="id199" class="indexterm"/>is a package management tool that stores information about software packages in its own database located at <code class="literal">/var/lib/rpm</code>, but on some occasions, it has been observed that this database can fail. If such an event does take place, then this can render the use of the <code class="literal">rpm</code> command useless, and in this situation, it is not uncommon to find that the system will begin exhibiting signs of trouble related to any Yum- or RPM-based processes.</p><p>For example, during a typical Yum update procedure, you could witness the following message:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>"error: cannot open Packages database in /var/lib/rpm"</strong></span>
</pre></div><p>At this point, I cannot help but stress the importance of a good backup strategy, but as a troubleshooter, this may be out of your control. Therefore, in such circumstances, the rudimentary process of restoring the RPM database can be diagnosed by completing the following steps:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># cd /var/lib/rpm</strong></span>
<span class="strong"><strong># rm -rf __db*</strong></span>
<span class="strong"><strong># rpm -v --rebuilddb</strong></span>
</pre></div><p>Having completed the above steps, you should be able to run various sanity checks in order to confirm that there are no segmentation errors by using one or more of the following commands:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># db_verify Packages</strong></span>
<span class="strong"><strong># db_stat -CA</strong></span>
<span class="strong"><strong># rpm -qa</strong></span>
<span class="strong"><strong># rpm -Va</strong></span>
<span class="strong"><strong># yum update</strong></span>
</pre></div><p>For example, having run the command <code class="literal">db_verify Packages</code>, you should see the following type of output:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>BDB5105 Verification of Packages succeeded.</strong></span>
</pre></div><p>Hopefully, this procedure will fix the issue. However, it is important to realize that this process is not definitive and it can fail. Look at it this way, in order to avoid this situation, a regular backup of <code class="literal">/var/lib/rpm</code> should be considered to be common practice on all CentOS/RHEL-based systems, and if verification of packages process fails, you will need to consider a full restore from a recent backup.</p></div>
<div class="section" title="Minor release upgrades"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec44"/>Minor release upgrades</h1></div></div></div><p>For CentOS 7 users, the <a id="id200" class="indexterm"/>ease of completing a minor release upgrade is simply a matter of using Yum but, as always, you should perform a full backup before proceeding.</p><p>The precise nature of the types of files you should back up will differ from system to system, but it will include configuration files, important system files, user data, databases, web versioning, and application files. Moreover, if you are using proprietary software, you should confirm the feasibility of any upgrades with the original developers prior to completing an update.</p><p>So, having taken all these measures into account, when possible, I would recommend the process of backing up the entire system, and in this respect, you can be rest assured that you will have a copy of everything.</p><p>To begin the process of a minor upgrade, you can view the current CentOS release information by typing:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># cat /etc/redhat-release</strong></span>
</pre></div><p>You can then view the Linux information with:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># uname -mrs</strong></span>
</pre></div><p>Now, before you invoke Yum to obtain a list of updated packages, it is always a good idea to begin by typing:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># yum clean all</strong></span>
</pre></div><p>Then, follow the instruction to purge Yum, as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># yum check-update</strong></span>
</pre></div><p>You will now be presented with a list of updates for the system in question. These pending updates will be displayed in a familiar format, and they will detail the package name and versioning.</p><p>If you wish to update the system, use the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># yum update</strong></span>
</pre></div><p>The time required by any update can vary, so you may need to be patient. However, having successfully completed this step, you may want to consider rebooting the system. The practice of rebooting a system is particularly advantageous if the updates need to effect any changes to the kernel during the boot phase.</p><p>To do this, type:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># reboot</strong></span>
</pre></div><p>Finally, after the reboot is complete, you can verify your system updates using:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># uname -a</strong></span>
</pre></div><p>Now, run one or <a id="id201" class="indexterm"/>more of the following commands to ensure that all services and applications are running correctly:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># tail -f /var/log/messages</strong></span>
<span class="strong"><strong># netstat -tulpn</strong></span>
<span class="strong"><strong># ps aux | less</strong></span>
</pre></div></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec45"/>Summary</h1></div></div></div><p>In this chapter, we have taken a whirlwind tour through the intricacies of troubleshooting package management. There is always much more ground to cover, but for the purpose of system administration, you have not only discovered a series of tools that can be used to overcome a wealth of common issues related to Yum, but we have also discussed the ability to extend Yum through a variety of plugins, install third-party repositories, enable Yum to download RPM packages, and restore an RPM database.</p><p>So, as you can see, and before we move on to a discussion regarding users, directories, and files, with some lateral thinking and a little practice, you should now be well on your way to being able to troubleshoot an entire host of problems and make almost any package management issue a thing of the past.</p></div>
<div class="section" title="References"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec46"/>References</h1></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The CentOS upgrade tool: <a class="ulink" href="http://wiki.centos.org/TipsAndTricks/CentOSUpgradeTool">http://wiki.centos.org/TipsAndTricks/CentOSUpgradeTool</a></li><li class="listitem" style="list-style-type: disc">How do I upgrade from Enterprise Linux 6 to Red Hat Enterprise Linux 7?: <a class="ulink" href="https://access.redhat.com/solutions/637583">https://access.redhat.com/solutions/637583</a></li><li class="listitem" style="list-style-type: disc">The cpio Wikipedia page: <a class="ulink" href="http://en.wikipedia.org/wiki/Cpio">http://en.wikipedia.org/wiki/Cpio</a></li><li class="listitem" style="list-style-type: disc">The <code class="literal">cpio</code> command: <a class="ulink" href="http://www.gnu.org/software/cpio/manual/cpio.html">http://www.gnu.org/software/cpio/manual/cpio.html</a></li><li class="listitem" style="list-style-type: disc">EPEL/epel7beta-faq: <a class="ulink" href="https://fedoraproject.org/wiki/EPEL/epel7beta-faq">https://fedoraproject.org/wiki/EPEL/epel7beta-faq</a></li><li class="listitem" style="list-style-type: disc">EPEL/epel7: <a class="ulink" href="https://fedoraproject.org/wiki/EPEL/epel7">https://fedoraproject.org/wiki/EPEL/epel7</a></li><li class="listitem" style="list-style-type: disc">Index of /pub/epel/7/x86_64/e: <a class="ulink" href="http://dl.fedoraproject.org/pub/epel/7/x86_64/e/">http://dl.fedoraproject.org/pub/epel/7/x86_64/e/</a></li><li class="listitem" style="list-style-type: disc">Les RPM de Remi - Blog: <a class="ulink" href="http://blog.famillecollet.com/pages/Config-en">http://blog.famillecollet.com/pages/Config-en</a></li><li class="listitem" style="list-style-type: disc">Index of Remi: <a class="ulink" href="http://rpms.famillecollet.com/enterprise/">http://rpms.famillecollet.com/enterprise/</a></li><li class="listitem" style="list-style-type: disc">IUS Community Project: <a class="ulink" href="https://iuscommunity.org/pages/IUSClientUsageGuide.html">https://iuscommunity.org/pages/IUSClientUsageGuide.html</a></li><li class="listitem" style="list-style-type: disc">Index of /pub/ius/stable/CentOS: <a class="ulink" href="http://dl.iuscommunity.org/pub/ius/stable/CentOS/">http://dl.iuscommunity.org/pub/ius/stable/CentOS/</a></li><li class="listitem" style="list-style-type: disc">The IUS package replacement guide: <a class="ulink" href="https://iuscommunity.org/pages/IUSClientUsageGuide.html">https://iuscommunity.org/pages/IUSClientUsageGuide.html</a></li><li class="listitem" style="list-style-type: disc">The ATrpms repository: <a class="ulink" href="http://atrpms.net/about/">http://atrpms.net/about/</a></li><li class="listitem" style="list-style-type: disc">The Nux repository: <a class="ulink" href="http://li.nux.ro/repos.html">http://li.nux.ro/repos.html</a></li><li class="listitem" style="list-style-type: disc">The RPM home page: <a class="ulink" href="http://rpm.org">http://rpm.org</a></li><li class="listitem" style="list-style-type: disc">The RPM recovery diagnostics: <a class="ulink" href="http://www.rpm.org/wiki/Docs/RpmRecovery">http://www.rpm.org/wiki/Docs/RpmRecovery</a></li></ul></div></div></body></html>