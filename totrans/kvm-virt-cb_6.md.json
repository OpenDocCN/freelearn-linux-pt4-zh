["```\nroot@controller:~# apt install software-properties-common\nroot@controller:~# add-apt-repository cloud-archive:newton\nroot@controller:~# apt update && apt dist-upgrade\nroot@controller:~# reboot\nroot@controller:~# apt install python-openstackclient\n\n```", "```\nroot@controller:~# apt install mariadb-server python-pymysql\nroot@controller:~# cat /etc/mysql/mariadb.conf.d/99-openstack.cnf\n[mysqld]\nbind-address = 10.208.130.36\ndefault-storage-engine = innodb\ninnodb_file_per_table\nmax_connections = 4096\ncollation-server = utf8_general_ci\ncharacter-set-server = utf8\nroot@controller:~#\n\n```", "```\nroot@controller:~# service mysql restart\nroot@controller:~# mysql_secure_installation\n\n```", "```\nroot@controller:~# apt install rabbitmq-server\nroot@controller:~# rabbitmqctl add_user openstack lxcpassword\nCreating user \"openstack\" ...\nroot@controller:~# rabbitmqctl set_permissions openstack \".*\" \".*\" \".*\"\nSetting permissions for user \"openstack\" in vhost \"/\" ...\nroot@controller:~#\n\n```", "```\nroot@controller:~# apt install memcached python-memcache\nroot@controller:~# sed -i 's/127.0.0.1/10.208.130.36/g'   \n/etc/memcached.conf\nroot@controller:~# cat /etc/memcached.conf | grep -vi \"#\" | sed \n'/^$/d'\n-d\nlogfile /var/log/memcached.log\n-m 64\n-p 11211\n-u memcache\n-l 10.208.130.36\nroot@controller:~# service memcached restart\nroot@controller:~#\n\n```", "```\nroot@controller:~# mysql -u root -plxcpassword\nMariaDB [(none)]> CREATE DATABASE keystone;\nQuery OK, 1 row affected (0.01 sec)\nMariaDB [(none)]> GRANT ALL PRIVILEGES ON keystone.* TO\n'keystone'@'localhost' IDENTIFIED BY 'lxcpassword';\nQuery OK, 0 rows affected (0.00 sec)\nMariaDB [(none)]> GRANT ALL PRIVILEGES ON keystone.* TO \n'keystone'@'%' IDENTIFIED BY 'lxcpassword';\nQuery OK, 0 rows affected (0.01 sec)\nMariaDB [(none)]> exit\nBye\nroot@controller:~#\n\n```", "```\nroot@controller:~# apt install keystone\n\n```", "```\nroot@controller:~# cat /etc/keystone/keystone.conf\n[DEFAULT]\nlog_dir = /var/log/keystone\n\n[assignment]\n[auth]\n[cache]\n[catalog]\n[cors]\n[cors.subdomain]\n[credential]\n[database]\nconnection = mysql+pymysql://keystone:lxcpassword@controller/keystone\n\n[domain_config]\n[endpoint_filter]\n[endpoint_policy]\n[eventlet_server]\n[federation]\n[fernet_tokens]\n[identity]\n[identity_mapping]\n[kvs]\n[ldap]\n[matchmaker_redis]\n[memcache]\n[oauth1]\n[os_inherit]\n[oslo_messaging_amqp]\n[oslo_messaging_notifications]\n[oslo_messaging_rabbit]\n[oslo_messaging_zmq]\n[oslo_middleware]\n[oslo_policy]\n[paste_deploy]\n[policy]\n[profiler]\n[resource]\n[revoke]\n[role]\n[saml]\n[security_compliance]\n[shadow_users]\n[signing]\n[token]\nprovider = fernet\n[tokenless_auth]\n[trust]\n[extra_headers]\nDistribution = Ubuntu\nroot@controller:~#\n\n```", "```\nroot@controller:~# su -s /bin/sh -c \"keystone-manage db_sync\" keystone\n...\nroot@controller:~#\n\n```", "```\nroot@controller:~# keystone-manage fernet_setup --keystone-user keystone --keystone-group keystone\nroot@controller:~# keystone-manage credential_setup --keystone-user keystone --keystone-group keystone\nroot@controller:~#\n\n```", "```\nroot@controller:~# keystone-manage bootstrap --bootstrap-password lxcpassword --bootstrap-admin-url http://controller:35357/v3/ --bootstrap-internal-url http://controller:35357/v3/ --bootstrap-public-url http://controller:5000/v3/ --bootstrap-region-id RegionOne\nroot@controller:~#\n\n```", "```\nroot@controller:~# cat /etc/apache2/apache2.conf\n...\nServerName controller \n...\nroot@controller:~# service apache2 restart\n\n```", "```\nroot@controller:~# rm -f /var/lib/keystone/keystone.db\n\n```", "```\nroot@controller:~# export OS_USERNAME=admin\nroot@controller:~# export OS_PASSWORD=lxcpassword\nroot@controller:~# export OS_PROJECT_NAME=admin\nroot@controller:~# export OS_USER_DOMAIN_NAME=default\nroot@controller:~# export OS_PROJECT_DOMAIN_NAME=default\nroot@controller:~# export OS_AUTH_URL=http://controller:35357/v3\nroot@controller:~# export OS_IDENTITY_API_VERSION=3\nroot@controller:~#\n\n```", "```\nroot@controller:~# openstack project create --domain default --description \"KVM Project\" service\n+-------------+-----------------------------------+\n| Field        | Value                            |\n+-------------+-----------------------------------+\n| description  | KVM Project                      |\n| domain_id    | default                          |\n| enabled      | True                             |\n| id           | 9a1a863fe41b42b2955b313f2cca0ef0 |\n| is_domain    | False                            |\n| name         | service                          |\n| parent_id    | default                          |\n+-------------+-----------------------------------+\nroot@controller:~# openstack project list\n+----------------------------------+---------+\n| ID                               | Name    |\n+----------------------------------+---------+\n| 06f4e2d7e384474781803395b24b3af2 | admin   |\n| 9a1a863fe41b42b2955b313f2cca0ef0 | service |\n+----------------------------------+---------+\nroot@controller:~#\n\n```", "```\nroot@controller:~# openstack project create --domain default --description \"KVM User Project\" kvm\n+-------------+----------------------------------+\n| Field       | Value                            |\n+-------------+----------------------------------+\n| description | KVM User Project                 |\n| domain_id   | default                          |\n| enabled     | True                             |\n| id          | eb9cdc2c2b4e4f098f2d104752970d52 |\n| is_domain   | False                            |\n| name        | kvm                              |\n| parent_id   | default                          |\n+-------------+----------------------------------+\nroot@controller:~#\nroot@controller:~# openstack user create --domain default --password-prompt kvm\nUser Password:\nRepeat User Password:\n+---------------------+----------------------------------+\n| Field               | Value                            |\n+---------------------+----------------------------------+\n| domain_id           | default                          |\n| enabled             | True                             |\n| id                  | 1e83e0c8ca194f2e9d8161eb61d21030 |\n| name                | kvm                              |\n| password_expires_at | None                             |\n+---------------------+----------------------------------+\nroot@controller:~#\n\n```", "```\nroot@controller:~# openstack role create user\n+-----------+----------------------------------+\n| Field     | Value                            |\n+-----------+----------------------------------+\n| domain_id | None                             |\n| id        | 331c0b61e9784112874627264f03a058 |\n| name      | user                             |\n+-----------+----------------------------------+\nroot@controller:~# openstack role add --project kvm --user kvm user\nroot@controller:~#\n\n```", "```\nroot@controller:~# cat /etc/keystone/keystone-paste.ini\n# Keystone PasteDeploy configuration file.\n[filter:debug]\nuse = egg:oslo.middleware#debug\n[filter:request_id]\nuse = egg:oslo.middleware#request_id\n[filter:build_auth_context]\nuse = egg:keystone#build_auth_context\n[filter:token_auth]\nuse = egg:keystone#token_auth\n[filter:admin_token_auth]\nuse = egg:keystone#admin_token_auth\n[filter:json_body]\nuse = egg:keystone#json_body\n[filter:cors]\nuse = egg:oslo.middleware#cors\noslo_config_project = keystone\n[filter:http_proxy_to_wsgi]\nuse = egg:oslo.middleware#http_proxy_to_wsgi\n[filter:ec2_extension]\nuse = egg:keystone#ec2_extension\n[filter:ec2_extension_v3]\nuse = egg:keystone#ec2_extension_v3\n[filter:s3_extension]\nuse = egg:keystone#s3_extension\n[filter:url_normalize]\nuse = egg:keystone#url_normalize\n[filter:sizelimit]\nuse = egg:oslo.middleware#sizelimit\n[filter:osprofiler]\nuse = egg:osprofiler#osprofiler\n[app:public_service]\nuse = egg:keystone#public_service\n[app:service_v3]\nuse = egg:keystone#service_v3\n[app:admin_service]\nuse = egg:keystone#admin_service\n[pipeline:public_api]\npipeline = cors sizelimit http_proxy_to_wsgi osprofiler url_normalize request_id build_auth_context token_auth json_body ec2_extension public_service\n[pipeline:admin_api]\npipeline = cors sizelimit http_proxy_to_wsgi osprofiler url_normalize request_id build_auth_context token_auth json_body ec2_extension s3_extension admin_service\n[pipeline:api_v3]\npipeline = cors sizelimit http_proxy_to_wsgi osprofiler url_normalize request_id build_auth_context token_auth json_body ec2_extension_v3 s3_extension service_v3\n[app:public_version_service]\nuse = egg:keystone#public_version_service\n[app:admin_version_service]\nuse = egg:keystone#admin_version_service\n[pipeline:public_version_api]\npipeline = cors sizelimit osprofiler url_normalize public_version_service\n[pipeline:admin_version_api]\npipeline = cors sizelimit osprofiler url_normalize admin_version_service\n[composite:main]\nuse = egg:Paste#urlmap\n/v2.0 = public_api\n/v3 = api_v3\n/ = public_version_api\n[composite:admin]\nuse = egg:Paste#urlmap\n/v2.0 = admin_api\n/v3 = api_v3\n/ = admin_version_api\nroot@controller:~#\n\n```", "```\nroot@controller:~# openstack --os-auth-url http://controller:35357/v3 --os-project-domain-name default --os-user-domain-name default --os-project-name admin --os-username admin token issue\n+------------+----------------------------------+\n| Field      | Value                            |\n+------------+----------------------------------+\n| expires    | 2017-04-26 18:29:03+00:00        |\n| id         | gAAAAABZMIdwefsdfB8e4rFk5IALgM4U |\n| project_id | 123c1e6f33584dd1876c0a34249a6e11 |\n| user_id    | cc14c5dbbd654c438e52d38efaf4f1a6 |\n+------------+----------------------------------+\nroot@controller:~# openstack --os-auth-url http://controller:5000/v3 --os-project-domain-name default --os-user-domain-name default --os-project-name kvm --os-username kvm token issue\n+------------+----------------------------------+\n| Field      | Value                            |\n+------------+----------------------------------+\n| expires    | 2017-04-26 18:29:52+00:00        |\n| id         | gAAAAABZANkQmInUifl6Up_PzdH_9OHd |\n| project_id | 10a92eccbad9439d9e56c4edda6b211f |\n| user_id    | a186b226ed1e4717b25bb978f2bc9958 |\n+------------+----------------------------------+\nroot@controller:~#\n\n```", "```\nroot@controller:~# cat rc.admin\nexport OS_PROJECT_DOMAIN_NAME=default\nexport OS_USER_DOMAIN_NAME=default\nexport OS_PROJECT_NAME=admin\nexport OS_USERNAME=admin\nexport OS_PASSWORD=lxcpassword\nexport OS_AUTH_URL=http://controller:35357/v3\nexport OS_IDENTITY_API_VERSION=3\nexport OS_IMAGE_API_VERSION=2\nroot@controller:~#\nroot@controller:~# cat rc.kvm\nexport OS_PROJECT_DOMAIN_NAME=default\nexport OS_USER_DOMAIN_NAME=default\nexport OS_PROJECT_NAME=kvm\nexport OS_USERNAME=kvm\nexport OS_PASSWORD=lxcpassword\nexport OS_AUTH_URL=http://controller:5000/v3\nexport OS_IDENTITY_API_VERSION=3\nexport OS_IMAGE_API_VERSION=2\nroot@controller:~#\n\n```", "```\nroot @ controller: ~ #. rc.admin \nroot @ controller: ~ #\n\n```", "```\nroot@controller:~# openstack token issue\n\n+------------+----------------------------------+\n| Field      | Value                            |\n+------------+----------------------------------+\n| expires    | 2017-04-26 18:30:41+00:00        |\n| id         | gAAAAABZANlBdsu-DTmz6ME2Z8JFKjJM |\n| project_id | 123c1e6f33584dd1876c0a34249a6e11 |\n| user_id    | cc14c5dbbd654c438e52d38efaf4f1a6 |\n+------------+----------------------------------+\nroot@controller:~#\n\n```", "```\nroot@controller:~# mysql -u root -plxcpassword\nMariaDB [(none)]> CREATE DATABASE glance;\nQuery OK, 1 row affected (0.00 sec)\nMariaDB [(none)]> GRANT ALL PRIVILEGES ON glance.* TO 'glance'@'localhost' IDENTIFIED BY 'lxcpassword';\nQuery OK, 0 rows affected (0.00 sec)\nMariaDB [(none)]> GRANT ALL PRIVILEGES ON glance.* TO 'glance'@'%' IDENTIFIED BY 'lxcpassword';\nQuery OK, 0 rows affected (0.00 sec)\nMariaDB [(none)]> exit\nBye\nroot@controller:~#\n\n```", "```\nroot@controller:~# openstack user create --domain default --password-prompt glance\nUser Password:\nRepeat User Password:\n+---------------------+----------------------------------+\n| Field               | Value                            |\n+---------------------+----------------------------------+\n| domain_id           | default                          |\n| enabled             | True                             |\n| id                  | e566c6e2012148daa374cd68077b38df |\n| name                | glance                           |\n| password_expires_at | None                             |\n+---------------------+----------------------------------+\nroot@controller:~# openstack role add --project service --user glance admin\nroot@controller:~#\n\n```", "```\nroot@controller:~# openstack service create --name glance --description \"OpenStack Image\" image\n+-------------+----------------------------------+\n| Field       | Value                            |\n+-------------+----------------------------------+\n| description | OpenStack Image                  |\n| enabled     | True                             |\n| id          | d4d42a586551461c8b445b927f2144e1 |\n| name        | glance                           |\n| type        | image                            |\n+-------------+----------------------------------+\nroot@controller:~#\n\n```", "```\nroot@controller:~# openstack endpoint create --region RegionOne image public http://controller:9292\n+--------------+----------------------------------+\n| Field        | Value                            |\n+--------------+----------------------------------+\n| enabled      | True                             |\n| id           | 618af0c845194f508752f230364d6e0e |\n| interface    | public                           |\n| region       | RegionOne                        |\n| region_id    | RegionOne                        |\n| service_id   | d4d42a586551461c8b445b927f2144e1 |\n| service_name | glance                           |\n| service_type | image                            |\n| url          | http://controller:9292           |\n+--------------+----------------------------------+\nroot@controller:~# openstack endpoint create --region RegionOne image internal http://controller:9292\n+--------------+----------------------------------+\n| Field        | Value                            |\n+--------------+----------------------------------+\n| enabled      | True                             |\n| id           | 991a1b03f7194139b98bafe19acf3518 |\n| interface    | internal                         |\n| region       | RegionOne                        |\n| region_id    | RegionOne                        |\n| service_id   | d4d42a586551461c8b445b927f2144e1 |\n| service_name | glance                           |\n| service_type | image                            |\n| url          | http://controller:9292           |\n+--------------+----------------------------------+\nroot@controller:~# openstack endpoint create --region RegionOne image admin http://controller:9292\n+--------------+----------------------------------+\n| Field        | Value                            |\n+--------------+----------------------------------+\n| enabled      | True                             |\n| id           | 991a1b03f7194139b98bafe19acf3322 |\n| interface    | admin                            |\n| region       | RegionOne                        |\n| region_id    | RegionOne                        |\n| service_id   | d4d42a586551461c8b445b927f2144e1 |\n| service_name | glance                           |\n| service_type | image                            |\n| url          | http://controller:9292           |\n+--------------+----------------------------------+\nroot@controller:~# \n\n```", "```\nroot@controller:~# apt install glance\n\n```", "```\nroot@controller:~# cat /etc/glance/glance-api.conf\n[DEFAULT]\n[cors]\n[cors.subdomain]\n\n[database]\nconnection = mysql+pymysql://glance:lxcpassword@controller/glance\n\n[glance_store]\nstores = file,http\ndefault_store = file\nfilesystem_store_datadir = /var/lib/glance/images/\n\n[image_format]\ndisk_formats = ami,ari,aki,vhd,vhdx,vmdk,raw,qcow2,vdi,iso,root-tar\n\n[keystone_authtoken]\nauth_uri = http://controller:5000\nauth_url = http://controller:35357\nmemcached_servers = controller:11211\nauth_type = password\nproject_domain_name = default\nuser_domain_name = default\nproject_name = service\nusername = glance\npassword = lxcpassword\n\n[matchmaker_redis]\n[oslo_concurrency]\n[oslo_messaging_amqp]\n[oslo_messaging_notifications]\n[oslo_messaging_rabbit]\n[oslo_messaging_zmq]\n[oslo_middleware]\n[oslo_policy]\n[paste_deploy]\nflavor = keystone\n\n[profiler]\n[store_type_location_strategy]\n[task]\n[taskflow_executor]\nroot@controller:~#\nroot@controller:~# cat /etc/glance/glance-registry.conf\n[DEFAULT]\n\n[database]\nconnection = mysql+pymysql://glance:lxcpassword@controller/glance\n\n[keystone_authtoken]\nauth_uri = http://controller:5000\nauth_url = http://controller:35357\nmemcached_servers = controller:11211\nauth_type = password\nproject_domain_name = default\nuser_domain_name = default\nproject_name = service\nusername = glance\npassword = lxcpassword\n\n[matchmaker_redis]\n[oslo_messaging_amqp]\n[oslo_messaging_notifications]\n[oslo_messaging_rabbit]\n[oslo_messaging_zmq]\n[oslo_policy]\n[paste_deploy]\nflavor = keystone\n\n[profiler]\nroot@controller:~#\n\n```", "```\nroot@controller:~# su -s /bin/sh -c \"glance-manage db_sync\" glance\n...\nroot@controller:~#\n\n```", "```\nroot@controller:~# service glance-registry restart\nroot@controller:~# service glance-api restart\nroot@controller:~#\n\n```", "```\nroot@controller:~# wget https://uec-images.ubuntu.com/releases/16.04/release-20170330/ubuntu-16.04-server-cloudimg-amd64-disk1.img\nSaving to: ‘ubuntu-16.04-server-cloudimg-amd64-disk1.img’\nubuntu-16.04-server-cloudimg-amd64-disk1.img 100%[===================================================>] 309.75M 31.1MB/s in 13s\n\n2017-04-26 17:40:21 (24.5 MB/s) - ‘ubuntu-16.04-server-cloudimg-amd64-disk1.img’ saved [324796416/324796416]\nroot@controller:~#\n\n```", "```\nroot@controller:~# openstack image create \"ubuntu_16.04\" --file ubuntu-16.04-server-cloudimg-amd64-disk1.img --disk-format qcow2 --container-format bare --public\n+------------------+------------------------------------------------------+\n| Field            | Value                                                |\n+------------------+------------------------------------------------------+\n| checksum         | 87b0b7a4b03dd0bb2177d5cc02c80720                     |\n| container_format | bare                                                 |\n| created_at       | 2017-04-26T17:41:44Z                                 |\n| disk_format      | qcow2                                                |\n| file             | /v2/images/abce08d2-2f9f-4545-a414-32019d41c0cd/file |\n| id               | abce08d2-2f9f-4545-a414-32019d41c0cd                 |\n| min_disk         | 0                                                    |\n| min_ram          | 0                                                    |\n| name             | ubuntu_16.04                                         |\n| owner            | 123c1e6f33584dd1876c0a34249a6e11                     |\n| protected        | False                                                |\n| schema           | /v2/schemas/image                                    |\n| size             | 324796416                                            |\n| status           | active                                               |\n| tags             |                                                      |\n| updated_at       | 2017-04-26T17:41:45Z                                 |\n| virtual_size     | None                                                 |\n| visibility       | public                                               |\n+------------------+------------------------------------------------------+\nroot@controller:~#\n\n```", "```\nroot@controller:~# openstack image list\n+--------------------------------------+--------------+--------+\n| ID                                   | Name         | Status |\n+--------------------------------------+--------------+--------+\n| abce08d2-2f9f-4545-a414-32019d41c0cd | ubuntu_16.04 | active |\n+--------------------------------------+--------------+--------+\nroot@controller:~# ls -lah /var/lib/glance/images/\ndrwxr-xr-x 2 glance glance 4.0K Apr 26 17:51 .\ndrwxr-xr-x 4 glance glance 4.0K Apr 26 17:32 ..\n-rw-r----- 1 glance glance 310M Apr 26 17:41 abce08d2-2f9f-4545-a414-32019d41c0cd\nroot@controller:~# qemu-img info /var/lib/glance/images/abce08d2-2f9f-4545-a414-32019d41c0cd\nimage: /var/lib/glance/images/abce08d2-2f9f-4545-a414-32019d41c0cd\nfile format: qcow2\nvirtual size: 2.2G (2361393152 bytes)\ndisk size: 310M\ncluster_size: 65536\nFormat specific information:\n compat: 0.10\n refcount bits: 16\nroot@controller:~# \n\n```", "```\nroot@controller:~# mysql -u root -plxcpassword\nMariaDB [(none)]> CREATE DATABASE nova_api;\nQuery OK, 1 row affected (0.00 sec)\nMariaDB [(none)]> CREATE DATABASE nova;\nQuery OK, 1 row affected (0.00 sec)\nMariaDB [(none)]> GRANT ALL PRIVILEGES ON nova_api.* TO 'nova'@'localhost' IDENTIFIED BY 'lxcpassword';\nQuery OK, 0 rows affected (0.03 sec)\nMariaDB [(none)]> GRANT ALL PRIVILEGES ON nova_api.* TO 'nova'@'%' IDENTIFIED BY 'lxcpassword';\nQuery OK, 0 rows affected (0.00 sec)\nMariaDB [(none)]> GRANT ALL PRIVILEGES ON nova.* TO 'nova'@'localhost' IDENTIFIED BY 'lxcpassword';\nQuery OK, 0 rows affected (0.00 sec)\nMariaDB [(none)]> GRANT ALL PRIVILEGES ON nova.* TO 'nova'@'%' IDENTIFIED BY 'lxcpassword';\nQuery OK, 0 rows affected (0.00 sec)\nMariaDB [(none)]> exit\nBye\nroot@controller:~#\n\n```", "```\nroot@controller:~# openstack user create --domain default --password-prompt nova\nUser Password:\nRepeat User Password:\n+---------------------+----------------------------------+\n| Field               | Value                            |\n+---------------------+----------------------------------+\n| domain_id           | default                          |\n| enabled             | True                             |\n| id                  | 038aa8840aca449dbd3e653c5d2c5a08 |\n| name                | nova                             |\n| password_expires_at | None                             |\n+---------------------+----------------------------------+\nroot@controller:~# openstack role add --project service --user nova admin\nroot@controller:~#\n\n```", "```\nroot@controller:~# openstack service create --name nova --description \"OpenStack Compute\" compute\n+-------------+----------------------------------+\n| Field       | Value                            |\n+-------------+----------------------------------+\n| description | OpenStack Compute                |\n| enabled     | True                             |\n| id          | 04132edd7f654f56ba0cc23ac182c9aa |\n| name        | nova                             |\n| type        | compute                          |\n+-------------+----------------------------------+\nroot@controller:~# openstack endpoint create --region RegionOne compute public http://controller:8774/v2.1/%(tenant_id)s\n+--------------+-------------------------------------------+\n| Field        | Value                                     |\n+--------------+-------------------------------------------+\n| enabled      | True                                      |\n| id           | 5fc54236c324412db135dff88807e820          |\n| interface    | public                                    |\n| region       | RegionOne                                 |\n| region_id    | RegionOne                                 |\n| service_id   | 04132edd7f654f56ba0cc23ac182c9aa          |\n| service_name | nova                                      |\n| service_type | compute                                   |\n| url          | http://controller:8774/v2.1/%(tenant_id)s |\n+--------------+-------------------------------------------+\nroot@controller:~# openstack endpoint create --region RegionOne compute internal http://controller:8774/v2.1/%(tenant_id)s\n+--------------+-------------------------------------------+\n| Field        | Value                                     |\n+--------------+-------------------------------------------+\n| enabled      | True                                      |\n| id           | a0f623ed345e4bdb8fced929b7fe6b3f          |\n| interface    | internal                                  |\n| region       | RegionOne                                 |\n| region_id    | RegionOne                                 |\n| service_id   | 04132edd7f654f56ba0cc23ac182c9aa          |\n| service_name | nova                                      |\n| service_type | compute                                   |\n| url          | http://controller:8774/v2.1/%(tenant_id)s |\n+--------------+-------------------------------------------+\nroot@controller:~# openstack endpoint create --region RegionOne compute admin http://controller:8774/v2.1/%(tenant_id)s\n+--------------+-------------------------------------------+\n| Field        | Value                                     |\n+--------------+-------------------------------------------+\n| enabled      | True                                      |\n| id           | 3964db0d281545acbaa6c18abc44a216          |\n| interface    | admin                                     |\n| region       | RegionOne                                 |\n| region_id    | RegionOne                                 |\n| service_id   | 04132edd7f654f56ba0cc23ac182c9aa          |\n| service_name | nova                                      |\n| service_type | compute                                   |\n| url          | http://controller:8774/v2.1/%(tenant_id)s |\n+--------------+-------------------------------------------+\nroot@controller:~#\n\n```", "```\nroot@controller:~# apt install nova-api nova-conductor nova-consoleauth nova-novncproxy nova-scheduler\n\n```", "```\nroot@controller:~# cat /etc/nova/nova.conf\n[DEFAULT]\ndhcpbridge_flagfile=/etc/nova/nova.conf\ndhcpbridge=/usr/bin/nova-dhcpbridge\nlog-dir=/var/log/nova\nstate_path=/var/lib/nova\nforce_dhcp_release=True\nverbose=True\nec2_private_dns_show_ip=True\nenabled_apis=osapi_compute,metadata\ntransport_url = rabbit://openstack:lxcpassword@controller\nauth_strategy = keystone\nmy_ip = 10.208.132.45\nuse_neutron = True\nfirewall_driver = nova.virt.firewall.NoopFirewallDriver\n\n[database]\nconnection = mysql+pymysql://nova:lxcpassword@controller/nova\n\n[api_database]\nconnection = mysql+pymysql://nova:lxcpassword@controller/nova_api\n\n[oslo_concurrency]\nlock_path = /var/lib/nova/tmp\n\n[libvirt]\nuse_virtio_for_bridges=True\n\n[wsgi]\napi_paste_config=/etc/nova/api-paste.ini\n\n[keystone_authtoken]\nauth_uri = http://controller:5000\nauth_url = http://controller:35357\nmemcached_servers = controller:11211\nauth_type = password\nproject_domain_name = default\nuser_domain_name = default\nproject_name = service\nusername = nova\npassword = lxcpassword\n\n[vnc]\nvncserver_listen = $my_ip\nvncserver_proxyclient_address = $my_ip\n\n[glance]\napi_servers = http://controller:9292\nroot@controller:~#\n\n```", "```\nroot@controller:~# su -s /bin/sh -c \"nova-manage api_db sync\" nova\n...\nroot@controller:~# su -s /bin/sh -c \"nova-manage db sync\" nova\n...\nroot@controller:~#\n\n```", "```\nroot@controller:~# service nova-api restart\nroot@controller:~# service nova-consoleauth restart\nroot@controller:~# service nova-scheduler restart\nroot@controller:~# service nova-conductor restart\nroot@controller:~# service nova-novncproxy restart\nroot@controller:~#\n\n```", "```\nroot@controller:~# apt install nova-compute\n\n```", "```\nroot@controller:~# cat /etc/nova/nova.conf\n[DEFAULT]\ndhcpbridge_flagfile=/etc/nova/nova.conf\ndhcpbridge=/usr/bin/nova-dhcpbridge\nlog-dir=/var/log/nova\nstate_path=/var/lib/nova\nforce_dhcp_release=True\nverbose=True\nec2_private_dns_show_ip=True\nenabled_apis=osapi_compute,metadata\ntransport_url = rabbit://openstack:lxcpassword@controller\nauth_strategy = keystone\nmy_ip = 10.208.132.45\nuse_neutron = True\nfirewall_driver = nova.virt.firewall.NoopFirewallDriver\ncompute_driver = libvirt.LibvirtDriver\n\n[database]\nconnection = mysql+pymysql://nova:lxcpassword@controller/nova\n\n[api_database]\nconnection = mysql+pymysql://nova:lxcpassword@controller/nova_api\n\n[oslo_concurrency]\nlock_path = /var/lib/nova/tmp\n\n[libvirt]\nuse_virtio_for_bridges=True\n\n[wsgi]\napi_paste_config=/etc/nova/api-paste.ini\n\n[keystone_authtoken]\nauth_uri = http://controller:5000\nauth_url = http://controller:35357\nmemcached_servers = controller:11211\nauth_type = password\nproject_domain_name = default\nuser_domain_name = default\nproject_name = service\nusername = nova\npassword = lxcpassword\n\n[vnc]\nenabled = True\nvncserver_listen = $my_ip\nvncserver_proxyclient_address = $my_ip\nnovncproxy_base_url = http://controller:6080/vnc_auto.html\n\n[glance]\napi_servers = http://controller:9292\n\nroot@controller:~#\n\n```", "```\nroot@controller:~# cat /etc/nova/nova-compute.conf\n[DEFAULT]\ncompute_driver=libvirt.LibvirtDriver\n[libvirt]\nvirt_type=kvm\nroot@controller:~# \n\n```", "```\nroot@controller:~# service nova-compute restart\nroot@controller:~# openstack compute service list\n+----+------------------+------------+----------+---------+-------+----------------------+\n| ID | Binary           | Host       | Zone     | Status  | State | Updated At           |\n+----+------------------+------------+----------+---------+-------+----------------------+\n| 8  | nova-consoleauth | controller | internal | enabled | up    | 2017-04-26T17:58     |\n| 9  | nova-scheduler   | controller | internal | enabled | up    | 2017-04-26T17:58     |\n| 10 | nova-conductor   | controller | internal | enabled | up    | 2017-04-26T17:58     |\n| 15 | nova-compute     | controller | nova     | enabled | up    | None                 |\n+----+------------------+------------+----------+---------+-------+----------------------+\nroot@controller:~# pgrep -lf nova | uniq -f1\n14110 nova-consoleaut\n14176 nova-conductor\n14239 nova-novncproxy\n20877 nova-api\n20994 nova-scheduler\n21065 nova-compute\nroot@controller:~#\n\n```", "```\nroot@controller:~# mysql -u root -plxcpassword\nMariaDB [(none)]> CREATE DATABASE neutron;\nQuery OK, 1 row affected (0.00 sec)\nMariaDB [(none)]> GRANT ALL PRIVILEGES ON neutron.* TO 'neutron'@'localhost' IDENTIFIED BY 'lxcpassword';\nQuery OK, 0 rows affected (0.00 sec)\nMariaDB [(none)]> GRANT ALL PRIVILEGES ON neutron.* TO 'neutron'@'%' IDENTIFIED BY 'lxcpassword';\nQuery OK, 0 rows affected (0.00 sec)\nMariaDB [(none)]> exit\nBye\nroot@controller:~#\n\n```", "```\nroot@controller:~# openstack user create --domain default --password-prompt neutron\nUser Password:\nRepeat User Password:\n+---------------------+----------------------------------+\n| Field               | Value                            |\n+---------------------+----------------------------------+\n| domain_id           | default                          |\n| enabled             | True                             |\n| id                  | 02934ad74c94461482b95fff32d36894 |\n| name                | neutron                          |\n| password_expires_at | None                             |\n+---------------------+----------------------------------+\nroot@controller:~# openstack role add --project service --user neutron admin\nroot@controller:~#\n\n```", "```\nroot@controller:~# openstack service create --name neutron --description \"OpenStack Networking\" network\n+-------------+----------------------------------+\n| Field       | Value                            |\n+-------------+----------------------------------+\n| description | OpenStack Networking             |\n| enabled     | True                             |\n| id          | 24b32d32d4b54e3ab2d785a1817b8e7e |\n| name        | neutron                          |\n| type        | network                          |\n+-------------+----------------------------------+\nroot@controller:~# openstack endpoint create --region RegionOne network public http://controller:9696\n+--------------+----------------------------------+\n| Field        | Value                            |\n+--------------+----------------------------------+\n| enabled      | True                             |\n| id           | 544821d511e04847869fc601f2ebf0f7 |\n| interface    | public                           |\n| region       | RegionOne                        |\n| region_id    | RegionOne                        |\n| service_id   | 24b32d32d4b54e3ab2d785a1817b8e7e |\n| service_name | neutron                          |\n| service_type | network                          |\n| url          | http://controller:9696           |\n+--------------+----------------------------------+\nroot@controller:~# openstack endpoint create --region RegionOne network internal http://controller:9696\n+--------------+----------------------------------+\n| Field        | Value                            |\n+--------------+----------------------------------+\n| enabled      | True                             |\n| id           | 05e276ec603f424f85be8705ce7fe86a |\n| interface    | internal                         |\n| region       | RegionOne                        |\n| region_id    | RegionOne                        |\n| service_id   | 24b32d32d4b54e3ab2d785a1817b8e7e |\n| service_name | neutron                          |\n| service_type | network                          |\n| url          | http://controller:9696           |\n+--------------+----------------------------------+\nroot@controller:~# openstack endpoint create --region RegionOne network admin http://controller:9696\n+--------------+----------------------------------+\n| Field        | Value                            |\n+--------------+----------------------------------+\n| enabled      | True                             |\n| id           | 836b4309186146fb9143544490cd0bc1 |\n| interface    | admin                            |\n| region       | RegionOne                        |\n| region_id    | RegionOne                        |\n| service_id   | 24b32d32d4b54e3ab2d785a1817b8e7e |\n| service_name | neutron                          |\n| service_type | network                          |\n| url          | http://controller:9696           |\n+--------------+----------------------------------+\nroot@controller:~#\n\n```", "```\nroot@controller:~# apt install neutron-server neutron-plugin-ml2 neutron-linuxbridge-agent neutron-l3-agent neutron-dhcp-agent neutron-metadata-agent\n...\nroot@controller:~#\n\n```", "```\nroot@controller:~# cat /etc/neutron/neutron.conf\n[DEFAULT]\ncore_plugin = ml2\nservice_plugins = router\nallow_overlapping_ips = True\ntransport_url = rabbit://openstack:lxcpassword@controller\nauth_strategy = keystone\nnotify_nova_on_port_status_changes = True\nnotify_nova_on_port_data_changes = True\n\n[agent]\nroot_helper = sudo /usr/bin/neutron-rootwrap /etc/neutron/rootwrap.conf\n\n[cors]\n[cors.subdomain]\n[database]\nconnection = mysql+pymysql://neutron:lxcpassword@controller/neutron\n\n[keystone_authtoken]\nauth_uri = http://controller:5000\nauth_url = http://controller:35357\nmemcached_servers = controller:11211\nauth_type = password\nproject_domain_name = default\nuser_domain_name = default\nproject_name = service\nusername = neutron\npassword = lxcpassword\n\n[matchmaker_redis]\n[nova]\nauth_url = http://controller:35357\nauth_type = password\nproject_domain_name = default\nuser_domain_name = default\nregion_name = RegionOne\nproject_name = service\nusername = nova\npassword = lxcpassword\n\n[oslo_concurrency]\n[oslo_messaging_amqp]\n[oslo_messaging_notifications]\n[oslo_messaging_rabbit]\n[oslo_messaging_zmq]\n[oslo_policy]\n[qos]\n[quotas]\n[ssl]\nroot@controller:~#\n\n```", "```\nroot@controller:~# cat /etc/neutron/plugins/ml2/ml2_conf.ini\n[DEFAULT]\n[ml2]\ntype_drivers = flat,vlan,vxlan\ntenant_network_types = vxlan\nmechanism_drivers = linuxbridge,l2population\nextension_drivers = port_security\n\n[ml2_type_flat]\nflat_networks = provider\n\n[ml2_type_geneve]\n[ml2_type_gre]\n[ml2_type_vlan]\n[ml2_type_vxlan]\nvni_ranges = 1:1000\n\n[securitygroup]\nenable_ipset = True\nroot@controller:~#\n\n```", "```\nroot@controller:~# cat /etc/neutron/plugins/ml2/linuxbridge_agent.ini\n[DEFAULT]\n[agent]\n[linux_bridge]\nphysical_interface_mappings = provider:eth1\n\n[securitygroup]\nenable_security_group = True\nfirewall_driver = neutron.agent.linux.iptables_firewall.IptablesFirewallDriver\n\n[vxlan]\nenable_vxlan = True\nlocal_ip = 10.208.132.45\nl2_population = True\nroot@controller:~#\n\n```", "```\nroot@controller:~# cat /etc/neutron/l3_agent.ini\n[DEFAULT]\ninterface_driver = neutron.agent.linux.interface.BridgeInterfaceDriver\n\n[AGENT]\nroot@controller:~#\n\n```", "```\nroot@controller:~# cat /etc/neutron/dhcp_agent.ini\n[DEFAULT]\ninterface_driver = neutron.agent.linux.interface.BridgeInterfaceDriver\ndhcp_driver = neutron.agent.linux.dhcp.Dnsmasq\nenable_isolated_metadata = True\n\n[AGENT]\nroot@controller:~#\n\n```", "```\nroot@controller:~# cat /etc/neutron/metadata_agent.ini [DEFAULT]\nnova_metadata_ip = controller\nmetadata_proxy_shared_secret = lxcpassword\n\n[AGENT]\n[cache]\nroot@controller:~#\n\n```", "```\nroot@controller:~# cat /etc/nova/nova.conf\n[DEFAULT]\ndhcpbridge_flagfile=/etc/nova/nova.conf\ndhcpbridge=/usr/bin/nova-dhcpbridge\nlog-dir=/var/log/nova\nstate_path=/var/lib/nova\nforce_dhcp_release=True\nverbose=True\nec2_private_dns_show_ip=True\nenabled_apis=osapi_compute,metadata\ntransport_url = rabbit://openstack:lxcpassword@controller\nauth_strategy = keystone\nmy_ip = 10.208.132.45\nuse_neutron = True\nfirewall_driver = nova.virt.firewall.NoopFirewallDriver\ncompute_driver = libvirt.LibvirtDriver\nscheduler_default_filters = RetryFilter, AvailabilityZoneFilter, RamFilter, ComputeFilter, ComputeCapabilitiesFilter, ImagePropertiesFilter, ServerGroupAntiAffinityFilter, ServerGroupAffinityFilter\n\n[database]\nconnection = mysql+pymysql://nova:lxcpassword@controller/nova\n\n[api_database]\nconnection = mysql+pymysql://nova:lxcpassword@controller/nova_api\n\n[oslo_concurrency]\nlock_path = /var/lib/nova/tmp\n\n[libvirt]\nuse_virtio_for_bridges=True\n\n[wsgi]\napi_paste_config=/etc/nova/api-paste.ini\n\n[keystone_authtoken]\nauth_uri = http://controller:5000\nauth_url = http://controller:35357\nmemcached_servers = controller:11211\nauth_type = password\nproject_domain_name = default\nuser_domain_name = default\nproject_name = service\nusername = nova\npassword = lxcpassword\n\n[vnc]\nenabled = True\nvncserver_listen = $my_ip\nvncserver_proxyclient_address = $my_ip\nnovncproxy_base_url = http://controller:6080/vnc_auto.html\n\n[glance]\napi_servers = http://controller:9292\n\n[libvirt]\nvirt_type = kvm\n\n[neutron]\nurl = http://controller:9696\nauth_url = http://controller:35357\nauth_type = password\nproject_domain_name = default\nuser_domain_name = default\nregion_name = RegionOne\nproject_name = service\nusername = neutron\npassword = lxcpassword\nservice_metadata_proxy = True\nmetadata_proxy_shared_secret = lxcpassword\nroot@controller:~#\n\n```", "```\nroot@controller:~# su -s /bin/sh -c \"neutron-db-manage --config-file /etc/neutron/neutron.conf --config-file /etc/neutron/plugins/ml2/ml2_conf.ini upgrade head\" neutron\nINFO [alembic.runtime.migration] Context impl MySQLImpl.\nINFO [alembic.runtime.migration] Will assume non-transactional DDL.\n Running upgrade for neutron ...\nINFO [alembic.runtime.migration] Context impl MySQLImpl.\nINFO [alembic.runtime.migration] Will assume non-transactional DDL.\nINFO [alembic.runtime.migration] Running upgrade -> kilo, kilo_initial\n...\nroot@controller:~#\n\n```", "```\nroot@controller:~# service neutron-server restart\nroot@controller:~# service neutron-linuxbridge-agent restart\nroot@controller:~# service neutron-dhcp-agent restart\nroot@controller:~# service neutron-metadata-agent restart\nroot@controller:~# service neutron-l3-agent restart\nroot@controller:~# service nova-api restart\nroot@controller:~# service nova-compute restart\nroot@controller:~#\n\n```", "```\nroot@controller:~# openstack network agent list\n+--------------------------------------+--------------------+------+-------------------+-------+-------+---------------------------+\n| ID | Agent Type | Host | Availability Zone | Alive | State | Binary |\n+--------------------------------------+--------------------+------+-------------------+-------+-------+---------------------------+\n| 9242d71d-de25-4b3e-8aa8-62691ef72001 | Linux bridge agent | kvm2 | None | True | UP | neutron-linuxbridge-agent |\n| 92b601de-06df-4b10-88c7-8f27bc48f6ab | L3 agent | kvm2 | nova | True | UP | neutron-l3-agent |\n| d249f986-9b26-4c5d-8ea5-311daf3b395d | DHCP agent | kvm2 | nova | True | UP | neutron-dhcp-agent |\n| f3cac79b-a7c3-4672-b846-9268f2d58706 | Metadata agent | kvm2 | None | True | UP | neutron-metadata-agent |\n+--------------------------------------+--------------------+------+-------------------+-------+-------+---------------------------+\nroot@controller:~#\n\n```", "```\nroot@controller:~# openstack network create nat\n+---------------------------+--------------------------------------+\n| Field                     | Value                                |\n+---------------------------+--------------------------------------+\n| admin_state_up            | UP                                   |\n| availability_zone_hints   |                                      |\n| availability_zones        |                                      |\n| created_at                | 2017-04-26T18:17:24Z                 |\n| description               |                                      |\n| headers                   |                                      |\n| id                        | b7ccb514-21fc-4ced-b74f-026e7e358bba |\n| ipv4_address_scope        | None                                 |\n| ipv6_address_scope        | None                                 |\n| mtu                       | 1450                                 |\n| name                      | nat                                  |\n| port_security_enabled     | True                                 |\n| project_id                | 123c1e6f33584dd1876c0a34249a6e11     |\n| project_id                | 123c1e6f33584dd1876c0a34249a6e11     |\n| provider:network_type     | vxlan                                |\n| provider:physical_network | None                                 |\n| provider:segmentation_id  | 37                                   |\n| revision_number           | 3                                    |\n| router:external           | Internal                             |\n| shared                    | False                                |\n| status                    | ACTIVE                               |\n| subnets                   |                                      |\n| tags                      | []                                   |\n| updated_at                | 2017-04-26T18:17:24Z                 |\n+---------------------------+--------------------------------------+\nroot@controller:~#\n\n```", "```\nroot@controller:~# openstack subnet create --network nat --dns-nameserver 8.8.8.8 --gateway 192.168.0.1 --subnet-range 192.168.0.0/24 nat\n+-------------------+--------------------------------------+\n| Field             | Value                                |\n+-------------------+--------------------------------------+\n| allocation_pools  | 192.168.0.2-192.168.0.254            |\n| cidr              | 192.168.0.0/24                       |\n| created_at        | 2017-04-26T18:17:41Z                 |\n| description       |                                      |\n| dns_nameservers   | 8.8.8.8                              |\n| enable_dhcp       | True                                 |\n| gateway_ip        | 192.168.0.1                          |\n| headers           |                                      |\n| host_routes       |                                      |\n| id                | 296250a7-f241-4f84-adbb-64a45c943094 |\n| ip_version        | 4                                    |\n| ipv6_address_mode | None                                 |\n| ipv6_ra_mode      | None                                 |\n| name              | nat                                  |\n| network_id        | b7ccb514-21fc-4ced-b74f-026e7e358bba |\n| project_id        | 123c1e6f33584dd1876c0a34249a6e11     |\n| project_id        | 123c1e6f33584dd1876c0a34249a6e11     |\n| revision_number   | 2                                    |\n| service_types     | []                                   |\n| subnetpool_id     | None                                 |\n| updated_at        | 2017-04-26T18:17:41Z                 |\n+-------------------+--------------------------------------+\nroot@controller:~#\n\n```", "```\nroot@controller:~# neutron net-update nat --router:external\nUpdated network: nat\nroot@controller:~#\n\n```", "```\nroot@controller:~# openstack router create router\n\n+-------------------------+--------------------------------------+\n| Field                   | Value                                |\n+-------------------------+--------------------------------------+\n| admin_state_up          | UP                                   |\n| availability_zone_hints |                                      |\n| availability_zones      |                                      |\n| created_at              | 2017-04-26T18:18:05Z                 |\n| description             |                                      |\n| external_gateway_info   | null                                 |\n| flavor_id               | None                                 |\n| headers                 |                                      |\n| id                      | f9cd8c96-a53c-4585-ad21-0e409f3b4d70 |\n| name                    | router                               |\n| project_id              | 10a92eccbad9439d9e56c4edda6b211f     |\n| project_id              | 10a92eccbad9439d9e56c4edda6b211f     |\n| revision_number         | 3                                    |\n| routes                  |                                      |\n| status                  | ACTIVE                               |\n| updated_at              | 2017-04-26T18:18:05Z                 |\n+-------------------------+--------------------------------------+\nroot@controller:~#\n\n```", "```\nroot@controller:~# . rc.admin\nroot@controller:~# neutron router-interface-add router nat\nAdded interface 2e1e2fd3-1819-489b-a21f-7005862f9de7 to router router.\nroot@controller:~#\n\n```", "```\nroot@controller:~# ip netns\nqrouter-f9cd8c96-a53c-4585-ad21-0e409f3b4d70\nqdhcp-b7ccb514-21fc-4ced-b74f-026e7e358bba\nroot@controller:~#\n\n```", "```\nroot@controller:~# neutron router-port-list router\n+--------------------------------------+------+-------------------+------------------------------------------------------------------------------------+\n| id | name | mac_address | fixed_ips |\n+--------------------------------------+------+-------------------+------------------------------------------------------------------------------------+\n| 2e1e2fd3-1819-489b-a21f-7005862f9de7 | | fa:16:3e:0e:db:14 | {\"subnet_id\": \"296250a7-f241-4f84-adbb-64a45c943094\", \"ip_address\": \"192.168.0.1\"} |\n+--------------------------------------+------+-------------------+------------------------------------------------------------------------------------+\nroot@controller:~#\n\n```", "```\nroot@controller:~# openstack network list\n+--------------------------------------+------+--------------------------------------+\n| ID                                   | Name | Subnets                              |\n+--------------------------------------+------+--------------------------------------+\n| b7ccb514-21fc-4ced-b74f-026e7e358bba | nat  | 296250a7-f241-4f84-adbb-64a45c943094 |\n+--------------------------------------+------+--------------------------------------+\nroot@controller:~#\n\n```", "```\nroot@controller:~# openstack image list\n+--------------------------------------+--------------+--------+\n| ID                                   | Name         | Status |\n+--------------------------------------+--------------+--------+\n| abce08d2-2f9f-4545-a414-32019d41c0cd | ubuntu_16.04 | active |\n+--------------------------------------+--------------+--------+\nroot@controller:~#\n\n```", "```\nroot@controller:~# openstack flavor create --id 0 --vcpus 1 --ram 1024 --disk 5000 kvm.medium\n+----------------------------+------------+\n| Field                      | Value      |\n+----------------------------+------------+\n| OS-FLV-DISABLED:disabled   | False      |\n| OS-FLV-EXT-DATA:ephemeral  | 0          |\n| disk                       | 5000       |\n| id                         | 0          |\n| name                       | kvm.medium |\n| os-flavor-access:is_public | True       |\n| properties                 |            |\n| ram                        | 1024       |\n| rxtx_factor                | 1.0        |\n| swap                       |            |\n| vcpus                      | 1          |\n+----------------------------+------------+\nroot@controller:~#\nroot@controller:~# openstack flavor list\n+----+------------+------+------+-----------+-------+-----------+\n| ID | Name       | RAM  | Disk | Ephemeral | VCPUs | Is Public |\n+----+------------+------+------+-----------+-------+-----------+\n| 0 | kvm.medium  | 1024 | 5000 | 0         | 1     | True      |\n+----+------------+------+------+-----------+-------+-----------+\nroot@controller:~#\n\n```", "```\nroot@controller:~# openstack keypair create --public-key ~/.ssh/kvm_rsa.pub kvmkey\n+-------------+-------------------------------------------------+\n| Field       | Value                                           |\n+-------------+-------------------------------------------------+\n| fingerprint | e9:7e:e6:05:8b:a4:31:c3:5e:41:65:0e:29:23:eb:2a |\n| name        | kvmkey                                          |\n| user_id     | cc14c5dbbd654c438e52d38efaf4f1a6                |\n+-------------+-------------------------------------------------+\nroot@controller:~# openstack keypair list\n+--------+-------------------------------------------------+\n| Name   | Fingerprint                                     |\n+--------+-------------------------------------------------+\n| kvmkey | e9:7e:e6:05:8b:a4:31:c3:5e:41:65:0e:29:23:eb:2a |\n+--------+-------------------------------------------------+\nroot@controller:~#\n\n```", "```\nroot@controller:~# openstack security group rule create --proto icmp default\n\n+-------------------+--------------------------------------+\n| Field             | Value                                |\n+-------------------+--------------------------------------+\n| created_at        | 2017-04-26T18:17:13Z                 |\n| description       |                                      |\n| direction         | ingress                              |\n| ethertype         | IPv4                                 |\n| headers           |                                      |\n| id                | ca28501a-1b3b-448f-8c1b-0fa6f9fa9263 |\n| port_range_max    | None                                 |\n| port_range_min    | None                                 |\n| project_id        | 123c1e6f33584dd1876c0a34249a6e11     |\n| project_id        | 123c1e6f33584dd1876c0a34249a6e11     |\n| protocol          | icmp                                 |\n| remote_group_id   | None                                 |\n| remote_ip_prefix  | 0.0.0.0/0                            |\n| revision_number   | 1                                    |\n| security_group_id | 050b8174-d961-4706-ab63-1cdd2a25fbdd |\n| updated_at        | 2017-04-26T18:17:13Z                 |\n+-------------------+--------------------------------------+\nroot@controller:~#\nroot@controller:~# openstack security group rule create --proto tcp --dst-port 22 default\n\n+-------------------+--------------------------------------+\n| Field             | Value                                |\n+-------------------+--------------------------------------+\n| created_at        | 2017-04-26T18:17:18Z                 |\n| description       |                                      |\n| direction         | ingress                              |\n| ethertype         | IPv4                                 |\n| headers           |                                      |\n| id                | 334130c3-42b2-4f1b-aba6-c46e91ad203e |\n| port_range_max    | 22                                   |\n| port_range_min    | 22                                   |\n| project_id        | 123c1e6f33584dd1876c0a34249a6e11     |\n| project_id        | 123c1e6f33584dd1876c0a34249a6e11     |\n| protocol          | tcp                                  |\n| remote_group_id   | None                                 |\n| remote_ip_prefix  | 0.0.0.0/0                            |\n| revision_number   | 1                                    |\n| security_group_id | 050b8174-d961-4706-ab63-1cdd2a25fbdd |\n| updated_at        | 2017-04-26T18:17:18Z                 |\n+-------------------+--------------------------------------+\nroot@controller:~#\n\n```", "```\nroot@controller:~# openstack network list\n+--------------------------------------+------+--------------------------------------+\n| ID                                   | Name | Subnets                              |\n+--------------------------------------+------+--------------------------------------+\n| b7ccb514-21fc-4ced-b74f-026e7e358bba | nat  | 296250a7-f241-4f84-adbb-64a45c943094 |\n+--------------------------------------+------+--------------------------------------+\nroot@controller:~#\n\n```", "```\nroot@controller:~# openstack server create --flavor kvm.medium --image ubuntu_16.04 --nic net-id=b7ccb514-21fc-4ced-b74f-026e7e358bba --security-group default --key-name kvmkey ubuntu_instance\n+--------------------------------------+-------------------------------------------+\n| Field                                | Value                                     |\n+--------------------------------------+-------------------------------------------+\n| OS-DCF:diskConfig                    | MANUAL                                    |\n| OS-EXT-AZ:availability_zone          |                                           |\n| OS-EXT-SRV-ATTR:host                 | None                                      |\n| OS-EXT-SRV-ATTR:hypervisor_hostname  | None                                      |\n| OS-EXT-SRV-ATTR:instance_name        |                                           |\n| OS-EXT-STS:power_state               | NOSTATE                                   |\n| OS-EXT-STS:task_state                | scheduling                                |\n| OS-EXT-STS:vm_state                  | building                                  |\n| OS-SRV-USG:launched_at               | None                                      |\n| OS-SRV-USG:terminated_at             | None                                      |\n| accessIPv4                           |                                           |\n| accessIPv6                           |                                           |\n| addresses                            |                                           |\n| adminPass                            | Z23yEuDLBjLe                              |\n| config_drive                         |                                           |\n| created                              | 2017-04-26T19:11:23Z                      |\n| flavor                               | kvm.medium (0)                            |\n| hostId                               |                                           |\n| id                                   | 0f4745b1-9d4b-4e8a-82f7-9eaa1f9bb08f      |\n| image                                | ubuntu_16.04 (abce08d2-a414-32019d41c0cd) |\n| key_name                             | kvmkey                                    |\n| name                                 | ubuntu_instance                           |\n| os-extended-volumes:volumes_attached | []                                        |\n| progress                             | 0                                         |\n| project_id                           | 123c1e6f33584dd1876c0a34249a6e11          |\n| properties                           |                                           |\n| security_groups                      | [{u'name': u'default'}]                   |\n| status                               | BUILD                                     |\n| updated                              | 2017-04-26T19:11:23Z                      |\n| user_id                              | cc14c5dbbd654c438e52d38efaf4f1a6          |\n+--------------------------------------+-------------------------------------------+\nroot@controller:~# openstack server list\n+---------------------+-----------------+---------+------------------+--------------+\n| ID                  | Name            | Status  | Networks         | Image Name   |\n+---------------------+-----------------+---------+------------------+--------------+\n| 0f4745b1-...-9bb08f | ubuntu_instance | BUILD   | nat=192.168.0.11 | ubuntu_16.04 |\n+---------------------+-----------------+---------+------------------+--------------+\nroot@controller:~#\n\n```", "```\nroot@controller:~# pgrep -lfa qemu\n23388 /usr/bin/qemu-system-x86_64 -name instance-00000005 -S -machine pc-i440fx-xenial,accel=kvm,usb=off -cpu Haswell-noTSX,+abm,+pdpe1gb,+rdrand,+f16c,+osxsave,+dca,+pdcm,+xtpr,+tm2,+est,+smx,+vmx,+ds_cpl,+monitor,+dtes64,+pbe,+tm,+ht,+ss,+acpi,+ds,+vme -m 1024 -realtime mlock=off -smp 1,sockets=1,cores=1,threads=1 -uuid 0f4745b1-9d4b-4e8a-82f7-9eaa1f9bb08f -smbios type=1,manufacturer=OpenStack Foundation,product=OpenStack Nova,version=14.0.4,serial=6d6366d9-4569-6233-dad6-4927587cc79f,uuid=0f4745b1-9d4b-4e8a-82f7-9eaa1f9bb08f,family=Virtual Machine -no-user-config -nodefaults -chardev socket,id=charmonitor,path=/var/lib/libvirt/qemu/domain-instance-00000005/monitor.sock,server,nowait -mon chardev=charmonitor,id=monitor,mode=control -rtc base=utc,driftfix=slew -global kvm-pit.lost_tick_policy=discard -no-hpet -no-shutdown -boot strict=on -device piix3-usb-uhci,id=usb,bus=pci.0,addr=0x1.0x2 -drive file=/var/lib/nova/instances/0f4745b1-9d4b-4e8a-82f7-9eaa1f9bb08f/disk,format=qcow2,if=none,id=drive-virtio-disk0,cache=none -device virtio-blk-pci,scsi=off,bus=pci.0,addr=0x4,drive=drive-virtio-disk0,id=virtio-disk0,bootindex=1 -netdev tap,fd=26,id=hostnet0,vhost=on,vhostfd=28 -device virtio-net-pci,netdev=hostnet0,id=net0,mac=fa:16:3e:3c:c0:0f,bus=pci.0,addr=0x3 -chardev file,id=charserial0,path=/var/lib/nova/instances/0f4745b1-9d4b-4e8a-82f7-9eaa1f9bb08f/console.log -device isa-serial,chardev=charserial0,id=serial0 -chardev pty,id=charserial1 -device isa-serial,chardev=charserial1,id=serial1 -device usb-tablet,id=input0 -vnc 0.0.0.0:0 -k en-us -device cirrus-vga,id=video0,bus=pci.0,addr=0x2 -device virtio-balloon-pci,id=balloon0,bus=pci.0,addr=0x5 -msg timestamp=on\nroot@controller:~# openstack server list\n+---------------------------+-----------------+--------+------------------+--------------+\n| ID                        | Name            | Status | Networks         | Image Name   |\n+---------------------------+-----------------+--------+------------------+--------------+\n| 0f4745b1-...-9eaa1f9bb08f | ubuntu_instance | ACTIVE | nat=192.168.0.11 | ubuntu_16.04 |\n+---------------------------+-----------------+--------+------------------+--------------+\nroot@controller:~#\n\n```", "```\nroot@controller:~# openstack server show ubuntu_instance\n+--------------------------------------+-------------------------------------------+\n| Field                                | Value                                     |\n+--------------------------------------+-------------------------------------------+\n| OS-DCF:diskConfig                    | MANUAL                                    |\n| OS-EXT-AZ:availability_zone          | nova                                      |\n| OS-EXT-SRV-ATTR:host                 | controller                                |\n| OS-EXT-SRV-ATTR:hypervisor_hostname  | controller                                |\n| OS-EXT-SRV-ATTR:instance_name        | instance-00000001                         |\n| OS-EXT-STS:power_state               | Running                                   |\n| OS-EXT-STS:task_state                | None                                      |\n| OS-EXT-STS:vm_state                  | active                                    |\n| OS-SRV-USG:launched_at               | 2017-04-26T19:11:37.000000                |\n| OS-SRV-USG:terminated_at             | None                                      |\n| accessIPv4                           |                                           |\n| accessIPv6                           |                                           |\n| addresses                            | nat=192.168.0.11                          |\n| config_drive                         |                                           |\n| created                              | 2017-04-26T19:11:23Z                      |\n| flavor                               | kvm.medium (0)                            |\n| hostId                               | c8d0t2jgdlkasdjg0iu4kjdg3o43045t          |\n| id                                   | 0f4745b1-9d4b-4e8a-82f7-9eaa1f9bb08f      |\n| image                                | ubuntu_16.04 (abce08d2-a414-32019d41c0cd) |\n| key_name                             | kvmkey                                    |\n| name                                 | ubuntu_instance                           |\n| os-extended-volumes:volumes_attached | []                                        |\n| progress                             | 0                                         |\n| project_id                           | 123c1e6f33584dd1876c0a34249a6e11          |\n| properties                           |                                           |\n| security_groups                      | [{u'name': u'default'}]                   |\n| status                               | ACTIVE                                    |\n| updated                              | 2017-04-26T19:11:23Z                      |\n| user_id                              | cc14c5dbbd654c438e52d38efaf4f1a6          |\n+--------------------------------------+-------------------------------------------+\nroot@controller:~#\n\n```", "```\nroot@controller:~# openstack server list\n+---------------------------+-----------------+--------+------------------+--------------+\n| ID                        | Name            | Status | Networks         | Image Name   |\n+---------------------------+-----------------+--------+------------------+--------------+\n| 0f4745b1-...-9eaa1f9bb08f | ubuntu_instance | ACTIVE | nat=192.168.0.11 | ubuntu_16.04 |\n+---------------------------+-----------------+--------+------------------+--------------+\nroot@controller:~#\n\n```", "```\nroot@controller:~# openstack server stop ubuntu_instance\nroot@controller:~#\n\n```", "```\nroot@controller:~# virsh list --all\n Id Name              State\n----------------------------------------------------\n -  instance-00000001 shut off\n\nroot@controller:~#\n\n```", "```\nroot@controller:~# pgrep -lfa qemu\nroot@controller:~#\n\n```", "```\nroot@controller:~# openstack server list\n+---------------------------+-----------------+--------+------------------+--------------+\n| ID                        | Name            | Status | Networks         | Image Name   |\n+---------------------------+-----------------+--------+------------------+--------------+\n| 0f4745b1-...-9eaa1f9bb08f | ubuntu_instance | SHUTOFF| nat=192.168.0.11 | ubuntu_16.04 |\n+---------------------------+-----------------+--------+------------------+--------------+\nroot@controller:~#\n\n```", "```\nroot@controller:~# openstack server start ubuntu_instance\nroot@controller:~# openstack server list\n+---------------------------+-----------------+--------+------------------+--------------+\n| ID                        | Name            | Status | Networks         | Image Name   |\n+---------------------------+-----------------+--------+------------------+--------------+\n| 0f4745b1-...-9eaa1f9bb08f | ubuntu_instance | ACTIVE | nat=192.168.0.11 | ubuntu_16.04 |\n+---------------------------+-----------------+--------+------------------+--------------+\nroot@controller:~#\n\n```", "```\nroot@controller:~# openstack server start ubuntu_instance\nroot@controller:~# openstack server list\n+---------------------------+-----------------+--------+------------------+--------------+\n| ID                        | Name            | Status | Networks         | Image Name   |\n+---------------------------+-----------------+--------+------------------+--------------+\n| 0f4745b1-...-9eaa1f9bb08f | ubuntu_instance | ACTIVE | nat=192.168.0.11 | ubuntu_16.04 |\n+---------------------------+-----------------+--------+------------------+--------------+\nroot@controller:~#\n\n```", "```\nroot@controller:~# openstack server delete ubuntu_instance\nroot@controller:~#\n\n```", "```\nroot@controller:~# openstack server list\n\nroot@controller:~# virsh list --all\n Id   Name   State\n----------------------------------------------------\n\nroot@controller:~#\n\n```", "```\nroot@controller:~# cat /var/log/nova/nova-api.log | grep -i delete\n2017-05-04 15:30:07.733 20915 INFO nova.osapi_compute.wsgi.server [req-54dbe80f-9942-43d8-949a-d80daa2440a9 cc14c5dbbd654c438e52d38efaf4f1a6 123c1e6f33584dd1876c0a34249a6e11 - default default] 10.184.226.74 \"DELETE /v2.1/123c1e6f33584dd1876c0a34249a6e11/servers/0f4745b1-9d4b-4e8a-82f7-9eaa1f9bb08f HTTP/1.1\" status: 204 len: 339 time: 0.1859989\nroot@controller:~#\nroot@controller:~# cat /var/log/neutron/neutron-server.log | grep -i delete\n2017-05-04 15:30:08.402 17910 INFO neutron.wsgi [req-5c9674d6-c596-4b17-b975-54625ac7adb2 cc14c5dbbd654c438e52d38efaf4f1a6 123c1e6f33584dd1876c0a34249a6e11 - - -] 10.184.226.74 - - [04/May/2017 15:30:08] \"DELETE /v2.0/ports/fdaf6ea1-b76a-4895-a028-db15831132fa.json HTTP/1.1\" 204 173 0.320351\nroot@controller:~#\nroot@controller:~# cat /var/log/nova/nova-compute.log\n...\n2017-05-04 15:30:07.747 21065 INFO nova.compute.manager [req-54dbe80f-9942-43d8-949a-d80daa2440a9 cc14c5dbbd654c438e52d38efaf4f1a6 123c1e6f33584dd1876c0a34249a6e11 - - -] [instance: 0f4745b1-9d4b-4e8a-82f7-9eaa1f9bb08f] Terminating instance\n2017-05-04 15:30:07.952 21065 INFO nova.virt.libvirt.driver [-] [instance: 0f4745b1-9d4b-4e8a-82f7-9eaa1f9bb08f] Instance destroyed successfully.\n2017-05-04 15:30:07.953 21065 INFO os_vif [req-54dbe80f-9942-43d8-949a-d80daa2440a9 cc14c5dbbd654c438e52d38efaf4f1a6 123c1e6f33584dd1876c0a34249a6e11 - - -] Successfully unplugged vif VIFBridge(active=True,address=fa:16:3e:3c:c0:0f,bridge_name='brqb7ccb514-21',has_traffic_filtering=True,id=fdaf6ea1-b76a-4895-a028-db15831132fa,network=Network(b7ccb514-21fc-4ced-b74f-026e7e358bba),plugin='linux_bridge',port_profile=<?>,preserve_on_delete=False,vif_name='tapfdaf6ea1-b7')\n2017-05-04 15:30:07.970 21065 INFO nova.virt.libvirt.driver [req-54dbe80f-9942-43d8-949a-d80daa2440a9 cc14c5dbbd654c438e52d38efaf4f1a6 123c1e6f33584dd1876c0a34249a6e11 - - -] [instance: 0f4745b1-9d4b-4e8a-82f7-9eaa1f9bb08f] Deleting instance files /var/lib/nova/instances/0f4745b1-9d4b-4e8a-82f7-9eaa1f9bb08f_del\n2017-05-04 15:30:07.974 21065 INFO nova.virt.libvirt.driver [req-54dbe80f-9942-43d8-949a-d80daa2440a9 cc14c5dbbd654c438e52d38efaf4f1a6 123c1e6f33584dd1876c0a34249a6e11 - - -] [instance: 0f4745b1-9d4b-4e8a-82f7-9eaa1f9bb08f] Deletion of /var/lib/nova/instances/0f4745b1-9d4b-4e8a-82f7-9eaa1f9bb08f_del complete\n...\nroot@controller:~#\n\n```"]