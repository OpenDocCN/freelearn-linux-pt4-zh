<html><head></head><body><div class="chapter" title="Chapter&#xA0;6.&#xA0;Compliance Management"><div class="titlepage"><div><div><h1 class="title"><a id="ch06"/>Chapter 6. Compliance Management</h1></div></div></div><p>In this chapter, we will cover the following recipes:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Importing compliance packs</li><li class="listitem" style="list-style-type: disc">Creating compliance rule groups</li><li class="listitem" style="list-style-type: disc">Creating custom compliance rules for Windows</li><li class="listitem" style="list-style-type: disc">Creating custom compliance rules for Linux</li><li class="listitem" style="list-style-type: disc">Creating custom compliance rules for virtualization</li><li class="listitem" style="list-style-type: disc">Modifying the default filter set</li><li class="listitem" style="list-style-type: disc">Creating compliance templates</li><li class="listitem" style="list-style-type: disc">Checking the compliance of the infrastructure</li><li class="listitem" style="list-style-type: disc">Exporting compliance rules</li><li class="listitem" style="list-style-type: disc">Compliance reports</li><li class="listitem" style="list-style-type: disc">Creating compliance exceptions</li></ul></div><div class="section" title="Introduction"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec57"/>Introduction</h1></div></div></div><p>Compliance means meeting requirements. It is also used to refer to industry-wide or government rules and regulations that mention how data should be managed, and the need for organizations to be compliant with those regulations.</p><p>Consider a rule for password complexity, such as the length of the password not being fewer than 12 characters. Now, you need to check whether this is true for all the machines in your infrastructure. Let's assume you have a few thousand machines to check and, if they aren't in compliance, reconfigure.</p><p>You can understand how much time it would take to go through each machine, check the setting, and correct it if it's to be found noncompliant. Now, multiply those efforts for a few hundred rules–how do you document all the statuses to show the auditor? This becomes more complex when you want to be compliant for various government and industry standards such as ISO, HIPPA, and Suburban Oxley. They have a few hundred rules per standard and changes per operating system. Also, you may have your own compliance rules, which may be different from the various standards; you need to check them as well. With some rules, there is the possibility that you need a deviation approved by your security team, and hence, being noncompliant with the rule should not affect your compliance score, so you need to add these as exceptions.</p><p>Now that the complexity of compliance is clearer, we need something that can do all this for us easily. There are other tools in the market, such as System Center Configuration Manager, BMC BSA, and Puppet, that are capable of doing this, but VCM is much better than these, for the following reasons:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">There are more than 50 ready-to-use industry and government standard compliance packs available</li><li class="listitem" style="list-style-type: disc">Creating your own compliance pack is a very easy process</li><li class="listitem" style="list-style-type: disc">The rules are processed on the data captured and stored on the VCM server, so that we get the setting configured on the server</li><li class="listitem" style="list-style-type: disc">It is much more cost effective, as it is part of the vRealize Operations suite</li><li class="listitem" style="list-style-type: disc">We can check the compliance of the VMware virtual infrastructure, as well as supported managed machines, in one console</li><li class="listitem" style="list-style-type: disc">We can enforce compliance for noncompliant rules (although not all rules and OSes are supported)</li></ul></div><p>In my opinion, this list is enough to understand why we should use VCM instead of any other tool to manage the compliance of the infrastructure.</p><div class="section" title="The constructs of VCM compliance"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec157"/>The constructs of VCM compliance</h2></div></div></div><p>To measure compliance, we need to create various elements in VCM. Let's get introduced to them.</p><div class="section" title="Rules"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl3sec55"/>Rules</h3></div></div></div><p>We have learned that compliance means meeting the requirements put forth by a standard, so to check compliance, we need to create a rule. Basically, a rule is the interpretation of the requirement put forth by the standard, which can then be understood by VCM. To continue with our previous example, our requirement was to have a password length of at least 12 characters. When we convert this requirement, what we get in VCM is a rule.</p><p>Rules can be basic or complex. A basic rule just checks the contents of data properties while with a complex rule, we can use logic to check for conditions.</p></div><div class="section" title="Filters"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl3sec56"/>Filters</h3></div></div></div><p>Filters are used to filter machines for conditions. For example, we create some rules and we want those rules to only be checked against a certain OS. So, we create a filter for that OS.</p></div><div class="section" title="Rule groups"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl3sec57"/>Rule groups</h3></div></div></div><p>Rules are grouped together under rule groups; for example, we can group all the rules that are applicable to Windows Server 2012 R2 under one rule group.</p></div><div class="section" title="Templates"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl3sec58"/>Templates</h3></div></div></div><p>Templates are used to group multiple rule groups together. They are used to check the compliance of machine groups.</p><p>Here's an example: in our company, we have rules, and they might be different for different versions of Windows. We can create the required rules groups for each OS that will be filtered on the basis of the filters created in each rule group. Then, all the rule groups will be grouped in a single template and that template can be used to check the compliance of the infrastructure.</p></div></div></div></div>
<div class="section" title="Importing compliance packs"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec58"/>Importing compliance packs</h1></div></div></div><p>There are more than 50 compliance packs available for download, and the list keeps on growing as VMware keeps on adding new compliance packs.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec158"/>Getting ready</h2></div></div></div><p>We will need an Internet connection for the VCM server in order to download the compliance packs from VMware. The <span class="strong"><strong>C</strong></span>ontent Wizard tool will use a proxy configured at the system level; have a look at the <span class="emphasis"><em>There's More...</em></span> section of this recipe for proxy details.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec159"/>How to do it...</h2></div></div></div><p>We will now download a compliance pack from the Internet:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Log in to the VCM server's OS.</li><li class="listitem">Launch the <span class="strong"><strong>Content Wizard</strong></span> tool from the desktop (<span class="strong"><strong>Start </strong></span>| <span class="strong"><strong>VMware vRealize Configuration Manager </strong></span>| <span class="strong"><strong>Content Wizard Tool</strong></span>).</li><li class="listitem">On the next page of the wizard, select <span class="strong"><strong>Get Updates from Internet</strong></span>.<p>The other option is <span class="strong"><strong>Get Updates from Local File System</strong></span>; for this, all files must be available in the <code class="literal">C:\ProgramData\CM\Content</code> folder. You must obtain updated files from VMware and manually copy them to the directory. Download the files from <a class="ulink" href="https://vcmupdates.vmware.com/CPC/VCM/5_7/">https://vcmupdates.vmware.com/CPC/VCM/5_7/</a>.</p></li><li class="listitem">The wizard will check for an Internet connection and will start downloading the <code class="literal">Updates.xml</code> file from VMware.</li><li class="listitem">Next, it will present the list of packs that are available for download. Select the packs required for your infrastructure; in this example, we are selecting <span class="strong"><strong>ISO 27001-27002 for Windows</strong></span>:<div class="mediaobject"><img alt="How to do it..." src="graphics/image_06_001.jpg"/></div></li><li class="listitem">The selected pack will be downloaded and ready for import.</li><li class="listitem">Once downloaded, it will start the import as a part of the wizard.</li><li class="listitem">Once the import is complete, it will present the <span class="strong"><strong>Log Result</strong></span> page and you have an option to save the logs. Click on <span class="strong"><strong>Close</strong></span>.</li><li class="listitem">On the next page, click on <span class="strong"><strong>Finish </strong></span>to complete the importing of the compliance pack.</li><li class="listitem">You can check the imported compliance packs by logging in to the VCM console and going to <span class="strong"><strong>Compliance </strong></span>| <span class="strong"><strong>Machine Group Compliance </strong></span>| <span class="strong"><strong>Templates</strong></span>:</li></ol></div><div class="mediaobject"><img alt="How to do it..." src="graphics/image_06_002.jpg"/></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec160"/>How it works...</h2></div></div></div><p>As explained in the introduction, we can either create our own compliance rules or import rules by importing compliance packs created by VMware. This gives us all the necessary constructs required to measure compliance against standards such as ISO 27001, SOX, and HIPPA, to name a few.</p><p>The tool downloads the rules in XML and they are then imported to the VCM database. The pack includes rules, rule groups, filters, and templates responsible for the selected standard; in our case, it is ISO 27001-27002 for Windows.</p><p>Once the compliance pack is imported, we can use the newly created templates to check the compliance of our infrastructure against the ISO 27001-27002 industry standard. Refer to the <span class="emphasis"><em>Checking the compliance of the infrastructure</em></span> recipe from this chapter.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec161"/>There's more...</h2></div></div></div><p>If your Internet access requires you to use a proxy, you can do that by changing some registry settings. Go to <code class="literal">HKEY_Current_User\Software\Microsoft\Windows\CurrentVersion\Internet Settings Proxy Server</code> to check proxy details; if there is a proxy configured and you are in an environment that does not need a proxy or the proxy has been changed, you need to check this before you start troubleshooting why the content wizard is failing to connect to <a class="ulink" href="http://www.vmware.com/">http://www.vmware.com/</a>.</p></div></div>
<div class="section" title="Creating compliance rule groups"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec59"/>Creating compliance rule groups</h1></div></div></div><p>In the previous recipe, we imported a compliance pack, which created the required rules, rule groups, filters, and templates. When we want to check compliance against our own standards, we need to create each of them. In this recipe, we will create a compliance rule group.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec162"/>Getting ready</h2></div></div></div><p>We need a working VCM server and credentials to log in as administrator on it.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec163"/>How to do it...</h2></div></div></div><p>This is a two-part recipe; first, we will create a rule group and then will create the required filters.</p><div class="section" title="Creating a rule group"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl3sec59"/>Creating a rule group</h3></div></div></div><p>Here are the steps to create a rule group:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Log in to VCM using an admin account.</li><li class="listitem">Go to <span class="strong"><strong>Compliance </strong></span>| <span class="strong"><strong>Machine Group Compliance</strong></span> | <span class="strong"><strong>Rule Group</strong></span>.</li><li class="listitem">Click on the green plus sign to create a new rule group.</li><li class="listitem">It will launch a wizard; fill in an appropriate name and provide a description. It is best practice to have some naming conventions while creating such things. We will look at naming conventions in detail in <a class="link" href="ch10.html" title="Chapter 10. Defining Naming Conventions">Appendix A</a> – <span class="emphasis"><em>Defining Naming Conventions</em></span>. In this case, we are creating a rule group for Windows Server 2012 for our company rules, so the following names will be used:<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Rule Group Name</strong></span>: <code class="literal">01_MyCompany_Win2k12</code></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Description</strong></span>: Provide an appropriate description</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Filter Set</strong></span>: Use the <span class="strong"><strong>Default </strong></span>filter set</li></ul></div><div class="mediaobject"><img alt="Creating a rule group" src="graphics/image_06_003.jpg"/></div><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note43"/>Note</h3><p>Note that the selected collection filter set is used when calculating the data age for the rules in the compliance templates. The filter set must collect the same data types that are included in the rules in the rule group. If the filter set does not collect the same data types, no data age is calculated.</p></div></div></li><li class="listitem">Accept the rule group creation confirmation box by clicking on <span class="strong"><strong>OK</strong></span>.</li></ol></div><p>Once the rule group has been created, we need to create the necessary filters so that only expected machines will be checked for the rules in this rule group.</p></div><div class="section" title="Creating a filter"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl3sec60"/>Creating a filter</h3></div></div></div><p>This is the second part of this recipe; here, we will create the necessary filters for the rule group. Here are the steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Click on the newly created rule group, that is, <code class="literal">01_MyCompany_Win2k12</code>, and then click on <span class="strong"><strong>Filters</strong></span>.</li><li class="listitem">Click on the green <span class="strong"><strong>+</strong></span> button to add a new filter.</li><li class="listitem">Provide a proper <span class="strong"><strong>Name</strong></span> and <span class="strong"><strong>Description</strong></span>.</li><li class="listitem">Select a data type.<p>Our imagination is the limit for selecting the correct data type; all the attributes captured by the VCM agent are available in the VCM database, and all of those can be used to create filters. In our case, we will be using the operating system name as the filter criteria; hence, we have selected <span class="strong"><strong>Machines</strong></span>. You can browse and check the other available options:</p><div class="mediaobject"><img alt="Creating a filter" src="graphics/image_06_004.jpg"/></div></li><li class="listitem">Now, the selected <span class="strong"><strong>Data Type</strong></span> will be used to create the rules. As we just need to check the OS name, we are going with <span class="strong"><strong>Basic</strong></span>:<div class="mediaobject"><img alt="Creating a filter" src="graphics/image_06_005.jpg"/></div></li><li class="listitem">Here too we have multiple choices to filter, and we will select OS Name Full, then we have conditional operators, and then the value.<p>As we are creating a filter for Microsoft Windows Server 2012, we are choosing <span class="strong"><strong>OS Name Full</strong></span>
<span class="strong"><strong>=</strong></span> <span class="strong"><strong>Microsoft Windows Server 2012 %</strong></span> (<span class="strong"><strong>%</strong></span> is a wildcard):</p><div class="mediaobject"><img alt="Creating a filter" src="graphics/image_06_006.jpg"/></div><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note44"/>Note</h3><p><span class="strong"><strong>Wildcards in VCM:</strong></span></p><p>
</p><div class="informaltable"><table border="1"><colgroup><col/><col/></colgroup><tbody><tr><td>
<p><span class="strong"><strong>Wildcard</strong></span></p>
</td><td>
<p><span class="strong"><strong>Meaning</strong></span></p>
</td></tr><tr><td>
<p><span class="strong"><strong>%</strong></span></p>
</td><td>
<p>Match all characters</p>
</td></tr><tr><td>
<p><span class="strong"><strong>_</strong></span> (underscore)</p>
</td><td>
<p>Match a single character</p>
</td></tr><tr><td>
<p><span class="strong"><strong>*</strong></span></p>
</td><td>
<p>Equivalent to <span class="strong"><strong>%</strong></span></p>
</td></tr><tr><td>
<p>?</p>
</td><td>
<p>Equivalent to <span class="strong"><strong>_</strong></span></p>
</td></tr></tbody></table></div></div></div></li><li class="listitem">Click on <span class="strong"><strong>Finish</strong></span> to complete the filter creation.</li><li class="listitem">To validate our filter, click on <span class="strong"><strong>Preview</strong></span>, and it should display all the machines with Windows Server 2012 in the infrastructure, as our rule is only looking for such machines:<div class="mediaobject"><img alt="Creating a filter" src="graphics/image_06_007.jpg"/></div><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note45"/>Note</h3><p>Note that if you have created multiple filters in a single rule group, they work as logical <span class="strong"><strong>AND</strong></span>, that is, if all the conditions are <span class="strong"><strong>True</strong></span>, only then will it display the machines, so be careful when creating multiple filters.</p></div></div></li></ol></div></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec164"/>How it works...</h2></div></div></div><p>In this recipe, we just created a rule group that will include our company security rules to be measured via VCM and selected the default filter set as the information will be collected as a part of the default filter set.</p><p>After that, we created a filter that will filter only Windows Server 2012 machines in the VCM.</p></div></div>
<div class="section" title="Creating custom compliance rules for Windows"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec60"/>Creating custom compliance rules for Windows</h1></div></div></div><p>VCM divides compliance into two broad categories:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="emphasis"><em>Machine group compliance</em></span></li><li class="listitem" style="list-style-type: disc"><span class="emphasis"><em>Virtual environment compliance</em></span></li></ul></div><div class="section" title="Machine group compliance"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec165"/>Machine group compliance</h2></div></div></div><p>In this category, compliance is checked at the operating system level, such as for all the supported versions of Windows or Linux.</p></div><div class="section" title="Virtual environment compliance"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec166"/>Virtual environment compliance</h2></div></div></div><p>In this category, the compliance of the ESXi hosts, vCenter, and virtual machines present in vCenter is checked.</p><p>Now, as we are ready with the rule group, let's start populating it with the rules for our organization. There are two ways we can create the rules: either copy what is created in the standard compliance packs we downloaded in the first recipe and modify it as per our requirement or create the rules from scratch.</p><p>In this recipe, we will create a custom compliance rule based on machine group compliance.</p></div><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec167"/>Getting ready</h2></div></div></div><p>We will need a fully ready VCM server, and to copy the rule from another rule group, we should finish the <span class="emphasis"><em>Importing compliance packs</em></span> recipe. We will need our own rule group created so that we can create our rules there.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec168"/>How to do it...</h2></div></div></div><p>We will continue our example of our requirement of having a complex password and a minimum password length of 12 characters; first, we will try to find the rule in the imported compliance pack and then, we will create our own rule.</p><div class="section" title="Copying a rule from another rule group"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl3sec61"/>Copying a rule from another rule group</h3></div></div></div><p>We can copy a rule from the compliance packs we have downloaded and added to VCM and then modify them as per our requirement or club rules from various compliance packs or standards as required to support our internal company standards.</p><p>Follow the next steps to copy a rule from another rule group:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Log in to VCM with admin privileges and go to <span class="strong"><strong>Compliance </strong></span>| <span class="strong"><strong>Machine Group Compliance</strong></span> | <span class="strong"><strong>Rule Groups</strong></span>.</li><li class="listitem">As we want to copy a rule, we must know where the original rule is; in our case, the rule is in the <span class="strong"><strong>Best Practises - ISO 27001-27002 Windows 2008 R2 Mbr</strong></span> rule group, so we will go there and select the required rule:<div class="mediaobject"><img alt="Copying a rule from another rule group" src="graphics/image_06_008.jpg"/></div></li><li class="listitem">Click on <span class="strong"><strong>Copy</strong></span>, and as the wizard starts, select the rule group that you want to copy the rule to:<div class="mediaobject"><img alt="Copying a rule from another rule group" src="graphics/image_06_009.jpg"/></div></li><li class="listitem">In next step, confirm the rule/rules you want to copy and click on <span class="strong"><strong>Finish</strong></span>.</li><li class="listitem">The rule will be copied in our rule group now.</li><li class="listitem">It should look like the following screenshot:<div class="mediaobject"><img alt="Copying a rule from another rule group" src="graphics/image_06_010.jpg"/></div></li></ol></div></div><div class="section" title="Creating a new rule"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl3sec62"/>Creating a new rule</h3></div></div></div><p>Now, as you have seen how to copy a rule, we will continue considering that we are not able to find a rule we want and thus need to create it.</p><p>Follow these steps to create the required rule:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Once again, log in to VCM and go to <span class="strong"><strong>Compliance</strong></span> | <span class="strong"><strong>Machine</strong></span><span class="strong"><strong>Group</strong></span><span class="strong"><strong>Compliance</strong></span> | <span class="strong"><strong>Rule</strong></span><span class="strong"><strong>Groups</strong></span>.</li><li class="listitem">Select the machine group created for storing our rules and go to <span class="strong"><strong>Rules</strong></span>, click on <span class="strong"><strong>Add</strong></span>, and follow the wizard.<div class="mediaobject"><img alt="Creating a new rule" src="graphics/image_06_011.jpg"/></div></li><li class="listitem">Provide a <span class="strong"><strong>Name</strong></span> and <span class="strong"><strong>Description</strong></span> for the rule.<div class="mediaobject"><img alt="Creating a new rule" src="graphics/image_06_012.jpg"/></div></li><li class="listitem">Select the correct <span class="strong"><strong>Data Type</strong></span>; in our case, it is <span class="strong"><strong>Account Policy</strong></span>.<div class="mediaobject"><img alt="Creating a new rule" src="graphics/image_06_013.jpg"/></div></li><li class="listitem">Select <span class="strong"><strong>Basic Rule</strong></span>.</li><li class="listitem">(For more details about the types of rules, refer to the <span class="emphasis"><em>Rules</em></span> subsection of the <span class="emphasis"><em>The constructs of VCM compliance</em></span> recipe).</li><li class="listitem">Select a <span class="strong"><strong>Min Length</strong></span> value greater than (<span class="strong"><strong>&gt;</strong></span>) <code class="literal">12</code> as a condition so that if the condition fails, it will flag as noncompliant.<div class="mediaobject"><img alt="Creating a new rule" src="graphics/image_06_014.jpg"/></div></li><li class="listitem">Select <span class="strong"><strong>Moderate Severity</strong></span>, confirm the rule creation and click on <span class="strong"><strong>Finish</strong></span>.</li><li class="listitem">We just created our first rule for our internal standards for Windows.</li></ol></div></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec169"/>How it works...</h2></div></div></div><p>To measure compliance, we need to create rules for each stated requirement; in this recipe, we first copied a rule from a standard that we imported, and then, to understand the process, we created the same rule. The rule will be stored in the rule group and will check the compliance of the Windows machine for password length.</p></div></div>
<div class="section" title="Creating custom compliance rules for Linux"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec61"/>Creating custom compliance rules for Linux</h1></div></div></div><p>In the previous recipe, we looked at a rule created for Windows for checking minimum the password length; we will continue with the same requirement here, except for Linux. The process will be similar; only the data types will change.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec170"/>Getting ready</h2></div></div></div><p>We need a fully functional VCM and a rule group created to store our Linux rule.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec171"/>How to do it...</h2></div></div></div><p>Like in the earlier recipe, here too we have two ways to create such rules, that is, copy them from another imported compliance pack rule group or create our own. The copying process is the same as for Windows; hence, we will not repeat it again.</p><p>We will create a new rule for Linux to check the minimum password length by completing these steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Once again, we need to log in to VCM with admin privileges and go to <span class="strong"><strong>Compliance | </strong></span><span class="strong"><strong>Machine </strong></span><span class="strong"><strong>Group </strong></span><span class="strong"><strong>Compliance</strong></span> | <span class="strong"><strong>Rule</strong></span><span class="strong"><strong>Groups</strong></span>.<p>Go to the machine group created for Linux rules, click on the arrow in front of the rule group name, and select <span class="strong"><strong>Rules</strong></span>.</p></li><li class="listitem">Click on <span class="strong"><strong>Add</strong></span>, and it will launch a wizard to create a new rule.</li><li class="listitem">On the first page of the wizard, provide a name and description.</li><li class="listitem">On the next page for data types, go to <span class="strong"><strong>Unix</strong></span> | <span class="strong"><strong>Custom Information</strong></span>.<div class="mediaobject"><img alt="How to do it..." src="graphics/image_06_015.jpg"/></div></li><li class="listitem">If you are a Linux admin, you already know where to find the required details; if not, consult your Linux admin.<p>In our case, I filled in the details after consulting my Linux admin.</p><p>Here is what we filled in:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Information Type: <code class="literal">builtin:login.defs</code>
</strong></span></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong> File Path : <code class="literal">/etc/login.defs</code>
</strong></span></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong> Internal Path:<code class="literal"> /builtin:login.defs</code>
</strong></span></li></ul></div><div class="mediaobject"><img alt="How to do it..." src="graphics/image_06_016.jpg"/></div></li><li class="listitem">Select the <code class="literal">PASS_MIN_LEN</code> condition to be greater than (<span class="strong"><strong>&gt;</strong></span>) <code class="literal">12</code>, so if the value found is less than <code class="literal">12</code>, then we are noncompliant and VCM will let us know.<div class="mediaobject"><img alt="How to do it..." src="graphics/image_06_017.jpg"/></div></li><li class="listitem">Set the <span class="strong"><strong>Severity </strong></span>to <span class="strong"><strong>Moderate</strong></span>, follow the wizard, and accept the creation of the rule and finish it by clicking on <span class="strong"><strong>Finish</strong></span>.</li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec172"/>How it works...</h2></div></div></div><p>Just like Windows compliance rules, this rule will be stored and will process the stored data collected from Linux machines and give us their compliance status.</p></div></div>
<div class="section" title="Creating custom compliance rules for virtualization"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec62"/>Creating custom compliance rules for virtualization</h1></div></div></div><p>So far, we created compliance rules for machine group compliance, that is, for Windows and Linux. Now, we will create a rule for virtual environment compliance. We can't continue with our example of minimum password length in this virtual world, so we will change it to another requirement we have, that is, the snapshot for a VM should not be retained for more than 10 days.</p><p>So, let's start and see how many VMs are noncompliant with our rule by first creating one.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec173"/>Getting ready</h2></div></div></div><p>We need a rule group created to store the virtualization compliance rules in a fully deployed and functional VCM server.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec174"/>How to do it...</h2></div></div></div><p>Like our previous experience with rules, this one can also be copied from another standard pack if you know where to copy from; the process is similar to that for Windows rules, so we will not repeat it here.</p><p>We will start creating a new rule using the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Once again, we need to log in to VCM with admin privileges and reach <span class="strong"><strong>Compliance |  </strong></span><span class="strong"><strong>Virtual Environment Compliance</strong></span> |<span class="strong"><strong> Rule Groups</strong></span>.</li><li class="listitem">Select the rule group created for storing virtual environment compliance rules. Click on the arrow to the side of it and go to <span class="strong"><strong>Rules</strong></span>.</li><li class="listitem">Click on <span class="strong"><strong>Add </strong></span>to start the wizard. Fill in the name and description for the rule to be created, and click on <span class="strong"><strong>Next</strong></span>.</li><li class="listitem">Check the screenshots in the previous recipes where we created rules for Windows and Linux, and make appropriate changes for virtualization as described in those steps.</li><li class="listitem">On the next page of the wizard, <span class="strong"><strong>Data Type</strong></span>, select <span class="strong"><strong>vCenter - Guests - Snapshots</strong></span>, as we want to check the snapshot age.<div class="mediaobject"><img alt="How to do it..." src="graphics/image_06_018.jpg"/></div></li><li class="listitem">Select <span class="strong"><strong>Basic </strong></span>as the rule type and click on <span class="strong"><strong>Next</strong></span>.</li><li class="listitem">To form a condition, select <span class="strong"><strong>Snapshot Age</strong></span> less than or equal to (<span class="strong"><strong>&lt;=</strong></span>) <code class="literal">10</code>, that is, if the snapshot age is less than <code class="literal">10</code>, then we are compliant, but if it is more than <code class="literal">10</code>, then we are noncompliant and that needs to be flagged. Click on <span class="strong"><strong>Next</strong></span>.<div class="mediaobject"><img alt="How to do it..." src="graphics/image_06_019.jpg"/></div></li><li class="listitem">Select <span class="strong"><strong>Moderate Severity</strong></span>, confirm the rule creation, and click on <span class="strong"><strong>Finish </strong></span>to close the wizard.</li></ol></div><p>This completes the creation of all types of rules for compliance.</p></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec175"/>How it works...</h2></div></div></div><p>The process is the same as machine group compliance and rules for Windows and Linux; in a virtual environment situation, the data to be used will be collected from vCenter servers, and the compliance score of the vCenter server will change instead of individual virtual machines'.</p></div></div>
<div class="section" title="Modifying the default filter set"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec63"/>Modifying the default filter set</h1></div></div></div><p>Now you know that VCM checks compliance on the data collected and available in the database it has and not directly on the live machine. This causes limitation: if a particular data type is not collected, it will not be available, and then, we cannot measure the compliance for the rule and VCM will tell you that the data has not been collected for the rule in the results.</p><p>To overcome this situation, we can set lots of collections with different types of filter sets created by VCM or we can modify the default filter set and add required filters.</p><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note46"/>Note</h3><p>Note that modifying a default set is not recommended by VMware. Create your own filter set that includes the required filters and use that to perform the collection.</p></div></div><p>So, what are filters and filter sets?</p><p><span class="strong"><strong>VCM filters</strong></span>: Filters define what data a VCM agent should collect while performing the collection; examples are a registry setting, service status, file permission, and so on.</p><p><span class="strong"><strong>VCM filter sets</strong></span>: These are collections of filters, which can be used to collect data from managed machines. Most of the time, we use the default filter set, but there are a few more created by default when we install VCM, and a few are added when we import compliance packs from the Internet. Compliance packs create the required filters and filter sets so that the data is collected and can be processed when we run the compliance check.</p><p>We need to select the correct filter set while performing a collection so that the required details will be added to the VCM database, modify the default filter set, or create a new one and use this single filter set to collect data.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec176"/>Getting ready</h2></div></div></div><p>We need a fully functional VCM server, and we should know which data filter is required to add to the default filter set, so we should import the compliance packs as we did in the first recipe.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec177"/>How to do it...</h2></div></div></div><p>We will be adding a Linux filter to collect the required data type used in the <span class="emphasis"><em>Creating custom compliance rules for Linux</em></span> recipe, where we used details from the <code class="literal">:/etc/login.defs</code> file, and those are not part of the default filter set. In this example, we are modifying the default filter set, but you can use the same process to first create a filter set and then add the required filters to it.</p><p>Let's jump into the VCM console to modify the default filter set then:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">To start, log in to VCM and go to <span class="strong"><strong>Administration </strong></span>| <span class="strong"><strong>Collection Filters</strong></span> | <span class="strong"><strong>Filter Sets</strong></span>.<div class="mediaobject"><img alt="How to do it..." src="graphics/image_06_020.jpg"/></div></li><li class="listitem">Select the default filter set and click on <span class="strong"><strong>Edit Filter Set</strong></span>.</li><li class="listitem">The wizard will start; as you can see, there are 9000 filters available; we really can't search through them, so create a <span class="strong"><strong>Filter</strong></span>, click on <span class="strong"><strong>Define</strong></span>, and it will open a pop-up.<div class="mediaobject"><img alt="How to do it..." src="graphics/image_06_021.jpg"/></div></li><li class="listitem">As we want to look for login details in the <span class="strong"><strong>Filter</strong></span>, create a filter like <span class="strong"><strong>Name </strong></span>like <span class="strong"><strong>%log%</strong></span> (<span class="strong"><strong>%</strong></span> acts a wildcard).<div class="mediaobject"><img alt="How to do it..." src="graphics/image_06_022.jpg"/></div></li><li class="listitem">Now, the filters we need to check are only 169 in number. Go through them and select the ones that match our requirement, in this case, <span class="strong"><strong>CIS - RHEL 7 - Custom Information - /etc/login.defs</strong></span>.</li><li class="listitem">Select and click on the downward arrow and then on <span class="strong"><strong>Next</strong></span>.<div class="mediaobject"><img alt="How to do it..." src="graphics/image_06_023.jpg"/></div></li><li class="listitem">Make sure there are no conflicts, and click on <span class="strong"><strong>Next</strong></span>.</li><li class="listitem">On the next page, it will show you the list of filters in this filter set; accept them by clicking on <span class="strong"><strong>Finish</strong></span>.<div class="mediaobject"><img alt="How to do it..." src="graphics/image_06_024.jpg"/></div></li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec178"/>How it works...</h2></div></div></div><p>As mentioned earlier, we need to instruct VCM what data needs to be collected; else, we will miss the data collection and cannot check compliance for those rules. We can do this in two ways: collecting data multiple times with multiple filter sets or as we did here, adding required filter sets and preparing a master filter set to collect all the details.</p><p>We chose the second option. Now onwards, whenever we collect data with the default filter set, it will collect from Linux/Unix managed machines details about <code class="literal">/etc/login.defs</code> file, which we can use.</p></div></div>
<div class="section" title="Creating compliance templates"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec64"/>Creating compliance templates</h1></div></div></div><p>Now that we are ready with all the required rule groups with the necessary filters and they have been populated with all the rules to fulfill the requirements given by the security officer, we need to move ahead and start checking compliance. But wait, we can't check compliance against a rule or rule groups; we will need a compliance template, which can have all the required rule groups.</p><p>So let's start by creating our compliance template for Windows-related rule groups.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec179"/>Getting ready</h2></div></div></div><p>We will need all the required rule groups created and they should be populated with the associated rules in a fully functional VCM server.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec180"/>How to do it...</h2></div></div></div><p>By now, you must already know where you should go to create your compliance template; if not, just follow this process and you will be learn that as well:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Go to <span class="strong"><strong>Compliance</strong></span> | <span class="strong"><strong>Machine </strong></span><span class="strong"><strong>Group </strong></span><span class="strong"><strong>Compliance</strong></span> | <span class="strong"><strong>Templates</strong></span> and then click on <span class="strong"><strong>Add</strong></span>.<div class="mediaobject"><img alt="How to do it..." src="graphics/image_06_025.jpg"/></div></li><li class="listitem">Once the wizard for creating a new template is launched, provide a proper <span class="strong"><strong>Name</strong></span> and <span class="strong"><strong>Description</strong></span> value.<div class="mediaobject"><img alt="How to do it..." src="graphics/image_06_026.jpg"/></div></li><li class="listitem">Select all the rule groups that should be part of this template.<div class="mediaobject"><img alt="How to do it..." src="graphics/image_06_027.jpg"/></div></li><li class="listitem">Make sure it provides results on both compliant and noncompliant details and processes compliance exceptions (more about this is in the <span class="emphasis"><em>Creating compliance exceptions</em></span> recipe at the end of this chapter).<div class="mediaobject"><img alt="How to do it..." src="graphics/image_06_028.jpg"/></div></li><li class="listitem">Confirm the creation of the template and hit <span class="strong"><strong>Finish</strong></span>.</li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec181"/>How it works...</h2></div></div></div><p>We can create rule groups for each version of Windows, such as Windows Server 2003, Windows Server 2008 and one for 2008 R2, and Server 2012 and 2012 R2. Each will have its own filters so that the rules in those rule groups will be applied to only the specific OSes they are created for. Now we can have a single template to run against a huge machine group that includes all the Windows machines in the infrastructure; VCM will pick the correct rule for them, and we can avoid having multiple templates and associated machine groups to check compliance against (checking infrastructure compliance is our next recipe).</p><p>When a rule that is called complaint is passed and it fails, then we are noncompliant for a setting. Now, there are chances that we need to make some exceptions to the rules, like in the last recipe of this chapter, <span class="emphasis"><em>Creating compliance exceptions</em></span>, where we create such exceptions.</p></div></div>
<div class="section" title="Checking the compliance of the infrastructure"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec65"/>Checking the compliance of the infrastructure</h1></div></div></div><p>We did the hard work of creating all the rules, rules groups, and templates to reach up to this: checking the compliance of the infrastructure. Now, we are ready to check how compliant we are against our internal standards, or we can directly use the standard compliance packs we downloaded and imported in the first recipe.</p><p>As we have only created test rules, we will use a standard template we imported in the first recipe.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec182"/>Getting ready</h2></div></div></div><p>All the heavy lifting should have been done on the VCM server; for instance, it should be ready with the templates and at least one machine group that will have the machines for which we need to check compliance, or we can use the default machine groups available. The preferred alternative is our own machine group.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec183"/>How to do it...</h2></div></div></div><p>As mentioned earlier, we will use an imported standard template called <span class="strong"><strong>International Organization for Standardization 27001-27002- Windows 2008 R2 Mbr Server Controls</strong></span>, and we will run this against the default machine group, <span class="strong"><strong>All Machines</strong></span>.</p><p>Follow this process to check the compliance of Windows servers:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Once logged in to VCM, go to <span class="strong"><strong>Compliance </strong></span>| <span class="strong"><strong>Templates</strong></span>.<div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note47"/>Note</h3><p>Note that you should make sure the correct machine group is selected at the top; this is how VCM decides which machines to apply the template to in order to measure compliance. If you want to change the machine group, click on the machine group, and in the pop-up, select the correct machine group.</p></div></div></li><li class="listitem">Select the required template on the right-hand side and click on <span class="strong"><strong>Run</strong></span>.<div class="mediaobject"><img alt="How to do it..." src="graphics/image_06_029.jpg"/></div></li><li class="listitem">Depending upon the organization's policies, decide to enforce or not enforce compliance.<div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note48"/>Note</h3><p>Note that not all rules are enforceable; also, we can create issues, such as breaking a working application. For example, if the print spooler service is required to be disabled, and when we enforce the compliance, we disable the service, this will create an issue in the printer farm as it will stop functioning. So it's better that we first learn what is noncompliant, then make necessary exceptions, and then enforce it from VCM or ask the respective server owners to take necessary action.</p></div></div></li><li class="listitem">In a few minutes, depending on how many machines you have in the machine group to check, the compliance run will finish. Click on <span class="strong"><strong>Close</strong></span>.<div class="mediaobject"><img alt="How to do it..." src="graphics/image_06_030.jpg"/></div></li><li class="listitem">The compliance status can be viewed by navigating to the template on the left-hand side and selecting the correct machine group from the top.<p>In our case, our support team needs to work a lot as we are noncompliant.</p><div class="mediaobject"><img alt="How to do it..." src="graphics/image_06_031.jpg"/></div></li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec184"/>How it works...</h2></div></div></div><p>When we ask VCM to check compliance, it first applies the filters available in the rule groups and then, only the machines that pass those filters are considered.</p><p>The compliance checks are performed on the data collected by VCM and available in the database, unlike some other tools, which performs the checks at the client end and the client submits the data. The process followed by VCM is better as this can be performed on servers that are offline at that point in time, and when we check the result, we get the value because of which a machine is noncompliant for a rule.</p><p>Again, this has some issues: firstly, we need to make sure our VCM is clean; by that, I mean that when a machine is decommissioned, it is purged from VCM; else, we will have the details of the machines that are not present in the infrastructure and that could play with our final compliance score.</p><p>The second issue is that it does not give us live details as it works on data that is in its database; again, this can give us some false positives.</p><p>To encounter this issue, we can schedule a compliance check after a full data collection for that machine group; in this way, we will not have stale data to process.</p><p>Once the compliance has been checked and if we have selected to enforce compliance, it will create jobs to enforce them and will start executing on the managed machines; for example, if we have rules to check the status of a service and we expect certain services in the running state, then VCM will start those services.</p></div></div>
<div class="section" title="Exporting compliance rules"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec66"/>Exporting compliance rules</h1></div></div></div><p>I don't know about you, but I am a lazy admin–I like to do things once and use them as many times as I can. Creating a complete compliance configuration is a huge task and can take up to months; now consider you have another VCM deployed and you want to recreate all the rules, rule groups, and templates again. Nobody will approve few months of rework and you won't enjoy the repeated work either.</p><p>This is where VMware's Export Import tool bundled with VCM comes in handy. You can export all your settings in a single XML file and then import as many VCM deployments as you want, and once they have been imported, you can modify them if required as well.</p><p>In this and the next recipe, we will have a look at those two things. First, we will export the configurations in an XML file and then import them again.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec185"/>Getting ready</h2></div></div></div><p>To start with the recipe, we need a completely functional VCM, and all the required rule groups with filters, rules, and templates should be ready before we start.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec186"/>How to do it...</h2></div></div></div><p>To work on the recipe, you don't need to log in to the VCM console, but you need to launch the <span class="strong"><strong>Import Export</strong></span> utility from the VCM server's desktop. Follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Once the <span class="strong"><strong>Import Export</strong></span> tool has been launched, click on <span class="strong"><strong>Connect to source</strong></span>.<div class="mediaobject"><img alt="How to do it..." src="graphics/image_06_032.jpg"/></div></li><li class="listitem">Select the database server and click on connect. Select the <span class="strong"><strong>VCM</strong></span> database and click on <span class="strong"><strong>OK</strong></span>.<div class="mediaobject"><img alt="How to do it..." src="graphics/image_06_033.jpg"/></div></li><li class="listitem">As we want to export the compliance template (this will include all the rule groups, filters, and rules), click on <span class="strong"><strong>Compliance Template</strong></span>; the tool will show the available compliance templates on the right-hand side.</li><li class="listitem">Accept the dependency alert–we need proper documentation if we modify or create new filter sets in order to recreate them on the new environment where we will import this template again.<div class="mediaobject"><img alt="How to do it..." src="graphics/image_06_034.jpg"/></div></li><li class="listitem">Select the compliance template you have created and want to export and then go to <span class="strong"><strong>File </strong></span>| <span class="strong"><strong>Save Source Document</strong></span>.<div class="mediaobject"><img alt="How to do it..." src="graphics/image_06_035.jpg"/></div></li><li class="listitem">In the next step, use the arrow buttons to move the templates you want to export, and then click on <span class="strong"><strong>OK</strong></span>.<div class="mediaobject"><img alt="How to do it..." src="graphics/image_06_036.jpg"/></div></li><li class="listitem">Enter a comment under <span class="strong"><strong>Save Options</strong></span>.<div class="mediaobject"><img alt="How to do it..." src="graphics/image_06_037.jpg"/></div></li><li class="listitem">Provide a descriptive name and click on OK.<div class="mediaobject"><img alt="How to do it..." src="graphics/image_06_038.jpg"/></div></li><li class="listitem">Click on <span class="strong"><strong>OK </strong></span>to complete the save.</li><li class="listitem">Now, we are done with the export and are ready to share our hard work with the world.</li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec187"/>How it works...</h2></div></div></div><p>The data is exported in XML format, which can be used with the same utility again in any other environment to recreate the compliance details, which could have taken a few months to recreate.</p></div></div>
<div class="section" title="Compliance reports"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec67"/>Compliance reports</h1></div></div></div><p>It does not matter how compliant you are unless you can give a full report showing all the details of the infrastructure. VCM does not let you down here as well: there are 15 default reports available to be exported. We will look how we can do that in this recipe.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec188"/>Getting ready</h2></div></div></div><p>We will need a fully deployed VCM server, and we should have finished checking the compliance of the infrastructure so that we can look at the options to get the reports.</p><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note49"/>Note</h3><p>Note that if we have not run the compliance run, we cannot see the reports-quite obvious, but we do miss this.</p></div></div></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec189"/>How to do it...</h2></div></div></div><p>To get the reports out of VCM, follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Log in to the VCM console and go to <span class="strong"><strong>Reports </strong></span>| <span class="strong"><strong>Machine Group Reports</strong></span> | <span class="strong"><strong>Compliance</strong></span>.</li><li class="listitem">Select the required report; use this list to understand what can be seen in the report:<div class="informaltable"><table border="1"><colgroup><col/><col/><col/></colgroup><tbody><tr><td>
<p><span class="strong"><strong>Sr. no.</strong></span></p>
</td><td>
<p><span class="strong"><strong>Name</strong></span></p>
</td><td>
<p><span class="strong"><strong>Description</strong></span></p>
</td></tr><tr><td>
<p><span class="strong"><strong>1</strong></span></p>
</td><td>
<p>Compliance badge mapping result by object</p>
</td><td>
<p>Displays the compliance badge mapping result by object in detail</p>
</td></tr><tr><td>
<p><span class="strong"><strong>2</strong></span></p>
</td><td>
<p>Compliance badge mapping result by template</p>
</td><td>
<p>Displays the compliance badge mapping result by template in detail</p>
</td></tr><tr><td>
<p><span class="strong"><strong>3</strong></span></p>
</td><td>
<p>Compliance badge rollup detail</p>
</td><td>
<p>Displays the compliance badge rollup in detail</p>
</td></tr><tr><td>
<p><span class="strong"><strong>4</strong></span></p>
</td><td>
<p>Compliance badge rollup summary</p>
</td><td>
<p>Displays the compliance badge rollup summary</p>
</td></tr><tr><td>
<p><span class="strong"><strong>5</strong></span></p>
</td><td>
<p>Compliance change history</p>
</td><td>
<p>Compliance change history for a series of compliance runs</p>
</td></tr><tr><td>
<p><span class="strong"><strong>6</strong></span></p>
</td><td>
<p>Compliance machine group summary</p>
</td><td>
<p>Displays compliance summary broken down by machine group</p>
</td></tr><tr><td>
<p><span class="strong"><strong>7</strong></span></p>
</td><td>
<p>Compliance results detail by machine</p>
</td><td>
<p>Displays results of compliance run grouped by machine and includes rule description</p>
</td></tr><tr><td>
<p><span class="strong"><strong>8</strong></span></p>
</td><td>
<p>Compliance results detail by rule</p>
</td><td>
<p>Displays results of compliance run grouped by rule name and includes rule description</p>
</td></tr><tr><td>
<p><span class="strong"><strong>9</strong></span></p>
</td><td>
<p>Compliance results details</p>
</td><td>
<p>Compliance results details by compliance template</p>
</td></tr><tr><td>
<p><span class="strong"><strong>10</strong></span></p>
</td><td>
<p>Compliance results machine group details</p>
</td><td>
<p>Displays results of compliance run grouped by machine groups</p>
</td></tr><tr><td>
<p><span class="strong"><strong>11</strong></span></p>
</td><td>
<p>Compliance results summary</p>
</td><td>
<p>Compliance results summary by compliance template</p>
</td></tr><tr><td>
<p><span class="strong"><strong>12</strong></span></p>
</td><td>
<p>Compliance results summary for rules</p>
</td><td>
<p>Compliance results summary for rules by compliance template for asset classification and rule severity</p>
</td></tr><tr><td>
<p><span class="strong"><strong>13</strong></span></p>
</td><td>
<p>Compliance results trends</p>
</td><td>
<p>Compliance results trends for selected templates</p>
</td></tr><tr><td>
<p><span class="strong"><strong>14</strong></span></p>
</td><td>
<p>Compliance rule details by rule group</p>
</td><td>
<p>Shows existing compliance rule details and the rule groups that contain them</p>
</td></tr><tr><td>
<p><span class="strong"><strong>15</strong></span></p>
</td><td>
<p>Compliance template listing</p>
</td><td>
<p>Compliance template listing by template with rule group details</p>
</td></tr></tbody></table></div></li><li class="listitem">Once the report is selected, click on <span class="strong"><strong>Run</strong></span> in the top menu. This will launch a wizard for you to follow.<div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note50"/>Note</h3><p>Note that you have to make sure you have selected the correct machine group from the top; if you have never run a compliance check against that machine group, there won't be any options in the dropdown for the next window.</p></div></div><div class="mediaobject"><img alt="How to do it..." src="graphics/image_06_039.jpg"/></div></li><li class="listitem">Select the options (they will differ for each selected report); the dropdown options will vary depending upon which template you have used to check the compliance.</li><li class="listitem">The rest you can choose depending upon your requirement; once all the required options have been selected, click on <span class="strong"><strong>View Report</strong></span>.<div class="mediaobject"><img alt="How to do it..." src="graphics/image_06_040.jpg"/></div></li><li class="listitem">The report will be displayed, and it can be exported to various formats, such as XML, CSV, PDF, and MHTML.<div class="mediaobject"><img alt="How to do it..." src="graphics/image_06_041.jpg"/></div></li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec190"/>How it works...</h2></div></div></div><p>VCM uses SSRS for its reporting functionality. When we click on the Run button, in order to display the report, VCM launches another Internet Explorer window, which takes us to SSRS. Then, the report asks us for options, such as the compliance template, the machines, and severity (they vary per report), and then goes to the VCM database and fetches the data. The data is presented in a nice report on the screen or can be exported to the formats shown in the previous screenshot.</p></div></div>
<div class="section" title="Creating compliance exceptions"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec68"/>Creating compliance exceptions</h1></div></div></div><p>As you know, every rule has an exception, and this is applicable to compliance as well. You create a rule for disabling the print spooler service on all servers, and then you have print servers that need this service running. Now, we can't disable this service if we know this is a known and accepted deviation, and we don't want our compliance score to get a hit because of this. What we can do is add an exception so that this will not create issues when checking compliance.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec191"/>Getting ready</h2></div></div></div><p>Our organization has a policy to disable unwanted services on servers, and the print spooler is considered an unwanted service, so it must be disabled on all the servers. Of course, the exceptions are the print servers. We will create an exception for the print server machine group to be excused from this mandate.</p><p>We will need the required rules created in VCM along with a machine group that includes all the print servers.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec192"/>How to do it...</h2></div></div></div><p>Let's create an exception for our print servers by following these steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Log in to VCM and go to <span class="strong"><strong>Compliance </strong></span>| <span class="strong"><strong>Machine Group Compliance</strong></span> | <span class="strong"><strong>Exceptions</strong></span>.</li><li class="listitem">Click on <span class="strong"><strong>Add</strong></span>.<div class="mediaobject"><img alt="How to do it..." src="graphics/image_06_042.jpg"/></div></li><li class="listitem">Provide a descriptive name and description, and click on <span class="strong"><strong>Next</strong></span>.<div class="mediaobject"><img alt="How to do it..." src="graphics/image_06_043.jpg"/></div></li><li class="listitem">Select the template for which you want this machine group to be excluded.</li><li class="listitem">In this case, we are selecting the one created by our organization rules; click on <span class="strong"><strong>Next</strong></span>.<div class="mediaobject"><img alt="How to do it..." src="graphics/image_06_044.jpg"/></div></li><li class="listitem">Select the machine group created for this exception–in our case, it is named <span class="strong"><strong>Print Servers – </strong></span>and click on <span class="strong"><strong>Next</strong></span>.<div class="mediaobject"><img alt="How to do it..." src="graphics/image_06_045.jpg"/></div></li><li class="listitem">Select <span class="strong"><strong>Override non-compliant results to compliant</strong></span>.</li><li class="listitem">I really don't know why there is another option, but there must be a use case that I am not aware of.<div class="mediaobject"><img alt="How to do it..." src="graphics/image_06_046.jpg"/></div></li><li class="listitem">We want this exception only for our rule for the print spooler server, called <span class="strong"><strong>Service_Print_Spooler</strong></span>, so selected that rule. Depending upon your requirement, you can have an exception for a complete rule group as well. But an exception to a single rule is sufficient in our case.</li><li class="listitem">Click on <span class="strong"><strong>Finish</strong></span>.<div class="mediaobject"><img alt="How to do it..." src="graphics/image_06_047.jpg"/></div></li><li class="listitem">You can enable/disable this exception as required.<div class="mediaobject"><img alt="How to do it..." src="graphics/image_06_048.jpg"/></div></li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec193"/>How it works...</h2></div></div></div><p>Exceptions are considered when we perform a compliance check, and a final score is calculated. By creating an exception, we make sure that we don't get a bad score because we need to have some things noncompliant. Also, this helps when we enforce compliance. Like in the earlier case, if we enforce that the service status should be disabled, then VCM will disable the print spooler service on all servers including the print servers, and that will affect productivity.</p><p>So, creating a compliance exception is a win-win situation for both the teams–the security team has a nice compliant environment and the printer admin team has a working print farm.</p></div></div></body></html>