- en: Installing and Configuring Horizon 7 - Part 2
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In the previous part of this chapter, we installed the core Horizon View Connection
    Server. Now, in this second part, we are going to continue building out the environment
    and install the other server roles and components, starting with the Replica Server.
  prefs: []
  type: TYPE_NORMAL
- en: 'In this chapter, we will cover the following topics:'
  prefs: []
  type: TYPE_NORMAL
- en: Installing a Horizon View Replica Server
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Installing a Security Server
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Installing an Enrollment Server
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Configuring the Cloud Pod Architecture
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Configuring View for GPU-enabled virtual desktops
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Installing a Horizon View Replica Server
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this section, we are going to deploy a second View Connection Server. Additional
    View Connection Servers are referred to as Replica Servers. This is due to the
    nature in which View shares its configurations between multiple View Connection
    Servers using the ADAM database.
  prefs: []
  type: TYPE_NORMAL
- en: Additional Connection Servers are generally deployed for availability reasons,
    as discussed in the previous chapters. For test purposes, you could roll out a
    single View Connection Server.
  prefs: []
  type: TYPE_NORMAL
- en: 'This second instance of the Connection Server is going to be installed on the
    virtual machine with the hostname `hzn7-cs2.pvolab.com`. This was built at the
    start of the previous chapter. It will also need a static IP address assigned
    to it and needs to be joined to the domain. Since the screenshots are almost identical
    to those from the first Connection Server install, we will only highlight and
    show the differences in this section:'
  prefs: []
  type: TYPE_NORMAL
- en: Open a console to the `hzn7-cs2` virtual machine, and then locate the Horizon
    View installation software. In the example lab, this was saved to a shared folder
    on the Domain Controller.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Launch the `VMware-Horizon-Connection-Server-x86_64-7.6.0-9823717` file to start
    the installation. This is the same installer application that you used for the
    first Connection Server, but it will be configured differently to reflect the
    fact that this is a Replica Server.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: If you see the **Open File - Security Warning** message, click the Run button.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: You will now see the Welcome to the Installation Wizard for VMware Horizon 7
    Connection Server screen.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click the Next > button to start the installation. You will now see the License
    Agreement screen.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click the radio button for I accept the terms in the license agreement, and
    then click the **Next >** button. You will now see the Destination Folder screen.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Leave the folder with its default settings and then click the Next > button
    to continue.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'You will now see the Installation Options screen, as shown in the following
    screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/46603283-87f3-408c-99be-2339f8fe5439.png)'
  prefs: []
  type: TYPE_IMG
- en: As this is the second Connection Server, or Replica Server, from the list of
    Horizon 7 Connection Server instances, select the option for Horizon 7 Replica
    Server from the list (**1**).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Like before, we are going to install HTML access, so check the box for Install
    HTML Access (**2**). This will allow users to access their desktops from an HTML
    5 web browser. This setting should match that of the original Connection Server
    so that this server is capable of delivering the same features and functionality.
    Don't forget that a Replica Server could take over should the first Connection
    Server be unavailable.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'The final option on this screen is to select which IP protocol to use: either
    IPv4 or IPv6\. In the example lab, select the IPv4 option (**3**). Again, as a
    reminder, you cannot mix the IP protocol version between the different View server
    instances.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click the Next > button to continue.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'You will now see the Source Server configuration screen, as shown in the following
    screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/d45a5113-41a5-47e4-8c17-5abb4725ed64.png)'
  prefs: []
  type: TYPE_IMG
- en: The Source Server is the Connection Server that you want to use as the source
    to replicate from, so in the Server box (**4**), type in the address of the first
    Connection Server. In the example lab, this is `hzn7-cs1.pvolab.com`.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click the Next > button to continue. You will now see the Firewall Configuration
    screen.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click the radio button for **Configure Windows Firewall automatically**, and
    then click the Next > button to continue. You will now see the Ready to Install
    the Program screen.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click the Install button to start the process.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The install will start and you will see the program filed install, and also
    the status of the initial replication. Once the Replica Server has been installed,
    you will see the Installer Completed screen. Click the Finish button on this screen
    to close the installer.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: You will now see the icon on the desktop for the Horizon 7 Administrator console.
    To check that the Replica Server has been installed correctly and that it is up
    and running, log in to the View Administrator.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'From the Inventory menu, expand the View Configuration section, and then click
    on Servers (**5**). Click the Connection Servers tab (**6**). You will now see
    the Replica Server `hzn7-cs2` listed (**7**), as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/02b0e666-0987-4fdc-b2a4-11a48ef3132e.png)'
  prefs: []
  type: TYPE_IMG
- en: You have successfully installed and configured the Replica Server.
  prefs: []
  type: TYPE_NORMAL
- en: Now that you have two Connection Servers, don't forget that Horizon View, as
    standard, includes no method to load balance Connection Servers or Security Servers.
    As such, you should work with the relevant documentation from your load balancing
    manufacturer to configure your load balancers to work with your View Connection
    Servers as required. This allows users to be load balanced for availability and
    scale.
  prefs: []
  type: TYPE_NORMAL
- en: In the next section, we are going to install a Horizon View Security Server.
  prefs: []
  type: TYPE_NORMAL
- en: Installing a Security Server
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The next component that we are going to install is the Security Server so that
    you can allow external access to your end users.
  prefs: []
  type: TYPE_NORMAL
- en: The Security Server is another instance of the Connection Server and is going
    to be installed on the virtual machine with the hostname `hzn7-sec.pvolab.com.`
    This was built in the previous chapter. It will also need a static IP address
    assigned to it, but this should not be joined to the domain.
  prefs: []
  type: TYPE_NORMAL
- en: Don't forget that a Security Server has a one-to-one relationship with a Connection
    Server. If you wish to roll out a number of Security Servers, you will want to
    have multiple View Connection Servers.
  prefs: []
  type: TYPE_NORMAL
- en: It is also recommended that you have dedicated external View Connection Servers
    ready to pair with your Security Servers and separate View Connection Servers
    for internal connections. This will allow you to specify which users can access
    desktops from outside the organization by using the tagging functionality, which
    we will discuss later in this chapter and in [Chapter 8](d44c9a7b-bcae-4758-a857-197be388a4be.xhtml),
    *Configuring and Managing Desktop Pools - Part 1*.
  prefs: []
  type: TYPE_NORMAL
- en: Preparing View Administrator for the Security Server install
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Before we start with the installation, we need to prepare the Connection Server
    for the Security Server by creating a pairing password. This password will be
    used to connect the two servers together securely. It''s the same kind of process
    you would use to pair your Bluetooth cell phone to the hands-free system in your
    car:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Log in to the View Administrator. You will then see the main configuration
    screen, as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/d6cd5ee8-b53e-4e3c-a0ac-20fe2bb84e5d.png)'
  prefs: []
  type: TYPE_IMG
- en: From the Inventory menu, expand the View Configuration section, and then click
    on Servers (**1**). Now, click the Connection Servers tab (**2**). You will then
    see the Connection Server within your environment. In the example lab, we have
    two, `hzn7-cs1` and `hzn7-cs2`.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click to select the Connection Server you want to pair the Security Server with.
    In the example lab, we are going to pair it with the Connection Server called
    `hzn7-cs2` (**3**).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Now, click the More Commands button (**4**) and select the option for Specify
    Security Server Pairing Password… (**5**). You will now see the Specify Security
    Server Pairing Password screen, as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/7f5140fa-f332-4c8c-9a7e-251401d180c8.png)'
  prefs: []
  type: TYPE_IMG
- en: In the Pairing password (**6**) box, type in the password you want to use for
    pairing. You will need to remember this password as you will enter it again during
    the installation of the Security Server. Type the password again in the Confirm
    password box (**7**).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In the Password timeout box (**8**), enter a time for this password to be valid
    for. Make sure that the time you set will give you enough time to install the
    Security Server. This will save you from having to come back and set up a new
    pairing password. From the dropdown box (**9**), you can also choose whether the
    time to live for the password is in hours or minutes.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click OK once you have configured the pairing password.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: You can now go ahead and start the installation of the Security Server.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Security Server software installation
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'With the prerequisites in place and the pairing password set, we can now install
    the Security Server. As the screenshots are almost identical to those from the
    previous Connection Server installs, we will only highlight and show the differences
    in this section:'
  prefs: []
  type: TYPE_NORMAL
- en: Open a console to the `hzn7-sec.pvolab.com` virtual machine, and then locate
    the Horizon View installation software. In the example lab, this was saved to
    a shared folder on the Domain Controller.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Launch the `VMware-Horizon-Connection-Server-x86_64-7.6.0-9823717` file to start
    the installation. This is the same installer application that you used for the
    first Connection Server, but it will be configured differently to reflect the
    fact that this is a Security Server.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: If you see the Open File - Security Warning message, click the Run button.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: You will now see the Welcome to the Installation Wizard for VMware Horizon 7
    Connection Server screen.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click the Next > button to start the installation. You will now see the License
    Agreement screen.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click the radio button for I accept the terms in the license agreement, and
    then click the Next > button. You will now see the Destination Folder screen.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Leave the folder as the default setting and then click the Next > button to
    continue.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'You will now see the Installation Options screen, as shown in the following
    screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/3660595f-3d27-40e6-9b8b-c31da40de795.png)'
  prefs: []
  type: TYPE_IMG
- en: As this is the third Connection Server instance, or Security Server, from the
    list of Horizon 7 Connection Server instances, select the option for Horizon 7
    Security Server from the list (**10**).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'The final option on this screen is to select which IP protocol to use: either
    IPv4 or IPv6\. In the example lab, select the IPv4 option (**11**). Again, as
    a reminder, you cannot mix the IP protocol version between the different View
    Server instances.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Click the Next > button to continue. You will now see the Paired Horizon 7
    Connection Server screen, as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/ce5c44f0-85b1-4cc9-aace-4493d6d8993f.png)'
  prefs: []
  type: TYPE_IMG
- en: In the Server box (**12**), enter the details of the Connection Server to pair
    with. In the example lab, we are going to pair with the server called `hzn7-cs2.pvolab.com`,
    which is the Replica Server we set up in the previous section.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Click the Next > button to continue. You will now see the Paired Horizon 7
    Connection Server Password screen:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/99926b52-e21a-4bda-bba2-a4b5f262a3ad.png)'
  prefs: []
  type: TYPE_IMG
- en: In the Password box (**13**), type in the pairing password that you specified
    when you configured it in the View Administrator.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click the Next > button to continue.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'You will now see the Horizon 7 Security Server Configuration, as shown in the
    following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/886c3449-d220-453b-9c7c-474453509b3f.png)'
  prefs: []
  type: TYPE_IMG
- en: On this screen, you can specify the Security Server settings. First, in the
    External URL box (**14**), enter the address that users will use to connect their
    Horizon client to over an internet connection. In the preceding example, this
    has been left as the default; however, you would probably want to change this
    to something more user-friendly.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In the PCoIP External URL box (**15**), enter the IP address for the external
    PCoIP connection. Note that, this must contain an IP address rather than a URL,
    as the box suggests. The address must also have the port suffix added, so in this
    case, `:4172` is the default PCoIP port.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Finally, in the Blast External URL box (**16**), enter the address for the Blast
    protocol. This is used for HTML5 access.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click the Next > button to continue. You will now see the Firewall Configuration
    screen.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click the radio button for Configure Windows Firewall automatically, and then
    click the Next > button to continue. You will see the Ready to Install the Program
    screen.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click the Install button to start the installation process.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Once the Security Server has been installed, you will see the Installer Completed
    screen. Click the Finish button to exit.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Unlike when we installed the Connection Server and the Replica Server, no Horizon
    icon is placed on the desktop. The settings are managed using the View Administrator
    console. However, to check whether the Security Server is installed and running,
    on the desktop of the Security Server, launch a Services console, as shown in
    the following screenshot:'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '![](img/0c88fedf-483f-4adb-8da2-2552e88ca136.png)'
  prefs: []
  type: TYPE_IMG
- en: Scroll down until you see the entry for VMware Horizon 7 Security Server (**17**),
    and then check that it is running.
  prefs: []
  type: TYPE_NORMAL
- en: 'You also need to check that the Security Server had registered with the View
    Administrator. To do this, perform the following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: 'From the Inventory menu, expand the View Configuration section, and then click
    on Servers (**18**). Click the Security Servers tab (**19**). You will now see
    the Security Server `HZN7-SEC` listed (**20**). This is shown in the following
    screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/775293aa-43e7-4fb3-bcc2-0f8b0d5a9720.png)'
  prefs: []
  type: TYPE_IMG
- en: You have successfully installed and configured a Security Server.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: As we mentioned earlier, we recommend installing Security Servers in conjunction
    with dedicated external View Connection Servers so that you can limit access to
    the virtual desktop machines from external connections by using the tagging functionality.
  prefs: []
  type: TYPE_NORMAL
- en: 'The first step in achieving this is by tagging your external Connection Servers.
    To tag a server, perform the following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: In the View Administrator, from the Inventory menu, expand the View Configuration
    section, and then click on Servers (**21**). Click the Connection Servers tab
    (**22**) and then highlight the Connection Server that is paired with the Security
    Server for the external connections. In the example lab, this server is called
    `HZN7-CS2` (**23**).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Right-click and then from the contextual menu, click on Edit… (**24**), as
    shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/025fdfbc-2742-4053-a990-5881f31b34fb.png)'
  prefs: []
  type: TYPE_IMG
- en: 'You will now see the Edit Connection Server Settings screen, as shown in the
    following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/c100782c-5a36-4150-8755-5ca9c896689a.png)'
  prefs: []
  type: TYPE_IMG
- en: In the Tags box (**25**), type in the name for this tag. In the example lab,
    this tag is called `external`. This means that only desktop pools that have also
    been configured with the tab named `external` can connect via this Connection
    Server.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Installing an Enrollment Server
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The final component we are going to install is the Enrollment Server.
  prefs: []
  type: TYPE_NORMAL
- en: 'This FINAL instance of the Connection Server is going to be installed on the
    virtual machine with the hostname `hzn7-enrol.pvolab.com.` This was built in the
    previous chapter. It will also need a static IP address assigned to it and needs
    to be joined to the domain. As the screenshots are almost identical to those from
    the other Connection Server installs, we will only highlight and show the differences
    in this section:'
  prefs: []
  type: TYPE_NORMAL
- en: Open a console to the `hzn7-enrol.pvolab.com` virtual machine, and then locate
    the Horizon View installation software. In the example lab, this was saved to
    a shared folder on the Domain Controller.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Launch the `VMware-Horizon-Connection-Server-x86_64-7.6.0-9823717` file to start
    the installation. This is the same installer application that you used for the
    first Connection Server, but it will be configured differently to reflect the
    fact that this is a Replica Server.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: If you see the Open File - Security Warning message, click the Run button.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: You will now see the Welcome to the Installation Wizard for VMware Horizon 7
    Connection Server screen.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click the Next > button to start the installation. You will now see the License
    Agreement screen.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click the radio button for I accept the terms in the license agreement, and
    then click the Next > button. You will now see the Destination Folder screen.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Leave the folder as the default setting and then click the Next > button to
    continue.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'You will now see the Installation Options screen, as shown in the following
    screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/a7413715-5569-4014-aed5-87d4493e802d.png)'
  prefs: []
  type: TYPE_IMG
- en: As this is the final Connection Server instance, or Enrollment Server, from
    the list of Horizon 7 Connection Server instances, select the option for Horizon
    7 Enrollment Server from the list (**1**).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The final option on this screen is to select an authentication mode for this
    Enrollment Server instance. Horizon 7 supports both on-premises and Horizon Cloud
    deployments. The example lab is an on-premises environment, so click the option
    for Horizon 7 (**2**).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click the Next > button to continue. You will now see the Firewall Configuration
    screen.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click the radio button for Configure Windows Firewall automatically and then
    click Next > to continue.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: You will see the Ready to Install the Program screen.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click the Install button to start the installation process. Once the Enrollment
    Server has been installed, you will see the Installer Completed screen. Click
    the Finish button to close the installer.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'There is no user interface or console for the Enrollment Server, nor is there
    an icon on the desktop. To check whether or not it''s running, we are going to
    check the Windows Services console. To do this, press the Windows key and *R*
    to open a Run dialog box. In the box, type `services.msc`. You will now see the
    Services screen, as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/3daee796-969f-4668-aac7-935e5f975385.png)'
  prefs: []
  type: TYPE_IMG
- en: Scroll down, and you will see an entry for VMware Horizon View Enrollment Server.
    Check that the service is running, and then close the Services screen.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: You have successfully installed and configured an Horizon View Enrollment Server.
    In the next section, we are going to complete the View Administration elements
    of the installation and configuration by enabling the Cloud Pod Architecture.
  prefs: []
  type: TYPE_NORMAL
- en: Configuring Cloud Pod Architecture
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In [Chapter 3](20877fa6-9a03-4c97-ab85-4a4338e2c680.xhtml), *Design and Deployment
    Considerations*, we discussed the Cloud Pod Architecture and its ability to deliver
    multi-site View deployments to allow for scalability and also disaster recovery
    scenarios. We are now going to look at how to set up a cloud pod by using the
    example lab.
  prefs: []
  type: TYPE_NORMAL
- en: In the example lab, we have built and configured another Connection Server called
    `hzn7-cs1b.pvolab.com`, which we will use to represent a second pod, located on
    a second site.
  prefs: []
  type: TYPE_NORMAL
- en: This server is installed as a Connection Server and not a Replica Server, as
    it needs to be the first server in a different pod.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following diagram illustrates the installation we are going to follow,
    using the example lab:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/3003f856-0e22-42b3-bb9f-4af1de62c3a4.png)'
  prefs: []
  type: TYPE_IMG
- en: The first step of the process is to initialize the Cloud Pod from the first
    Connection Server.
  prefs: []
  type: TYPE_NORMAL
- en: Initializing the Cloud Pod
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'To initialize the Cloud Pod Architecture, perform the following the steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Log in to the View Administrator, and from the console screen, in the Inventory
    pane on the left, expand the View Configuration section and click Cloud Pod Architecture
    (**1**).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Now, click the option for the Initialize the Cloud Pod Architecture feature
    (**2**), as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/f567effe-84c5-412b-b3bd-01760e791d5f.png)'
  prefs: []
  type: TYPE_IMG
- en: 'You will now see the Initialize dialog box, as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/39d304ed-5328-4902-83cd-b62cad05668a.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Click the OK button to start the initialization. You will now see the initialization
    process start, and a visual representation of the progress displayed as a % bar
    across the screen. You will also see that the status is shown as Pending, as shown
    in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/411d1023-6af3-479d-840a-6fea9e0b5eae.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Once the Cloud Pod Architecture feature has complete its initialization, you
    will see the Reload dialog box, as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/36413d9f-1c1e-4c25-9fe4-5e532fe1122f.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Click the OK button to reload the client. You will now see the Cloud Pod Architecture
    screen in the View Administrator, as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/89f07272-09bc-45d3-b64c-f021cf4e6adb.png)'
  prefs: []
  type: TYPE_IMG
- en: As you can see, a Pod Federation has been created called Horizon Cloud Pod Federation.
    You can change this name by clicking the Edit… button, should you need to.
  prefs: []
  type: TYPE_NORMAL
- en: You will also see that the pods are listed, along with the site information.
    In the example lab, we only have the `HZN7-CS1` Connection Server listed, as this
    is the first Connection Server to have the Cloud Pod Architecture installed.
  prefs: []
  type: TYPE_NORMAL
- en: The next step is to connect the Connection Server in the second pod, or second
    site to the federation.
  prefs: []
  type: TYPE_NORMAL
- en: Connecting the second pod to the Cloud Pod
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The next step in this process is to connect or join your other pods to the pod
    federation.
  prefs: []
  type: TYPE_NORMAL
- en: Log in to the View Administrator console on the second Connection Server. This
    is called `hzn7-cs1b.pvolab.com`. This is the first Connection Server on the second
    site in the example lab.
  prefs: []
  type: TYPE_NORMAL
- en: 'Perform the following steps to connect the second pod to the federation:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Log in to the View Administrator console. In the Inventory pane on the left,
    expand the View Configuration section and click Cloud Pod Architecture (**1**),
    but this time click the option for Join the pod federation (**2**), as shown in
    the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/eb5c8a83-f4a3-481e-8671-d23363001f38.png)'
  prefs: []
  type: TYPE_IMG
- en: 'You will now see the Join dialog box, as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/fe88f6d1-bd38-4b00-b242-8fcf7634abed.png)'
  prefs: []
  type: TYPE_IMG
- en: Here, enter the details of a Connection Server that is in a pod that has the
    Cloud Pod Architecture already initialized.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In the Connection Server box (**3**), enter the address of the Connection Server
    from the first site. In the example lab, this is the server called `hzn7-cs1.pvolab.com`.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In the User name box (**4**), enter the username that has the correct privileges
    for joining pods together. In the example lab, we are going to use the administrator
    account. Note that you need to enter the username in the format `domain\username`,
    so in the example lab, we are going to enter this as `pvolab\username`.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click OK to continue.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: You will now see the join process start, and a visual representation of the
    progress displayed as a % bar across the screen, as well as the status, being
    shown as Pending**.**
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Once the Cloud Pod Architecture feature has completed the join to the pod federation,
    you will see the Reload dialog box.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Click the OK button to reload the client. You will now see the Cloud Pod Architecture
    screen in the View Administrator, as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/0987d34e-ab6b-41b9-9ea0-efd0be785a74.png)'
  prefs: []
  type: TYPE_IMG
- en: As you can see, both pods are now listed, along with the site information. In
    the example lab, we now have the `HZN7-CS1` and `HZN-CS1B` Connection Servers
    listed.
  prefs: []
  type: TYPE_NORMAL
- en: If you were to now look at the Sites screen, you would see that the site is
    listed with the number of pods that make up that site, as well as the details
    of the pods in the site.
  prefs: []
  type: TYPE_NORMAL
- en: 'You will also be able to see the Global Entitlements, as shown in the following
    screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/0b1ee366-f439-4904-a11d-7a5baf43ce22.png)'
  prefs: []
  type: TYPE_IMG
- en: Now that you have created a pod federation by initializing the Cloud Pod Architecture
    feature and added a second pod to the pod federation, you can now create Global
    Entitlements, which we will cover in the next section.
  prefs: []
  type: TYPE_NORMAL
- en: Entitling users to the Cloud Pod
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In this section, we are going to add a Global Entitlement by creating a desktop
    pool and then entitling a user to connect to desktops within the pool. To do this,
    follow these steps:'
  prefs: []
  type: TYPE_NORMAL
- en: From the View Administrator console, in the Inventory pane on the left, expand
    the Catalog section, and then click on Global Entitlement (**1**).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Next, click the Add… button (**2**), as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/e15c5a15-80ad-4e7c-bb52-8eb5e9f9b2f9.png)'
  prefs: []
  type: TYPE_IMG
- en: 'You will now see the Add Global Entitlement dialog box and the first section
    where you choose the type of entitlement you want to create, as shown in the following
    screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/fca48d6a-1d55-4a99-8c89-ecced54c4452.png)'
  prefs: []
  type: TYPE_IMG
- en: 'In this example, we are going to create a desktop entitlement, so click the
    radio button for Desktop Entitlement (**3**), and then click the Next > button.
    You will now see the Name and Policies configuration screen, as shown in the following
    screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/b61344d1-b5ed-41ac-ad1c-5800a33752a5.png)'
  prefs: []
  type: TYPE_IMG
- en: In the General section, enter a Name (**4**) for the policy name. In the example
    lab, we will call this `Global Desktop Pool`.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In the Policies section, under User assignment, click the radio button for Dedicated
    (**5**). You can specify the user assignment and whether the desktop pool is floating
    or dedicated. Under Scope, click the radio button for All sites (**6**). You can
    choose from either All sites, Within site, or Within pod.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Check the box for Use Home Site (**7**).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: You then have the option to choose the Default display protocol. In the example
    lab, we are going to select PCoIP, so from the dropdown menu, select PCoIP.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: From the Allow users to choose protocol option, choose whether you want users
    to change protocol. In the example lab, from the dropdown menu (**9**), select
    Yes.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Finally, check the box if you want to enable HTML Access (**10**).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click the Next > button to continue.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'You will now see the Users and Groups configuration screen, as shown on the
    following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/5fb2cb99-99d6-485b-bf92-05c8680c2d63.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Click the Add… button (**11**). You will now see the Find User or Group configuration
    screen, as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/64df7aa6-0d4f-46e1-b7f0-9fdfb3cabcf1.png)'
  prefs: []
  type: TYPE_IMG
- en: Click the dropdown arrow (**12**) and select the domain in which the user resides.
    In the example lab, this is `pvolab.com`. Then, in the Name/User name box (**13**),
    enter the name of the user you want to entitle to this pool, and then click the
    Find button (**14**). The details of the user are then displayed. Click to highlight
    and select the user (**15**), and then click the OK button.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'You will return to the Users and Groups screen, which now shows the selected
    user, as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/1f598aa0-850d-4aea-8181-1305a266481f.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Click the Next > button to continue. You will now see the Ready to Complete
    screen, as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/ae76a00c-2618-4e10-95ac-8b7b6979d830.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Check that the details have been entered correctly and then click the Finish
    button. You will return to the Global Entitlements screen, which will now show
    the Global Desktop Poo**l** and the number of assigned users, as shown in the
    following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/a4fc4396-b2be-48ad-a8ae-8df35c22fa37.png)'
  prefs: []
  type: TYPE_IMG
- en: You have now successfully configured a Cloud Pod federation.
  prefs: []
  type: TYPE_NORMAL
- en: In the final section of this chapter, we are going to finish off the installation
    by configuring the ESXi host servers with NVIDIA graphics cards.
  prefs: []
  type: TYPE_NORMAL
- en: Configuring View for GPU-enabled virtual desktops
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In [Chapter 2](5d942e5b-dda5-4e5a-8278-62a64210aeef.xhtml), *Understanding Horizon
    7 Architecture and Components*, we discussed that Horizon View virtual desktop
    machines can be configured to use hardware that's been installed in the ESXi host
    server hosting those desktops. In this case, the hardware in question is a graphics
    card.
  prefs: []
  type: TYPE_NORMAL
- en: As we discussed earlier, an advanced feature of Horizon View is its ability
    to use dedicated hardware installed that's been on the ESXi host servers, configured
    with PCI pass-through so that the virtual desktop machine can see the hardware.
  prefs: []
  type: TYPE_NORMAL
- en: In this section, we will perform the initial steps to install a NVIDIA GRID
    GPU card into one of the host servers. Later on, in [Chapter 7](d42ce468-eec2-4d43-ba82-25b90b59f936.xhtml),
    *Building and Optimizing the Virtual Desktop OS*, we will create a virtual desktop
    machine image, which will have a dedicated assignment and access to the GPU resource.
  prefs: []
  type: TYPE_NORMAL
- en: If you are going to be using vGPU, you will need vSphere 6 installed as the
    hypervisor to support this.
  prefs: []
  type: TYPE_NORMAL
- en: Configuring the ESXi host servers
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Before you build the virtual desktop machine, you need to have the graphics
    card physically installed and configured into the ESXi host in preparation to
    build the new virtual desktop machines that will use it.
  prefs: []
  type: TYPE_NORMAL
- en: In the example lab, we are using the NVIDIA GRID K2 card. These cards are available
    via the OEM route and come already configured from the server vendors due to them
    requiring additional power connectors, cooling fans, and specific BIOS settings.
  prefs: []
  type: TYPE_NORMAL
- en: 'It''s worth checking these before you start, as just retrofitting the cards
    to an existing server might mean that they do not work. You will find the list
    of certified servers by clicking on the following link: [http://www.nvidia.com/object/grid-partners.html](http://www.nvidia.com/object/grid-partners.html).'
  prefs: []
  type: TYPE_NORMAL
- en: 'With the hardware installed, log in to the vSphere Web Client, select the host
    that the card has been installed on, and perform the following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Login into the vSphere Web Client and then navigate to the host server that
    has the NVIDIA card installed. In the example lab, this is host `esx-1.pvolab.com`,
    as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/5e6570e3-f4ac-4029-a72f-618c00171952.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Select the ESXi host server `esx-1.pvolab.com` (**1**) and then click the Manage
    tab (**2**). Click the Settings button (**3**) and expand the Hardware section.
    Click on PCI Devices (**4**) and then click the pencil icon (**5**) to edit the
    settings. You will now see the Edit PCI Device Availability screen, as shown in
    the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/295bc235-0edb-41db-8db6-937f0716ffe8.png)'
  prefs: []
  type: TYPE_IMG
- en: As you can see, this host server has been configured with two NVIDIA GRID K2
    graphics cards. Check boxes (**6**) and (**7**) to enable the cards on the host
    server.
  prefs: []
  type: TYPE_NORMAL
- en: You now configured the ESXi host server to use the NVIDIA GRID K2 GPU cards.
    These will be used when we build the virtual desktop machines in later this book,
    in [Chapter 7](d42ce468-eec2-4d43-ba82-25b90b59f936.xhtml), *Building and Optimizing
    the Virtual Desktop OS*.
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, we completed the installation of the Horizon View Environment,
    including the Replica Server, the Security Server, and the Enrollment Server.
  prefs: []
  type: TYPE_NORMAL
- en: We discussed the initial configuration items that you will need to undertake,
    such as licensing your environment, connecting your vCenter and View Composer
    Servers, and configuring the View Security Server for external connections. We
    also looked at the configuration items that are needed to prepare our environment
    for advanced graphics with NVIDIA GRID.
  prefs: []
  type: TYPE_NORMAL
- en: The final part of this chapter covered how to initialize and configure the Cloud
    Pod Architecture feature.
  prefs: []
  type: TYPE_NORMAL
- en: Having completed this chapter, you should have built a fully functioning View
    deployment, which is ready to deliver virtual desktop machines to your end users.
    The next steps are to start building the virtual desktops, preparing them for
    delivery before configuring Horizon View to deliver them.
  prefs: []
  type: TYPE_NORMAL
- en: But before we start building our virtual desktop machines, we are going to look
    at the security considerations in the next chapter, [Chapter 6](8b824015-c1b0-4107-9c9d-dd5cdb4b3221.xhtml),
    *Securing Horizon View with SSL Certificates*, where we are going to configure
    SSL certificates across our environment to ensure it is secure. We will also take
    a look at configuring the True SSO feature.
  prefs: []
  type: TYPE_NORMAL
